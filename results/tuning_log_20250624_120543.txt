2025-06-24 12:05:43,223 - src.hyperparameter_tuning - INFO - MLflow 실험 설정: hyperparameter_tuning (ID: 765186397364671153)
2025-06-24 12:05:43,223 - src.hyperparameter_tuning - INFO - 전달받은 데이터 사용: (1333765, 33)
2025-06-24 12:05:43,223 - src.hyperparameter_tuning - INFO - 모델 타입: lightgbm
2025-06-24 12:05:43,223 - src.hyperparameter_tuning - INFO - 튜닝 설정 - 시도 횟수: 100, 타임아웃: 3600초
2025-06-24 12:05:43,223 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 튜너 초기화 완료
2025-06-24 12:05:43,224 - src.hyperparameter_tuning - INFO -   - 튜닝 설정: {'data': {'file_path': 'data/processed/processed_data_with_features.csv', 'encoding': 'utf-8', 'na_values': ['', 'nan', 'NaN', 'NULL', 'null']}, 'features': {'target_columns': ['suicide_a_next_year'], 'exclude_columns': ['id', 'patient_id', 'visit_date', 'visit_year'], 'categorical_columns': ['gender', 'marital_status', 'education_level', 'income_level', 'residence_type', 'insurance_type', 'primary_diagnosis', 'comorbidity', 'medication_type', 'treatment_type', 'follow_up_status'], 'selected_features': ['age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score'], 'validation': {'scope': 'sample', 'sample_size': 10}, 'enable_feature_engineering': False, 'enable_lagged_features': False, 'lag_periods': [1, 2, 3], 'lagged_features': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}, 'enable_rolling_stats': False, 'rolling_stats': {'window_sizes': [2, 3], 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}}, 'preprocessing': {'time_series_imputation': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp'], 'fallback_strategy': 'mean'}, 'numerical_imputation': {'strategy': 'mean', 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']}, 'categorical_imputation': {'strategy': 'most_frequent', 'columns': ['sex']}, 'categorical_encoding': {'method': 'ordinal'}, 'missing_value_strategy': 'median', 'outlier_detection': {'method': 'iqr', 'threshold': 1.5}, 'scaling': {'method': 'robust', 'with_mean': True, 'with_std': True}, 'feature_selection': {'method': 'variance_threshold', 'threshold': 0.01}}, 'data_split': {'test_ids_ratio': 0.15, 'random_state': 42, 'method': 'stratified_kfold', 'n_splits': 5, 'test_size': 0.2, 'val_size': 0.2}, 'validation': {'strategy': 'group_kfold', 'num_cv_folds': 5, 'test_size': 0.15, 'random_state': 42, 'val_ids_ratio': 0.15, 'validation_start_year': 2021, 'min_train_years': 3, 'max_train_years': 8}, 'time_series': {'date_column': 'dov', 'year_column': 'yov', 'id_column': 'id'}, 'evaluation': {'regression_metrics': ['mae', 'rmse', 'r2'], 'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2'], 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True, 'primary_metric': 'pr_auc', 'secondary_metrics': ['recall', 'precision', 'balanced_accuracy', 'roc_auc'], 'metrics': {'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy', 'pr_auc'], 'regression_metrics': ['mae', 'rmse', 'r2'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2', 'pr_auc']}}, 'training': {'early_stopping': True, 'patience': 10, 'handle_imbalance': True, 'save_best_model': True, 'model_save_path': 'models/'}, 'logging': {'log_splits_info': True, 'log_fold_details': True, 'level': 'INFO', 'format': '%(asctime)s - %(name)s - %(levelname)s - %(message)s', 'file': 'logs/experiment.log'}, 'output': {'directory': 'results', 'save_model': True, 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True}, 'mlflow': {'experiment_name': 'hyperparameter_tuning', 'experiment_description': '자살 위험 예측 모델 실험', 'tags': ['suicide_prediction', 'healthcare', 'classification', 'regression'], 'nested_runs': True, 'save_artifacts': True, 'log_params': True, 'log_metrics': True, 'log_model': True, 'tracking': {'tracking_uri': 'file:./mlruns', 'experiment_name': 'suicide_prediction', 'nested_runs': True, 'artifact_location': './mlruns'}, 'logging': {'param_logging_level': 'INFO', 'metric_logging_level': 'INFO', 'artifact_logging_level': 'INFO', 'log_experiment_info': True, 'log_fold_results': True, 'log_model_info': True}, 'log_optimization': True}, 'model': {'model_type': 'lightgbm', 'lightgbm': {'num_leaves': 31, 'learning_rate': 0.1, 'feature_fraction': 0.9, 'bagging_fraction': 0.8, 'bagging_freq': 5, 'min_data_in_leaf': 20, 'min_sum_hessian_in_leaf': '1e-3', 'lambda_l1': 0.1, 'lambda_l2': 0.1, 'num_threads': 28, 'verbose': -1, 'early_stopping_rounds': 10, 'max_cat_threshold': 32, 'cat_smooth': 10.0, 'cat_l2': 10.0, 'is_unbalance': True, 'scale_pos_weight': 1.0, 'class_weight': 'balanced', 'boosting_type': 'gbdt', 'objective': 'binary', 'metric': 'binary_logloss', 'max_depth': 6, 'min_gain_to_split': 0.0, 'min_child_samples': 20, 'bagging_seed': 42, 'feature_fraction_seed': 42, 'drop_seed': 42, 'data_random_seed': 42, 'use_focal_loss': False, 'focal_loss': {'alpha': 0.25, 'gamma': 2.0}}}, 'imbalanced_data': {'resampling': {'enabled': False, 'method': 'smote', 'smote': {'k_neighbors': 5, 'sampling_strategy': 'auto'}, 'borderline_smote': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'm_neighbors': 10}, 'adasyn': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'n_neighbors': 5}, 'under_sampling': {'strategy': 'random', 'sampling_strategy': 'auto'}}, 'class_weight': 'balanced', 'scale_pos_weight': 1.0, 'is_unbalance': True}, 'experiment': {'name': 'hyperparameter_tuning_experiment', 'description': 'Optuna 기반 하이퍼파라미터 최적화 실험', 'tags': ['hyperparameter_tuning', 'optuna', 'optimization']}, 'tuning': {'direction': 'maximize', 'n_trials': 100, 'n_jobs': 1, 'early_stopping': {'enabled': True, 'patience': 20, 'min_trials': 30}}, 'sampler': {'type': 'tpe', 'tpe': {'n_startup_trials': 10, 'n_ei_candidates': 24, 'multivariate': True, 'group': False}, 'cmaes': {'x0': {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'min_child_weight': 1, 'reg_alpha': 0.1, 'reg_lambda': 1.0}, 'sigma0': 0.1}}, 'xgboost_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 15, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'scale_pos_weight': {'type': 'float', 'low': 0.5, 'high': 10.0, 'log': True}}, 'lightgbm_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 12, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}}, 'catboost_params': {'iterations': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'depth': {'type': 'int', 'low': 3, 'high': 10, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'l2_leaf_reg': {'type': 'float', 'low': 1, 'high': 10, 'log': True}, 'border_count': {'type': 'int', 'low': 32, 'high': 255, 'log': False}, 'bagging_temperature': {'type': 'float', 'low': 0.1, 'high': 1.0, 'log': False}, 'random_strength': {'type': 'float', 'low': 0.1, 'high': 10.0, 'log': True}}, 'random_forest_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 20, 'log': False}, 'min_samples_split': {'type': 'int', 'low': 2, 'high': 20, 'log': False}, 'min_samples_leaf': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'max_features': {'type': 'categorical', 'choices': ['sqrt', 'log2', 'auto']}}, 'cv': {'strategy': 'group_kfold', 'n_folds': 5, 'shuffle': False}, 'results': {'save_best_model': True, 'model_save_path': 'models/best_tuned_model.joblib', 'save_study': True, 'study_save_path': 'models/optuna_study.pkl', 'create_plots': True, 'plots_save_path': 'data/tuning_results/'}}
2025-06-24 12:05:43,224 - src.hyperparameter_tuning - INFO -   - 튜닝 횟수: 100
2025-06-24 12:05:43,224 - src.hyperparameter_tuning - INFO -   - 타임아웃: 3600초
2025-06-24 12:05:43,247 - __main__ - INFO - MLflow Run 시작: acf4c0d8f13c4e58aeaf6ae27b4aa629
2025-06-24 12:05:43,250 - __main__ - INFO - 튜닝 파라미터 로깅 완료: 6개 파라미터
2025-06-24 12:05:43,251 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 최적화 시작
2025-06-24 12:05:43,256 - src.hyperparameter_tuning - INFO - Trial 0: 모델 타입 = lightgbm
2025-06-24 12:05:45,313 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:05:45,313 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:05:45,313 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:05:45,313 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:05:45,313 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:05:45,313 - src.training - INFO - 교차 검증 시작
2025-06-24 12:05:45,314 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:05:45,331 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:05:45,794 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:05:45,794 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:05:45,794 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:05:45,794 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:05:45,794 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:05:45,794 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:05:45,794 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:05:45,794 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:05:45,794 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:05:45,963 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:05:45,963 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:05:45,963 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:05:45,963 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:05:45,963 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:05:45,963 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:05:45,963 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:05:45,963 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:05:45,963 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:05:45,963 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:05:47,410 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:05:48,541 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:05:48,541 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:05:48,546 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:05:48,577 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:05:48,577 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:05:48,577 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:05:48,577 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:05:49,925 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:05:50,197 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:05:50,197 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:05:50,363 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:05:50,363 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:05:50,406 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:05:50,406 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:05:50,406 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:05:50,406 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:05:50,406 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:50,406 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:05:50,468 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:05:50,468 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:05:50,468 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:50,468 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:50,468 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:05:50,468 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:05:50,468 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:50,534 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:05:50,534 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:05:50,534 - src.training - INFO - 모델 학습 시작
2025-06-24 12:05:50,666 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:05:50,666 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:05:50,666 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:05:50,666 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:05:50,666 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:05:50,666 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:05:50,666 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:05:50,666 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:05:50,666 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:05:50,666 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:05:50,666 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:05:50,666 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:05:50,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:05:50,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:50,667 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:05:50,759 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:05:50,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:05:50,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:05:50,958 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:05:51,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:05:51,105 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:05:51,121 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:05:51,122 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:51,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:05:51,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:51,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:05:51,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:51,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:05:51,212 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:05:51,227 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:05:51,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:05:51,260 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:05:51,277 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:05:51,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:05:51,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:05:51,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:51,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:05:51,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:51,313 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:05:51,313 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:51,313 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:05:51,327 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   learning_rate: 0.1205712628744377
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   n_estimators: 406
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   subsample: 0.8394633936788146
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6624074561769746
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   reg_alpha: 3.3323645788192616e-08
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO -   reg_lambda: 0.6245760287469893
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:05:51,331 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:05:51,466 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:05:51,466 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.7087992977540456})})
2025-06-24 12:05:51,466 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:05:51,466 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:05:51,466 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:05:51,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:05:51,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:51,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:05:51,491 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:05:51,506 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:05:51,521 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:05:51,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:05:51,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:05:51,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:05:51,571 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:05:51,571 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:51,575 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:05:51,581 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:05:51,582 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:05:51,582 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:05:51,582 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:05:51,582 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:05:51,582 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:05:51,582 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:05:51,582 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:05:51,586 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:05:51,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:05:51,591 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [7.43446279e-001 1.42770457e-014 5.96039131e-001 0.00000000e+000
 3.64939500e-156 9.42132121e-030 9.64402299e-094 9.17272366e-033
 3.45460844e-010 1.23705126e-027 4.65873474e-005 7.17487841e-001
 9.98045234e-001 1.50044377e-215 3.17773976e-052 2.62013108e-021
 9.39072146e-301 2.11301064e-082 9.99999985e-001 5.50826663e-063
 1.13058639e-133 1.67168661e-104 9.80136271e-072 3.11070401e-020
 8.96674731e-307 1.13344880e-145 1.52026427e-279 9.98341004e-013
 4.13585554e-112 2.54392254e-188 3.76054208e-173 2.45742501e-014
 1.71838643e-012 2.24175421e-274 1.90770849e-111 5.13989591e-006
 2.42022841e-115 9.58375621e-001 2.22787522e-013 5.81291121e-023
 2.32116964e-030 3.94126688e-035 3.75122218e-183 3.43054758e-018
 2.05273152e-035 4.22936455e-173 3.31945145e-032 3.31495914e-077
 1.26257926e-072 4.13647977e-034 3.93311933e-035 8.98427957e-053
 7.14306415e-186 3.97394682e-241 5.22040542e-107 8.32810643e-028
 6.14229938e-122 2.69218988e-162 3.50761795e-127 2.32527469e-039
 5.82495280e-023 5.62466372e-037 1.04649058e-057 9.73663607e-016
 6.16320143e-053 1.17478099e-181 1.52946300e-070 4.85412778e-019
 6.58798151e-028 9.99999998e-001 9.50130548e-053 7.23247035e-038
 1.11989395e-011 5.72528841e-151 8.00501879e-113 1.04432723e-057
 1.72756952e-157 5.59569866e-048 7.56071407e-124 3.75559595e-029
 1.55787075e-011 4.53376564e-266 1.09003957e-060 1.02499152e-077
 6.03658485e-073 1.22826201e-042 4.30786863e-037 3.52861820e-063
 2.73139735e-199 6.41856447e-056 4.05150009e-054 5.95581565e-132
 5.91870443e-094 2.33908950e-070 2.35416461e-108 1.20224965e-151
 6.21947523e-149 2.69580236e-156 1.79206867e-242 3.13747303e-063
 4.62823205e-204 2.24613180e-052 2.27884315e-089 1.75788632e-141
 3.48515659e-089 2.67011584e-261 5.53005022e-149 3.95898914e-138
 4.01664553e-175 1.83319822e-180]
2025-06-24 12:05:51,591 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:05:52,371 - src.training - INFO -   precision: 0.0
2025-06-24 12:05:52,371 - src.training - INFO -   recall: 0.0
2025-06-24 12:05:52,371 - src.training - INFO -   f1: 0.0
2025-06-24 12:05:52,371 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:05:52,371 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:05:52,371 - src.training - INFO -   positive_samples: 270
2025-06-24 12:05:52,371 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:05:52,371 - src.training - INFO -   total_samples: 220940
2025-06-24 12:05:52,371 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:05:52,371 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:05:52,371 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:05:52,371 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:05:52,371 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:05:52,371 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:05:52,371 - src.training - INFO - 모델 학습 완료
2025-06-24 12:05:52,371 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:05:52,371 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:52,371 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:52,371 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:52,371 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:52,391 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:05:52,391 - src.hyperparameter_tuning - ERROR - Trial 0 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:05:52,811 - src.hyperparameter_tuning - INFO - Trial 1: 모델 타입 = lightgbm
2025-06-24 12:05:54,612 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:05:54,612 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:05:54,612 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:05:54,612 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:05:54,612 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:05:54,612 - src.training - INFO - 교차 검증 시작
2025-06-24 12:05:54,612 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:05:54,631 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:05:55,100 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:05:55,100 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:05:55,100 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:05:55,100 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:05:55,100 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:05:55,100 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:05:55,100 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:05:55,100 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:05:55,100 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:05:55,267 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:05:55,267 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:05:55,267 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:05:55,267 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:05:55,267 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:05:55,267 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:05:55,267 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:05:55,267 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:05:55,267 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:05:55,267 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:05:56,737 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:05:57,879 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:05:57,879 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:05:57,885 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:05:57,917 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:05:57,917 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:05:57,917 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:05:57,918 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:05:59,263 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:05:59,532 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:05:59,532 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:05:59,699 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:05:59,699 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:05:59,742 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:05:59,742 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:05:59,742 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:05:59,742 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:05:59,742 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:59,742 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:05:59,804 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:05:59,804 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:05:59,804 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:59,804 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:59,804 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:05:59,804 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:05:59,804 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:59,869 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:05:59,869 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:05:59,869 - src.training - INFO - 모델 학습 시작
2025-06-24 12:06:00,001 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:06:00,001 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:06:00,001 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:06:00,001 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:06:00,001 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:06:00,001 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:06:00,001 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:06:00,001 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:06:00,001 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:06:00,001 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:06:00,001 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:06:00,001 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:06:00,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:06:00,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:00,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:00,090 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:00,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:00,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:00,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:00,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:00,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:00,448 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:06:00,448 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:00,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:06:00,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:00,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:06:00,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:00,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:00,530 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:00,545 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:00,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:00,577 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:00,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:00,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:00,615 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:06:00,615 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:00,630 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:06:00,630 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:00,630 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:06:00,630 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:00,630 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:06:00,643 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   learning_rate: 0.010725209743171997
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:06:00,645 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO -   n_estimators: 621
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO -   subsample: 0.9879639408647978
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9329770563201687
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO -   reg_alpha: 4.329370014459266e-07
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO -   reg_lambda: 4.4734294104626844e-07
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:06:00,646 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:06:00,757 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:06:00,757 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.16125891018456978})})
2025-06-24 12:06:00,757 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:06:00,757 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:06:00,758 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:06:00,758 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:06:00,758 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:00,758 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:00,779 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:00,795 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:00,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:00,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:00,844 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:00,862 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:00,865 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:06:00,865 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:00,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:06:00,874 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:06:00,874 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:06:00,874 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:06:00,874 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:06:00,874 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:00,874 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:00,874 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:06:00,874 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:06:00,878 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:06:00,883 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:06:00,884 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00251772 0.10222178 0.04393002 0.33701265 0.0050561  0.0103742
 0.03589401 0.1607431  0.35388794 0.10674087 0.00115553 0.08371821
 0.00477808 0.8134218  0.00115544 0.76679974 0.2341771  0.00115607
 0.39395852 0.46848843 0.85724768 0.39645649 0.12693073 0.00115588
 0.00306533 0.0011561  0.02141667 0.59568929 0.59314329 0.72577103
 0.00115612]
2025-06-24 12:06:00,884 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:06:01,738 - src.training - INFO -   precision: 0.0
2025-06-24 12:06:01,739 - src.training - INFO -   recall: 0.0
2025-06-24 12:06:01,739 - src.training - INFO -   f1: 0.0
2025-06-24 12:06:01,739 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:06:01,739 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:06:01,739 - src.training - INFO -   positive_samples: 270
2025-06-24 12:06:01,739 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:06:01,739 - src.training - INFO -   total_samples: 220940
2025-06-24 12:06:01,739 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:06:01,739 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:06:01,739 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:06:01,739 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:06:01,739 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:06:01,739 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:06:01,739 - src.training - INFO - 모델 학습 완료
2025-06-24 12:06:01,739 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:06:01,739 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:01,739 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:01,739 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:01,739 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:01,759 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:06:01,759 - src.hyperparameter_tuning - ERROR - Trial 1 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:06:02,203 - src.hyperparameter_tuning - INFO - Trial 2: 모델 타입 = lightgbm
2025-06-24 12:06:04,174 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:06:04,175 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:06:04,175 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:06:04,175 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:06:04,175 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:06:04,175 - src.training - INFO - 교차 검증 시작
2025-06-24 12:06:04,175 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:06:04,191 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:06:04,663 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:06:04,663 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:06:04,663 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:06:04,663 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:06:04,663 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:06:04,663 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:06:04,663 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:06:04,663 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:06:04,663 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:06:04,837 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:06:04,837 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:06:04,837 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:06:04,837 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:06:04,837 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:06:04,837 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:06:04,837 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:06:04,837 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:06:04,837 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:06:04,837 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:06:06,299 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:06:07,439 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:06:07,439 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:06:07,445 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:06:07,478 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:06:07,478 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:06:07,478 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:06:07,479 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:06:08,816 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:06:09,086 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:06:09,086 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:06:09,254 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:06:09,254 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:06:09,297 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:06:09,297 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:06:09,297 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:06:09,297 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:06:09,297 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:09,297 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:09,359 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:06:09,359 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:06:09,359 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:09,359 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:09,359 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:06:09,359 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:06:09,359 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:09,426 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:06:09,426 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:06:09,426 - src.training - INFO - 모델 학습 시작
2025-06-24 12:06:09,545 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:06:09,545 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:06:09,545 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:06:09,545 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:06:09,545 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:06:09,545 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:06:09,545 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:06:09,545 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:06:09,545 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:06:09,546 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:06:09,546 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:06:09,546 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:06:09,546 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:06:09,546 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:09,546 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:09,624 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:09,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:09,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:09,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:09,887 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:09,961 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:09,976 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:06:09,977 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:10,037 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:06:10,037 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:10,037 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:06:10,037 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:10,038 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:10,056 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:10,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:10,087 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:10,103 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:10,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:10,139 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:10,142 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:06:10,142 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:10,158 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:06:10,158 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:10,158 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:06:10,158 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:10,158 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:06:10,171 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   learning_rate: 0.04345454109729477
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   n_estimators: 339
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   subsample: 0.7164916560792167
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8447411578889518
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   reg_alpha: 4.258943089524393e-06
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO -   reg_lambda: 1.9826980964985924e-05
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:06:10,175 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:06:10,288 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:06:10,288 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 2.4396222639250493})})
2025-06-24 12:06:10,288 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:06:10,288 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:06:10,289 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:06:10,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:06:10,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:10,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:10,308 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:10,323 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:10,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:10,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:10,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:10,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:10,395 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:06:10,395 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:10,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:06:10,402 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:06:10,402 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:06:10,402 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:06:10,402 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:06:10,402 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:10,402 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:10,402 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:06:10,402 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:06:10,406 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:06:10,410 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:06:10,412 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [1.72722680e-002 9.97968158e-001 9.25539727e-001 9.99995256e-001
 9.99999979e-001 2.73122621e-001 1.91477087e-002 7.71807997e-005
 9.99646815e-001 8.76617734e-001 9.99172034e-001 9.93689394e-001
 9.99910062e-001 9.99992605e-001 2.40851140e-080 9.99526913e-001
 1.29498509e-002 1.36987370e-005 2.30902866e-001 1.00000000e+000
 1.71725325e-002 9.39266909e-004 7.01296788e-004 9.99719408e-001
 1.00000000e+000 8.41359307e-001 2.68302423e-004 1.00000000e+000
 1.78339207e-173 9.99999972e-001 1.83078674e-001 9.98891130e-001
 1.56794674e-070 1.16099255e-163 9.41360789e-004 0.00000000e+000
 4.64391193e-099 6.36894497e-101 1.14326731e-068 9.99998321e-001
 8.46536933e-162 9.99996659e-001 9.99244229e-001 9.35224009e-004
 1.61193575e-007 4.13528969e-006 9.99717751e-001 9.99624142e-001
 9.78328928e-111 2.16719076e-004 1.61313841e-007 5.19956020e-028
 7.46177637e-247 1.02335367e-248 9.99951038e-001 9.99861658e-001
 4.67736822e-002 1.25255127e-021 7.02860541e-004 1.00000000e+000
 4.62887823e-018 9.80965903e-001 8.44943489e-006 9.69523758e-031
 4.96417551e-015 4.64091493e-072 1.00000000e+000 3.11397950e-011
 3.61962523e-013 6.04218020e-073 2.61288793e-274 8.97221703e-274
 2.20240033e-003 1.45664733e-031 9.99999977e-001 1.18441950e-010
 3.98828117e-015 7.43250804e-006 9.99999998e-001 9.43950101e-001
 7.21908601e-004 9.99999999e-001 5.19811419e-071 9.99747367e-001
 1.13677196e-019 8.56551525e-005 4.13799504e-006 1.21267978e-017
 9.99922593e-001 9.39928984e-001 2.15681786e-021 4.04050659e-003
 3.80851683e-024 5.46977282e-017 1.66314324e-019 1.00000000e+000
 4.93900760e-026 7.89065129e-001 2.97965630e-011 9.96347168e-001
 1.57264229e-019 6.84930740e-027 8.28661562e-075 9.06839466e-017
 9.94387097e-001 6.08172918e-027 2.13437067e-270 2.09541977e-021
 1.41885837e-007 4.08648297e-013 9.15049973e-017 3.79125582e-026
 1.41793074e-007 9.35784650e-018 2.26123613e-012 1.19067390e-032
 2.45539520e-001 5.73128709e-246 9.78417814e-001 1.23050474e-275
 2.34342994e-253 5.32426688e-020 2.44109753e-016 4.99416787e-025
 7.06927595e-029 1.09969990e-013 1.25120924e-028 4.95727096e-034
 1.51377204e-076 2.72590271e-274 4.76756320e-032 2.24784611e-277
 1.49226696e-040 1.51730789e-025 1.83571076e-073 3.83595118e-024
 1.40426393e-018 4.00216350e-023 7.81638883e-039 2.50739252e-021
 3.61459078e-032 3.36809755e-028 2.22016207e-035 2.04674209e-103
 6.89143564e-273 4.07488351e-076 6.68074498e-083 3.11956029e-107
 1.09828451e-110 5.52197400e-035 8.54546661e-099 9.93307327e-101
 2.09679141e-112 2.77631712e-031 6.69892574e-104 4.58042325e-023
 6.05091838e-277 1.57286318e-017 1.13519085e-038]
2025-06-24 12:06:10,412 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:06:11,268 - src.training - INFO -   precision: 0.0
2025-06-24 12:06:11,268 - src.training - INFO -   recall: 0.0
2025-06-24 12:06:11,268 - src.training - INFO -   f1: 0.0
2025-06-24 12:06:11,268 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:06:11,268 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:06:11,268 - src.training - INFO -   positive_samples: 270
2025-06-24 12:06:11,268 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:06:11,268 - src.training - INFO -   total_samples: 220940
2025-06-24 12:06:11,268 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:06:11,268 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:06:11,268 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:06:11,268 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:06:11,268 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:06:11,268 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:06:11,268 - src.training - INFO - 모델 학습 완료
2025-06-24 12:06:11,268 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:06:11,268 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:11,268 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:11,268 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:11,268 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:11,287 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:06:11,287 - src.hyperparameter_tuning - ERROR - Trial 2 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:06:11,739 - src.hyperparameter_tuning - INFO - Trial 3: 모델 타입 = lightgbm
2025-06-24 12:06:13,687 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:06:13,687 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:06:13,687 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:06:13,687 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:06:13,687 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:06:13,687 - src.training - INFO - 교차 검증 시작
2025-06-24 12:06:13,687 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:06:13,705 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:06:14,176 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:06:14,176 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:06:14,176 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:06:14,176 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:06:14,176 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:06:14,176 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:06:14,176 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:06:14,176 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:06:14,176 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:06:14,349 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:06:14,349 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:06:14,349 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:06:14,349 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:06:14,349 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:06:14,349 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:06:14,349 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:06:14,349 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:06:14,349 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:06:14,349 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:06:15,815 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:06:16,957 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:06:16,957 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:06:16,963 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:06:16,998 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:06:16,998 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:06:16,998 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:06:16,998 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:06:18,345 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:06:18,599 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:06:18,599 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:06:18,768 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:06:18,768 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:06:18,811 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:06:18,812 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:06:18,812 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:06:18,812 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:06:18,812 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:18,812 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:18,861 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:06:18,861 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:06:18,861 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:18,861 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:18,861 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:06:18,861 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:06:18,861 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:18,926 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:06:18,926 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:06:18,926 - src.training - INFO - 모델 학습 시작
2025-06-24 12:06:19,045 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:06:19,046 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:06:19,046 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:06:19,046 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:06:19,046 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:06:19,046 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:06:19,046 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:06:19,046 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:06:19,046 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:06:19,046 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:06:19,046 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:06:19,046 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:06:19,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:06:19,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:19,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:19,126 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:19,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:19,263 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:19,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:19,394 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:19,469 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:19,486 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:06:19,486 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:19,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:06:19,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:19,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:06:19,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:19,550 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:19,568 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:19,583 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:19,599 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:19,615 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:19,632 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:19,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:19,653 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:06:19,653 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:19,668 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:06:19,668 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:19,668 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:06:19,668 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:19,668 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:06:19,681 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   learning_rate: 0.019721610970574007
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   n_estimators: 483
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   subsample: 0.8056937753654446
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.836965827544817
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0029369981104377003
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO -   reg_lambda: 3.425445902633376e-07
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:06:19,685 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:06:22,414 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:06:22,416 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.4003152139288667})})
2025-06-24 12:06:22,416 - src.models.lightgbm_model - INFO -   - Best Iteration: 483
2025-06-24 12:06:22,416 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:06:22,416 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:06:22,416 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:06:22,416 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:22,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:22,437 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:22,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:22,469 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:22,486 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:22,504 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:22,522 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:22,525 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:06:22,525 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:22,529 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:06:22,638 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:06:22,638 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:06:22,638 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:06:22,638 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:06:22,638 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:22,638 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:22,638 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:06:22,638 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:06:22,643 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:06:22,647 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:06:22,651 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.05082952 0.04224036 0.01012208 ... 0.00628575 0.01365114 0.00694998]
2025-06-24 12:06:22,651 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:06:24,007 - src.training - INFO -   precision: 0.0
2025-06-24 12:06:24,008 - src.training - INFO -   recall: 0.0
2025-06-24 12:06:24,008 - src.training - INFO -   f1: 0.0
2025-06-24 12:06:24,008 - src.training - INFO -   accuracy: 0.99868742645062
2025-06-24 12:06:24,008 - src.training - INFO -   balanced_accuracy: 0.499954683463996
2025-06-24 12:06:24,008 - src.training - INFO -   positive_samples: 270
2025-06-24 12:06:24,008 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:06:24,008 - src.training - INFO -   total_samples: 220940
2025-06-24 12:06:24,008 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:06:24,008 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:06:24,008 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:06:24,008 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:06:24,008 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:06:24,008 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:06:24,008 - src.training - INFO - 모델 학습 완료
2025-06-24 12:06:24,008 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.99868742645062, 'balanced_accuracy': 0.499954683463996, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:06:24,008 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:24,008 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:24,008 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:24,008 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:24,030 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:06:24,030 - src.hyperparameter_tuning - ERROR - Trial 3 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:06:24,478 - src.hyperparameter_tuning - INFO - Trial 4: 모델 타입 = lightgbm
2025-06-24 12:06:26,452 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:06:26,452 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:06:26,452 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:06:26,452 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:06:26,452 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:06:26,452 - src.training - INFO - 교차 검증 시작
2025-06-24 12:06:26,452 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:06:26,470 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:06:26,941 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:06:26,941 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:06:26,941 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:06:26,941 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:06:26,941 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:06:26,941 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:06:26,941 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:06:26,941 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:06:26,941 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:06:27,116 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:06:27,117 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:06:27,117 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:06:27,117 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:06:27,117 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:06:27,117 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:06:27,117 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:06:27,117 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:06:27,117 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:06:27,117 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:06:28,597 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:06:29,750 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:06:29,750 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:06:29,756 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:06:29,788 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:06:29,789 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:06:29,789 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:06:29,789 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:06:31,144 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:06:31,412 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:06:31,412 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:06:31,580 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:06:31,580 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:06:31,623 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:06:31,623 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:06:31,623 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:06:31,623 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:06:31,623 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:31,623 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:31,673 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:06:31,673 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:06:31,673 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:31,673 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:31,673 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:06:31,673 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:06:31,673 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:31,738 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:06:31,738 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:06:31,738 - src.training - INFO - 모델 학습 시작
2025-06-24 12:06:31,870 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:06:31,870 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:06:31,870 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:06:31,870 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:06:31,870 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:06:31,870 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:06:31,870 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:06:31,870 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:06:31,870 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:06:31,870 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:06:31,870 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:06:31,870 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:06:31,870 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:06:31,870 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:31,871 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:31,960 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:32,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:32,094 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:32,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:32,226 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:32,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:32,320 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:06:32,320 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:32,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:06:32,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:32,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:06:32,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:32,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:32,400 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:32,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:32,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:32,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:32,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:32,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:32,487 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:06:32,487 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:32,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:06:32,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:32,501 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:06:32,501 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:32,501 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:06:32,516 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:06:32,519 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   learning_rate: 0.26690431824362526
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   n_estimators: 111
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   subsample: 0.9233589392465844
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7218455076693483
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   reg_alpha: 0.014391207615728067
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO -   reg_lambda: 9.148975058772307e-05
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:06:32,520 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:06:32,623 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:06:32,623 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.04236450119220211})})
2025-06-24 12:06:32,623 - src.models.lightgbm_model - INFO -   - Best Iteration: 7
2025-06-24 12:06:32,623 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:06:32,625 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:06:32,625 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:06:32,625 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:32,625 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:32,644 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:32,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:32,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:32,694 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:32,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:32,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:32,733 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:06:32,733 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:32,737 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:06:32,739 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:06:32,739 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:06:32,739 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:06:32,739 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:06:32,739 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:32,739 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:32,739 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:06:32,739 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:06:32,743 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:06:32,747 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:06:32,748 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00000000e+000 5.65111529e-237 3.24454440e-147 4.89420041e-171
 5.85529045e-125 1.30722873e-057 3.88168613e-101 8.66609719e-034
 8.52436809e-261 2.45264724e-201 4.22033690e-267 1.00000000e+000
 7.77853968e-190 1.11835447e-010 8.97522129e-004]
2025-06-24 12:06:32,748 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:06:34,122 - src.training - INFO -   precision: 0.0
2025-06-24 12:06:34,122 - src.training - INFO -   recall: 0.0
2025-06-24 12:06:34,122 - src.training - INFO -   f1: 0.0
2025-06-24 12:06:34,122 - src.training - INFO -   accuracy: 0.9987734226486829
2025-06-24 12:06:34,122 - src.training - INFO -   balanced_accuracy: 0.4999977341731998
2025-06-24 12:06:34,122 - src.training - INFO -   positive_samples: 270
2025-06-24 12:06:34,122 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:06:34,122 - src.training - INFO -   total_samples: 220940
2025-06-24 12:06:34,122 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:06:34,122 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:06:34,122 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:06:34,122 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:06:34,123 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:06:34,123 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:06:34,123 - src.training - INFO - 모델 학습 완료
2025-06-24 12:06:34,123 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987734226486829, 'balanced_accuracy': 0.4999977341731998, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:06:34,123 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:34,123 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:34,123 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:34,123 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:34,143 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:06:34,143 - src.hyperparameter_tuning - ERROR - Trial 4 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:06:34,590 - src.hyperparameter_tuning - INFO - Trial 5: 모델 타입 = lightgbm
2025-06-24 12:06:36,548 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:06:36,549 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:06:36,549 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:06:36,549 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:06:36,549 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:06:36,549 - src.training - INFO - 교차 검증 시작
2025-06-24 12:06:36,549 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:06:36,566 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:06:37,034 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:06:37,034 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:06:37,034 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:06:37,034 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:06:37,034 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:06:37,034 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:06:37,034 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:06:37,034 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:06:37,034 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:06:37,198 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:06:37,199 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:06:37,199 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:06:37,199 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:06:37,199 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:06:37,199 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:06:37,199 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:06:37,199 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:06:37,199 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:06:37,199 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:06:38,657 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:06:39,801 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:06:39,801 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:06:39,807 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:06:39,840 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:06:39,840 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:06:39,840 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:06:39,840 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:06:41,211 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:06:41,484 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:06:41,484 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:06:41,652 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:06:41,652 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:06:41,695 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:06:41,696 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:06:41,696 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:06:41,696 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:06:41,696 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:41,696 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:41,757 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:06:41,758 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:06:41,758 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:41,758 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:41,758 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:06:41,758 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:06:41,758 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:41,823 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:06:41,823 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:06:41,823 - src.training - INFO - 모델 학습 시작
2025-06-24 12:06:41,955 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:06:41,955 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:06:41,955 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:06:41,955 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:06:41,955 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:06:41,955 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:06:41,955 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:06:41,955 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:06:41,955 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:06:41,955 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:06:41,955 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:06:41,955 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:06:41,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:06:41,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:41,956 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:42,045 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:42,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:42,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:42,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:42,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:42,387 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:42,403 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:06:42,403 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:42,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:06:42,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:42,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:06:42,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:42,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:42,484 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:42,499 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:42,516 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:42,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:42,549 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:42,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:42,570 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:06:42,570 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:42,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:06:42,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:42,585 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:06:42,585 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:42,585 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:06:42,597 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   learning_rate: 0.011240768803005551
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:06:42,599 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:06:42,600 - src.models.lightgbm_model - INFO -   n_estimators: 166
2025-06-24 12:06:42,600 - src.models.lightgbm_model - INFO -   subsample: 0.9637281608315128
2025-06-24 12:06:42,600 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7035119926400067
2025-06-24 12:06:42,600 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 12:06:42,600 - src.models.lightgbm_model - INFO -   reg_alpha: 6.388511557344611e-06
2025-06-24 12:06:42,600 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0004793052550782129
2025-06-24 12:06:42,600 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:06:42,600 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:06:42,600 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:06:42,713 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:06:42,713 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.1990783136862117})})
2025-06-24 12:06:42,713 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:06:42,713 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:06:42,714 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:06:42,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:06:42,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:42,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:42,734 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:42,750 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:42,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:42,784 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:42,801 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:42,820 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:42,823 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:06:42,823 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:42,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:06:42,827 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:06:42,827 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:06:42,827 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:06:42,827 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:06:42,827 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:42,827 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:42,827 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:06:42,827 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:06:42,831 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:06:42,835 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:06:42,837 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00245994 0.12426162 0.05196829 0.40501406 0.01589928 0.01151455
 0.04211734 0.19661134 0.42399733 0.12987658 0.00115494 0.00511208
 0.86619454 0.00115485 0.00115581 0.82808166 0.28551147 0.00115551
 0.46832711 0.54791862 0.90054831 0.47105538 0.1549197  0.00115532
 0.56478984 0.00321071 0.00115554 0.02457578 0.67496095 0.67252802
 0.79324562]
2025-06-24 12:06:42,837 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:06:43,696 - src.training - INFO -   precision: 0.0
2025-06-24 12:06:43,697 - src.training - INFO -   recall: 0.0
2025-06-24 12:06:43,697 - src.training - INFO -   f1: 0.0
2025-06-24 12:06:43,697 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:06:43,697 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:06:43,697 - src.training - INFO -   positive_samples: 270
2025-06-24 12:06:43,697 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:06:43,697 - src.training - INFO -   total_samples: 220940
2025-06-24 12:06:43,697 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:06:43,697 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:06:43,697 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:06:43,697 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:06:43,697 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:06:43,697 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:06:43,697 - src.training - INFO - 모델 학습 완료
2025-06-24 12:06:43,697 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:06:43,697 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:43,697 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:43,697 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:43,697 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:43,717 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:06:43,717 - src.hyperparameter_tuning - ERROR - Trial 5 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:06:44,172 - src.hyperparameter_tuning - INFO - Trial 6: 모델 타입 = lightgbm
2025-06-24 12:06:46,158 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:06:46,158 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:06:46,158 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:06:46,158 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:06:46,158 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:06:46,158 - src.training - INFO - 교차 검증 시작
2025-06-24 12:06:46,158 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:06:46,175 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:06:46,647 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:06:46,647 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:06:46,647 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:06:46,647 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:06:46,647 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:06:46,647 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:06:46,647 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:06:46,647 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:06:46,647 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:06:46,820 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:06:46,821 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:06:46,821 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:06:46,821 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:06:46,821 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:06:46,821 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:06:46,821 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:06:46,821 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:06:46,821 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:06:46,821 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:06:48,282 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:06:49,425 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:06:49,425 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:06:49,431 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:06:49,464 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:06:49,464 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:06:49,464 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:06:49,464 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:06:50,815 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:06:51,084 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:06:51,084 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:06:51,251 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:06:51,251 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:06:51,294 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:06:51,294 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:06:51,294 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:06:51,294 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:06:51,294 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:51,294 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:51,343 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:06:51,343 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:06:51,343 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:51,344 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:51,344 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:06:51,344 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:06:51,344 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:51,408 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:06:51,408 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:06:51,408 - src.training - INFO - 모델 학습 시작
2025-06-24 12:06:51,540 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:06:51,540 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:06:51,540 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:06:51,540 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:06:51,540 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:06:51,540 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:06:51,540 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:06:51,540 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:06:51,540 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:06:51,540 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:06:51,540 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:06:51,540 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:06:51,540 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:06:51,540 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:51,541 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:51,629 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:51,694 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:51,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:51,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:51,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:51,968 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:51,989 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:06:51,989 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:52,053 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:06:52,053 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:52,053 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:06:52,053 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:52,054 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:52,072 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:52,087 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:52,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:52,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:52,138 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:52,156 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:52,159 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:06:52,159 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:52,174 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:06:52,174 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:52,174 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:06:52,174 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:52,174 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:06:52,185 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO -   learning_rate: 0.27051668818999286
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:06:52,187 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   n_estimators: 569
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   subsample: 0.9100531293444458
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9757995766256756
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   reg_alpha: 0.002404915432737351
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO -   reg_lambda: 1.9809253750493907
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:06:52,188 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:06:52,258 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:06:52,259 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.042208154373949355})})
2025-06-24 12:06:52,259 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:06:52,259 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:06:52,259 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:06:52,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:06:52,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:52,260 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:06:52,282 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:06:52,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:06:52,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:06:52,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:06:52,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:06:52,365 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:06:52,368 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:06:52,368 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:52,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:06:52,375 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:06:52,375 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:06:52,375 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:06:52,375 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:06:52,375 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:52,375 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:06:52,375 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:06:52,375 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:06:52,378 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:06:52,383 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:06:52,383 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:06:52,383 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:06:53,234 - src.training - INFO -   precision: 0.0
2025-06-24 12:06:53,234 - src.training - INFO -   recall: 0.0
2025-06-24 12:06:53,234 - src.training - INFO -   f1: 0.0
2025-06-24 12:06:53,234 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:06:53,234 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:06:53,234 - src.training - INFO -   positive_samples: 270
2025-06-24 12:06:53,235 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:06:53,235 - src.training - INFO -   total_samples: 220940
2025-06-24 12:06:53,235 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:06:53,235 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:06:53,235 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:06:53,235 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:06:53,235 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:06:53,235 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:06:53,235 - src.training - INFO - 모델 학습 완료
2025-06-24 12:06:53,235 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:06:53,235 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:53,235 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:53,235 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:06:53,235 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:06:53,254 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:06:53,254 - src.hyperparameter_tuning - ERROR - Trial 6 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:06:53,707 - src.hyperparameter_tuning - INFO - Trial 7: 모델 타입 = lightgbm
2025-06-24 12:06:55,673 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:06:55,673 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:06:55,673 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:06:55,673 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:06:55,673 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:06:55,673 - src.training - INFO - 교차 검증 시작
2025-06-24 12:06:55,673 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:06:55,691 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:06:56,160 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:06:56,160 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:06:56,160 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:06:56,160 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:06:56,160 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:06:56,160 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:06:56,160 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:06:56,160 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:06:56,160 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:06:56,329 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:06:56,329 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:06:56,329 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:06:56,329 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:06:56,329 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:06:56,329 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:06:56,329 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:06:56,329 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:06:56,329 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:06:56,329 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:06:57,790 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:06:58,930 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:06:58,930 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:06:58,936 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:06:58,969 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:06:58,969 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:06:58,969 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:06:58,969 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:07:00,340 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:07:00,606 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:07:00,606 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:07:00,773 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:07:00,773 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:07:00,816 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:07:00,816 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:07:00,816 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:07:00,816 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:07:00,816 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:00,816 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:00,865 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:07:00,866 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:07:00,866 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:00,866 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:00,866 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:07:00,866 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:07:00,866 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:00,933 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:07:00,933 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:07:00,933 - src.training - INFO - 모델 학습 시작
2025-06-24 12:07:01,065 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:07:01,065 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:07:01,065 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:07:01,065 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:07:01,065 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:07:01,065 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:07:01,065 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:07:01,065 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:07:01,065 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:07:01,065 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:07:01,065 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:07:01,065 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:07:01,065 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:07:01,065 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:01,066 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:01,157 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:01,222 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:01,290 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:01,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:01,418 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:01,493 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:01,511 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:07:01,511 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:01,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:07:01,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:01,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:07:01,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:01,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:01,593 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:01,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:01,625 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:01,641 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:01,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:01,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:01,680 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:07:01,680 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:01,694 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:07:01,695 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:01,695 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:07:01,695 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:01,695 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:07:01,707 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:07:01,709 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   learning_rate: 0.011662890273931383
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   n_estimators: 134
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   subsample: 0.7301321323053057
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7554709158757928
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   reg_alpha: 0.28749982347407854
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO -   reg_lambda: 1.6247252885719427e-05
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:07:01,710 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:07:01,809 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:07:01,809 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.2178193523112724})})
2025-06-24 12:07:01,809 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:07:01,809 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:07:01,809 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:07:01,810 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:07:01,810 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:01,810 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:01,832 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:01,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:01,865 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:01,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:01,899 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:01,916 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:01,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:07:01,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:01,922 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:07:01,923 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:07:01,924 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:07:01,924 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:07:01,924 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:07:01,924 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:01,924 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:01,924 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:07:01,924 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:07:01,928 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:07:01,932 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:07:01,933 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00252968 0.1739542  0.10268332 0.31817003 0.01032811 0.08799463
 0.00540277 0.91537487 0.06312194 0.44614409 0.10931649 0.9398157
 0.69360645 0.0236599  0.52567099 0.8664544 ]
2025-06-24 12:07:01,933 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:07:02,786 - src.training - INFO -   precision: 0.0
2025-06-24 12:07:02,786 - src.training - INFO -   recall: 0.0
2025-06-24 12:07:02,786 - src.training - INFO -   f1: 0.0
2025-06-24 12:07:02,786 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:07:02,786 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:07:02,786 - src.training - INFO -   positive_samples: 270
2025-06-24 12:07:02,786 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:07:02,786 - src.training - INFO -   total_samples: 220940
2025-06-24 12:07:02,786 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:07:02,786 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:07:02,786 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:07:02,786 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:07:02,786 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:07:02,786 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:07:02,786 - src.training - INFO - 모델 학습 완료
2025-06-24 12:07:02,786 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:07:02,786 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:02,786 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:02,786 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:02,786 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:02,806 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:07:02,806 - src.hyperparameter_tuning - ERROR - Trial 7 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:07:03,262 - src.hyperparameter_tuning - INFO - Trial 8: 모델 타입 = lightgbm
2025-06-24 12:07:05,243 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:07:05,243 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:07:05,243 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:07:05,243 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:07:05,243 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:07:05,243 - src.training - INFO - 교차 검증 시작
2025-06-24 12:07:05,243 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:07:05,261 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:07:05,727 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:07:05,727 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:07:05,727 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:07:05,727 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:07:05,727 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:07:05,727 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:07:05,727 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:07:05,727 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:07:05,727 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:07:05,887 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:07:05,887 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:07:05,887 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:07:05,887 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:07:05,887 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:07:05,887 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:07:05,887 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:07:05,887 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:07:05,887 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:07:05,887 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:07:07,341 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:07:08,483 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:07:08,483 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:07:08,489 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:07:08,522 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:07:08,522 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:07:08,522 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:07:08,522 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:07:09,883 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:07:10,155 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:07:10,155 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:07:10,323 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:07:10,323 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:07:10,366 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:07:10,366 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:07:10,366 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:07:10,366 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:07:10,366 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:10,366 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:10,428 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:07:10,428 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:07:10,428 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:10,428 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:10,428 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:07:10,428 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:07:10,428 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:10,495 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:07:10,495 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:07:10,495 - src.training - INFO - 모델 학습 시작
2025-06-24 12:07:10,627 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:07:10,627 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:07:10,627 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:07:10,627 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:07:10,627 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:07:10,627 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:07:10,627 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:07:10,627 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:07:10,627 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:07:10,627 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:07:10,627 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:07:10,627 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:07:10,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:07:10,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:10,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:10,716 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:10,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:10,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:10,911 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:10,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:11,060 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:11,076 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:07:11,076 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:11,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:07:11,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:11,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:07:11,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:11,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:11,165 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:11,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:11,196 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:11,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:11,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:11,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:11,251 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:07:11,251 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:11,265 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:07:11,266 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:11,266 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:07:11,266 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:11,266 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:07:11,278 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   learning_rate: 0.016149614799999188
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   n_estimators: 317
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   subsample: 0.9208787923016158
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6298202574719083
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   reg_alpha: 0.08916674715636537
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO -   reg_lambda: 6.143857495033091e-07
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:07:11,282 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:07:13,191 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:07:13,191 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.4487528170674784})})
2025-06-24 12:07:13,191 - src.models.lightgbm_model - INFO -   - Best Iteration: 317
2025-06-24 12:07:13,191 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:07:13,192 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:07:13,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:07:13,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:13,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:13,213 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:13,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:13,251 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:13,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:13,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:13,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:13,307 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:07:13,307 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:13,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:07:13,382 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:07:13,383 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:07:13,383 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:07:13,383 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:07:13,383 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:13,383 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:13,383 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:07:13,383 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:07:13,387 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:07:13,391 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:07:13,395 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.03435287 0.02472859 0.02276414 ... 0.05509056 0.01329768 0.01414212]
2025-06-24 12:07:13,395 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:07:14,265 - src.training - INFO -   precision: 0.0
2025-06-24 12:07:14,265 - src.training - INFO -   recall: 0.0
2025-06-24 12:07:14,265 - src.training - INFO -   f1: 0.0
2025-06-24 12:07:14,265 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:07:14,265 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:07:14,265 - src.training - INFO -   positive_samples: 270
2025-06-24 12:07:14,265 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:07:14,265 - src.training - INFO -   total_samples: 220940
2025-06-24 12:07:14,265 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:07:14,265 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:07:14,265 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:07:14,265 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:07:14,265 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:07:14,265 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:07:14,265 - src.training - INFO - 모델 학습 완료
2025-06-24 12:07:14,265 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:07:14,265 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:14,265 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:14,265 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:14,265 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:14,286 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:07:14,287 - src.hyperparameter_tuning - ERROR - Trial 8 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:07:14,733 - src.hyperparameter_tuning - INFO - Trial 9: 모델 타입 = lightgbm
2025-06-24 12:07:16,685 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:07:16,685 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:07:16,685 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:07:16,685 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:07:16,685 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:07:16,685 - src.training - INFO - 교차 검증 시작
2025-06-24 12:07:16,685 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:07:16,703 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:07:17,169 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:07:17,170 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:07:17,170 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:07:17,170 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:07:17,170 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:07:17,170 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:07:17,170 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:07:17,170 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:07:17,170 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:07:17,337 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:07:17,337 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:07:17,337 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:07:17,337 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:07:17,337 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:07:17,337 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:07:17,337 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:07:17,337 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:07:17,337 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:07:17,337 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:07:18,795 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:07:19,940 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:07:19,940 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:07:19,946 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:07:19,978 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:07:19,978 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:07:19,978 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:07:19,978 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:07:21,316 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:07:21,586 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:07:21,586 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:07:21,754 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:07:21,755 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:07:21,798 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:07:21,798 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:07:21,798 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:07:21,798 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:07:21,798 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:21,798 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:21,860 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:07:21,860 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:07:21,860 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:21,860 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:21,860 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:07:21,860 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:07:21,860 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:21,925 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:07:21,925 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:07:21,925 - src.training - INFO - 모델 학습 시작
2025-06-24 12:07:22,057 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:07:22,057 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:07:22,057 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:07:22,057 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:07:22,057 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:07:22,057 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:07:22,057 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:07:22,057 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:07:22,058 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:07:22,058 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:07:22,058 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:07:22,058 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:07:22,058 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:07:22,058 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:22,058 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:22,148 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:22,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:22,281 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:22,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:22,410 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:22,487 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:22,500 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:07:22,500 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:22,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:07:22,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:22,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:07:22,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:22,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:22,582 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:22,598 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:22,614 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:22,630 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:22,647 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:22,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:22,668 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:07:22,668 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:22,683 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:07:22,684 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:22,684 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:07:22,684 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:22,684 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:07:22,695 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:07:22,697 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:07:22,697 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:07:22,697 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:07:22,697 - src.models.lightgbm_model - INFO -   learning_rate: 0.11069143219393454
2025-06-24 12:07:22,697 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:07:22,697 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:07:22,697 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:07:22,697 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:07:22,697 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:07:22,697 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:07:22,697 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:07:22,697 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   n_estimators: 55
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   subsample: 0.8916028672163949
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9085081386743783
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   reg_alpha: 1.683416412018213e-05
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO -   reg_lambda: 1.1036250149900698e-07
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:07:22,698 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:07:22,799 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:07:22,799 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 3.5532010065987025})})
2025-06-24 12:07:22,799 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:07:22,799 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:07:22,800 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:07:22,800 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:07:22,800 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:22,800 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:22,822 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:22,838 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:22,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:22,871 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:22,888 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:22,905 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:22,908 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:07:22,908 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:22,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:07:22,913 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:07:22,913 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:07:22,913 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:07:22,913 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:07:22,913 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:22,913 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:22,913 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:07:22,913 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:07:22,917 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:07:22,921 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:07:22,923 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [6.83349383e-001 9.99957343e-001 1.00000000e+000 0.00000000e+000
 9.44101030e-099 1.31733601e-103 2.71261721e-010 1.36393394e-086
 4.42188720e-003 9.99999957e-001 9.95624513e-001 1.00000000e+000
 1.00000000e+000 1.00000000e+000 1.18148368e-196 3.36306542e-053
 3.13823066e-004 1.06286136e-056 9.62081658e-048 3.40346262e-069
 1.66843855e-124 4.30249723e-119 4.31056936e-090 1.00000000e+000
 4.44034294e-063 1.84566574e-109 5.44921887e-140 6.85848742e-123
 1.80083753e-096 3.03380631e-003 9.89149028e-001 4.70994225e-280
 4.04996177e-089 4.68902121e-255 9.99990818e-001 1.81109109e-096
 1.17623566e-171 9.99974089e-001 9.99994423e-001 2.60747937e-250
 1.74621755e-102 1.00000000e+000 1.00000000e+000 9.99996576e-001
 2.55286706e-011 7.05360170e-012 2.94583403e-016 6.54083247e-167
 6.12428890e-007 1.05484039e-012 1.51827372e-012 7.00996535e-131
 7.75421754e-099 4.96265280e-046 2.58128313e-004 2.94024281e-016
 7.24256366e-011 5.02386290e-126 3.21300988e-089 5.16596900e-035
 9.99948817e-001 4.07067000e-112 1.56115947e-053 1.71017258e-021
 3.52128439e-017 2.55772164e-011 6.32881409e-017 2.28949610e-146
 5.60563912e-026 1.09407440e-004 1.34223263e-021 3.65276626e-002
 1.26022871e-009 2.46573076e-019 5.90402667e-015 1.00000000e+000
 9.50155886e-104 5.59499956e-026 2.80434668e-123 1.97089126e-019
 9.99120270e-001 9.99999263e-001 9.99995413e-001 7.08071028e-031
 4.05513089e-112 8.23245229e-024 9.14081957e-034 2.18870784e-029
 1.65777728e-020 4.21024882e-012 4.48485067e-041 6.51995519e-058
 7.30450146e-032 1.91557265e-051 1.87913529e-139 8.82169499e-030
 2.06538680e-019 3.00308232e-036 4.81060986e-045 1.18774707e-012
 2.16613343e-139 5.07311384e-023 5.99342879e-044 1.86778767e-090
 1.30143338e-065 1.07369623e-036 4.58597908e-047 9.70973851e-108
 3.11569818e-061 2.07709388e-258 1.21706365e-155 2.89298017e-124
 6.27699233e-277 2.34117167e-138 2.62149444e-281 7.58671038e-144
 3.49387139e-122 1.20745670e-259 1.34634335e-131 2.00922922e-115
 3.44665584e-037]
2025-06-24 12:07:22,923 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:07:24,292 - src.training - INFO -   precision: 0.0007927070947284979
2025-06-24 12:07:24,292 - src.training - INFO -   recall: 0.007407407407407408
2025-06-24 12:07:24,292 - src.training - INFO -   f1: 0.0014321518080916578
2025-06-24 12:07:24,292 - src.training - INFO -   accuracy: 0.9873766633475152
2025-06-24 12:07:24,292 - src.training - INFO -   balanced_accuracy: 0.49799155434040104
2025-06-24 12:07:24,292 - src.training - INFO -   positive_samples: 270
2025-06-24 12:07:24,292 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:07:24,292 - src.training - INFO -   total_samples: 220940
2025-06-24 12:07:24,292 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:07:24,292 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:07:24,292 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:07:24,292 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:07:24,292 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:07:24,292 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:07:24,292 - src.training - INFO - 모델 학습 완료
2025-06-24 12:07:24,292 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0007927070947284979, 'recall': 0.007407407407407408, 'f1': 0.0014321518080916578, 'accuracy': 0.9873766633475152, 'balanced_accuracy': 0.49799155434040104, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:07:24,292 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:24,292 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:24,292 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:24,292 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:24,312 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:07:24,312 - src.hyperparameter_tuning - ERROR - Trial 9 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:07:24,771 - src.hyperparameter_tuning - INFO - Trial 10: 모델 타입 = lightgbm
2025-06-24 12:07:26,753 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:07:26,753 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:07:26,753 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:07:26,753 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:07:26,753 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:07:26,753 - src.training - INFO - 교차 검증 시작
2025-06-24 12:07:26,753 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:07:26,771 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:07:27,238 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:07:27,238 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:07:27,238 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:07:27,238 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:07:27,238 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:07:27,238 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:07:27,238 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:07:27,238 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:07:27,238 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:07:27,412 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:07:27,412 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:07:27,413 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:07:27,413 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:07:27,413 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:07:27,413 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:07:27,413 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:07:27,413 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:07:27,413 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:07:27,413 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:07:28,871 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:07:30,008 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:07:30,009 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:07:30,015 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:07:30,048 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:07:30,048 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:07:30,048 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:07:30,048 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:07:31,411 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:07:31,676 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:07:31,676 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:07:31,843 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:07:31,843 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:07:31,886 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:07:31,886 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:07:31,886 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:07:31,886 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:07:31,886 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:31,886 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:31,935 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:07:31,935 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:07:31,935 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:31,935 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:31,935 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:07:31,935 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:07:31,935 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:32,000 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:07:32,000 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:07:32,000 - src.training - INFO - 모델 학습 시작
2025-06-24 12:07:32,132 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:07:32,132 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:07:32,132 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:07:32,132 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:07:32,132 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:07:32,132 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:07:32,132 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:07:32,132 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:07:32,132 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:07:32,132 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:07:32,132 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:07:32,132 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:07:32,132 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:07:32,132 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:32,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:32,221 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:32,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:32,354 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:32,418 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:32,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:32,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:32,577 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:07:32,577 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:32,639 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:07:32,640 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:32,640 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:07:32,640 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:32,640 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:32,658 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:32,674 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:32,691 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:32,707 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:32,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:32,742 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:32,745 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:07:32,745 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:32,759 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:07:32,759 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:32,760 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:07:32,760 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:32,760 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:07:32,774 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   learning_rate: 0.25215417296101006
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:07:32,777 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:07:32,778 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:07:32,778 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:07:32,778 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:07:32,778 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:07:32,778 - src.models.lightgbm_model - INFO -   n_estimators: 259
2025-06-24 12:07:32,778 - src.models.lightgbm_model - INFO -   subsample: 0.8918922075033184
2025-06-24 12:07:32,778 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7398939640097985
2025-06-24 12:07:32,778 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:07:32,778 - src.models.lightgbm_model - INFO -   reg_alpha: 1.66551035792772e-08
2025-06-24 12:07:32,778 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0349486075512524
2025-06-24 12:07:32,778 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:07:32,778 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:07:32,778 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:07:32,864 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:07:32,864 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.04236450149008022})})
2025-06-24 12:07:32,864 - src.models.lightgbm_model - INFO -   - Best Iteration: 6
2025-06-24 12:07:32,864 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:07:32,866 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:07:32,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:07:32,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:32,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:32,888 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:32,904 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:32,921 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:32,938 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:32,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:32,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:32,976 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:07:32,976 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:32,980 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:07:32,981 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:07:32,982 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:07:32,982 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:07:32,982 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:07:32,982 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:32,982 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:32,982 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:07:32,982 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:07:32,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:07:32,990 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:07:32,991 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00000000e+000 1.19879229e-220 4.64150282e-137 1.45094706e-159
 1.07253488e-116 4.16827938e-054 3.43098227e-094 1.33341050e-031
 3.74745901e-243 1.88210383e-187 1.39553161e-249 1.00000000e+000
 1.38134809e-176 2.88267060e-010 9.10672444e-004]
2025-06-24 12:07:32,991 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:07:34,343 - src.training - INFO -   precision: 0.0
2025-06-24 12:07:34,343 - src.training - INFO -   recall: 0.0
2025-06-24 12:07:34,343 - src.training - INFO -   f1: 0.0
2025-06-24 12:07:34,343 - src.training - INFO -   accuracy: 0.9987734226486829
2025-06-24 12:07:34,343 - src.training - INFO -   balanced_accuracy: 0.4999977341731998
2025-06-24 12:07:34,343 - src.training - INFO -   positive_samples: 270
2025-06-24 12:07:34,343 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:07:34,343 - src.training - INFO -   total_samples: 220940
2025-06-24 12:07:34,343 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:07:34,343 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:07:34,343 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:07:34,343 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:07:34,343 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:07:34,343 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:07:34,343 - src.training - INFO - 모델 학습 완료
2025-06-24 12:07:34,343 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987734226486829, 'balanced_accuracy': 0.4999977341731998, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:07:34,343 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:34,343 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:34,343 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:34,344 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:34,364 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:07:34,364 - src.hyperparameter_tuning - ERROR - Trial 10 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:07:34,816 - src.hyperparameter_tuning - INFO - Trial 11: 모델 타입 = lightgbm
2025-06-24 12:07:36,758 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:07:36,758 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:07:36,758 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:07:36,758 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:07:36,758 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:07:36,758 - src.training - INFO - 교차 검증 시작
2025-06-24 12:07:36,758 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:07:36,776 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:07:37,247 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:07:37,247 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:07:37,247 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:07:37,247 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:07:37,247 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:07:37,247 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:07:37,247 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:07:37,247 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:07:37,247 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:07:37,414 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:07:37,415 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:07:37,415 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:07:37,415 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:07:37,415 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:07:37,415 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:07:37,415 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:07:37,415 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:07:37,415 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:07:37,415 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:07:38,884 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:07:40,032 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:07:40,032 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:07:40,038 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:07:40,071 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:07:40,071 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:07:40,071 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:07:40,071 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:07:41,435 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:07:41,717 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:07:41,717 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:07:41,885 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:07:41,886 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:07:41,929 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:07:41,929 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:07:41,929 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:07:41,929 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:07:41,929 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:41,929 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:41,991 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:07:41,991 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:07:41,991 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:41,991 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:41,991 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:07:41,991 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:07:41,991 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:42,056 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:07:42,056 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:07:42,056 - src.training - INFO - 모델 학습 시작
2025-06-24 12:07:42,187 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:07:42,187 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:07:42,187 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:07:42,187 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:07:42,187 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:07:42,187 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:07:42,187 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:07:42,187 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:07:42,187 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:07:42,187 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:07:42,187 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:07:42,187 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:07:42,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:07:42,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:42,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:42,277 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:42,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:42,410 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:42,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:42,541 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:42,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:42,634 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:07:42,634 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:42,696 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:07:42,696 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:42,696 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:07:42,696 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:42,696 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:42,715 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:42,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:42,747 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:42,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:42,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:42,798 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:42,801 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:07:42,801 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:42,817 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:07:42,817 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:42,817 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:07:42,817 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:42,817 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:07:42,829 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   learning_rate: 0.014018938621423336
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:07:42,832 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO -   n_estimators: 592
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO -   subsample: 0.9395686500135386
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9839876813547666
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO -   reg_alpha: 6.332402862366595e-07
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO -   reg_lambda: 9.85266015538796e-05
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:07:42,833 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:07:46,330 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:07:46,330 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.40174760171396695})})
2025-06-24 12:07:46,330 - src.models.lightgbm_model - INFO -   - Best Iteration: 592
2025-06-24 12:07:46,330 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:07:46,333 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:07:46,333 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:07:46,333 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:46,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:46,362 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:46,386 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:46,410 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:46,434 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:46,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:46,484 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:46,488 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:07:46,488 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:46,493 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:07:46,648 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:07:46,649 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:07:46,649 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:07:46,649 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:07:46,649 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:46,649 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:46,649 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:07:46,649 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:07:46,653 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:07:46,658 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:07:46,662 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.02343735 0.08628259 0.0173704  ... 0.01139797 0.00933248 0.01664612]
2025-06-24 12:07:46,662 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:07:47,517 - src.training - INFO -   precision: 0.0
2025-06-24 12:07:47,517 - src.training - INFO -   recall: 0.0
2025-06-24 12:07:47,517 - src.training - INFO -   f1: 0.0
2025-06-24 12:07:47,517 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:07:47,517 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:07:47,517 - src.training - INFO -   positive_samples: 270
2025-06-24 12:07:47,517 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:07:47,517 - src.training - INFO -   total_samples: 220940
2025-06-24 12:07:47,517 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:07:47,517 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:07:47,517 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:07:47,517 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:07:47,517 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:07:47,517 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:07:47,517 - src.training - INFO - 모델 학습 완료
2025-06-24 12:07:47,517 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:07:47,518 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:47,518 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:47,518 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:47,518 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:47,538 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:07:47,538 - src.hyperparameter_tuning - ERROR - Trial 11 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:07:47,989 - src.hyperparameter_tuning - INFO - Trial 12: 모델 타입 = lightgbm
2025-06-24 12:07:49,930 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:07:49,930 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:07:49,930 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:07:49,930 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:07:49,931 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:07:49,931 - src.training - INFO - 교차 검증 시작
2025-06-24 12:07:49,931 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:07:49,948 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:07:50,417 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:07:50,417 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:07:50,417 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:07:50,417 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:07:50,417 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:07:50,417 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:07:50,417 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:07:50,417 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:07:50,417 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:07:50,588 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:07:50,588 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:07:50,588 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:07:50,588 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:07:50,588 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:07:50,588 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:07:50,588 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:07:50,588 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:07:50,588 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:07:50,588 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:07:52,039 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:07:53,175 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:07:53,175 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:07:53,181 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:07:53,214 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:07:53,214 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:07:53,214 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:07:53,214 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:07:54,451 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:07:54,701 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:07:54,702 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:07:54,861 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:07:54,861 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:07:54,902 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:07:54,902 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:07:54,902 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:07:54,902 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:07:54,902 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:54,902 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:54,949 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:07:54,949 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:07:54,949 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:54,949 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:54,949 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:07:54,949 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:07:54,949 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:55,008 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:07:55,009 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:07:55,009 - src.training - INFO - 모델 학습 시작
2025-06-24 12:07:55,138 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:07:55,138 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:07:55,138 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:07:55,138 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:07:55,138 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:07:55,138 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:07:55,138 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:07:55,138 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:07:55,138 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:07:55,138 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:07:55,138 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:07:55,138 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:07:55,138 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:07:55,138 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:55,139 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:55,215 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:55,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:55,326 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:55,382 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:55,441 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:55,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:55,525 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:07:55,526 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:55,597 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:07:55,597 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:55,597 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:07:55,597 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:55,597 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:55,615 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:55,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:55,642 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:55,656 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:55,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:55,687 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:55,691 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:07:55,691 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:55,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:07:55,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:55,706 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:07:55,706 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:55,706 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:07:55,717 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:07:55,719 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   learning_rate: 0.048649820760777875
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   n_estimators: 426
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   subsample: 0.7106660900135554
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6052706929853362
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   reg_alpha: 2.063878230036083e-07
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO -   reg_lambda: 0.6304808735069546
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:07:55,720 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:07:55,837 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:07:55,837 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 4.12885058104245})})
2025-06-24 12:07:55,837 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:07:55,838 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:07:55,838 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:07:55,838 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:07:55,838 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:55,839 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:07:55,859 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:07:55,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:07:55,888 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:07:55,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:07:55,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:07:55,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:07:55,937 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:07:55,937 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:55,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:07:55,943 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:07:55,943 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:07:55,943 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:07:55,943 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:07:55,943 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:55,943 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:07:55,943 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:07:55,943 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:07:55,947 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:07:55,951 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:07:55,953 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [2.44045036e-002 9.99251952e-001 9.99998747e-001 9.72889887e-260
 1.04195430e-057 3.74252504e-001 9.26239591e-001 9.99746312e-001
 9.99999882e-001 9.99999999e-001 9.99998993e-001 3.76305421e-119
 9.99925547e-001 2.51680946e-002 8.64028640e-001 2.66594363e-001
 9.99999998e-001 1.00000000e+000 5.70962791e-004 7.49110064e-004
 2.51735281e-251 9.42786553e-001 8.66967505e-003 1.73573483e-106
 1.00000000e+000 1.48377037e-212 1.68353481e-106 9.99999999e-001
 3.22953734e-001 9.99806665e-001 1.63336720e-095 2.22696384e-148
 5.72388513e-004 3.65091905e-108 1.78395630e-053 9.99999723e-001
 2.64050085e-063 4.44560419e-106 1.68401171e-095 1.00000000e+000
 9.99999736e-001 1.91792552e-062 1.43955554e-201 1.75289949e-199
 9.99999586e-001 7.27110668e-004 1.21797790e-006 5.76986265e-002
 7.27717606e-004 2.29536332e-159 6.42460899e-153 0.00000000e+000
 1.02483669e-004 2.60248739e-100 2.01195206e-107 1.98889758e-093
 7.50980294e-004 1.00000000e+000 3.21231439e-003 1.00000000e+000
 9.99991049e-001 2.71170071e-146 2.05056574e-093 1.00000000e+000
 7.27457038e-091 4.96426166e-093 3.64760815e-011 9.94549253e-001
 2.64509567e-019 2.07663639e-103 9.45188858e-001 1.07325631e-069
 4.96263273e-054 6.83229657e-055 2.58164106e-002 9.81222103e-001
 7.43964163e-089 4.07686260e-095 2.84758659e-113 1.36545262e-073
 1.42159447e-153 3.90066959e-077 3.15177401e-102 1.00000000e+000
 1.81777237e-118 1.04266882e-100 3.46741264e-111 9.59747197e-001
 4.21952070e-062 1.63745886e-001 2.13901620e-068 1.32313106e-006
 1.14637835e-148 9.99978546e-001 3.83781167e-100 1.70542204e-105
 1.24995434e-006 9.99753012e-001 1.08866543e-110 1.30087126e-055
 5.94990709e-004 6.75931530e-002 1.94930145e-092 3.14589899e-021
 7.98126872e-012 1.57375544e-008 9.61219597e-001 7.82303531e-151
 9.99979540e-001 1.16543876e-083 9.99999926e-001 6.71024106e-010
 3.80041671e-009 4.74971722e-075 2.49001363e-082 1.41911649e-081
 1.57364520e-008 1.04461994e-011 2.03529351e-102 9.59413313e-001
 4.10118406e-158 9.99998236e-001 9.99999999e-001 6.96017949e-073
 9.99999999e-001 2.07955653e-079 4.16288169e-001 1.55486996e-062
 4.46461084e-061 3.85079702e-071 1.27859719e-061 1.19588383e-058
 2.73510091e-054 1.14051455e-058]
2025-06-24 12:07:55,953 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:07:56,734 - src.training - INFO -   precision: 0.0
2025-06-24 12:07:56,734 - src.training - INFO -   recall: 0.0
2025-06-24 12:07:56,734 - src.training - INFO -   f1: 0.0
2025-06-24 12:07:56,734 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:07:56,734 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:07:56,734 - src.training - INFO -   positive_samples: 270
2025-06-24 12:07:56,734 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:07:56,734 - src.training - INFO -   total_samples: 220940
2025-06-24 12:07:56,734 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:07:56,734 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:07:56,734 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:07:56,734 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:07:56,734 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:07:56,734 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:07:56,734 - src.training - INFO - 모델 학습 완료
2025-06-24 12:07:56,734 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:07:56,734 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:56,734 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:56,734 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:07:56,734 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:07:56,754 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:07:56,754 - src.hyperparameter_tuning - ERROR - Trial 12 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:07:57,192 - src.hyperparameter_tuning - INFO - Trial 13: 모델 타입 = lightgbm
2025-06-24 12:07:58,981 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:07:58,982 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:07:58,982 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:07:58,982 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:07:58,982 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:07:58,982 - src.training - INFO - 교차 검증 시작
2025-06-24 12:07:58,982 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:07:58,999 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:07:59,434 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:07:59,434 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:07:59,434 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:07:59,434 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:07:59,434 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:07:59,434 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:07:59,434 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:07:59,434 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:07:59,434 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:07:59,612 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:07:59,612 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:07:59,612 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:07:59,612 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:07:59,612 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:07:59,612 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:07:59,612 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:07:59,612 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:07:59,612 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:07:59,612 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:08:00,919 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:08:01,939 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:08:01,939 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:08:01,943 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:08:01,974 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:08:01,975 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:08:01,975 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:08:01,975 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:08:03,181 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:08:03,428 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:08:03,428 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:08:03,587 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:08:03,587 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:08:03,628 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:08:03,628 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:08:03,628 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:08:03,628 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:08:03,628 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:03,628 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:03,674 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:08:03,674 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:08:03,674 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:03,674 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:03,674 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:08:03,674 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:08:03,674 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:03,731 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:08:03,731 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:08:03,731 - src.training - INFO - 모델 학습 시작
2025-06-24 12:08:03,857 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:08:03,857 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:08:03,857 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:08:03,857 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:08:03,857 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:08:03,857 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:08:03,857 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:08:03,857 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:08:03,857 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:08:03,857 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:08:03,857 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:08:03,857 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:08:03,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:08:03,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:03,858 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:03,935 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:03,989 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:04,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:04,105 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:04,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:04,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:04,247 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:08:04,247 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:04,317 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:08:04,317 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:04,317 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:08:04,317 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:04,317 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:04,335 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:04,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:04,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:04,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:04,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:04,407 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:04,410 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:08:04,410 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:04,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:08:04,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:04,425 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:08:04,425 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:04,425 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:08:04,436 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:08:04,438 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:08:04,438 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:08:04,438 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:08:04,438 - src.models.lightgbm_model - INFO -   learning_rate: 0.2697555284286996
2025-06-24 12:08:04,438 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:08:04,438 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:08:04,438 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:08:04,438 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:08:04,438 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:08:04,438 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:08:04,438 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:08:04,438 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:08:04,438 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:08:04,438 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   n_estimators: 786
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   subsample: 0.8226567178582186
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6483387931775606
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00019608088886328894
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO -   reg_lambda: 0.020639453252646555
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:08:04,439 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:08:04,523 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:08:04,524 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.042364501135120976})})
2025-06-24 12:08:04,524 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:08:04,524 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:08:04,524 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:08:04,524 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:08:04,524 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:04,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:04,545 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:04,560 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:04,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:04,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:04,604 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:04,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:04,624 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:08:04,624 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:04,628 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:08:04,629 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:08:04,630 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:08:04,630 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:08:04,630 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:08:04,630 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:04,630 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:04,630 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:08:04,630 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:08:04,633 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:08:04,638 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:08:04,638 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00000000e+000 3.49886233e-240 3.26811986e-149 2.74380157e-173
 1.40214053e-126 2.70184879e-058 1.67007824e-102 3.21815025e-034
 2.93752505e-264 4.59165245e-204 1.56730258e-270 1.00000000e+000
 1.93238848e-192 9.30674058e-011 8.95002134e-004]
2025-06-24 12:08:04,638 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:08:05,879 - src.training - INFO -   precision: 0.0
2025-06-24 12:08:05,879 - src.training - INFO -   recall: 0.0
2025-06-24 12:08:05,879 - src.training - INFO -   f1: 0.0
2025-06-24 12:08:05,881 - src.training - INFO -   accuracy: 0.9987734226486829
2025-06-24 12:08:05,881 - src.training - INFO -   balanced_accuracy: 0.4999977341731998
2025-06-24 12:08:05,881 - src.training - INFO -   positive_samples: 270
2025-06-24 12:08:05,881 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:08:05,881 - src.training - INFO -   total_samples: 220940
2025-06-24 12:08:05,881 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:08:05,881 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:08:05,881 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:08:05,881 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:08:05,881 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:08:05,881 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:08:05,881 - src.training - INFO - 모델 학습 완료
2025-06-24 12:08:05,881 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987734226486829, 'balanced_accuracy': 0.4999977341731998, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:08:05,881 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:05,881 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:05,881 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:05,881 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:05,902 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:08:05,902 - src.hyperparameter_tuning - ERROR - Trial 13 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:08:06,344 - src.hyperparameter_tuning - INFO - Trial 14: 모델 타입 = lightgbm
2025-06-24 12:08:08,164 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:08:08,164 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:08:08,164 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:08:08,164 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:08:08,164 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:08:08,164 - src.training - INFO - 교차 검증 시작
2025-06-24 12:08:08,164 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:08:08,183 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:08:08,633 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:08:08,633 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:08:08,633 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:08:08,633 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:08:08,633 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:08:08,633 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:08:08,633 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:08:08,633 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:08:08,633 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:08:08,814 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:08:08,814 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:08:08,814 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:08:08,814 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:08:08,814 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:08:08,814 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:08:08,814 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:08:08,814 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:08:08,814 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:08:08,814 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:08:10,117 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:08:11,134 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:08:11,134 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:08:11,140 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:08:11,172 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:08:11,172 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:08:11,172 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:08:11,172 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:08:12,378 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:08:12,625 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:08:12,625 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:08:12,784 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:08:12,784 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:08:12,824 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:08:12,825 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:08:12,825 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:08:12,825 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:08:12,825 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:12,825 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:12,870 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:08:12,870 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:08:12,870 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:12,870 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:12,870 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:08:12,870 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:08:12,870 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:12,928 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:08:12,928 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:08:12,928 - src.training - INFO - 모델 학습 시작
2025-06-24 12:08:13,054 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:08:13,054 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:08:13,054 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:08:13,054 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:08:13,054 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:08:13,054 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:08:13,054 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:08:13,054 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:08:13,054 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:08:13,054 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:08:13,054 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:08:13,055 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:08:13,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:08:13,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:13,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:13,133 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:13,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:13,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:13,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:13,357 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:13,427 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:13,441 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:08:13,442 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:13,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:08:13,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:13,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:08:13,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:13,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:13,529 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:13,543 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:13,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:13,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:13,585 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:13,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:13,604 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:08:13,604 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:13,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:08:13,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:13,618 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:08:13,618 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:13,618 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:08:13,630 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO -   learning_rate: 0.02840798478077277
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:08:13,632 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   n_estimators: 787
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   subsample: 0.9680175870698012
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9330528388075537
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   reg_alpha: 2.129462133200499e-05
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO -   reg_lambda: 2.2443842108566792e-08
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:08:13,633 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:08:13,743 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:08:13,743 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 1.5764996945658327})})
2025-06-24 12:08:13,743 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:08:13,743 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:08:13,744 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:08:13,744 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:08:13,744 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:13,744 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:13,767 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:13,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:13,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:13,810 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:13,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:13,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:13,847 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:08:13,847 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:13,850 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:08:13,852 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:08:13,852 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:08:13,852 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:08:13,852 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:08:13,852 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:13,852 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:13,852 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:08:13,852 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:08:13,856 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:08:13,860 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:08:13,861 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [8.48349751e-003 9.32346393e-001 9.51413333e-001 9.49045157e-001
 9.99907753e-001 3.81993981e-002 2.70976212e-001 9.14294324e-001
 3.94389245e-001 1.47146793e-001 3.04831657e-004 9.56997700e-001
 3.04523404e-015 9.88187732e-001 4.48685398e-002 9.99999689e-001
 1.08212833e-003 9.99999343e-001 9.09917473e-001 3.63760959e-055
 7.92784439e-009 1.08370455e-003 2.38519425e-093 9.99970481e-001
 1.56368308e-047 0.00000000e+000 9.52627271e-005 9.96519333e-001
 9.73965610e-001 1.03047642e-004 2.50331687e-011 7.15977095e-018
 1.36956704e-003 2.50453771e-011 1.04367056e-006 3.78585114e-025
 9.99141785e-001 3.86982013e-209 1.84344206e-005 5.81786052e-001
 6.55102020e-001 9.99994494e-001 7.67525310e-002 1.03865463e-002
 3.33128286e-010 9.99512807e-001 4.41767759e-058 1.15282373e-003
 1.86394706e-011 6.90991580e-003 3.51759694e-044 9.85593834e-019
 1.59982364e-041 9.99997809e-001 9.99959696e-001 8.65757490e-059
 1.15028863e-005 8.64823560e-007 2.29125180e-007 1.59766420e-008
 7.87427059e-004 7.06936962e-004 4.21214133e-004 7.08113791e-012
 1.62740701e-017 9.63408514e-001 9.50733333e-001 3.04758292e-006
 3.72168369e-049 3.22427917e-001 2.14351207e-057 9.64259081e-004
 6.38310997e-022 8.45605428e-008 9.99301056e-001 9.99334914e-001
 1.61864444e-010 5.18735627e-001 6.13692856e-015 9.99947983e-001
 8.18301645e-052 9.99997172e-001 8.46365665e-002 2.38839349e-001
 6.43166145e-011 4.83311903e-012 3.28264875e-058 1.55719972e-009
 1.75444654e-006 5.70856027e-014 3.99630558e-020 7.88491157e-004
 1.46730007e-208 9.96867134e-001 7.05614756e-060 9.99998395e-001
 4.41710326e-002]
2025-06-24 12:08:13,861 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:08:14,660 - src.training - INFO -   precision: 0.0
2025-06-24 12:08:14,660 - src.training - INFO -   recall: 0.0
2025-06-24 12:08:14,660 - src.training - INFO -   f1: 0.0
2025-06-24 12:08:14,660 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:08:14,660 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:08:14,660 - src.training - INFO -   positive_samples: 270
2025-06-24 12:08:14,660 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:08:14,660 - src.training - INFO -   total_samples: 220940
2025-06-24 12:08:14,660 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:08:14,660 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:08:14,660 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:08:14,660 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:08:14,661 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:08:14,661 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:08:14,661 - src.training - INFO - 모델 학습 완료
2025-06-24 12:08:14,661 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:08:14,661 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:14,661 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:14,661 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:14,661 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:14,680 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:08:14,680 - src.hyperparameter_tuning - ERROR - Trial 14 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:08:15,110 - src.hyperparameter_tuning - INFO - Trial 15: 모델 타입 = lightgbm
2025-06-24 12:08:17,053 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:08:17,053 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:08:17,053 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:08:17,053 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:08:17,053 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:08:17,053 - src.training - INFO - 교차 검증 시작
2025-06-24 12:08:17,053 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:08:17,069 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:08:17,551 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:08:17,551 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:08:17,551 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:08:17,551 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:08:17,551 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:08:17,551 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:08:17,551 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:08:17,551 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:08:17,551 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:08:17,722 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:08:17,722 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:08:17,722 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:08:17,722 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:08:17,722 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:08:17,722 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:08:17,722 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:08:17,722 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:08:17,722 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:08:17,722 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:08:19,178 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:08:20,315 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:08:20,315 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:08:20,321 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:08:20,353 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:08:20,353 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:08:20,353 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:08:20,353 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:08:21,687 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:08:21,958 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:08:21,958 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:08:22,125 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:08:22,125 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:08:22,168 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:08:22,169 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:08:22,169 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:08:22,169 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:08:22,169 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:22,169 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:22,218 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:08:22,218 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:08:22,218 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:22,218 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:22,218 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:08:22,218 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:08:22,218 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:22,285 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:08:22,286 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:08:22,286 - src.training - INFO - 모델 학습 시작
2025-06-24 12:08:22,417 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:08:22,417 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:08:22,417 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:08:22,417 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:08:22,417 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:08:22,417 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:08:22,417 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:08:22,417 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:08:22,417 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:08:22,417 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:08:22,417 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:08:22,417 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:08:22,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:08:22,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:22,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:22,507 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:22,573 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:22,641 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:22,704 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:22,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:22,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:22,861 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:08:22,861 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:22,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:08:22,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:22,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:08:22,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:22,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:22,943 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:22,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:22,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:22,991 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:23,008 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:23,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:23,029 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:08:23,029 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:23,044 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:08:23,044 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:23,044 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:08:23,044 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:23,044 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:08:23,054 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   learning_rate: 0.10863714748410747
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:08:23,056 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   n_estimators: 463
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   subsample: 0.9170568439631313
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6370289136139937
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   reg_alpha: 1.7573293960982555e-07
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO -   reg_lambda: 0.015643589454316154
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:08:23,057 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:08:23,165 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:08:23,166 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 4.4669653609901})})
2025-06-24 12:08:23,166 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:08:23,166 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:08:23,166 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:08:23,166 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:08:23,166 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:23,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:23,188 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:23,204 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:23,221 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:23,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:23,253 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:23,270 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:23,273 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:08:23,273 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:23,276 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:08:23,278 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:08:23,278 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:08:23,278 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:08:23,278 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:08:23,278 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:23,278 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:23,278 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:08:23,278 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:08:23,282 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:08:23,286 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:08:23,288 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [6.62610481e-001 9.99999445e-001 1.00000000e+000 0.00000000e+000
 8.62853162e-097 5.44012216e-092 3.78244078e-008 2.79617415e-084
 8.99859424e-001 9.99999999e-001 9.99997344e-001 1.00000000e+000
 1.00000000e+000 1.00000000e+000 1.03120742e-192 1.00320007e-050
 7.41819178e-004 3.68204397e-054 2.05335442e-036 3.31760350e-067
 1.68286703e-112 6.27705051e-303 1.02627945e-087 1.00000000e+000
 2.02029913e-060 1.18989103e-120 5.63108831e-094 6.85192704e-003
 9.99991503e-001 2.16396840e-274 2.45247339e-087 7.40264459e-250
 9.99999843e-001 5.66255374e-094 3.52762177e-168 9.99999660e-001
 9.99999904e-001 3.36095087e-245 1.26669361e-100 1.00000000e+000
 1.00000000e+000 9.99999953e-001 5.24771812e-010 8.22283857e-010
 4.14086663e-014 1.60161187e-163 1.04401383e-005 2.47047350e-009
 2.33092625e-010 9.28531215e-119 2.61172954e-087 6.90742116e-038
 3.55127696e-001 4.13315294e-014 9.99718031e-001 1.47273548e-123
 2.08650361e-072 4.16582126e-017 6.94462086e-009 4.45660529e-110
 2.77777467e-035 9.05106983e-016 5.25751190e-010 1.17162396e-014
 3.01738303e-022 1.69129462e-003 5.99185045e-018 7.58064759e-002
 1.33433638e-007 1.19053599e-019 1.52242736e-011 1.00000000e+000
 7.27498118e-102 3.01176219e-022 1.06024874e-307 8.05217577e-112
 8.92469806e-019 9.99999285e-001 2.36413924e-015 4.25593297e-010
 9.99999987e-001 9.95418761e-001 1.34907187e-023 2.33192406e-031
 7.00623983e-095 4.49501289e-023 4.63068165e-027 9.99997170e-001
 8.41159389e-015 2.55297680e-018 5.48037799e-035 1.39883500e-039
 1.45163257e-024 8.78956339e-044 2.52125931e-118 1.60390908e-022
 1.00005286e-013 6.41939823e-037 4.30818103e-007 7.60662537e-137
 6.90956840e-016 7.63201085e-036 1.27869031e-073 4.18240933e-057
 1.08811076e-030 1.74513847e-039 1.39128314e-090 8.30403411e-053
 1.21141352e-241 3.26146199e-134 8.66432761e-113 8.07772006e-260
 2.99752060e-117 4.06778767e-264 5.24620749e-132 9.57321709e-111
 7.42401178e-243 1.29131843e-110 4.12409899e-104 3.28783604e-029]
2025-06-24 12:08:23,288 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:08:24,653 - src.training - INFO -   precision: 0.0007927070947284979
2025-06-24 12:08:24,653 - src.training - INFO -   recall: 0.007407407407407408
2025-06-24 12:08:24,653 - src.training - INFO -   f1: 0.0014321518080916578
2025-06-24 12:08:24,653 - src.training - INFO -   accuracy: 0.9873766633475152
2025-06-24 12:08:24,653 - src.training - INFO -   balanced_accuracy: 0.49799155434040104
2025-06-24 12:08:24,653 - src.training - INFO -   positive_samples: 270
2025-06-24 12:08:24,653 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:08:24,653 - src.training - INFO -   total_samples: 220940
2025-06-24 12:08:24,653 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:08:24,653 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:08:24,653 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:08:24,653 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:08:24,653 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:08:24,653 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:08:24,653 - src.training - INFO - 모델 학습 완료
2025-06-24 12:08:24,653 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0007927070947284979, 'recall': 0.007407407407407408, 'f1': 0.0014321518080916578, 'accuracy': 0.9873766633475152, 'balanced_accuracy': 0.49799155434040104, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:08:24,653 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:24,653 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:24,653 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:24,653 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:24,673 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:08:24,673 - src.hyperparameter_tuning - ERROR - Trial 15 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:08:25,124 - src.hyperparameter_tuning - INFO - Trial 16: 모델 타입 = lightgbm
2025-06-24 12:08:27,044 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:08:27,044 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:08:27,044 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:08:27,044 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:08:27,044 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:08:27,044 - src.training - INFO - 교차 검증 시작
2025-06-24 12:08:27,044 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:08:27,060 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:08:27,533 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:08:27,533 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:08:27,533 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:08:27,533 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:08:27,533 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:08:27,533 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:08:27,533 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:08:27,533 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:08:27,533 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:08:27,701 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:08:27,701 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:08:27,701 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:08:27,701 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:08:27,701 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:08:27,701 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:08:27,701 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:08:27,701 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:08:27,701 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:08:27,701 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:08:29,163 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:08:30,299 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:08:30,299 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:08:30,305 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:08:30,337 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:08:30,337 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:08:30,337 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:08:30,337 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:08:31,670 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:08:31,937 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:08:31,937 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:08:32,105 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:08:32,105 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:08:32,148 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:08:32,148 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:08:32,148 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:08:32,148 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:08:32,148 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:32,148 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:32,198 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:08:32,198 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:08:32,198 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:32,198 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:32,198 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:08:32,198 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:08:32,198 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:32,262 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:08:32,262 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:08:32,262 - src.training - INFO - 모델 학습 시작
2025-06-24 12:08:32,394 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:08:32,394 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:08:32,394 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:08:32,394 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:08:32,394 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:08:32,394 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:08:32,394 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:08:32,394 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:08:32,394 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:08:32,394 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:08:32,394 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:08:32,394 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:08:32,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:08:32,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:32,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:32,484 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:32,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:32,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:32,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:32,747 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:32,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:32,837 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:08:32,837 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:32,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:08:32,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:32,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:08:32,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:32,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:32,919 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:32,934 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:32,950 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:32,965 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:32,981 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:32,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:33,001 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:08:33,001 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:33,016 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:08:33,016 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:33,016 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:08:33,016 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:33,016 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:08:33,027 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   learning_rate: 0.021877321178095717
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:08:33,029 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:08:33,030 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:08:33,030 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:08:33,030 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:08:33,030 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:08:33,030 - src.models.lightgbm_model - INFO -   n_estimators: 363
2025-06-24 12:08:33,030 - src.models.lightgbm_model - INFO -   subsample: 0.9406057735282904
2025-06-24 12:08:33,030 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7726651033830346
2025-06-24 12:08:33,030 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:08:33,030 - src.models.lightgbm_model - INFO -   reg_alpha: 1.145293713215081e-07
2025-06-24 12:08:33,030 - src.models.lightgbm_model - INFO -   reg_lambda: 3.278660414342363e-06
2025-06-24 12:08:33,030 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:08:33,030 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:08:33,030 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:08:35,190 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:08:35,191 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.5856664686517206})})
2025-06-24 12:08:35,191 - src.models.lightgbm_model - INFO -   - Best Iteration: 363
2025-06-24 12:08:35,191 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:08:35,191 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:08:35,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:08:35,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:35,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:35,214 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:35,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:35,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:35,265 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:35,283 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:35,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:35,304 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:08:35,304 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:35,307 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:08:35,383 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:08:35,383 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:08:35,383 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:08:35,383 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:08:35,383 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:35,383 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:35,383 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:08:35,383 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:08:35,387 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:08:35,392 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:08:35,396 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.04156463 0.11105118 0.02356772 ... 0.0079933  0.00601238 0.00827756]
2025-06-24 12:08:35,396 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:08:36,773 - src.training - INFO -   precision: 0.004830917874396135
2025-06-24 12:08:36,773 - src.training - INFO -   recall: 0.014814814814814815
2025-06-24 12:08:36,773 - src.training - INFO -   f1: 0.007285974499089253
2025-06-24 12:08:36,773 - src.training - INFO -   accuracy: 0.9950665339006065
2025-06-24 12:08:36,773 - src.training - INFO -   balanced_accuracy: 0.5055403661240431
2025-06-24 12:08:36,773 - src.training - INFO -   positive_samples: 270
2025-06-24 12:08:36,773 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:08:36,773 - src.training - INFO -   total_samples: 220940
2025-06-24 12:08:36,773 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:08:36,773 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:08:36,773 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:08:36,773 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:08:36,773 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:08:36,773 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:08:36,774 - src.training - INFO - 모델 학습 완료
2025-06-24 12:08:36,774 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.004830917874396135, 'recall': 0.014814814814814815, 'f1': 0.007285974499089253, 'accuracy': 0.9950665339006065, 'balanced_accuracy': 0.5055403661240431, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:08:36,774 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:36,774 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:36,774 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:36,774 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:36,794 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:08:36,794 - src.hyperparameter_tuning - ERROR - Trial 16 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:08:37,262 - src.hyperparameter_tuning - INFO - Trial 17: 모델 타입 = lightgbm
2025-06-24 12:08:39,221 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:08:39,222 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:08:39,222 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:08:39,222 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:08:39,222 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:08:39,222 - src.training - INFO - 교차 검증 시작
2025-06-24 12:08:39,222 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:08:39,239 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:08:39,714 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:08:39,714 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:08:39,714 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:08:39,714 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:08:39,714 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:08:39,714 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:08:39,714 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:08:39,714 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:08:39,714 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:08:39,878 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:08:39,878 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:08:39,878 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:08:39,878 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:08:39,879 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:08:39,879 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:08:39,879 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:08:39,879 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:08:39,879 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:08:39,879 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:08:41,338 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:08:42,477 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:08:42,478 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:08:42,484 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:08:42,515 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:08:42,515 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:08:42,515 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:08:42,515 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:08:43,861 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:08:44,129 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:08:44,129 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:08:44,296 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:08:44,296 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:08:44,339 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:08:44,340 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:08:44,340 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:08:44,340 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:08:44,340 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:44,340 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:44,389 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:08:44,389 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:08:44,389 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:44,389 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:44,389 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:08:44,389 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:08:44,389 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:44,455 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:08:44,455 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:08:44,455 - src.training - INFO - 모델 학습 시작
2025-06-24 12:08:44,586 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:08:44,586 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:08:44,586 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:08:44,586 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:08:44,586 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:08:44,586 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:08:44,586 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:08:44,586 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:08:44,586 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:08:44,586 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:08:44,586 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:08:44,586 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:08:44,586 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:08:44,586 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:44,586 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:44,675 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:44,742 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:44,810 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:44,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:44,940 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:45,017 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:45,032 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:08:45,032 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:45,095 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:08:45,095 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:45,095 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:08:45,095 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:45,095 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:45,114 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:45,129 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:45,145 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:45,161 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:45,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:45,196 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:45,199 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:08:45,199 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:45,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:08:45,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:45,214 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:08:45,214 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:45,214 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:08:45,225 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:08:45,228 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:08:45,228 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:08:45,228 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:08:45,228 - src.models.lightgbm_model - INFO -   learning_rate: 0.10314243632957078
2025-06-24 12:08:45,228 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:08:45,228 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:08:45,228 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:08:45,228 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:08:45,228 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:08:45,228 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:08:45,228 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:08:45,228 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:08:45,228 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:08:45,228 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   n_estimators: 767
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   subsample: 0.9972455966187783
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8072957294731979
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   reg_alpha: 3.7770457002794944e-06
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO -   reg_lambda: 0.09268625636135217
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:08:45,229 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:08:45,345 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:08:45,345 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 6.419643201383355})})
2025-06-24 12:08:45,345 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:08:45,345 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:08:45,346 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:08:45,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:08:45,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:45,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:45,368 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:45,384 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:45,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:45,417 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:45,433 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:45,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:45,454 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:08:45,454 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:45,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:08:45,459 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:08:45,459 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:08:45,459 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:08:45,459 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:08:45,459 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:45,459 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:45,459 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:08:45,459 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:08:45,463 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:08:45,467 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:08:45,469 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [5.95853095e-001 1.00000000e+000 1.00000000e+000 0.00000000e+000
 1.39075044e-091 2.83769251e-098 6.90740975e-288 3.14490706e-004
 2.08110696e-081 9.99999872e-001 1.00000000e+000 1.00000000e+000
 1.00000000e+000 1.00000000e+000 3.05198277e-182 2.28939773e-045
 9.99482695e-001 1.25364664e-048 3.38326559e-024 3.38036085e-065
 2.68159791e-077 1.13520939e-049 1.42612543e-054 9.56454738e-106
 1.07297707e-040 3.82702418e-069 1.14894325e-114 6.52874469e-279
 1.29637569e-090 9.99937665e-001 9.99999999e-001 2.37987096e-259
 1.31450932e-082 4.67506842e-236 1.30325223e-090 5.99537896e-159
 1.00000000e+000 1.23399968e-231 1.18718310e-095 1.00000000e+000
 1.00000000e+000 4.03820044e-008 4.86735048e-004 4.04535539e-008
 1.58249999e-154 7.17484693e-005 2.50778708e-006 1.09403382e-123
 7.89787859e-094 2.04962947e-031 9.99998187e-001 9.99999985e-001
 5.36184949e-117 6.16762659e-040 1.46158036e-004 1.25603933e-104
 8.09466280e-022 5.05604922e-005 2.07957976e-010 4.37664569e-075
 3.59579323e-015 5.75711991e-002 4.32854632e-011 9.99994057e-001
 3.09201084e-014 5.71993225e-007 7.87839756e-097 3.58943342e-015
 1.92247339e-283 4.31343319e-083 1.32018633e-011 1.00000000e+000
 3.72210282e-010 9.99999789e-001 9.48127173e-010 2.83715653e-061
 1.09686296e-015 1.00000000e+000 4.19623963e-004 1.03172089e-005
 2.87049729e-023 6.72436693e-026 1.14197682e-010 6.48307694e-029
 1.70170653e-030 9.94562259e-009 4.38429414e-003 9.99885864e-001
 4.84248912e-130 1.94018130e-002 1.78504862e-029 4.35309953e-041
 1.16358803e-049 3.45493597e-019 7.80304369e-025 3.41531414e-057
 1.40049676e-045 3.41345185e-274 2.56274370e-023 5.19533753e-084
 1.41911555e-040 1.57021458e-295 2.94942704e-102 4.52468615e-082
 1.80877980e-024 3.55115231e-023 9.00135128e-076]
2025-06-24 12:08:45,469 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:08:46,771 - src.training - INFO -   precision: 0.002068087814190264
2025-06-24 12:08:46,771 - src.training - INFO -   recall: 0.04814814814814815
2025-06-24 12:08:46,771 - src.training - INFO -   f1: 0.003965832824893227
2025-06-24 12:08:46,771 - src.training - INFO -   accuracy: 0.9704444645605141
2025-06-24 12:08:46,771 - src.training - INFO -   balanced_accuracy: 0.5098605425564232
2025-06-24 12:08:46,771 - src.training - INFO -   positive_samples: 270
2025-06-24 12:08:46,771 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:08:46,771 - src.training - INFO -   total_samples: 220940
2025-06-24 12:08:46,771 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:08:46,771 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:08:46,771 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:08:46,771 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:08:46,771 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:08:46,771 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:08:46,771 - src.training - INFO - 모델 학습 완료
2025-06-24 12:08:46,771 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002068087814190264, 'recall': 0.04814814814814815, 'f1': 0.003965832824893227, 'accuracy': 0.9704444645605141, 'balanced_accuracy': 0.5098605425564232, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:08:46,771 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:46,771 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:46,771 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:46,771 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:46,791 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:08:46,791 - src.hyperparameter_tuning - ERROR - Trial 17 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:08:47,248 - src.hyperparameter_tuning - INFO - Trial 18: 모델 타입 = lightgbm
2025-06-24 12:08:49,203 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:08:49,203 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:08:49,203 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:08:49,203 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:08:49,203 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:08:49,203 - src.training - INFO - 교차 검증 시작
2025-06-24 12:08:49,203 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:08:49,221 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:08:49,698 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:08:49,698 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:08:49,698 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:08:49,698 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:08:49,698 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:08:49,698 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:08:49,698 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:08:49,698 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:08:49,698 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:08:49,863 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:08:49,863 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:08:49,863 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:08:49,863 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:08:49,863 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:08:49,863 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:08:49,863 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:08:49,863 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:08:49,863 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:08:49,863 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:08:51,317 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:08:52,452 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:08:52,452 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:08:52,458 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:08:52,490 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:08:52,490 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:08:52,490 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:08:52,490 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:08:53,828 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:08:54,100 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:08:54,100 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:08:54,268 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:08:54,268 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:08:54,322 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:08:54,322 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:08:54,322 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:08:54,322 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:08:54,322 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:54,322 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:54,372 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:08:54,372 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:08:54,372 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:54,372 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:54,372 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:08:54,372 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:08:54,372 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:54,438 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:08:54,439 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:08:54,439 - src.training - INFO - 모델 학습 시작
2025-06-24 12:08:54,571 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:08:54,571 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:08:54,571 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:08:54,571 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:08:54,571 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:08:54,571 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:08:54,571 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:08:54,571 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:08:54,571 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:08:54,571 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:08:54,571 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:08:54,571 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:08:54,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:08:54,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:54,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:54,660 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:54,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:54,795 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:54,859 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:54,925 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:55,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:55,018 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:08:55,019 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:55,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:08:55,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:55,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:08:55,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:55,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:55,100 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:55,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:55,131 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:55,147 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:55,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:55,182 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:55,185 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:08:55,185 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:55,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:08:55,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:55,201 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:08:55,201 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:55,201 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:08:55,211 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   learning_rate: 0.017726672452699255
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   n_estimators: 257
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   subsample: 0.8839388918009317
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6618035309979471
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   reg_alpha: 6.003903736307582e-06
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO -   reg_lambda: 0.03581637118068328
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:08:55,214 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:08:55,215 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:08:56,735 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:08:56,735 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.4519741207750059})})
2025-06-24 12:08:56,735 - src.models.lightgbm_model - INFO -   - Best Iteration: 257
2025-06-24 12:08:56,735 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:08:56,736 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:08:56,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:08:56,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:56,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:08:56,757 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:08:56,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:08:56,791 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:08:56,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:08:56,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:08:56,842 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:08:56,844 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:08:56,844 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:56,848 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:08:56,904 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:08:56,904 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:08:56,904 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:08:56,904 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:08:56,904 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:56,904 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:08:56,904 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:08:56,904 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:08:56,908 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:08:56,913 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:08:56,917 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.02506955 0.04124067 0.01971928 ... 0.0082073  0.00686428 0.01160345]
2025-06-24 12:08:56,917 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:08:57,776 - src.training - INFO -   precision: 0.0
2025-06-24 12:08:57,776 - src.training - INFO -   recall: 0.0
2025-06-24 12:08:57,776 - src.training - INFO -   f1: 0.0
2025-06-24 12:08:57,776 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:08:57,776 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:08:57,776 - src.training - INFO -   positive_samples: 270
2025-06-24 12:08:57,776 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:08:57,776 - src.training - INFO -   total_samples: 220940
2025-06-24 12:08:57,776 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:08:57,776 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:08:57,776 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:08:57,776 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:08:57,777 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:08:57,777 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:08:57,777 - src.training - INFO - 모델 학습 완료
2025-06-24 12:08:57,777 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:08:57,777 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:57,777 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:57,777 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:08:57,777 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:08:57,797 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:08:57,797 - src.hyperparameter_tuning - ERROR - Trial 18 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:08:58,261 - src.hyperparameter_tuning - INFO - Trial 19: 모델 타입 = lightgbm
2025-06-24 12:09:00,198 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:09:00,198 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:09:00,198 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:09:00,198 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:09:00,198 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:09:00,198 - src.training - INFO - 교차 검증 시작
2025-06-24 12:09:00,198 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:09:00,215 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:09:00,687 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:09:00,687 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:09:00,687 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:09:00,687 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:09:00,687 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:09:00,687 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:09:00,687 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:09:00,687 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:09:00,687 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:09:00,856 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:09:00,856 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:09:00,856 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:09:00,856 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:09:00,856 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:09:00,856 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:09:00,856 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:09:00,856 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:09:00,856 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:09:00,856 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:09:02,303 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:09:03,432 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:09:03,432 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:09:03,438 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:09:03,471 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:09:03,471 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:09:03,471 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:09:03,471 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:09:04,820 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:09:05,072 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:09:05,072 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:09:05,236 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:09:05,236 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:09:05,276 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:09:05,276 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:09:05,276 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:09:05,277 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:09:05,277 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:05,277 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:05,334 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:09:05,334 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:09:05,334 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:05,334 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:05,334 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:09:05,334 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:09:05,334 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:05,392 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:09:05,392 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:09:05,392 - src.training - INFO - 모델 학습 시작
2025-06-24 12:09:05,519 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:09:05,519 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:09:05,519 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:09:05,519 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:09:05,519 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:09:05,519 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:09:05,519 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:09:05,519 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:09:05,519 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:09:05,519 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:09:05,519 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:09:05,519 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:09:05,519 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:09:05,519 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:05,520 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:05,598 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:05,653 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:05,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:05,766 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:05,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:05,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:05,909 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:09:05,910 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:05,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:09:05,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:05,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:09:05,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:05,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:06,001 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:06,015 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:06,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:06,044 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:06,058 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:06,075 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:06,078 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:09:06,078 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:06,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:09:06,093 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:06,093 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:09:06,093 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:06,093 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:09:06,103 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   learning_rate: 0.0667455590178049
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:09:06,106 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:09:06,107 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:09:06,107 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:09:06,107 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:09:06,107 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:09:06,107 - src.models.lightgbm_model - INFO -   n_estimators: 435
2025-06-24 12:09:06,107 - src.models.lightgbm_model - INFO -   subsample: 0.7878881945196605
2025-06-24 12:09:06,107 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.833151305089003
2025-06-24 12:09:06,107 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 12:09:06,107 - src.models.lightgbm_model - INFO -   reg_alpha: 1.369967432330966e-05
2025-06-24 12:09:06,107 - src.models.lightgbm_model - INFO -   reg_lambda: 3.0843124732539984
2025-06-24 12:09:06,107 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:09:06,107 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:09:06,107 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:09:06,235 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:09:06,235 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 3.75491884548309})})
2025-06-24 12:09:06,235 - src.models.lightgbm_model - INFO -   - Best Iteration: 4
2025-06-24 12:09:06,235 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:09:06,236 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:09:06,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:09:06,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:06,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:06,257 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:06,271 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:06,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:06,300 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:06,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:06,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:06,335 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:09:06,335 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:06,339 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:09:06,344 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:09:06,344 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:09:06,344 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:09:06,344 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:09:06,344 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:06,345 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:06,345 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:09:06,345 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:09:06,348 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:09:06,352 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:09:06,355 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [1.31223107e-001 9.30924081e-002 9.98470281e-001 0.00000000e+000
 3.80217805e-001 2.51610566e-078 1.45105981e-008 5.78403329e-003
 2.06610906e-232 3.08895734e-017 1.28942728e-001 9.90325344e-001
 9.99998999e-001 6.61310710e-050 1.00000000e+000 8.92854799e-007
 1.53030351e-275 1.36468670e-001 8.39510969e-001 7.69978708e-001
 2.84501123e-047 1.78408907e-146 2.28058724e-238 2.74121000e-059
 9.85540943e-013 9.19081448e-018 1.68722184e-003 1.14724508e-003
 5.74673114e-279 2.48341249e-053 1.14723842e-140 6.34328647e-285
 9.99954932e-001 8.32646294e-012 1.28040883e-026 4.00231667e-195
 1.80805501e-178 5.32551854e-065 2.55635778e-064 1.33120091e-252
 4.38914739e-106 4.53257504e-001 2.82288697e-049 9.99999745e-001
 8.74948620e-001 6.16715530e-055 1.31859724e-116 1.39140931e-086
 4.22005730e-233 1.01908949e-063 6.67288626e-080 1.61795346e-072
 7.79664154e-003 2.22974471e-114 6.73666836e-216 3.06898978e-117
 1.61376921e-066 2.12722423e-216 9.99999972e-001 2.22131362e-078
 6.27298122e-189 9.21992609e-128 2.22116962e-069 4.89446095e-213
 9.99994437e-001 2.59355635e-002 8.41703603e-229 1.00000000e+000
 1.82190563e-164 2.49653913e-080 6.69864773e-125 1.19406506e-031
 9.99974542e-001 4.18010223e-097 3.03701266e-094 1.15999259e-020
 9.99849331e-001 1.62822834e-002 3.75090969e-003 9.99663215e-001
 3.68350716e-226 1.00739154e-012 2.31594472e-058 1.08176903e-025
 6.06448438e-154 1.01091492e-083 1.01116453e-065 1.39404303e-052
 2.13913960e-044 9.65392051e-003 9.96857348e-001 2.88065494e-022
 6.80159916e-006 8.74253106e-002 1.60537142e-074 1.77021508e-148
 1.00000000e+000 8.94265993e-097 1.13831691e-142 2.68427640e-246
 1.76518845e-003 1.42589031e-001 9.99999991e-001 9.97638266e-001
 1.07020711e-177 2.68468778e-130 4.48907130e-049 3.41064603e-075
 3.63024814e-004 1.99285861e-002 9.99994078e-001 1.33114176e-187
 7.29858631e-249 1.12019933e-243 4.84812069e-077 1.92251007e-134
 5.77564671e-145 2.84190442e-001 1.55599845e-008 9.99866872e-001
 2.30195042e-015 1.00000000e+000 9.01274766e-095 1.00000000e+000
 2.30458896e-015 3.67779784e-110 6.39064762e-163 8.92297817e-002
 1.11116327e-211 1.13024275e-007 1.06228635e-010 3.38526941e-044
 1.00000000e+000 1.39678101e-131 1.00029153e-149 1.17657653e-001
 9.39082905e-009 1.48071241e-008 1.75751311e-213 1.95499202e-034
 7.55961560e-017 2.16335548e-004 1.23326621e-004 3.82095066e-194
 8.34859667e-195 3.59382626e-217 8.06690526e-004 1.15450015e-002
 2.96292515e-252 2.62877232e-009 3.02846385e-088 9.99970104e-001
 4.19624001e-142 6.42961723e-001 6.51953945e-013 3.13083288e-188
 6.82057685e-018 8.44754073e-143 9.99999981e-001 5.73651929e-001
 1.14909860e-006 6.34095067e-165 2.58267313e-010 9.16047269e-001
 3.06604164e-230 9.95152317e-001 2.65814724e-050 7.95679588e-095
 8.97771163e-001 9.16646736e-041 5.06207008e-113 3.89412126e-141
 1.34144130e-143 1.66742887e-079 9.99999957e-001 7.14798988e-243
 4.19900454e-001 9.85821657e-174 9.99953806e-001 1.15984509e-211
 8.27503023e-178 2.53292459e-008 1.47065932e-035 3.66365387e-065
 1.06593741e-029 2.42738839e-013 9.99999884e-001 4.29158648e-011
 2.12250455e-046 3.17103718e-130 7.56949957e-004 6.97783029e-010
 1.69397408e-002 9.99665364e-001 1.00000000e+000 4.75397347e-037
 5.05720733e-226 9.94760634e-001 2.72704884e-017 9.99999315e-001
 2.51168395e-047 9.80595001e-141 2.30388625e-127 3.02453089e-001
 7.31459635e-008 1.89183831e-075 9.99967076e-001 1.42839075e-072
 1.87712641e-077 3.41865683e-006 7.73554478e-047 1.50083681e-178
 1.55578361e-197 2.69488814e-005 3.18298374e-004 1.49146167e-015
 9.99483018e-001 5.16287955e-002 7.32330428e-063 2.43175589e-047
 1.85317350e-187 1.64480731e-216 5.40060541e-015 6.22307915e-227
 6.87480243e-011 2.52693095e-004 1.44564523e-204 5.83518391e-173
 9.99999896e-001 4.89807897e-177 3.70244216e-003 2.29502604e-082
 9.73579052e-216 4.55197843e-190 5.10709193e-185 9.36670754e-190
 3.96139499e-013 2.56400561e-018 4.86112583e-011 1.67192139e-247
 8.94752539e-034 3.99940281e-126 7.09448928e-001 7.45842555e-198
 7.37374537e-001 1.95949334e-212 2.58904986e-015 5.02213215e-008
 1.73296767e-006 4.22478220e-018 6.77250307e-002 1.00000000e+000
 2.57552101e-001 8.30785329e-007 6.75037558e-015 1.00000000e+000
 6.45020331e-001 6.23626361e-231 9.99973199e-001 9.99944097e-001
 3.41500177e-211 8.07304882e-209 1.49386057e-003 1.00000000e+000
 2.57361501e-006 9.99999950e-001 8.48273514e-193 3.41354088e-197
 2.90438739e-002 2.85418694e-230 1.54358671e-013 1.74551133e-192
 5.24913198e-011 4.74915208e-001 9.99999997e-001 5.85890747e-021
 9.99999998e-001 7.11157204e-001 2.73078360e-003 5.36494834e-198
 1.03155632e-062 1.37914401e-003 1.07828502e-068 8.28197707e-004
 1.16214462e-233 1.62194158e-199 8.17346543e-021 2.18020442e-014
 1.11387848e-009 1.49024839e-069 1.20828296e-019 2.26830693e-055
 4.19974520e-123 8.41623285e-009 9.51720417e-188 5.95042846e-001
 1.41166332e-006 2.02137610e-210 1.13173627e-012 1.50147315e-029
 2.69399905e-207 9.42674765e-012 4.72017372e-011 2.36073515e-012
 7.12044508e-197 5.87314239e-002 3.02253208e-202 1.83176348e-194
 4.17962307e-144 6.93042224e-205 7.06462284e-013 1.93003279e-013
 8.69633788e-018 4.66660126e-015 6.76751796e-007 1.82701426e-141
 1.13592511e-003 1.07987307e-240 4.28691537e-189 5.60010046e-130
 9.99431635e-001 1.00000000e+000 2.92517774e-193 3.65751332e-193
 9.28995888e-208 4.69242272e-055 8.92058269e-009 7.88626972e-009
 7.98719703e-003 1.00000000e+000 4.06662264e-193 7.49441809e-259
 1.01282564e-140 1.05232866e-008 2.96655967e-087 2.32917090e-005
 6.77686204e-008 2.29850794e-007 2.62887713e-150 2.68185390e-143
 1.16573001e-238 2.85301197e-007 5.48368275e-150 1.36773394e-007
 2.41155701e-006 1.29150296e-207 2.67287887e-023 5.59418916e-143
 3.40025259e-226 4.38601910e-018 2.18221815e-190 1.00000000e+000
 6.33646282e-229 4.82893812e-131 2.87853478e-040 1.44615044e-054
 5.49331289e-002 3.81104407e-141 7.98878293e-192 1.15925818e-007
 9.99999850e-001 2.45540703e-197 9.96848298e-001 5.33526414e-238
 2.00621262e-001 3.43621716e-001 4.82384084e-144 1.00622477e-143
 2.16030929e-010 5.58850885e-239 7.23481568e-002 5.31885469e-233
 9.05117173e-073 1.66756127e-008 6.35601175e-234 1.00000000e+000
 1.00000000e+000 1.02741735e-015 2.01237273e-243 1.00728803e-130
 9.99979098e-001 9.97826803e-014 9.99999058e-001 6.14721374e-067
 1.19666966e-008 9.02529255e-003 1.18873194e-009 6.68408573e-050
 2.09488697e-049 1.00000000e+000 4.70961324e-094 2.66179213e-062]
2025-06-24 12:09:06,355 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:09:07,586 - src.training - INFO -   precision: 0.003354476701634545
2025-06-24 12:09:07,586 - src.training - INFO -   recall: 0.2037037037037037
2025-06-24 12:09:07,586 - src.training - INFO -   f1: 0.006600264010560422
2025-06-24 12:09:07,586 - src.training - INFO -   accuracy: 0.925065628677469
2025-06-24 12:09:07,586 - src.training - INFO -   balanced_accuracy: 0.5648259761097936
2025-06-24 12:09:07,586 - src.training - INFO -   positive_samples: 270
2025-06-24 12:09:07,586 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:09:07,586 - src.training - INFO -   total_samples: 220940
2025-06-24 12:09:07,586 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:09:07,586 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:09:07,586 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:09:07,586 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:09:07,586 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:09:07,586 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:09:07,586 - src.training - INFO - 모델 학습 완료
2025-06-24 12:09:07,586 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003354476701634545, 'recall': 0.2037037037037037, 'f1': 0.006600264010560422, 'accuracy': 0.925065628677469, 'balanced_accuracy': 0.5648259761097936, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:09:07,586 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:07,586 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:07,586 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:07,586 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:07,606 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:09:07,606 - src.hyperparameter_tuning - ERROR - Trial 19 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:09:08,041 - src.hyperparameter_tuning - INFO - Trial 20: 모델 타입 = lightgbm
2025-06-24 12:09:09,907 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:09:09,907 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:09:09,907 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:09:09,907 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:09:09,907 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:09:09,907 - src.training - INFO - 교차 검증 시작
2025-06-24 12:09:09,907 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:09:09,923 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:09:10,393 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:09:10,393 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:09:10,393 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:09:10,393 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:09:10,393 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:09:10,393 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:09:10,393 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:09:10,393 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:09:10,393 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:09:10,559 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:09:10,559 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:09:10,559 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:09:10,559 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:09:10,559 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:09:10,559 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:09:10,559 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:09:10,559 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:09:10,559 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:09:10,559 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:09:12,006 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:09:13,134 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:09:13,134 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:09:13,140 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:09:13,173 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:09:13,173 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:09:13,173 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:09:13,173 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:09:14,514 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:09:14,784 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:09:14,784 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:09:14,952 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:09:14,952 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:09:14,995 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:09:14,995 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:09:14,995 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:09:14,995 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:09:14,995 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:14,995 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:15,045 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:09:15,045 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:09:15,045 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:15,045 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:15,045 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:09:15,045 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:09:15,045 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:15,111 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:09:15,111 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:09:15,111 - src.training - INFO - 모델 학습 시작
2025-06-24 12:09:15,243 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:09:15,243 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:09:15,243 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:09:15,243 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:09:15,243 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:09:15,243 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:09:15,243 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:09:15,243 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:09:15,243 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:09:15,243 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:09:15,243 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:09:15,243 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:09:15,243 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:09:15,243 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:15,244 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:15,333 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:15,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:15,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:15,530 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:15,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:15,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:15,688 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:09:15,688 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:15,752 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:09:15,752 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:15,752 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:09:15,752 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:15,752 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:15,771 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:15,786 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:15,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:15,818 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:15,836 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:15,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:15,857 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:09:15,857 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:15,871 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:09:15,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:15,872 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:09:15,872 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:15,872 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:09:15,883 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   learning_rate: 0.010207095677349268
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   n_estimators: 363
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   subsample: 0.9865753228840899
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.95582378097439
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   reg_alpha: 3.8779333859817635e-08
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO -   reg_lambda: 6.305861034604035e-06
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:09:15,886 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:09:15,999 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:09:15,999 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.12916689323124841})})
2025-06-24 12:09:15,999 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:09:15,999 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:09:16,000 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:09:16,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:09:16,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:16,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:16,020 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:16,036 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:16,053 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:16,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:16,084 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:16,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:16,105 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:09:16,105 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:16,108 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:09:16,110 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:09:16,110 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:09:16,110 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:09:16,110 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:09:16,110 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:16,110 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:16,110 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:09:16,110 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:09:16,114 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:09:16,118 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:09:16,119 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00242605 0.08363373 0.03705523 0.27486016 0.00471126 0.00934088
 0.03053649 0.130219   0.28924265 0.08722511 0.00115611 0.06891824
 0.0044643  0.74556882 0.00115603 0.6913999  0.18941929 0.00115663
 0.32386851 0.39024798 0.79896923 0.3260503  0.10327342 0.00115645
 0.00292584 0.00115666 0.01864311 0.51066361 0.50815189 0.64567936
 0.00115667]
2025-06-24 12:09:16,119 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:09:16,974 - src.training - INFO -   precision: 0.0
2025-06-24 12:09:16,974 - src.training - INFO -   recall: 0.0
2025-06-24 12:09:16,974 - src.training - INFO -   f1: 0.0
2025-06-24 12:09:16,974 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:09:16,974 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:09:16,974 - src.training - INFO -   positive_samples: 270
2025-06-24 12:09:16,974 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:09:16,974 - src.training - INFO -   total_samples: 220940
2025-06-24 12:09:16,974 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:09:16,974 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:09:16,974 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:09:16,974 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:09:16,975 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:09:16,975 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:09:16,975 - src.training - INFO - 모델 학습 완료
2025-06-24 12:09:16,975 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:09:16,975 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:16,975 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:16,975 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:16,975 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:16,994 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:09:16,994 - src.hyperparameter_tuning - ERROR - Trial 20 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:09:17,454 - src.hyperparameter_tuning - INFO - Trial 21: 모델 타입 = lightgbm
2025-06-24 12:09:19,456 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:09:19,456 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:09:19,456 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:09:19,456 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:09:19,456 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:09:19,456 - src.training - INFO - 교차 검증 시작
2025-06-24 12:09:19,456 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:09:19,473 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:09:19,949 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:09:19,949 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:09:19,949 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:09:19,949 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:09:19,949 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:09:19,950 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:09:19,950 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:09:19,950 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:09:19,950 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:09:20,116 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:09:20,116 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:09:20,116 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:09:20,116 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:09:20,116 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:09:20,116 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:09:20,116 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:09:20,116 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:09:20,116 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:09:20,116 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:09:21,559 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:09:22,691 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:09:22,691 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:09:22,697 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:09:22,729 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:09:22,729 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:09:22,729 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:09:22,729 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:09:24,059 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:09:24,331 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:09:24,331 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:09:24,500 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:09:24,500 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:09:24,543 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:09:24,543 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:09:24,543 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:09:24,543 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:09:24,543 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:24,543 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:24,605 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:09:24,605 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:09:24,605 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:24,605 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:24,605 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:09:24,605 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:09:24,605 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:24,670 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:09:24,670 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:09:24,670 - src.training - INFO - 모델 학습 시작
2025-06-24 12:09:24,802 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:09:24,802 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:09:24,802 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:09:24,802 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:09:24,802 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:09:24,802 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:09:24,802 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:09:24,802 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:09:24,802 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:09:24,802 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:09:24,802 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:09:24,802 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:09:24,802 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:09:24,802 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:24,802 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:24,890 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:24,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:25,023 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:25,087 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:25,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:25,233 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:25,249 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:09:25,249 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:25,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:09:25,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:25,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:09:25,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:25,313 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:25,331 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:25,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:25,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:25,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:25,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:25,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:25,417 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:09:25,417 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:25,433 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:09:25,433 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:25,433 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:09:25,433 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:25,433 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:09:25,444 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:09:25,446 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:09:25,446 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:09:25,446 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:09:25,446 - src.models.lightgbm_model - INFO -   learning_rate: 0.07669250918535661
2025-06-24 12:09:25,446 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:09:25,446 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:09:25,446 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:09:25,446 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:09:25,446 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:09:25,446 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   n_estimators: 592
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   subsample: 0.6935689103746192
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.747864856065468
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   reg_alpha: 9.286826632452236e-07
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO -   reg_lambda: 1.546662297018089e-05
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:09:25,447 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:09:25,573 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:09:25,573 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 6.507310513648466})})
2025-06-24 12:09:25,573 - src.models.lightgbm_model - INFO -   - Best Iteration: 4
2025-06-24 12:09:25,573 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:09:25,574 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:09:25,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:09:25,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:25,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:25,597 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:25,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:25,631 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:25,647 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:25,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:25,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:25,684 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:09:25,684 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:25,687 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:09:25,689 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:09:25,689 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:09:25,689 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:09:25,689 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:09:25,689 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:25,689 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:25,689 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:09:25,689 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:09:25,694 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:09:25,698 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:09:25,701 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [1.00674474e-001 3.77309859e-095 0.00000000e+000 1.90252268e-083
 4.90825861e-001 7.10247723e-009 5.52065087e-100 9.99981198e-001
 1.95659260e-127 1.00000000e+000 2.51721306e-036 1.62718793e-001
 9.99999956e-001 7.22608216e-001 9.72442163e-064 9.99815164e-001
 1.32138756e-039 3.59781122e-043 3.24181635e-138 3.43733502e-040
 9.99999996e-001 2.26814081e-131 9.10411184e-001 4.58870658e-057
 9.99952612e-001 5.34221663e-013 2.27793908e-009 6.78563347e-006
 1.05749607e-046 5.23103670e-034 9.14699170e-111 1.01514539e-015
 1.00000000e+000 9.30697520e-034 7.63554235e-020 2.15359865e-099
 1.85115135e-234 9.69866012e-013 9.99817112e-001 2.07459755e-029
 4.44781951e-025 1.91799142e-218 3.03957416e-001 2.77066697e-008
 1.23338449e-082 6.39970403e-104 8.97751935e-077 1.31561163e-005
 1.26871345e-131 3.79348410e-063 6.31342512e-128 2.49651613e-103
 8.84798748e-131 9.95761261e-001 9.97578279e-001 6.48481338e-112
 5.13198781e-005 7.63264199e-127 9.27401162e-051 1.00000000e+000
 2.71006359e-188 2.64840533e-203 1.43321797e-203 1.14998125e-260
 9.99999998e-001 1.39186139e-062 6.12409999e-073 3.35557344e-002
 3.56822944e-110 1.97234121e-040 2.40493569e-033 7.42171596e-083
 3.25582087e-016 1.89656516e-021 7.24727288e-001 9.99910930e-001
 9.90016209e-001 1.41769510e-005 1.84430702e-002 1.26462830e-137
 1.40350143e-042 9.81961505e-036 3.76708162e-001 7.66563773e-020
 5.64133457e-044 1.05475879e-117 1.96176178e-060 5.37120754e-146
 1.73318447e-124 3.96006884e-015 5.09278472e-050 2.58443510e-002
 2.51540756e-210 5.52991004e-002 8.41012906e-037 2.09342081e-005
 5.97285370e-001 2.61133677e-069 1.67596489e-058 2.50159356e-059
 8.73511115e-228 1.18695668e-203 6.53791700e-058 3.90165399e-002
 9.99757561e-001 4.54652945e-005 9.90618804e-001 7.84195577e-009
 1.91949313e-002 2.88980661e-066 7.89337143e-231 7.38362818e-132
 1.47188080e-094 7.24929534e-012 1.53154102e-130 4.89029059e-097
 2.34788396e-253 9.41323781e-102 4.81141667e-082 7.65280691e-060
 6.23529094e-033 9.59296897e-015 1.00114559e-249 2.41304013e-102
 2.40548398e-040 2.57159576e-002 2.97606924e-090 4.93808977e-108
 5.11821742e-011 1.71067724e-226 9.99999998e-001 9.99999892e-001
 1.49229795e-053 1.08620353e-030 5.15471551e-039 5.81297380e-157
 7.76742332e-092 9.90604537e-001 9.75932651e-006 1.23518240e-147
 2.10127523e-044 1.35352647e-013 6.49188032e-001 9.96009575e-001
 1.00000000e+000 1.04512543e-089 9.98794716e-001 1.67063833e-029
 1.38991170e-127 9.09639538e-109 9.98388086e-001 3.97432233e-095
 8.17837974e-215 5.26799523e-066 3.31205535e-088 9.25790672e-087
 1.06668788e-055 1.26932744e-102 7.09167415e-064 1.72798581e-156
 4.95162965e-102 8.35663556e-056 2.99730650e-160 2.62505952e-254
 3.95275297e-134 1.75623975e-165 3.82604660e-018 5.59096445e-203
 9.90477389e-001 9.99999957e-001 9.99865035e-001 1.99660989e-010
 9.82421177e-133 1.01879921e-095 1.88998614e-293 1.21396690e-049
 1.45285775e-069 1.47735221e-045 6.82923230e-002 1.03313944e-202
 3.32680344e-067 9.99995180e-001 3.83806504e-080 1.49722413e-079
 7.95108479e-264 8.84621509e-076 1.19288382e-001 2.84673758e-005
 1.00000000e+000 1.46658511e-188 9.99988795e-001 1.59237382e-227
 3.23143849e-164 1.57097826e-029 4.13554118e-009 5.72112924e-188
 2.00353156e-060 1.43493393e-177 9.97541513e-001 7.17190665e-090
 4.86691563e-022 1.77540828e-134 7.19747856e-010 6.19729507e-021
 3.80699266e-005 1.92634233e-107 1.07655121e-071 1.14862478e-062
 2.88038355e-160 9.68510202e-001 9.37868841e-002 2.66881736e-212
 5.12559100e-002 1.00000000e+000 6.03311665e-059 2.55579005e-043
 2.45911338e-015 1.60832851e-180 4.70708597e-006 1.59752447e-247
 9.99999999e-001 9.99511074e-001 7.88671824e-001 2.80772692e-009
 9.99999972e-001 6.12797508e-050 8.26678327e-195 1.46569118e-036
 7.89934208e-001 1.19360710e-154 3.96275205e-006 1.40172670e-166
 1.43977886e-150 2.80414218e-096 4.25708589e-186 1.89302439e-185
 2.77422278e-158 8.97283422e-022 9.99983157e-001 1.36136803e-001
 9.49390809e-001 9.55408639e-001 4.51279769e-012 5.63405607e-080
 2.93244030e-157 4.49987301e-185 8.60559543e-010 9.99999882e-001
 1.67842622e-167 1.11621989e-182 9.99998610e-001 4.04413058e-006
 8.68009852e-010 6.05156249e-192 1.27727648e-018 9.99972514e-001
 1.00000000e+000 3.54694642e-008 2.83764877e-187 1.36782093e-102
 6.33319406e-006 7.22052853e-001 9.99999033e-001 1.46315869e-190
 8.10396637e-001 1.73070702e-095 1.17980608e-046 1.74066247e-001
 2.20848948e-018 9.64599449e-001 9.97300006e-001 4.44409867e-180
 1.00000000e+000 3.22616401e-006 4.46113911e-066 1.00000000e+000
 5.90517256e-179 9.99972927e-001 4.27460714e-005 9.99997694e-001
 1.57874324e-011 4.83456122e-024 7.82902587e-006 9.99999994e-001
 9.99628004e-001 4.58086558e-003 2.99083700e-008 9.99982928e-001
 9.99992915e-001 1.13874930e-021 9.44226450e-143 1.00000000e+000
 1.21287682e-007 1.07122527e-155 1.00000000e+000 1.38551267e-002
 5.74372518e-003 1.00000000e+000 5.22980700e-021 6.70395009e-018
 3.49884204e-011 5.96601776e-066 2.50324904e-019 9.99999628e-001
 9.99999974e-001 1.00000000e+000 2.26800317e-011 9.99999409e-001
 9.99999989e-001 1.00000000e+000 7.36898946e-184 1.79730926e-146
 2.58156043e-181 8.06764846e-017 4.94060842e-009 9.99999979e-001
 1.00000000e+000 5.13439444e-005 5.73514800e-015 1.84077179e-005
 4.98263875e-018 1.03659777e-185 9.99999248e-001 7.36256682e-030
 9.99999999e-001 1.18759594e-194 1.00000000e+000 1.00000000e+000
 6.59477890e-004 1.72174728e-221 2.18111603e-013 3.66579831e-070
 3.46032150e-143 8.43265791e-190 2.64885079e-002 1.00000000e+000
 2.81207101e-002 9.99999991e-001 9.46003090e-199 1.20664402e-006
 9.37163893e-001 8.27342910e-173 8.16399077e-058 9.90575691e-001
 2.47222215e-014 9.99998502e-001 6.18872040e-093 2.61362640e-097
 1.50014822e-196 2.55078926e-091 9.08386988e-011 8.10658632e-008
 1.05719224e-187 1.65691384e-017 1.44892945e-170 2.81348540e-027
 1.98427719e-007 3.24538184e-095 2.31158597e-228 6.37770825e-057
 7.46979815e-187 3.55304226e-092 2.86392225e-084 4.10559447e-008
 8.57097249e-003 1.00000000e+000 1.26956993e-200 1.82033475e-010
 2.38312970e-004 7.12124147e-001 4.74609101e-194 2.00918066e-012
 3.39025296e-178 9.99739626e-001 2.03591146e-082 9.99999996e-001
 2.20389727e-002 2.56727300e-009 3.21638008e-188 7.23201559e-022
 9.61773500e-020 2.11915179e-195 2.56750961e-003 9.99479707e-001
 9.99999999e-001 1.00000000e+000 9.33599892e-001 1.00000000e+000
 1.21832235e-166 1.00000000e+000 1.47711532e-004 1.10469478e-003
 9.99999787e-001 2.12496235e-189 5.66406287e-010 1.70524538e-061
 5.40003643e-032 9.99999723e-001 7.83988320e-086 8.84615352e-026
 6.92231588e-235 1.02547264e-029 1.07257822e-206]
2025-06-24 12:09:25,701 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:09:27,066 - src.training - INFO -   precision: 0.002752192580088804
2025-06-24 12:09:27,066 - src.training - INFO -   recall: 0.2777777777777778
2025-06-24 12:09:27,066 - src.training - INFO -   f1: 0.005450383343628502
2025-06-24 12:09:27,066 - src.training - INFO -   accuracy: 0.8761156875169729
2025-06-24 12:09:27,066 - src.training - INFO -   balanced_accuracy: 0.5773127797666702
2025-06-24 12:09:27,066 - src.training - INFO -   positive_samples: 270
2025-06-24 12:09:27,066 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:09:27,066 - src.training - INFO -   total_samples: 220940
2025-06-24 12:09:27,066 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:09:27,066 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:09:27,066 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:09:27,068 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:09:27,068 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:09:27,068 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:09:27,068 - src.training - INFO - 모델 학습 완료
2025-06-24 12:09:27,068 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002752192580088804, 'recall': 0.2777777777777778, 'f1': 0.005450383343628502, 'accuracy': 0.8761156875169729, 'balanced_accuracy': 0.5773127797666702, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:09:27,068 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:27,068 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:27,068 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:27,068 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:27,088 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:09:27,088 - src.hyperparameter_tuning - ERROR - Trial 21 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:09:27,554 - src.hyperparameter_tuning - INFO - Trial 22: 모델 타입 = lightgbm
2025-06-24 12:09:29,531 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:09:29,531 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:09:29,531 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:09:29,531 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:09:29,531 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:09:29,531 - src.training - INFO - 교차 검증 시작
2025-06-24 12:09:29,531 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:09:29,548 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:09:30,007 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:09:30,007 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:09:30,007 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:09:30,007 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:09:30,007 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:09:30,007 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:09:30,007 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:09:30,007 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:09:30,007 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:09:30,189 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:09:30,189 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:09:30,189 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:09:30,189 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:09:30,189 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:09:30,189 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:09:30,189 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:09:30,189 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:09:30,189 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:09:30,189 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:09:31,494 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:09:32,517 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:09:32,517 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:09:32,523 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:09:32,555 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:09:32,555 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:09:32,555 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:09:32,555 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:09:33,790 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:09:34,043 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:09:34,043 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:09:34,204 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:09:34,204 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:09:34,245 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:09:34,246 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:09:34,246 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:09:34,246 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:09:34,246 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:34,246 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:34,303 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:09:34,303 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:09:34,303 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:34,303 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:34,303 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:09:34,303 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:09:34,303 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:34,360 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:09:34,360 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:09:34,360 - src.training - INFO - 모델 학습 시작
2025-06-24 12:09:34,488 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:09:34,488 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:09:34,488 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:09:34,488 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:09:34,488 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:09:34,488 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:09:34,488 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:09:34,488 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:09:34,488 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:09:34,488 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:09:34,489 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:09:34,489 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:09:34,489 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:09:34,489 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:34,489 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:34,567 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:34,623 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:34,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:34,737 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:34,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:34,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:34,885 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:09:34,885 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:34,956 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:09:34,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:34,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:09:34,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:34,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:34,975 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:34,989 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:35,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:35,017 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:35,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:35,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:35,051 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:09:35,051 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:35,065 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:09:35,065 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:35,065 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:09:35,065 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:35,065 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:09:35,078 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   learning_rate: 0.0104557424579548
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   n_estimators: 685
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   subsample: 0.99450975741151
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9595891134331327
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   reg_alpha: 3.5495856503369966e-07
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO -   reg_lambda: 4.498914979976511e-08
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:09:35,081 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:09:35,197 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:09:35,197 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.14384136325799118})})
2025-06-24 12:09:35,197 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:09:35,197 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:09:35,198 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:09:35,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:09:35,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:35,199 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:35,217 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:35,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:35,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:35,262 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:35,277 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:35,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:35,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:09:35,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:35,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:09:35,304 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:09:35,304 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:09:35,304 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:09:35,304 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:09:35,304 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:35,304 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:35,304 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:09:35,304 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:09:35,308 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:09:35,312 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:09:35,313 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00246962 0.0921369  0.04021484 0.30380045 0.00487373 0.00982339
 0.03300338 0.14420244 0.31940711 0.09615243 0.00115583 0.07569168
 0.00461224 0.78001877 0.00115574 0.72924423 0.2100318  0.00115636
 0.35674692 0.42734971 0.82891355 0.35908834 0.11409749 0.00115618
 0.00299197 0.00115639 0.01992719 0.55185508 0.5493076  0.68550509
 0.00115641]
2025-06-24 12:09:35,313 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:09:36,096 - src.training - INFO -   precision: 0.0
2025-06-24 12:09:36,096 - src.training - INFO -   recall: 0.0
2025-06-24 12:09:36,096 - src.training - INFO -   f1: 0.0
2025-06-24 12:09:36,096 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:09:36,096 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:09:36,096 - src.training - INFO -   positive_samples: 270
2025-06-24 12:09:36,096 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:09:36,096 - src.training - INFO -   total_samples: 220940
2025-06-24 12:09:36,096 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:09:36,097 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:09:36,097 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:09:36,097 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:09:36,097 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:09:36,097 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:09:36,097 - src.training - INFO - 모델 학습 완료
2025-06-24 12:09:36,097 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:09:36,097 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:36,097 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:36,097 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:36,097 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:36,117 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:09:36,117 - src.hyperparameter_tuning - ERROR - Trial 22 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:09:36,562 - src.hyperparameter_tuning - INFO - Trial 23: 모델 타입 = lightgbm
2025-06-24 12:09:38,347 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:09:38,347 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:09:38,347 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:09:38,347 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:09:38,347 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:09:38,347 - src.training - INFO - 교차 검증 시작
2025-06-24 12:09:38,347 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:09:38,364 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:09:38,807 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:09:38,807 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:09:38,807 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:09:38,807 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:09:38,807 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:09:38,807 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:09:38,807 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:09:38,807 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:09:38,807 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:09:38,986 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:09:38,986 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:09:38,986 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:09:38,986 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:09:38,986 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:09:38,986 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:09:38,986 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:09:38,986 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:09:38,986 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:09:38,986 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:09:40,293 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:09:41,318 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:09:41,318 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:09:41,324 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:09:41,354 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:09:41,355 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:09:41,355 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:09:41,355 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:09:42,571 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:09:42,821 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:09:42,821 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:09:42,981 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:09:42,981 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:09:43,022 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:09:43,022 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:09:43,022 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:09:43,022 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:09:43,022 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:43,022 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:43,079 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:09:43,079 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:09:43,079 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:43,079 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:43,079 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:09:43,079 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:09:43,079 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:43,136 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:09:43,136 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:09:43,136 - src.training - INFO - 모델 학습 시작
2025-06-24 12:09:43,264 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:09:43,264 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:09:43,264 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:09:43,264 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:09:43,264 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:09:43,264 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:09:43,264 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:09:43,264 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:09:43,264 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:09:43,264 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:09:43,264 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:09:43,264 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:09:43,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:09:43,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:43,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:43,341 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:43,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:43,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:43,506 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:43,564 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:43,635 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:43,650 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:09:43,650 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:43,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:09:43,720 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:43,720 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:09:43,720 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:43,720 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:43,737 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:43,751 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:43,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:43,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:43,793 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:43,810 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:43,813 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:09:43,813 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:43,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:09:43,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:43,827 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:09:43,827 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:43,827 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:09:43,838 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:09:43,840 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   learning_rate: 0.10145700069241342
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   n_estimators: 261
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   subsample: 0.7470351878088947
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.903112174250839
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   reg_alpha: 6.668903243046754e-05
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO -   reg_lambda: 6.674078197041623e-07
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:09:43,841 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:09:44,110 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:09:44,110 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 3.319984887113938})})
2025-06-24 12:09:44,110 - src.models.lightgbm_model - INFO -   - Best Iteration: 25
2025-06-24 12:09:44,110 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:09:44,111 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:09:44,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:09:44,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:44,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:44,129 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:44,144 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:44,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:44,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:44,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:44,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:44,209 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:09:44,209 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:44,212 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:09:44,219 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:09:44,219 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:09:44,219 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:09:44,219 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:09:44,219 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:44,219 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:44,219 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:09:44,219 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:09:44,223 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:09:44,228 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:09:44,229 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [1.00000000e+000 1.68008601e-001 2.19999900e-001 ... 1.22012976e-001
 1.49187095e-129 1.52614042e-284]
2025-06-24 12:09:44,229 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:09:45,436 - src.training - INFO -   precision: 0.0020200076952674104
2025-06-24 12:09:45,437 - src.training - INFO -   recall: 0.15555555555555556
2025-06-24 12:09:45,437 - src.training - INFO -   f1: 0.003988225239768303
2025-06-24 12:09:45,437 - src.training - INFO -   accuracy: 0.9050511451072689
2025-06-24 12:09:45,437 - src.training - INFO -   balanced_accuracy: 0.5307618716736404
2025-06-24 12:09:45,437 - src.training - INFO -   positive_samples: 270
2025-06-24 12:09:45,437 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:09:45,437 - src.training - INFO -   total_samples: 220940
2025-06-24 12:09:45,437 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:09:45,437 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:09:45,437 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:09:45,437 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:09:45,437 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:09:45,437 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:09:45,437 - src.training - INFO - 모델 학습 완료
2025-06-24 12:09:45,437 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0020200076952674104, 'recall': 0.15555555555555556, 'f1': 0.003988225239768303, 'accuracy': 0.9050511451072689, 'balanced_accuracy': 0.5307618716736404, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:09:45,437 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:45,437 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:45,437 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:45,437 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:45,457 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:09:45,457 - src.hyperparameter_tuning - ERROR - Trial 23 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:09:45,895 - src.hyperparameter_tuning - INFO - Trial 24: 모델 타입 = lightgbm
2025-06-24 12:09:47,710 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:09:47,710 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:09:47,710 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:09:47,710 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:09:47,710 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:09:47,710 - src.training - INFO - 교차 검증 시작
2025-06-24 12:09:47,710 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:09:47,727 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:09:48,168 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:09:48,168 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:09:48,168 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:09:48,168 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:09:48,168 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:09:48,168 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:09:48,168 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:09:48,168 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:09:48,168 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:09:48,350 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:09:48,350 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:09:48,350 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:09:48,350 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:09:48,350 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:09:48,350 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:09:48,350 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:09:48,350 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:09:48,350 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:09:48,350 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:09:49,661 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:09:50,692 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:09:50,692 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:09:50,698 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:09:50,728 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:09:50,729 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:09:50,729 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:09:50,729 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:09:51,955 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:09:52,211 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:09:52,211 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:09:52,371 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:09:52,371 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:09:52,412 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:09:52,412 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:09:52,412 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:09:52,412 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:09:52,412 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:52,412 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:52,469 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:09:52,469 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:09:52,469 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:52,469 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:52,469 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:09:52,469 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:09:52,469 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:52,526 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:09:52,527 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:09:52,527 - src.training - INFO - 모델 학습 시작
2025-06-24 12:09:52,654 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:09:52,654 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:09:52,654 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:09:52,654 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:09:52,654 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:09:52,654 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:09:52,654 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:09:52,654 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:09:52,654 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:09:52,654 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:09:52,654 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:09:52,654 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:09:52,654 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:09:52,654 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:52,654 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:52,732 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:52,786 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:52,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:52,897 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:52,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:53,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:53,040 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:09:53,040 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:53,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:09:53,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:53,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:09:53,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:53,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:53,128 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:53,141 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:53,156 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:53,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:53,184 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:53,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:53,204 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:09:53,204 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:53,217 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:09:53,218 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:53,218 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:09:53,218 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:53,218 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:09:53,229 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:09:53,231 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:09:53,231 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:09:53,231 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:09:53,231 - src.models.lightgbm_model - INFO -   learning_rate: 0.012151934099823692
2025-06-24 12:09:53,231 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:09:53,231 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:09:53,231 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:09:53,231 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:09:53,231 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:09:53,231 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:09:53,231 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:09:53,231 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:09:53,231 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:09:53,231 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   n_estimators: 259
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   subsample: 0.744344435749703
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8666201877323032
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   reg_alpha: 5.078551130964871e-07
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0003521654695501888
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:09:53,232 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:09:53,346 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:09:53,346 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.2822162181776151})})
2025-06-24 12:09:53,346 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:09:53,346 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:09:53,346 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:09:53,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:09:53,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:53,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:09:53,365 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:09:53,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:09:53,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:09:53,409 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:09:53,424 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:09:53,441 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:09:53,445 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:09:53,445 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:53,448 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:09:53,450 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:09:53,450 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:09:53,450 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:09:53,450 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:09:53,450 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:53,450 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:09:53,450 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:09:53,450 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:09:53,454 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:09:53,458 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:09:53,459 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00261296 0.17311811 0.06966433 0.53282274 0.01959701 0.01384062
 0.05571161 0.27399709 0.55380392 0.18109354 0.00115391 0.00576015
 0.92866698 0.00115381 0.00115485 0.90437389 0.39070106 0.00115453
 0.60111855 0.68029372 0.94927137 0.60395436 0.2163999  0.00115432
 0.69614836 0.00348466 0.00115456 0.03130337 0.7920312  0.79005339
 0.88088797]
2025-06-24 12:09:53,459 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:09:54,191 - src.training - INFO -   precision: 0.0
2025-06-24 12:09:54,191 - src.training - INFO -   recall: 0.0
2025-06-24 12:09:54,191 - src.training - INFO -   f1: 0.0
2025-06-24 12:09:54,191 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:09:54,191 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:09:54,191 - src.training - INFO -   positive_samples: 270
2025-06-24 12:09:54,191 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:09:54,191 - src.training - INFO -   total_samples: 220940
2025-06-24 12:09:54,191 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:09:54,191 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:09:54,191 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:09:54,191 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:09:54,192 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:09:54,192 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:09:54,192 - src.training - INFO - 모델 학습 완료
2025-06-24 12:09:54,192 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:09:54,192 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:54,192 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:54,192 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:09:54,192 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:09:54,211 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:09:54,212 - src.hyperparameter_tuning - ERROR - Trial 24 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:09:54,657 - src.hyperparameter_tuning - INFO - Trial 25: 모델 타입 = lightgbm
2025-06-24 12:09:56,443 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:09:56,443 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:09:56,443 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:09:56,443 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:09:56,443 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:09:56,443 - src.training - INFO - 교차 검증 시작
2025-06-24 12:09:56,443 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:09:56,459 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:09:56,908 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:09:56,908 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:09:56,908 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:09:56,908 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:09:56,908 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:09:56,908 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:09:56,908 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:09:56,908 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:09:56,908 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:09:57,085 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:09:57,085 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:09:57,085 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:09:57,085 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:09:57,085 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:09:57,085 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:09:57,085 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:09:57,085 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:09:57,085 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:09:57,085 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:09:58,397 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:09:59,420 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:09:59,420 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:09:59,426 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:09:59,456 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:09:59,456 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:09:59,456 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:09:59,456 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:10:00,683 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:10:00,932 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:10:00,932 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:10:01,093 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:10:01,093 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:10:01,133 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:10:01,133 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:10:01,133 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:10:01,133 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:10:01,134 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:01,134 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:01,190 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:10:01,190 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:10:01,190 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:01,190 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:01,190 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:10:01,190 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:10:01,190 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:01,250 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:10:01,250 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:10:01,250 - src.training - INFO - 모델 학습 시작
2025-06-24 12:10:01,380 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:10:01,380 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:10:01,380 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:10:01,380 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:10:01,380 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:10:01,380 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:10:01,380 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:10:01,380 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:10:01,380 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:10:01,380 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:10:01,380 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:10:01,380 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:10:01,380 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:10:01,380 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:01,380 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:01,457 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:01,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:01,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:01,623 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:01,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:01,751 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:01,766 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:10:01,766 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:01,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:10:01,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:01,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:10:01,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:01,833 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:01,852 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:01,866 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:01,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:01,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:01,908 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:01,925 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:01,927 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:10:01,927 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:01,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:10:01,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:01,941 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:10:01,941 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:01,941 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:10:01,955 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   learning_rate: 0.09045696535051974
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   n_estimators: 352
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   subsample: 0.8730741514926638
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6790650453031798
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   reg_alpha: 2.2520370210911345e-06
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO -   reg_lambda: 2.9776221953493414
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:10:01,959 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:10:02,094 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:10:02,094 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 6.295517792601556})})
2025-06-24 12:10:02,094 - src.models.lightgbm_model - INFO -   - Best Iteration: 4
2025-06-24 12:10:02,094 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:10:02,096 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:10:02,096 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:10:02,096 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:02,097 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:02,115 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:02,130 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:02,145 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:02,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:02,174 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:02,191 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:02,194 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:10:02,194 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:02,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:10:02,201 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:10:02,201 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:10:02,201 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:10:02,201 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:10:02,201 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:02,201 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:02,201 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:10:02,201 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:10:02,205 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:10:02,209 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:10:02,212 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [3.15887200e-001 1.00000000e+000 0.00000000e+000 3.93509777e-103
 1.00000000e+000 3.21239945e-001 5.56031643e-073 6.54868431e-187
 1.00000000e+000 3.78734654e-040 3.84106369e-001 1.00000000e+000
 2.45305960e-005 1.18440362e-079 3.19861698e-048 1.26056197e-199
 3.17988877e-020 1.49257791e-191 5.80324370e-055 3.76517127e-012
 4.69598500e-081 1.57326698e-001 1.00000000e+000 7.43835577e-044
 4.90115009e-063 1.24937886e-233 1.36944825e-281 1.65196831e-007
 1.00000000e+000 3.64620797e-291 9.99992590e-001 1.00000000e+000
 6.09846732e-102 9.56295351e-041 3.55946450e-101 1.41322507e-030
 1.87251335e-087 1.20099374e-075 6.69747698e-057 1.42379932e-058
 5.63597583e-064 1.00000000e+000 6.27923758e-267 8.30856503e-112
 3.84896052e-003 1.31555945e-074 9.99676544e-052 9.48169836e-001
 8.73459364e-166 1.77992190e-003 5.19248963e-015 4.92394303e-063
 6.86556934e-024 3.30749826e-032 3.04711666e-303 1.01757647e-217
 6.78876174e-003 8.81286608e-072 3.40757856e-059 1.01897392e-273
 1.32706435e-104 9.37498980e-001 3.52998592e-021 1.67851924e-136
 1.18260706e-124 1.10101537e-014 2.83464531e-002 9.81034626e-242
 1.30005024e-245 6.19875377e-077 1.25148428e-199 1.80329441e-006
 2.20001304e-272 2.15839641e-062 4.45533516e-060 2.90195114e-086
 3.36914698e-025 7.05125791e-304 2.02617290e-125 1.73476612e-047
 7.09701340e-049 9.99151624e-001 2.07696142e-126 1.55803431e-166
 5.94613129e-001 4.99356037e-120 7.37231177e-027 2.92801280e-095
 5.14731180e-074 9.99993135e-001 2.78566799e-063 8.59513947e-285
 3.14439847e-003 8.62392209e-267 1.25949214e-029 1.37669383e-076
 2.05548564e-064 1.66905736e-033 5.76042462e-142 1.72877690e-143
 1.03997222e-070 6.20421531e-015 6.77378572e-097 1.83276018e-123
 3.65824472e-043 1.08208335e-263 2.00280746e-096 9.88623649e-001
 1.66015813e-268 7.24683527e-035 1.20776973e-049 9.99999557e-001
 3.39242793e-032 6.12203641e-267 9.74809198e-169 1.86901296e-222
 5.68128517e-048 7.50077542e-018 1.11345075e-157 1.51134426e-092
 2.66336824e-021 2.31885327e-223 9.99999999e-001 1.31673390e-144
 5.00333892e-037 5.92197957e-065 1.27756158e-136 1.00000000e+000
 9.81741367e-208 2.67523051e-148 1.15861584e-200 1.00000000e+000
 7.95590766e-150 5.45290063e-087 4.90022074e-073 4.44279136e-078
 9.64152868e-110 1.81168790e-110 2.04385113e-076 3.58808013e-085
 1.40224705e-188 9.99900035e-001 6.50772250e-263 1.83115806e-290
 5.01459162e-151 9.99999999e-001 1.48025379e-083 7.72501467e-206
 3.90680480e-006 1.84788118e-084 1.19341962e-054 9.25490103e-171
 1.30455728e-139 4.39372090e-023 8.86370154e-053 3.51474279e-153
 2.40942771e-085 6.22397327e-054 9.99999971e-001 4.70782504e-070
 9.00030840e-022 9.99906307e-001 2.90477072e-018 2.90514907e-018
 1.80352929e-006 1.58069541e-148 9.61592961e-001 3.16241583e-093
 9.99997960e-001 8.72713075e-007 7.06754572e-099 9.99983077e-001
 5.40126379e-071 6.89864182e-060 9.95611678e-001 3.76869749e-069
 1.00000000e+000 3.92610952e-011 1.10327825e-018 9.92101368e-218
 1.00000000e+000 3.35462738e-130 7.81340908e-001 8.45036416e-147
 9.99962916e-001 2.08599241e-012 6.83687587e-040 3.45186727e-022
 8.40934745e-022 4.01152213e-071 4.63423834e-044 6.94533324e-011
 8.32873795e-109 6.34580172e-018 4.24342968e-070 1.15370536e-016
 3.75347738e-174 1.41826646e-064 1.75673045e-005 3.46798770e-063
 6.89551150e-020 1.50621149e-022 3.32307223e-009 3.91869943e-130
 6.06392320e-155 9.53268280e-001 1.65430999e-181 7.95706720e-060
 1.25025703e-098 1.04479825e-218 8.47474289e-158 1.28699588e-089
 8.78095953e-061 8.16938528e-194 6.83598548e-040 4.38975915e-106
 8.34641473e-013 7.39697400e-065 2.18696405e-102 7.83203312e-010
 2.12006471e-085 2.67466285e-076 4.26900808e-018 1.41497854e-195
 1.49768188e-194 4.15059766e-142 3.73882076e-214 2.59109093e-036
 9.99999045e-001 1.15543724e-014 1.20291026e-103 3.71859334e-019
 5.11232517e-079 6.73267017e-168 5.56687619e-079 7.31264915e-233
 2.59940688e-004 9.17903908e-082 1.00214837e-091 3.03330479e-010
 7.40994480e-018 1.47649044e-012 1.58121127e-013 3.47840036e-091
 1.76436408e-007 5.62473718e-287 2.08567040e-288 4.75406237e-001
 6.08921686e-147 6.54336007e-108 6.71932798e-014 9.99891934e-001
 1.93771158e-027 2.70824099e-004 9.99943489e-001 7.00076100e-019
 5.17835909e-074 2.46471383e-016 1.88531293e-082 4.23282827e-005
 3.18526505e-084 2.99094390e-134 1.84316319e-031 4.11644042e-059
 1.11181783e-095 1.04995318e-014 4.98858423e-004 6.11821051e-002
 2.13007408e-002 3.15216948e-041 1.31569413e-110 4.67211189e-102
 4.11584111e-039 3.05509536e-001 9.99999878e-001 2.79058785e-108
 9.72093356e-014 1.40462924e-103 5.35021314e-095 1.23534934e-087
 3.75056032e-047 2.43637172e-184 9.12950774e-018 1.09283420e-027
 9.33781955e-095 1.93636901e-015 6.41816680e-193 7.13847305e-032
 4.92027970e-017 6.94077882e-025 2.13581927e-037 3.86151779e-275
 1.99419728e-139 1.00000000e+000 9.98596144e-001 1.45350554e-029
 1.15536470e-036 2.11486749e-005]
2025-06-24 12:10:02,212 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:10:03,428 - src.training - INFO -   precision: 0.0027413587604290823
2025-06-24 12:10:03,428 - src.training - INFO -   recall: 0.17037037037037037
2025-06-24 12:10:03,428 - src.training - INFO -   f1: 0.005395894428152493
2025-06-24 12:10:03,428 - src.training - INFO -   accuracy: 0.9232461301710871
2025-06-24 12:10:03,428 - src.training - INFO -   balanced_accuracy: 0.5472688395106485
2025-06-24 12:10:03,428 - src.training - INFO -   positive_samples: 270
2025-06-24 12:10:03,428 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:10:03,428 - src.training - INFO -   total_samples: 220940
2025-06-24 12:10:03,428 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:10:03,428 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:10:03,428 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:10:03,428 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:10:03,428 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:10:03,428 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:10:03,428 - src.training - INFO - 모델 학습 완료
2025-06-24 12:10:03,429 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0027413587604290823, 'recall': 0.17037037037037037, 'f1': 0.005395894428152493, 'accuracy': 0.9232461301710871, 'balanced_accuracy': 0.5472688395106485, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:10:03,429 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:03,429 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:03,429 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:03,429 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:03,449 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:10:03,449 - src.hyperparameter_tuning - ERROR - Trial 25 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:10:03,905 - src.hyperparameter_tuning - INFO - Trial 26: 모델 타입 = lightgbm
2025-06-24 12:10:05,720 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:10:05,720 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:10:05,720 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:10:05,720 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:10:05,720 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:10:05,720 - src.training - INFO - 교차 검증 시작
2025-06-24 12:10:05,720 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:10:05,737 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:10:06,187 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:10:06,187 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:10:06,187 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:10:06,187 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:10:06,187 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:10:06,187 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:10:06,187 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:10:06,187 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:10:06,187 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:10:06,365 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:10:06,365 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:10:06,365 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:10:06,365 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:10:06,365 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:10:06,365 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:10:06,365 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:10:06,365 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:10:06,365 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:10:06,365 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:10:07,678 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:10:08,693 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:10:08,694 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:10:08,699 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:10:08,731 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:10:08,731 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:10:08,731 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:10:08,731 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:10:09,951 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:10:10,203 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:10:10,203 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:10:10,363 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:10:10,363 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:10:10,404 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:10:10,404 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:10:10,404 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:10:10,404 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:10:10,404 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:10,404 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:10,452 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:10:10,452 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:10:10,452 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:10,452 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:10,452 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:10:10,452 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:10:10,452 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:10,511 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:10:10,511 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:10:10,511 - src.training - INFO - 모델 학습 시작
2025-06-24 12:10:10,639 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:10:10,639 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:10:10,639 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:10:10,639 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:10:10,639 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:10:10,639 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:10:10,639 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:10:10,639 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:10:10,639 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:10:10,639 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:10:10,639 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:10:10,639 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:10:10,639 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:10:10,639 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:10,640 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:10,717 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:10,771 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:10,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:10,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:10,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:11,053 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:11,070 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:10:11,070 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:11,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:10:11,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:11,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:10:11,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:11,134 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:11,152 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:11,167 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:11,183 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:11,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:11,215 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:11,234 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:11,236 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:10:11,236 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:11,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:10:11,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:11,251 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:10:11,251 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:11,251 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:10:11,262 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   learning_rate: 0.03311385427297357
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   n_estimators: 292
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   subsample: 0.6143854481798963
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8131279970759081
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0002542959336453523
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00036087593158894333
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:10:11,265 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:10:11,367 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:10:11,367 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 1.2493966851993117})})
2025-06-24 12:10:11,367 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:10:11,367 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:10:11,368 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:10:11,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:10:11,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:11,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:11,387 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:11,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:11,422 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:11,439 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:11,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:11,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:11,478 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:10:11,478 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:11,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:10:11,487 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:10:11,487 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:10:11,487 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:10:11,487 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:10:11,487 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:11,487 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:11,487 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:10:11,487 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:10:11,491 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:10:11,495 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:10:11,497 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [4.25721623e-003 1.00039027e-002 3.87740935e-001 9.75432509e-001
 1.67952744e-027 2.90350058e-191 7.11057884e-001 1.16084059e-002
 4.94753928e-001 9.80003638e-001 2.35399544e-005 6.03161416e-004
 6.35129760e-002 2.69690532e-001 2.33206127e-050 9.87183546e-001
 8.22592795e-003 1.43666631e-002 8.07600544e-002 9.99993622e-001
 9.99999992e-001 1.08385551e-003 8.89799026e-004 1.08651283e-003
 1.26260021e-003 9.99999953e-001 4.45600295e-001 4.18050125e-004
 9.79733772e-056 9.99999990e-001 4.21421433e-079 9.50221262e-091
 9.99992230e-001 6.72611018e-002 9.75743792e-001 2.94710364e-048
 1.26766340e-071 1.08569599e-003 7.01499374e-043 2.21059238e-188
 6.20421423e-191 7.51004042e-082 2.63835736e-003 5.94126425e-188
 1.27871528e-024 9.92994780e-001 9.95137850e-001 9.99809462e-001
 9.99682857e-001 5.73898997e-001 2.23549215e-007 2.88723069e-005
 4.45033454e-007 9.99999339e-001 9.99998839e-001 8.11589847e-089
 9.09273373e-006 3.32278138e-012 9.99747370e-001 0.00000000e+000
 5.67489663e-108 9.99505293e-002 4.79091807e-002 4.56748188e-006
 5.35305336e-001 8.91310274e-004 9.99999761e-001 1.00503373e-005
 2.08371112e-002 5.89580984e-004 9.68487930e-271 7.05019233e-106
 9.74562035e-001 6.41437190e-080 9.99999976e-001 6.65964320e-018
 8.91980994e-004 9.99999677e-001 9.99990383e-001 3.95263557e-018
 1.89546484e-010 5.46336739e-016 8.78368715e-004 6.46048498e-001
 1.42303581e-017 2.88887203e-005 3.73393614e-010 9.99997747e-001
 2.01272461e-199 7.62475032e-009 7.12347547e-009 6.78516655e-011
 1.16425884e-035 4.95889061e-004 8.88669586e-004 1.56650099e-003
 4.59991418e-004 3.48821147e-010 4.44385214e-105 9.99999180e-001
 7.79562972e-273 3.73181461e-010 9.99999709e-001 3.32089346e-012
 6.00484695e-009 4.03538913e-001 9.83316551e-001 1.12813195e-003
 7.75964860e-190 8.55984103e-002 9.88685533e-001 3.48647348e-010
 2.53397992e-009 5.57920993e-025 4.61650596e-026 1.05404322e-003
 3.75201598e-004 8.09254073e-011 2.67547971e-017 1.24092183e-010
 1.68754722e-018 1.13928255e-023 6.10453865e-270]
2025-06-24 12:10:11,497 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:10:12,357 - src.training - INFO -   precision: 0.0
2025-06-24 12:10:12,368 - src.training - INFO -   recall: 0.0
2025-06-24 12:10:12,368 - src.training - INFO -   f1: 0.0
2025-06-24 12:10:12,368 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:10:12,368 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:10:12,368 - src.training - INFO -   positive_samples: 270
2025-06-24 12:10:12,368 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:10:12,368 - src.training - INFO -   total_samples: 220940
2025-06-24 12:10:12,368 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:10:12,368 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:10:12,368 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:10:12,368 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:10:12,369 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:10:12,369 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:10:12,369 - src.training - INFO - 모델 학습 완료
2025-06-24 12:10:12,369 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:10:12,369 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:12,369 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:12,369 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:12,369 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:12,389 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:10:12,389 - src.hyperparameter_tuning - ERROR - Trial 26 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:10:12,849 - src.hyperparameter_tuning - INFO - Trial 27: 모델 타입 = lightgbm
2025-06-24 12:10:14,848 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:10:14,849 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:10:14,849 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:10:14,849 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:10:14,849 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:10:14,849 - src.training - INFO - 교차 검증 시작
2025-06-24 12:10:14,849 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:10:14,866 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:10:15,343 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:10:15,343 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:10:15,343 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:10:15,343 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:10:15,343 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:10:15,343 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:10:15,343 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:10:15,343 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:10:15,343 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:10:15,515 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:10:15,515 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:10:15,515 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:10:15,515 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:10:15,515 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:10:15,515 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:10:15,515 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:10:15,515 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:10:15,515 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:10:15,515 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:10:16,957 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:10:18,090 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:10:18,091 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:10:18,097 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:10:18,129 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:10:18,129 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:10:18,129 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:10:18,130 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:10:19,476 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:10:19,749 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:10:19,749 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:10:19,918 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:10:19,918 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:10:19,961 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:10:19,961 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:10:19,961 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:10:19,961 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:10:19,961 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:19,961 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:20,022 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:10:20,023 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:10:20,023 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:20,023 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:20,023 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:10:20,023 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:10:20,023 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:20,089 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:10:20,089 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:10:20,090 - src.training - INFO - 모델 학습 시작
2025-06-24 12:10:20,221 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:10:20,221 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:10:20,221 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:10:20,221 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:10:20,221 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:10:20,221 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:10:20,221 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:10:20,221 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:10:20,221 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:10:20,221 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:10:20,221 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:10:20,221 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:10:20,221 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:10:20,221 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:20,222 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:20,311 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:20,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:20,442 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:20,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:20,573 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:20,649 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:20,666 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:10:20,666 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:20,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:10:20,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:20,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:10:20,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:20,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:20,747 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:20,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:20,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:20,795 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:20,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:20,830 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:20,832 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:10:20,833 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:20,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:10:20,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:20,847 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:10:20,847 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:20,847 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:10:20,858 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   learning_rate: 0.011874761946127957
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   n_estimators: 691
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   subsample: 0.9631728512708426
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8690509926745927
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   reg_alpha: 9.211505350531135e-07
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO -   reg_lambda: 5.178611775237673e-07
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:10:20,861 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:10:20,969 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:10:20,969 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.25491192512589883})})
2025-06-24 12:10:20,969 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:10:20,969 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:10:20,970 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:10:20,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:10:20,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:20,971 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:20,990 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:21,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:21,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:21,041 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:21,058 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:21,076 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:21,079 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:10:21,079 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:21,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:10:21,084 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:10:21,084 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:10:21,084 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:10:21,084 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:10:21,084 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:21,084 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:21,084 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:10:21,084 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:10:21,087 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:10:21,092 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:10:21,093 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00273363 0.15682859 0.06376067 0.49362186 0.00591346 0.01308784
 0.05118908 0.24857893 0.51427843 0.16403135 0.00115423 0.12722778
 0.00555481 0.91324049 0.00115413 0.88509151 0.35704203 0.00115483
 0.56138337 0.64196509 0.93752033 0.56423051 0.19601082 0.00115462
 0.00339895 0.00115486 0.02908728 0.76000689 0.75786774 0.85829901
 0.00115488]
2025-06-24 12:10:21,093 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:10:21,905 - src.training - INFO -   precision: 0.0
2025-06-24 12:10:21,905 - src.training - INFO -   recall: 0.0
2025-06-24 12:10:21,905 - src.training - INFO -   f1: 0.0
2025-06-24 12:10:21,905 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:10:21,905 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:10:21,905 - src.training - INFO -   positive_samples: 270
2025-06-24 12:10:21,905 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:10:21,905 - src.training - INFO -   total_samples: 220940
2025-06-24 12:10:21,905 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:10:21,905 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:10:21,905 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:10:21,906 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:10:21,906 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:10:21,906 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:10:21,906 - src.training - INFO - 모델 학습 완료
2025-06-24 12:10:21,906 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:10:21,906 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:21,906 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:21,906 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:21,906 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:21,925 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:10:21,926 - src.hyperparameter_tuning - ERROR - Trial 27 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:10:22,387 - src.hyperparameter_tuning - INFO - Trial 28: 모델 타입 = lightgbm
2025-06-24 12:10:24,388 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:10:24,388 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:10:24,388 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:10:24,388 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:10:24,388 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:10:24,388 - src.training - INFO - 교차 검증 시작
2025-06-24 12:10:24,388 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:10:24,406 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:10:24,881 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:10:24,881 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:10:24,881 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:10:24,881 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:10:24,881 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:10:24,881 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:10:24,881 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:10:24,881 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:10:24,881 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:10:25,050 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:10:25,050 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:10:25,050 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:10:25,050 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:10:25,050 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:10:25,050 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:10:25,050 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:10:25,050 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:10:25,050 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:10:25,050 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:10:26,491 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:10:27,627 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:10:27,627 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:10:27,633 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:10:27,666 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:10:27,666 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:10:27,666 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:10:27,666 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:10:29,021 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:10:29,296 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:10:29,296 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:10:29,465 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:10:29,465 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:10:29,508 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:10:29,508 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:10:29,508 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:10:29,508 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:10:29,508 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:29,508 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:29,570 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:10:29,570 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:10:29,570 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:29,570 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:29,570 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:10:29,570 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:10:29,570 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:29,635 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:10:29,635 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:10:29,635 - src.training - INFO - 모델 학습 시작
2025-06-24 12:10:29,767 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:10:29,767 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:10:29,767 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:10:29,767 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:10:29,767 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:10:29,767 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:10:29,767 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:10:29,767 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:10:29,767 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:10:29,767 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:10:29,767 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:10:29,767 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:10:29,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:10:29,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:29,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:29,857 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:29,922 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:29,990 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:30,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:30,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:30,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:30,216 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:10:30,216 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:30,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:10:30,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:30,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:10:30,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:30,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:30,296 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:30,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:30,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:30,344 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:30,361 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:30,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:30,382 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:10:30,382 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:30,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:10:30,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:30,397 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:10:30,397 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:30,397 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:10:30,410 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   learning_rate: 0.011596210466332193
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   n_estimators: 320
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   subsample: 0.8980864047757167
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9951944571209766
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   reg_alpha: 0.01408000376615644
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO -   reg_lambda: 1.6391412848674745e-08
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:10:30,414 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:10:30,521 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:10:30,521 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.2291929951413507})})
2025-06-24 12:10:30,521 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:10:30,521 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:10:30,523 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:10:30,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:10:30,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:30,524 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:30,542 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:30,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:30,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:30,591 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:30,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:30,624 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:30,627 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:10:30,627 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:30,630 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:10:30,635 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:10:30,635 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:10:30,635 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:10:30,635 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:10:30,635 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:30,635 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:30,635 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:10:30,635 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:10:30,639 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:10:30,643 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:10:30,644 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00267967 0.14173732 0.05830001 0.45430556 0.00569329 0.01237204
 0.04699545 0.22467442 0.47437632 0.14821048 0.00115454 0.11517906
 0.00535578 0.89475604 0.00115444 0.8623909  0.32458031 0.00115513
 0.52064221 0.60152727 0.92318938 0.52346164 0.17701821 0.00115493
 0.00331493 0.00115516 0.0270138  0.72458176 0.72229727 0.83210326
 0.00115518]
2025-06-24 12:10:30,644 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:10:31,501 - src.training - INFO -   precision: 0.0
2025-06-24 12:10:31,501 - src.training - INFO -   recall: 0.0
2025-06-24 12:10:31,501 - src.training - INFO -   f1: 0.0
2025-06-24 12:10:31,501 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:10:31,501 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:10:31,501 - src.training - INFO -   positive_samples: 270
2025-06-24 12:10:31,501 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:10:31,501 - src.training - INFO -   total_samples: 220940
2025-06-24 12:10:31,501 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:10:31,501 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:10:31,501 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:10:31,501 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:10:31,501 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:10:31,501 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:10:31,501 - src.training - INFO - 모델 학습 완료
2025-06-24 12:10:31,501 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:10:31,501 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:31,501 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:31,501 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:31,501 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:31,521 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:10:31,521 - src.hyperparameter_tuning - ERROR - Trial 28 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:10:31,995 - src.hyperparameter_tuning - INFO - Trial 29: 모델 타입 = lightgbm
2025-06-24 12:10:33,976 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:10:33,977 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:10:33,977 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:10:33,977 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:10:33,977 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:10:33,977 - src.training - INFO - 교차 검증 시작
2025-06-24 12:10:33,977 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:10:33,994 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:10:34,469 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:10:34,469 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:10:34,469 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:10:34,469 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:10:34,469 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:10:34,469 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:10:34,469 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:10:34,469 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:10:34,469 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:10:34,638 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:10:34,638 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:10:34,638 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:10:34,638 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:10:34,638 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:10:34,638 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:10:34,638 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:10:34,638 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:10:34,638 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:10:34,638 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:10:36,083 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:10:37,212 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:10:37,212 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:10:37,218 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:10:37,250 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:10:37,250 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:10:37,250 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:10:37,250 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:10:38,588 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:10:38,859 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:10:38,860 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:10:39,028 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:10:39,028 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:10:39,071 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:10:39,071 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:10:39,071 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:10:39,071 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:10:39,071 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:39,071 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:39,133 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:10:39,133 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:10:39,133 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:39,133 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:39,133 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:10:39,133 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:10:39,133 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:39,199 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:10:39,199 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:10:39,200 - src.training - INFO - 모델 학습 시작
2025-06-24 12:10:39,331 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:10:39,331 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:10:39,331 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:10:39,331 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:10:39,331 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:10:39,331 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:10:39,331 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:10:39,331 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:10:39,331 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:10:39,331 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:10:39,331 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:10:39,331 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:10:39,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:10:39,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:39,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:39,421 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:39,486 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:39,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:39,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:39,686 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:39,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:39,780 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:10:39,780 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:39,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:10:39,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:39,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:10:39,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:39,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:39,859 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:39,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:39,891 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:39,907 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:39,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:39,943 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:39,945 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:10:39,945 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:39,960 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:10:39,960 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:39,960 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:10:39,960 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:39,960 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:10:39,974 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   learning_rate: 0.09459507523299628
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   n_estimators: 239
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   subsample: 0.706146513433176
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7491667532101085
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   reg_alpha: 2.759160443189367e-05
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO -   reg_lambda: 8.24998212875962e-06
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:10:39,978 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:10:40,098 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:10:40,098 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 7.955808010001585})})
2025-06-24 12:10:40,098 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:10:40,098 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:10:40,098 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:10:40,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:10:40,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:40,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:40,117 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:40,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:40,151 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:40,167 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:40,183 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:40,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:40,204 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:10:40,204 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:40,207 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:10:40,212 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:10:40,212 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:10:40,212 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:10:40,212 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:10:40,212 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:40,212 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:40,212 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:10:40,212 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:10:40,216 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:10:40,220 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:10:40,222 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [3.54990817e-001 1.00000000e+000 0.00000000e+000 6.30067732e-093
 9.86819717e-161 4.95952965e-001 8.24201665e-072 5.49172274e-199
 1.00000000e+000 1.00000000e+000 1.00000000e+000 5.85437125e-166
 9.00882990e-041 9.99999973e-001 1.49899036e-009 4.46901684e-074
 3.25061263e-049 2.76963260e-212 1.00000000e+000 7.67582971e-204
 1.00000000e+000 7.61956452e-066 2.27101225e-105 2.97392710e-080
 1.98389232e-002 1.00000000e+000 1.24167949e-235 1.07425009e-084
 1.68250351e-152 5.83630038e-015 2.86381923e-214 2.19946575e-097
 1.35025674e-144 3.25134447e-210 6.23361482e-088 1.00000000e+000
 2.11501749e-006 1.15707115e-002 2.11845411e-006 1.53297028e-140
 2.90740145e-002 3.89695226e-007 4.40479230e-003 9.91943080e-001
 3.08780633e-017 4.85671960e-184 1.17615822e-156 5.46566836e-043
 1.00000000e+000 2.15963789e-036 1.16474275e-023 3.44741384e-061
 1.11885437e-017 3.10093348e-116 8.82659313e-191 1.32235298e-019
 1.81429401e-261 2.66091618e-260 6.29091049e-009 6.65271352e-001
 3.48633562e-038 3.65613147e-096 2.96258902e-016 9.86251308e-014
 9.99999285e-001 1.48748797e-001 1.00000000e+000 6.44717419e-008
 9.75534156e-009 3.99018395e-028 6.63073779e-059 3.56130541e-004
 1.71121957e-046 3.11577789e-005 5.17949029e-089 2.61344287e-094
 2.34376364e-264 7.85387686e-203 2.41034599e-228 9.22900359e-034
 3.55045405e-040 1.69701038e-028 9.99990431e-001 9.99999992e-001
 6.40660890e-011 7.34213730e-237 4.29651141e-098 5.36138418e-020
 2.84364039e-077 2.96708777e-090 9.48481027e-240 3.58880513e-067
 2.94776158e-030 1.91484213e-027 3.06520112e-039 5.53099532e-010
 5.90001117e-071 3.30679485e-004 4.21891976e-096 1.88026157e-025
 1.07682723e-235 9.98561493e-001 1.79939710e-119 3.85315758e-268
 5.79346157e-069 9.88679776e-021 2.72379184e-001 1.65313398e-026
 1.00000000e+000 5.95613525e-253 9.08264236e-074 7.58536895e-003
 6.73233746e-007 1.10679994e-010 2.21839381e-091 2.95992533e-012
 9.37732521e-025 1.55930692e-243 1.56282057e-088 5.09363607e-070
 2.51047879e-088 9.01620693e-021 1.98947940e-261 1.85711420e-274
 2.25142434e-258 2.15199865e-015 8.63582035e-085 9.81096564e-001
 8.05108258e-237 5.19678395e-054 2.07079835e-104 2.07455276e-030
 5.07211695e-045 9.40459682e-058 4.33037783e-256 2.77807349e-064
 2.80274599e-041 1.67176332e-033 6.61416993e-101 9.99982974e-001
 9.11112893e-234 9.55529731e-010 9.99826109e-001 1.20904779e-205
 7.71204196e-201 3.78534902e-209 3.70929221e-097 5.33446620e-017
 9.99999989e-001 5.42373563e-195 8.32522812e-005 6.78046012e-202
 4.58906992e-193 1.70383881e-013 1.34619100e-242 1.28171546e-007
 4.05514851e-196 3.32653309e-267 9.99997944e-001 3.69806878e-196
 9.97455688e-001 5.71141461e-004 1.00000000e+000 9.92024749e-001
 1.21403685e-187 9.97679209e-001]
2025-06-24 12:10:40,222 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:10:41,578 - src.training - INFO -   precision: 0.0022170608108108107
2025-06-24 12:10:41,578 - src.training - INFO -   recall: 0.07777777777777778
2025-06-24 12:10:41,578 - src.training - INFO -   f1: 0.0043112297269554505
2025-06-24 12:10:41,578 - src.training - INFO -   accuracy: 0.9560966778310853
2025-06-24 12:10:41,578 - src.training - INFO -   balanced_accuracy: 0.5174745598002044
2025-06-24 12:10:41,578 - src.training - INFO -   positive_samples: 270
2025-06-24 12:10:41,578 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:10:41,578 - src.training - INFO -   total_samples: 220940
2025-06-24 12:10:41,578 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:10:41,578 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:10:41,578 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:10:41,578 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:10:41,578 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:10:41,578 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:10:41,578 - src.training - INFO - 모델 학습 완료
2025-06-24 12:10:41,578 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0022170608108108107, 'recall': 0.07777777777777778, 'f1': 0.0043112297269554505, 'accuracy': 0.9560966778310853, 'balanced_accuracy': 0.5174745598002044, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:10:41,578 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:41,578 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:41,578 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:41,578 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:41,601 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:10:41,601 - src.hyperparameter_tuning - ERROR - Trial 29 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:10:42,060 - src.hyperparameter_tuning - INFO - Trial 30: 모델 타입 = lightgbm
2025-06-24 12:10:44,038 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:10:44,038 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:10:44,038 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:10:44,038 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:10:44,038 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:10:44,038 - src.training - INFO - 교차 검증 시작
2025-06-24 12:10:44,038 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:10:44,055 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:10:44,533 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:10:44,533 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:10:44,533 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:10:44,533 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:10:44,533 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:10:44,533 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:10:44,533 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:10:44,533 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:10:44,533 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:10:44,699 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:10:44,699 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:10:44,699 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:10:44,699 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:10:44,699 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:10:44,699 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:10:44,699 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:10:44,699 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:10:44,699 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:10:44,699 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:10:46,144 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:10:47,271 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:10:47,271 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:10:47,277 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:10:47,309 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:10:47,309 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:10:47,309 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:10:47,309 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:10:48,660 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:10:48,937 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:10:48,937 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:10:49,106 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:10:49,107 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:10:49,150 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:10:49,150 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:10:49,150 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:10:49,150 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:10:49,150 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:49,150 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:49,212 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:10:49,212 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:10:49,212 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:49,212 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:49,212 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:10:49,212 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:10:49,212 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:49,277 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:10:49,277 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:10:49,277 - src.training - INFO - 모델 학습 시작
2025-06-24 12:10:49,409 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:10:49,409 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:10:49,409 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:10:49,409 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:10:49,409 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:10:49,409 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:10:49,409 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:10:49,409 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:10:49,409 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:10:49,409 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:10:49,409 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:10:49,409 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:10:49,409 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:10:49,409 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:49,409 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:49,499 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:49,566 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:49,636 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:49,700 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:49,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:49,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:49,861 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:10:49,861 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:49,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:10:49,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:49,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:10:49,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:49,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:49,939 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:49,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:49,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:49,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:50,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:50,022 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:50,025 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:10:50,025 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:50,039 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:10:50,039 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:50,039 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:10:50,039 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:50,039 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:10:50,055 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   learning_rate: 0.025351187897108034
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   n_estimators: 225
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   subsample: 0.7332757915457646
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9062723865323481
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:10:50,058 - src.models.lightgbm_model - INFO -   reg_alpha: 1.2159075442703253e-07
2025-06-24 12:10:50,059 - src.models.lightgbm_model - INFO -   reg_lambda: 1.8989061233288688e-06
2025-06-24 12:10:50,059 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:10:50,059 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:10:50,059 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:10:50,880 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:10:50,880 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 1.19516285183776})})
2025-06-24 12:10:50,880 - src.models.lightgbm_model - INFO -   - Best Iteration: 135
2025-06-24 12:10:50,880 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:10:50,880 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:10:50,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:10:50,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:50,881 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:10:50,901 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:10:50,916 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:10:50,933 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:10:50,949 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:10:50,967 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:10:50,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:10:50,988 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:10:50,988 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:50,990 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:10:51,017 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:10:51,017 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:10:51,017 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:10:51,017 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:10:51,017 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:51,017 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:51,017 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:10:51,017 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:10:51,021 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:10:51,025 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:10:51,028 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00047414 0.00501863 0.01531    ... 0.0668889  0.00405472 0.00050867]
2025-06-24 12:10:51,028 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:10:52,395 - src.training - INFO -   precision: 0.005659891947517366
2025-06-24 12:10:52,395 - src.training - INFO -   recall: 0.08148148148148149
2025-06-24 12:10:52,395 - src.training - INFO -   f1: 0.010584556170315132
2025-06-24 12:10:52,395 - src.training - INFO -   accuracy: 0.9813840861772427
2025-06-24 12:10:52,395 - src.training - INFO -   balanced_accuracy: 0.5319833201579701
2025-06-24 12:10:52,395 - src.training - INFO -   positive_samples: 270
2025-06-24 12:10:52,395 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:10:52,395 - src.training - INFO -   total_samples: 220940
2025-06-24 12:10:52,395 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:10:52,395 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:10:52,395 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:10:52,395 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:10:52,395 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:10:52,395 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:10:52,395 - src.training - INFO - 모델 학습 완료
2025-06-24 12:10:52,395 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.005659891947517366, 'recall': 0.08148148148148149, 'f1': 0.010584556170315132, 'accuracy': 0.9813840861772427, 'balanced_accuracy': 0.5319833201579701, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:10:52,395 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:52,395 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:52,395 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:52,395 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:52,417 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:10:52,417 - src.hyperparameter_tuning - ERROR - Trial 30 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:10:52,877 - src.hyperparameter_tuning - INFO - Trial 31: 모델 타입 = lightgbm
2025-06-24 12:10:54,826 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:10:54,826 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:10:54,826 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:10:54,826 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:10:54,826 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:10:54,826 - src.training - INFO - 교차 검증 시작
2025-06-24 12:10:54,826 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:10:54,843 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:10:55,319 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:10:55,319 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:10:55,319 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:10:55,319 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:10:55,319 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:10:55,319 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:10:55,319 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:10:55,319 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:10:55,319 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:10:55,485 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:10:55,485 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:10:55,485 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:10:55,485 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:10:55,485 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:10:55,485 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:10:55,485 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:10:55,485 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:10:55,485 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:10:55,485 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:10:56,928 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:10:58,055 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:10:58,055 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:10:58,062 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:10:58,094 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:10:58,094 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:10:58,094 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:10:58,094 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:10:59,437 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:10:59,707 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:10:59,707 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:10:59,876 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:10:59,876 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:10:59,919 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:10:59,919 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:10:59,919 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:10:59,919 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:10:59,919 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:10:59,919 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:10:59,981 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:10:59,981 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:10:59,981 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:59,981 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:10:59,981 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:10:59,981 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:10:59,981 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:00,046 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:11:00,046 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:11:00,047 - src.training - INFO - 모델 학습 시작
2025-06-24 12:11:00,178 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:11:00,178 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:11:00,178 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:11:00,178 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:11:00,178 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:11:00,178 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:11:00,179 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:11:00,179 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:11:00,179 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:11:00,179 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:11:00,179 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:11:00,179 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:11:00,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:11:00,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:00,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:00,269 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:00,336 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:00,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:00,470 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:00,538 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:00,615 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:00,631 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:11:00,631 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:00,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:11:00,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:00,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:11:00,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:00,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:00,709 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:00,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:00,741 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:00,757 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:00,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:00,792 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:00,795 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:11:00,795 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:00,810 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:11:00,810 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:00,810 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:11:00,810 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:00,810 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:11:00,825 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:11:00,828 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:11:00,828 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:11:00,828 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   learning_rate: 0.02671591595319576
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   n_estimators: 651
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   subsample: 0.8274808117893204
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8678391695691816
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0007255497634279696
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO -   reg_lambda: 1.8862385864246697e-07
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:11:00,829 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:11:02,534 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:11:02,534 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.9670627515477116})})
2025-06-24 12:11:02,534 - src.models.lightgbm_model - INFO -   - Best Iteration: 296
2025-06-24 12:11:02,534 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:11:02,535 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:11:02,535 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:11:02,535 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:02,535 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:02,554 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:02,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:02,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:02,604 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:02,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:02,639 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:02,641 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:11:02,642 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:02,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:11:02,701 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:11:02,701 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:11:02,701 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:11:02,701 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:11:02,701 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:02,701 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:02,701 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:11:02,701 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:11:02,705 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:11:02,710 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:11:02,713 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00889617 0.14440223 0.02897602 ... 0.0003133  0.24489631 0.01453534]
2025-06-24 12:11:02,713 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:11:04,024 - src.training - INFO -   precision: 0.007882111034955449
2025-06-24 12:11:04,024 - src.training - INFO -   recall: 0.08518518518518518
2025-06-24 12:11:04,024 - src.training - INFO -   f1: 0.014429109159347553
2025-06-24 12:11:04,024 - src.training - INFO -   accuracy: 0.9857789445098216
2025-06-24 12:11:04,024 - src.training - INFO -   balanced_accuracy: 0.5360330240060154
2025-06-24 12:11:04,024 - src.training - INFO -   positive_samples: 270
2025-06-24 12:11:04,024 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:11:04,024 - src.training - INFO -   total_samples: 220940
2025-06-24 12:11:04,024 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:11:04,024 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:11:04,024 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:11:04,024 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:11:04,024 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:11:04,024 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:11:04,024 - src.training - INFO - 모델 학습 완료
2025-06-24 12:11:04,024 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.007882111034955449, 'recall': 0.08518518518518518, 'f1': 0.014429109159347553, 'accuracy': 0.9857789445098216, 'balanced_accuracy': 0.5360330240060154, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:11:04,024 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:04,024 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:04,024 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:04,024 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:04,046 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:11:04,046 - src.hyperparameter_tuning - ERROR - Trial 31 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:11:04,522 - src.hyperparameter_tuning - INFO - Trial 32: 모델 타입 = lightgbm
2025-06-24 12:11:06,476 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:11:06,476 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:11:06,476 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:11:06,476 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:11:06,476 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:11:06,476 - src.training - INFO - 교차 검증 시작
2025-06-24 12:11:06,476 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:11:06,492 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:11:06,967 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:11:06,967 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:11:06,967 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:11:06,967 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:11:06,967 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:11:06,967 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:11:06,967 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:11:06,967 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:11:06,967 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:11:07,130 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:11:07,130 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:11:07,130 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:11:07,130 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:11:07,130 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:11:07,130 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:11:07,130 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:11:07,130 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:11:07,130 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:11:07,130 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:11:08,570 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:11:09,696 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:11:09,696 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:11:09,702 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:11:09,734 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:11:09,734 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:11:09,734 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:11:09,734 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:11:11,069 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:11:11,341 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:11:11,341 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:11:11,511 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:11:11,511 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:11:11,554 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:11:11,554 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:11:11,554 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:11:11,554 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:11:11,554 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:11,554 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:11,616 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:11:11,616 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:11:11,616 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:11,616 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:11,616 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:11:11,616 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:11:11,616 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:11,681 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:11:11,681 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:11:11,681 - src.training - INFO - 모델 학습 시작
2025-06-24 12:11:11,812 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:11:11,813 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:11:11,813 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:11:11,813 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:11:11,813 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:11:11,813 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:11:11,813 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:11:11,813 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:11:11,813 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:11:11,813 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:11:11,813 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:11:11,813 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:11:11,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:11:11,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:11,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:11,902 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:11,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:12,041 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:12,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:12,171 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:12,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:12,265 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:11:12,265 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:12,324 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:11:12,324 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:12,324 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:11:12,324 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:12,324 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:12,342 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:12,358 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:12,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:12,389 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:12,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:12,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:12,428 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:11:12,428 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:12,442 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:11:12,443 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:12,443 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:11:12,443 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:12,443 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:11:12,458 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   learning_rate: 0.21462362710118066
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   n_estimators: 331
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   subsample: 0.7997394408707434
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6501754510783216
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   reg_alpha: 2.6824667147453024e-08
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO -   reg_lambda: 1.4427655589002943
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:11:12,461 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:11:12,551 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:11:12,551 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.042208154373949355})})
2025-06-24 12:11:12,551 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:11:12,551 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:11:12,552 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:11:12,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:11:12,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:12,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:12,574 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:12,591 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:12,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:12,625 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:12,641 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:12,659 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:12,662 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:11:12,662 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:12,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:11:12,669 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:11:12,669 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:11:12,669 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:11:12,669 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:11:12,669 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:12,669 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:12,669 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:11:12,669 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:11:12,673 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:11:12,677 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:11:12,678 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00000000e+000 7.01180660e-226 4.24445785e-181 3.50207018e-100
 5.45386894e-177 2.44881396e-119 4.81032706e-104 4.00728315e-174
 2.96792672e-200 8.45008473e-154 5.67723986e-064 1.10752118e-206
 1.49719838e-144 9.19011417e-279 3.10354686e-153 7.14818322e-230
 9.66324485e-168 1.24236216e-216 4.06770346e-206]
2025-06-24 12:11:12,678 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:11:13,535 - src.training - INFO -   precision: 0.0
2025-06-24 12:11:13,535 - src.training - INFO -   recall: 0.0
2025-06-24 12:11:13,535 - src.training - INFO -   f1: 0.0
2025-06-24 12:11:13,535 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:11:13,535 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:11:13,535 - src.training - INFO -   positive_samples: 270
2025-06-24 12:11:13,535 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:11:13,535 - src.training - INFO -   total_samples: 220940
2025-06-24 12:11:13,535 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:11:13,535 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:11:13,535 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:11:13,535 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:11:13,535 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:11:13,535 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:11:13,535 - src.training - INFO - 모델 학습 완료
2025-06-24 12:11:13,535 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:11:13,535 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:13,535 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:13,535 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:13,535 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:13,557 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:11:13,557 - src.hyperparameter_tuning - ERROR - Trial 32 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:11:14,027 - src.hyperparameter_tuning - INFO - Trial 33: 모델 타입 = lightgbm
2025-06-24 12:11:16,007 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:11:16,007 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:11:16,007 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:11:16,007 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:11:16,007 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:11:16,007 - src.training - INFO - 교차 검증 시작
2025-06-24 12:11:16,007 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:11:16,024 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:11:16,500 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:11:16,500 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:11:16,500 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:11:16,500 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:11:16,500 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:11:16,500 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:11:16,500 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:11:16,500 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:11:16,500 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:11:16,664 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:11:16,664 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:11:16,664 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:11:16,664 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:11:16,664 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:11:16,664 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:11:16,664 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:11:16,664 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:11:16,664 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:11:16,664 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:11:18,093 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:11:19,213 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:11:19,213 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:11:19,219 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:11:19,251 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:11:19,251 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:11:19,251 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:11:19,251 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:11:20,581 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:11:20,854 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:11:20,854 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:11:21,023 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:11:21,023 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:11:21,066 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:11:21,066 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:11:21,066 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:11:21,066 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:11:21,066 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:21,066 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:21,127 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:11:21,127 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:11:21,127 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:21,127 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:21,127 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:11:21,127 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:11:21,127 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:21,194 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:11:21,195 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:11:21,195 - src.training - INFO - 모델 학습 시작
2025-06-24 12:11:21,327 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:11:21,327 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:11:21,327 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:11:21,327 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:11:21,327 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:11:21,327 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:11:21,327 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:11:21,327 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:11:21,327 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:11:21,327 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:11:21,327 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:11:21,327 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:11:21,327 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:11:21,327 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:21,327 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:21,416 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:21,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:21,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:21,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:21,684 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:21,761 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:21,777 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:11:21,777 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:21,836 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:11:21,837 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:21,837 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:11:21,837 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:21,837 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:21,855 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:21,870 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:21,886 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:21,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:21,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:21,938 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:21,941 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:11:21,941 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:21,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:11:21,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:21,955 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:11:21,955 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:21,955 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:11:21,970 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:11:21,973 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   learning_rate: 0.013744752766159479
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   n_estimators: 427
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   subsample: 0.8124101835635733
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7672611846042177
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   reg_alpha: 0.004742990466325826
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO -   reg_lambda: 3.3353350729706144e-06
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:11:21,974 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:11:22,085 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:11:22,085 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.48132181158768794})})
2025-06-24 12:11:22,085 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:11:22,085 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:11:22,085 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:11:22,085 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:11:22,085 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:22,085 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:22,106 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:22,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:22,139 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:22,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:22,172 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:22,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:22,192 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:11:22,192 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:22,196 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:11:22,201 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:11:22,201 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:11:22,201 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:11:22,201 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:11:22,201 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:22,201 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:22,201 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:11:22,201 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:11:22,205 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:11:22,209 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:11:22,210 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00312499 0.29241392 0.11439377 0.73762746 0.00762712 0.01906886
 0.08978537 0.44591211 0.75571541 0.30538523 0.00115212 0.23762563
 0.00709513 0.97785481 0.001152   0.96851511 0.59443927 0.00115281
 0.79394077 0.85056756 0.98519844 0.79612328 0.36112724 0.00115257
 0.00402065 0.00115285 0.04755496 0.91663249 0.91559242 0.95883339
 0.00115287]
2025-06-24 12:11:22,210 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:11:23,023 - src.training - INFO -   precision: 0.0
2025-06-24 12:11:23,023 - src.training - INFO -   recall: 0.0
2025-06-24 12:11:23,023 - src.training - INFO -   f1: 0.0
2025-06-24 12:11:23,023 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:11:23,023 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:11:23,023 - src.training - INFO -   positive_samples: 270
2025-06-24 12:11:23,023 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:11:23,023 - src.training - INFO -   total_samples: 220940
2025-06-24 12:11:23,023 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:11:23,023 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:11:23,023 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:11:23,023 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:11:23,023 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:11:23,023 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:11:23,023 - src.training - INFO - 모델 학습 완료
2025-06-24 12:11:23,023 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:11:23,023 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:23,023 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:23,023 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:23,023 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:23,044 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:11:23,045 - src.hyperparameter_tuning - ERROR - Trial 33 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:11:23,509 - src.hyperparameter_tuning - INFO - Trial 34: 모델 타입 = lightgbm
2025-06-24 12:11:25,487 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:11:25,487 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:11:25,487 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:11:25,487 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:11:25,487 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:11:25,487 - src.training - INFO - 교차 검증 시작
2025-06-24 12:11:25,487 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:11:25,503 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:11:25,977 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:11:25,977 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:11:25,977 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:11:25,977 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:11:25,977 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:11:25,977 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:11:25,977 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:11:25,977 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:11:25,977 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:11:26,141 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:11:26,142 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:11:26,142 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:11:26,142 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:11:26,142 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:11:26,142 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:11:26,142 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:11:26,142 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:11:26,142 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:11:26,142 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:11:27,575 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:11:28,698 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:11:28,698 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:11:28,704 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:11:28,737 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:11:28,737 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:11:28,737 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:11:28,737 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:11:30,077 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:11:30,347 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:11:30,347 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:11:30,515 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:11:30,516 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:11:30,559 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:11:30,559 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:11:30,559 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:11:30,559 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:11:30,559 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:30,559 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:30,620 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:11:30,621 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:11:30,621 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:30,621 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:30,621 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:11:30,621 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:11:30,621 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:30,686 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:11:30,686 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:11:30,686 - src.training - INFO - 모델 학습 시작
2025-06-24 12:11:30,819 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:11:30,819 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:11:30,819 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:11:30,819 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:11:30,819 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:11:30,819 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:11:30,819 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:11:30,819 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:11:30,819 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:11:30,819 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:11:30,819 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:11:30,819 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:11:30,819 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:11:30,819 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:30,820 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:30,909 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:30,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:31,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:31,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:31,177 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:31,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:31,272 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:11:31,272 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:31,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:11:31,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:31,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:11:31,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:31,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:31,350 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:31,365 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:31,381 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:31,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:31,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:31,433 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:31,435 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:11:31,435 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:31,449 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:11:31,449 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:31,449 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:11:31,449 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:31,449 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:11:31,465 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   learning_rate: 0.01830765833018989
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   n_estimators: 533
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   subsample: 0.642432259372136
2025-06-24 12:11:31,468 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8553257333392185
2025-06-24 12:11:31,469 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:11:31,469 - src.models.lightgbm_model - INFO -   reg_alpha: 0.7156875731121699
2025-06-24 12:11:31,469 - src.models.lightgbm_model - INFO -   reg_lambda: 7.444389646302298e-07
2025-06-24 12:11:31,469 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:11:31,469 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:11:31,469 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:11:34,576 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:11:34,576 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.40308851346563845})})
2025-06-24 12:11:34,576 - src.models.lightgbm_model - INFO -   - Best Iteration: 533
2025-06-24 12:11:34,576 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:11:34,576 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:11:34,576 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:11:34,576 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:34,577 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:34,596 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:34,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:34,630 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:34,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:34,663 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:34,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:34,685 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:11:34,685 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:34,689 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:11:34,831 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:11:34,831 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:11:34,831 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:11:34,831 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:11:34,831 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:34,831 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:34,831 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:11:34,831 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:11:34,835 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:11:34,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:11:34,844 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.02872037 0.09824536 0.0166902  ... 0.00588139 0.01152226 0.00906827]
2025-06-24 12:11:34,844 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:11:35,704 - src.training - INFO -   precision: 0.0
2025-06-24 12:11:35,704 - src.training - INFO -   recall: 0.0
2025-06-24 12:11:35,704 - src.training - INFO -   f1: 0.0
2025-06-24 12:11:35,704 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:11:35,704 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:11:35,704 - src.training - INFO -   positive_samples: 270
2025-06-24 12:11:35,704 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:11:35,704 - src.training - INFO -   total_samples: 220940
2025-06-24 12:11:35,704 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:11:35,704 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:11:35,704 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:11:35,704 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:11:35,704 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:11:35,704 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:11:35,704 - src.training - INFO - 모델 학습 완료
2025-06-24 12:11:35,704 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:11:35,704 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:35,704 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:35,704 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:35,704 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:35,727 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:11:35,727 - src.hyperparameter_tuning - ERROR - Trial 34 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:11:36,188 - src.hyperparameter_tuning - INFO - Trial 35: 모델 타입 = lightgbm
2025-06-24 12:11:38,141 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:11:38,141 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:11:38,141 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:11:38,141 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:11:38,141 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:11:38,141 - src.training - INFO - 교차 검증 시작
2025-06-24 12:11:38,141 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:11:38,158 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:11:38,635 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:11:38,635 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:11:38,635 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:11:38,635 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:11:38,635 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:11:38,635 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:11:38,635 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:11:38,635 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:11:38,635 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:11:38,799 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:11:38,799 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:11:38,799 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:11:38,799 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:11:38,799 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:11:38,799 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:11:38,799 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:11:38,799 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:11:38,799 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:11:38,799 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:11:40,233 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:11:41,358 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:11:41,358 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:11:41,364 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:11:41,397 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:11:41,397 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:11:41,397 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:11:41,397 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:11:42,733 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:11:43,008 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:11:43,008 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:11:43,176 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:11:43,176 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:11:43,219 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:11:43,219 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:11:43,220 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:11:43,220 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:11:43,220 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:43,220 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:43,281 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:11:43,281 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:11:43,281 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:43,281 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:43,281 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:11:43,281 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:11:43,281 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:43,346 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:11:43,346 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:11:43,346 - src.training - INFO - 모델 학습 시작
2025-06-24 12:11:43,477 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:11:43,478 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:11:43,478 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:11:43,478 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:11:43,478 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:11:43,478 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:11:43,478 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:11:43,478 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:11:43,478 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:11:43,478 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:11:43,478 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:11:43,478 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:11:43,478 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:11:43,478 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:43,478 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:43,569 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:43,635 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:43,706 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:43,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:43,836 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:43,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:43,930 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:11:43,930 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:43,989 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:11:43,989 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:43,989 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:11:43,989 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:43,989 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:44,008 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:44,023 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:44,039 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:44,055 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:44,073 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:44,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:44,093 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:11:44,093 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:44,107 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:11:44,107 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:44,107 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:11:44,107 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:44,107 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:11:44,122 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   learning_rate: 0.027398079594044996
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   n_estimators: 141
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   subsample: 0.7601332701967838
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7480959428429059
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   reg_alpha: 1.9481914541026654e-06
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO -   reg_lambda: 4.0277122059423737e-07
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:11:44,126 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:11:44,245 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:11:44,245 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 1.572812144541735})})
2025-06-24 12:11:44,245 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:11:44,245 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:11:44,246 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:11:44,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:11:44,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:44,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:44,264 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:44,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:44,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:44,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:44,329 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:44,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:44,350 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:11:44,350 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:44,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:11:44,358 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:11:44,358 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:11:44,358 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:11:44,358 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:11:44,358 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:44,358 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:44,358 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:11:44,358 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:11:44,362 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:11:44,366 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:11:44,367 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [6.74940675e-03 6.78877737e-03 9.61083997e-01 9.28759090e-01
 9.99834751e-01 7.34430390e-08 4.00324002e-01 8.46197834e-03
 2.30186215e-01 8.83942936e-01 7.90025926e-01 4.46923301e-04
 9.93407286e-01 6.01357891e-11 9.27000789e-01 6.57551759e-03
 3.90843765e-02 9.99999318e-01 1.07132849e-03 1.04357348e-03
 1.07979922e-03 1.34784219e-03 1.07350128e-03 9.99999136e-01
 9.99998597e-01 2.25563071e-01 2.03427207e-90 1.79095358e-40
 6.55091389e-11 8.95681856e-45 3.15793780e-46 4.02623738e-02
 8.81219986e-01 3.11087659e-02 9.25879987e-05 1.00860236e-04
 1.07283348e-03 6.37037966e-07 7.39413874e-43 6.00909664e-85
 1.77885144e-05 2.06120456e-37 5.41553552e-12 0.00000000e+00
 6.50752585e-02 1.92194197e-40 1.50527200e-03 9.95994689e-01
 9.78772482e-01 1.07868310e-03 6.55611595e-11 2.00187681e-04
 9.99965909e-01 9.99964796e-01 2.42439928e-03 6.55919960e-11
 2.54463003e-04 3.51705787e-18 2.09374597e-07 9.98748482e-01
 2.19327385e-10 1.46753152e-11 1.29372328e-02 5.33025651e-01
 1.13077153e-13 1.30364681e-14 1.12074647e-41 4.60962659e-90
 6.50419692e-01 7.95757345e-10 9.98961360e-01 7.93128672e-10
 1.73323326e-43 8.09369494e-11 1.73905322e-07 3.42661318e-92
 9.99998560e-01 8.28127691e-01 1.19401369e-06 5.60548050e-53
 9.99972696e-01 1.04569005e-03 9.99995806e-01 9.99930437e-01
 1.28841671e-45 9.80573010e-05 2.43795307e-01 5.91899267e-46
 3.89387370e-03 8.08330942e-06 9.99965709e-01 1.75961802e-82
 1.31249262e-49 1.12940850e-13 1.65300162e-10 9.25036671e-01
 3.63823422e-09 4.86345027e-01 5.59872365e-53 4.86412613e-01
 9.99916162e-01 9.99994946e-01 7.78689987e-08 9.95794050e-01
 6.41550120e-09 1.48901051e-99 1.47518906e-03 9.99999554e-01
 4.65915478e-45 9.39864135e-06 1.23912714e-91 1.11850968e-03
 4.31119276e-05]
2025-06-24 12:11:44,367 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:11:45,221 - src.training - INFO -   precision: 0.0
2025-06-24 12:11:45,221 - src.training - INFO -   recall: 0.0
2025-06-24 12:11:45,221 - src.training - INFO -   f1: 0.0
2025-06-24 12:11:45,221 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:11:45,221 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:11:45,221 - src.training - INFO -   positive_samples: 270
2025-06-24 12:11:45,221 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:11:45,222 - src.training - INFO -   total_samples: 220940
2025-06-24 12:11:45,222 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:11:45,222 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:11:45,222 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:11:45,222 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:11:45,222 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:11:45,222 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:11:45,222 - src.training - INFO - 모델 학습 완료
2025-06-24 12:11:45,222 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:11:45,222 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:45,222 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:45,222 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:45,222 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:45,243 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:11:45,243 - src.hyperparameter_tuning - ERROR - Trial 35 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:11:45,714 - src.hyperparameter_tuning - INFO - Trial 36: 모델 타입 = lightgbm
2025-06-24 12:11:47,689 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:11:47,690 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:11:47,690 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:11:47,690 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:11:47,690 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:11:47,690 - src.training - INFO - 교차 검증 시작
2025-06-24 12:11:47,690 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:11:47,707 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:11:48,183 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:11:48,183 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:11:48,183 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:11:48,183 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:11:48,183 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:11:48,183 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:11:48,183 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:11:48,183 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:11:48,183 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:11:48,349 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:11:48,349 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:11:48,349 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:11:48,349 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:11:48,349 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:11:48,349 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:11:48,349 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:11:48,349 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:11:48,349 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:11:48,349 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:11:49,801 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:11:50,923 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:11:50,923 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:11:50,929 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:11:50,962 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:11:50,962 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:11:50,962 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:11:50,962 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:11:52,295 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:11:52,567 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:11:52,567 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:11:52,737 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:11:52,737 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:11:52,780 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:11:52,780 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:11:52,780 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:11:52,780 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:11:52,780 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:52,780 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:52,841 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:11:52,841 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:11:52,842 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:52,842 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:52,842 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:11:52,842 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:11:52,842 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:52,907 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:11:52,908 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:11:52,908 - src.training - INFO - 모델 학습 시작
2025-06-24 12:11:53,040 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:11:53,040 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:11:53,040 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:11:53,040 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:11:53,040 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:11:53,040 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:11:53,040 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:11:53,040 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:11:53,040 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:11:53,040 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:11:53,040 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:11:53,040 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:11:53,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:11:53,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:53,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:53,130 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:53,197 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:53,267 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:53,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:53,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:53,476 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:53,493 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:11:53,493 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:53,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:11:53,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:53,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:11:53,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:53,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:53,571 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:53,586 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:53,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:53,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:53,636 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:53,654 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:53,657 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:11:53,657 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:53,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:11:53,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:53,671 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:11:53,671 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:53,671 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:11:53,686 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   learning_rate: 0.11373193540110109
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   n_estimators: 539
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   subsample: 0.8133578132123082
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7481624884056435
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   reg_alpha: 2.3855353834028197e-08
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO -   reg_lambda: 0.003273267816706234
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:11:53,690 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:11:53,808 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:11:53,808 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 1.9346249418450872})})
2025-06-24 12:11:53,808 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:11:53,808 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:11:53,808 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:11:53,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:11:53,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:53,809 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:11:53,830 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:11:53,847 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:11:53,864 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:11:53,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:11:53,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:11:53,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:11:53,917 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:11:53,917 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:53,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:11:53,922 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:11:53,922 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:11:53,922 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:11:53,922 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:11:53,922 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:53,922 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:11:53,922 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:11:53,922 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:11:53,926 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:11:53,930 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:11:53,932 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [7.09230486e-001 8.12170988e-001 1.00000000e+000 0.00000000e+000
 2.61324951e-104 2.07235370e-014 8.06374517e-090 1.92666971e-009
 9.99882861e-001 1.32938030e-004 9.99999998e-001 9.99157607e-001
 9.99994334e-001 1.00000000e+000 1.63450772e-202 1.93640089e-056
 3.84422887e-014 4.90445203e-060 8.82631208e-126 6.04691148e-072
 2.04235867e-093 1.00000000e+000 1.36870099e-066 5.69967512e-100
 3.96636394e-013 3.48196494e-002 1.79269796e-288 8.67416384e-263
 9.98594813e-001 1.00000000e+000 9.71726084e-001 5.73302178e-100
 7.90874321e-177 1.00000000e+000 8.78299123e-001 9.82865469e-001
 6.51189067e-258 1.00000000e+000 9.99999998e-001 1.00000000e+000
 9.99894626e-001 9.82974826e-001 1.35612071e-010 5.22392210e-019
 7.99537662e-016 2.53132032e-020 5.93727212e-172 1.65324133e-014
 1.72900005e-016 1.00000000e+000 1.00592551e-016 2.47759809e-132
 2.07989606e-099 2.69405049e-064 1.03581771e-010 2.52638401e-020
 5.14019713e-007 1.29804714e-005 1.10080150e-112 8.29847807e-037
 6.65732497e-024 7.77301493e-056 3.36138217e-032 5.23412915e-019
 1.62737701e-011 3.17852959e-021 5.71355617e-033 1.05884422e-004
 1.80467217e-028 3.40591899e-012 1.00000000e+000 4.29176612e-006
 5.29612947e-012 1.64716454e-013 3.84942031e-029 1.62420348e-011
 8.39260816e-019 9.99999765e-001 8.83389332e-004 5.70241420e-033
 8.85238140e-196 9.22727757e-030 3.25102230e-001 2.77964322e-063
 1.21587003e-024 3.57911635e-025 9.97825644e-001 1.35877044e-010
 1.00000000e+000 6.97865710e-007 3.89402362e-048 1.97423564e-047
 1.00000000e+000 3.26443664e-136 2.92181613e-034 6.23578033e-043
 4.67023603e-005 3.46817670e-031 4.46143438e-038 2.55482724e-052
 2.46092105e-060 3.77411611e-049 2.86852674e-069 5.19953630e-047
 4.63091968e-030 4.08383106e-023 4.58527232e-040 3.71154806e-062
 5.91813779e-114 2.04762007e-084 8.06830376e-048 9.05898636e-065
 1.03109828e-131 5.93389409e-117 3.40584437e-099 6.33503093e-098
 6.46651188e-080 1.87865905e-121 2.05940205e-212 1.18202361e-194
 1.04238144e-187 3.27307237e-055]
2025-06-24 12:11:53,932 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:11:55,302 - src.training - INFO -   precision: 0.0006752194463200541
2025-06-24 12:11:55,302 - src.training - INFO -   recall: 0.003703703703703704
2025-06-24 12:11:55,302 - src.training - INFO -   f1: 0.001142204454597373
2025-06-24 12:11:55,302 - src.training - INFO -   accuracy: 0.9920838236625328
2025-06-24 12:11:55,302 - src.training - INFO -   balanced_accuracy: 0.49849842818755674
2025-06-24 12:11:55,302 - src.training - INFO -   positive_samples: 270
2025-06-24 12:11:55,302 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:11:55,302 - src.training - INFO -   total_samples: 220940
2025-06-24 12:11:55,302 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:11:55,302 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:11:55,302 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:11:55,302 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:11:55,302 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:11:55,302 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:11:55,302 - src.training - INFO - 모델 학습 완료
2025-06-24 12:11:55,302 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0006752194463200541, 'recall': 0.003703703703703704, 'f1': 0.001142204454597373, 'accuracy': 0.9920838236625328, 'balanced_accuracy': 0.49849842818755674, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:11:55,302 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:55,302 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:55,302 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:11:55,302 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:11:55,324 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:11:55,324 - src.hyperparameter_tuning - ERROR - Trial 36 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:11:55,784 - src.hyperparameter_tuning - INFO - Trial 37: 모델 타입 = lightgbm
2025-06-24 12:11:57,759 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:11:57,759 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:11:57,759 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:11:57,759 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:11:57,759 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:11:57,759 - src.training - INFO - 교차 검증 시작
2025-06-24 12:11:57,759 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:11:57,776 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:11:58,249 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:11:58,249 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:11:58,249 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:11:58,249 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:11:58,249 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:11:58,249 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:11:58,249 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:11:58,249 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:11:58,249 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:11:58,413 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:11:58,413 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:11:58,413 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:11:58,414 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:11:58,414 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:11:58,414 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:11:58,414 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:11:58,414 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:11:58,414 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:11:58,414 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:11:59,853 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:12:00,977 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:12:00,977 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:12:00,983 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:12:01,015 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:12:01,015 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:12:01,015 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:12:01,015 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:12:02,343 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:12:02,618 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:12:02,618 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:12:02,786 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:12:02,786 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:12:02,830 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:12:02,830 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:12:02,830 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:12:02,830 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:12:02,830 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:02,830 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:02,891 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:12:02,891 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:12:02,891 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:02,891 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:02,891 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:12:02,891 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:12:02,891 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:02,957 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:12:02,957 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:12:02,957 - src.training - INFO - 모델 학습 시작
2025-06-24 12:12:03,088 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:12:03,088 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:12:03,088 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:12:03,088 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:12:03,088 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:12:03,088 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:12:03,088 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:12:03,088 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:12:03,088 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:12:03,089 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:12:03,089 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:12:03,089 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:12:03,089 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:12:03,089 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:03,089 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:03,179 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:03,245 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:03,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:03,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:03,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:03,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:03,540 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:12:03,540 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:03,599 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:12:03,599 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:03,599 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:12:03,599 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:03,600 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:03,618 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:03,633 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:03,649 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:03,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:03,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:03,700 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:03,702 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:12:03,702 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:03,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:12:03,717 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:03,717 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:12:03,717 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:03,717 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:12:03,732 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   learning_rate: 0.10689158509685733
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:12:03,735 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   n_estimators: 681
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   subsample: 0.7870740783130812
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6711700839533253
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   reg_alpha: 1.0893258804921589e-08
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO -   reg_lambda: 0.026442704046310193
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:12:03,736 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:12:03,849 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:12:03,849 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 5.176846561595788})})
2025-06-24 12:12:03,849 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:12:03,849 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:12:03,849 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:12:03,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:12:03,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:03,850 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:03,872 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:03,888 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:03,905 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:03,921 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:03,938 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:03,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:03,959 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:12:03,959 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:03,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:12:03,964 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:12:03,965 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:12:03,965 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:12:03,965 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:12:03,965 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:03,965 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:03,965 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:12:03,965 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:12:03,969 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:12:03,973 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:12:03,974 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [6.43083791e-001 9.99999971e-001 1.00000000e+000 0.00000000e+000
 3.94583345e-095 4.21363292e-102 2.35909488e-279 1.18985045e-006
 3.29643342e-082 9.99434920e-001 1.00000000e+000 9.99999984e-001
 1.00000000e+000 1.00000000e+000 1.00000000e+000 2.24307887e-189
 2.05734192e-048 1.77261268e-001 8.57443787e-052 1.97771377e-041
 2.07949745e-065 4.72620950e-270 1.37386320e-085 1.00000000e+000
 5.93099763e-058 1.55858505e-299 9.49526588e-119 9.50310621e-092
 6.58918622e-001 9.99999723e-001 1.34874887e-269 7.90508074e-086
 1.86147384e-245 9.99999990e-001 9.55535216e-092 3.09578213e-165
 9.99999982e-001 9.99999994e-001 7.11382447e-241 4.81813094e-099
 1.00000000e+000 1.00000000e+000 9.99999997e-001 4.43737227e-009
 2.31859887e-008 1.36884254e-012 1.18308677e-160 7.52942928e-005
 1.25491231e-007 7.95725128e-009 1.93617677e-128 1.70120886e-097
 8.82040638e-032 9.91255991e-001 1.36633357e-012 9.99996905e-001
 1.81312212e-121 2.65717753e-060 2.47682845e-012 2.81859754e-005
 2.40497762e-108 3.23549778e-030 1.04219985e-011 4.44552053e-009
 4.68915062e-013 1.36400931e-019 1.11342740e-002 2.31041221e-015
 1.08401106e-305 9.56657565e-001 3.46700082e-006 2.49171151e-017
 8.39235051e-010 1.00000000e+000 2.89718671e-100 1.36150920e-019
 9.52459125e-275 2.56552542e-102 4.49839345e-016 9.99999976e-001
 4.22055823e-013 1.80665599e-006 9.99999999e-001 9.99951714e-001
 2.14549834e-018 2.17379382e-027 2.04924372e-082 2.65614721e-020
 3.68205684e-023 9.99999987e-001 9.34486152e-011 1.58754801e-013
 1.28484648e-030 1.91015658e-034 2.39279955e-019 2.94989494e-038
 1.96591439e-102 2.45130646e-017 1.06768292e-009 7.90879754e-031
 3.58554518e-003 1.10509432e-134 8.26172038e-011 9.03607621e-030
 1.70314456e-061 1.08739874e-050 2.17598820e-026 4.99587826e-034
 3.47108900e-078 1.84159498e-046 3.18501617e-227 4.57770991e-118
 2.86124113e-103 4.16060819e-245 2.24612556e-101 2.45631852e-249
 3.52739983e-122 2.93120201e-101 2.04146803e-228 7.57019232e-095
 9.87912846e-095 3.04545908e-023]
2025-06-24 12:12:03,974 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:12:05,275 - src.training - INFO -   precision: 0.0007927070947284979
2025-06-24 12:12:05,275 - src.training - INFO -   recall: 0.007407407407407408
2025-06-24 12:12:05,275 - src.training - INFO -   f1: 0.0014321518080916578
2025-06-24 12:12:05,275 - src.training - INFO -   accuracy: 0.9873766633475152
2025-06-24 12:12:05,275 - src.training - INFO -   balanced_accuracy: 0.49799155434040104
2025-06-24 12:12:05,275 - src.training - INFO -   positive_samples: 270
2025-06-24 12:12:05,275 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:12:05,275 - src.training - INFO -   total_samples: 220940
2025-06-24 12:12:05,275 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:12:05,275 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:12:05,275 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:12:05,275 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:12:05,275 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:12:05,275 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:12:05,275 - src.training - INFO - 모델 학습 완료
2025-06-24 12:12:05,275 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0007927070947284979, 'recall': 0.007407407407407408, 'f1': 0.0014321518080916578, 'accuracy': 0.9873766633475152, 'balanced_accuracy': 0.49799155434040104, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:12:05,275 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:05,275 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:05,275 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:05,275 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:05,299 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:12:05,299 - src.hyperparameter_tuning - ERROR - Trial 37 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:12:05,769 - src.hyperparameter_tuning - INFO - Trial 38: 모델 타입 = lightgbm
2025-06-24 12:12:07,712 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:12:07,712 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:12:07,712 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:12:07,712 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:12:07,712 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:12:07,712 - src.training - INFO - 교차 검증 시작
2025-06-24 12:12:07,712 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:12:07,729 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:12:08,206 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:12:08,206 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:12:08,206 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:12:08,206 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:12:08,206 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:12:08,206 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:12:08,206 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:12:08,206 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:12:08,206 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:12:08,367 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:12:08,368 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:12:08,368 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:12:08,368 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:12:08,368 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:12:08,368 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:12:08,368 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:12:08,368 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:12:08,368 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:12:08,368 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:12:09,806 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:12:10,927 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:12:10,927 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:12:10,933 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:12:10,966 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:12:10,966 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:12:10,966 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:12:10,966 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:12:12,287 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:12:12,559 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:12:12,559 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:12:12,729 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:12:12,729 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:12:12,772 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:12:12,772 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:12:12,772 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:12:12,772 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:12:12,772 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:12,772 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:12,834 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:12:12,834 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:12:12,834 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:12,834 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:12,834 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:12:12,834 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:12:12,834 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:12,899 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:12:12,899 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:12:12,899 - src.training - INFO - 모델 학습 시작
2025-06-24 12:12:13,030 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:12:13,030 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:12:13,030 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:12:13,030 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:12:13,030 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:12:13,030 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:12:13,030 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:12:13,030 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:12:13,030 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:12:13,030 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:12:13,030 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:12:13,030 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:12:13,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:12:13,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:13,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:13,120 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:13,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:13,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:13,322 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:13,388 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:13,464 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:13,482 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:12:13,482 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:13,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:12:13,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:13,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:12:13,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:13,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:13,569 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:13,585 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:13,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:13,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:13,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:13,652 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:13,655 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:12:13,655 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:13,673 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:12:13,673 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:13,673 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:12:13,673 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:13,673 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:12:13,686 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   learning_rate: 0.030266038674616916
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   n_estimators: 536
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   subsample: 0.6698034092738437
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8198626169348787
2025-06-24 12:12:13,689 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 12:12:13,690 - src.models.lightgbm_model - INFO -   reg_alpha: 9.021785080698397e-07
2025-06-24 12:12:13,690 - src.models.lightgbm_model - INFO -   reg_lambda: 6.090857026147028e-07
2025-06-24 12:12:13,690 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:12:13,690 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:12:13,690 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:12:13,800 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:12:13,800 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 1.4392800127904832})})
2025-06-24 12:12:13,800 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:12:13,800 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:12:13,801 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:12:13,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:12:13,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:13,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:13,824 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:13,841 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:13,857 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:13,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:13,889 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:13,907 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:13,910 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:12:13,910 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:13,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:12:13,918 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:12:13,918 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:12:13,918 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:12:13,918 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:12:13,918 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:13,918 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:13,918 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:12:13,918 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:12:13,922 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:12:13,926 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:12:13,927 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [8.02251220e-003 7.21635252e-001 8.87616723e-001 9.71616427e-001
 9.99966902e-001 4.88677168e-002 3.45912977e-001 9.49760952e-001
 3.87377232e-003 1.29591746e-004 2.50760010e-003 9.00513339e-001
 6.19007121e-026 9.76653175e-001 5.51599649e-002 9.99999923e-001
 1.05099591e-003 9.75718528e-001 9.99999829e-001 5.49626969e-001
 1.44224986e-029 1.10122425e-064 9.86710331e-023 1.05262704e-003
 4.23491615e-019 1.00016510e-258 9.99990659e-001 1.49442632e-056
 0.00000000e+000 5.54805691e-004 9.98492057e-001 9.40269527e-001
 1.87708054e-005 7.09947050e-011 6.16123969e-006 2.53950140e-037
 5.97804066e-074 2.95788249e-004 7.10315935e-011 2.35908918e-044
 9.99501832e-001 2.42209357e-014 6.30174121e-001 7.59867526e-001
 9.99998357e-001 9.99099961e-001 5.95340534e-005 1.22925250e-002
 1.11903661e-009 7.29331517e-004 9.99814751e-001 5.54106710e-066
 1.98759320e-012 8.11255405e-066 1.73739124e-030 3.20142328e-036
 1.61396284e-037 3.44625331e-029 4.79108776e-010 9.99999221e-001
 9.99982654e-001 6.30162430e-009 9.95808521e-001 2.13126595e-009
 7.88262975e-004 4.57152831e-005 9.71061960e-005 2.41537495e-011
 9.97327202e-001 8.37845874e-001 7.08655473e-001 3.99999798e-010
 2.37744734e-004 9.90674152e-040 6.75237921e-068 1.11129171e-008
 9.99656037e-001 5.40512289e-001 2.24387281e-042 9.99974873e-001
 1.84134354e-040 9.99998871e-001 4.79538372e-003 1.78320909e-003
 3.35161357e-004 9.38696396e-012 1.57592903e-010 9.94199781e-001
 7.87203618e-006 3.35761093e-008 3.21133307e-003 2.96203128e-015
 1.47959715e-010 3.53049326e-018 9.95981392e-001 2.04456405e-004
 9.99999580e-001 2.98118838e-065 1.06935896e-011 1.47492758e-004]
2025-06-24 12:12:13,927 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:12:14,783 - src.training - INFO -   precision: 0.0
2025-06-24 12:12:14,783 - src.training - INFO -   recall: 0.0
2025-06-24 12:12:14,783 - src.training - INFO -   f1: 0.0
2025-06-24 12:12:14,783 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:12:14,783 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:12:14,783 - src.training - INFO -   positive_samples: 270
2025-06-24 12:12:14,783 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:12:14,783 - src.training - INFO -   total_samples: 220940
2025-06-24 12:12:14,783 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:12:14,783 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:12:14,783 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:12:14,783 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:12:14,784 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:12:14,784 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:12:14,784 - src.training - INFO - 모델 학습 완료
2025-06-24 12:12:14,784 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:12:14,784 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:14,784 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:14,784 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:14,784 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:14,803 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:12:14,803 - src.hyperparameter_tuning - ERROR - Trial 38 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:12:15,275 - src.hyperparameter_tuning - INFO - Trial 39: 모델 타입 = lightgbm
2025-06-24 12:12:17,212 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:12:17,212 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:12:17,212 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:12:17,212 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:12:17,212 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:12:17,212 - src.training - INFO - 교차 검증 시작
2025-06-24 12:12:17,212 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:12:17,229 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:12:17,704 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:12:17,704 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:12:17,704 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:12:17,704 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:12:17,704 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:12:17,704 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:12:17,704 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:12:17,704 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:12:17,704 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:12:17,868 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:12:17,868 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:12:17,868 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:12:17,868 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:12:17,868 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:12:17,868 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:12:17,868 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:12:17,868 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:12:17,868 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:12:17,868 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:12:19,307 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:12:20,427 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:12:20,427 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:12:20,433 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:12:20,465 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:12:20,465 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:12:20,465 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:12:20,465 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:12:21,799 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:12:22,068 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:12:22,068 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:12:22,237 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:12:22,237 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:12:22,279 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:12:22,280 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:12:22,280 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:12:22,280 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:12:22,280 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:22,280 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:22,341 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:12:22,341 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:12:22,341 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:22,341 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:22,341 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:12:22,341 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:12:22,341 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:22,408 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:12:22,408 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:12:22,408 - src.training - INFO - 모델 학습 시작
2025-06-24 12:12:22,540 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:12:22,540 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:12:22,540 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:12:22,540 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:12:22,540 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:12:22,540 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:12:22,540 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:12:22,540 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:12:22,540 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:12:22,540 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:12:22,540 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:12:22,540 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:12:22,540 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:12:22,540 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:22,541 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:22,630 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:22,697 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:22,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:22,832 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:22,899 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:22,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:22,992 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:12:22,992 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:23,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:12:23,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:23,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:12:23,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:23,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:23,070 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:23,086 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:23,101 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:23,117 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:23,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:23,153 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:23,155 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:12:23,155 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:23,169 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:12:23,169 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:23,170 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:12:23,170 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:23,170 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:12:23,185 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   learning_rate: 0.01809378106263188
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   n_estimators: 385
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   subsample: 0.7016326818689271
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8012947934038904
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0028911395061563994
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO -   reg_lambda: 1.45729468519123e-08
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:12:23,188 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:12:25,360 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:12:25,361 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.42168913603085684})})
2025-06-24 12:12:25,361 - src.models.lightgbm_model - INFO -   - Best Iteration: 385
2025-06-24 12:12:25,361 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:12:25,361 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:12:25,361 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:12:25,361 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:25,361 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:25,382 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:25,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:25,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:25,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:25,448 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:25,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:25,470 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:12:25,470 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:25,472 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:12:25,555 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:12:25,555 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:12:25,555 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:12:25,555 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:12:25,555 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:25,555 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:25,555 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:12:25,555 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:12:25,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:12:25,564 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:12:25,568 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.0303431  0.04653107 0.01639665 ... 0.01039789 0.01673939 0.01176226]
2025-06-24 12:12:25,568 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:12:26,915 - src.training - INFO -   precision: 0.0
2025-06-24 12:12:26,915 - src.training - INFO -   recall: 0.0
2025-06-24 12:12:26,915 - src.training - INFO -   f1: 0.0
2025-06-24 12:12:26,915 - src.training - INFO -   accuracy: 0.9987281614918078
2025-06-24 12:12:26,915 - src.training - INFO -   balanced_accuracy: 0.4999750759051978
2025-06-24 12:12:26,915 - src.training - INFO -   positive_samples: 270
2025-06-24 12:12:26,915 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:12:26,915 - src.training - INFO -   total_samples: 220940
2025-06-24 12:12:26,915 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:12:26,915 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:12:26,915 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:12:26,915 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:12:26,916 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:12:26,916 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:12:26,916 - src.training - INFO - 모델 학습 완료
2025-06-24 12:12:26,916 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987281614918078, 'balanced_accuracy': 0.4999750759051978, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:12:26,916 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:26,916 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:26,916 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:26,916 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:26,938 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:12:26,938 - src.hyperparameter_tuning - ERROR - Trial 39 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:12:27,403 - src.hyperparameter_tuning - INFO - Trial 40: 모델 타입 = lightgbm
2025-06-24 12:12:29,391 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:12:29,391 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:12:29,391 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:12:29,391 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:12:29,391 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:12:29,391 - src.training - INFO - 교차 검증 시작
2025-06-24 12:12:29,391 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:12:29,408 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:12:29,882 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:12:29,882 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:12:29,882 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:12:29,883 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:12:29,883 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:12:29,883 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:12:29,883 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:12:29,883 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:12:29,883 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:12:30,046 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:12:30,046 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:12:30,046 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:12:30,046 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:12:30,046 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:12:30,046 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:12:30,046 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:12:30,046 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:12:30,046 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:12:30,046 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:12:31,479 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:12:32,597 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:12:32,597 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:12:32,603 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:12:32,635 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:12:32,635 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:12:32,635 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:12:32,635 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:12:33,964 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:12:34,237 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:12:34,237 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:12:34,405 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:12:34,405 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:12:34,448 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:12:34,448 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:12:34,448 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:12:34,448 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:12:34,448 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:34,448 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:34,510 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:12:34,510 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:12:34,510 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:34,510 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:34,510 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:12:34,510 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:12:34,510 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:34,576 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:12:34,576 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:12:34,576 - src.training - INFO - 모델 학습 시작
2025-06-24 12:12:34,709 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:12:34,709 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:12:34,709 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:12:34,709 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:12:34,709 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:12:34,709 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:12:34,709 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:12:34,709 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:12:34,709 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:12:34,709 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:12:34,709 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:12:34,709 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:12:34,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:12:34,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:34,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:34,799 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:34,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:34,938 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:35,001 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:35,067 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:35,144 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:35,159 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:12:35,159 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:35,219 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:12:35,219 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:35,219 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:12:35,219 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:35,220 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:35,238 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:35,253 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:35,270 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:35,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:35,303 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:35,321 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:35,323 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:12:35,323 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:35,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:12:35,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:35,338 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:12:35,338 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:35,338 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:12:35,353 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   learning_rate: 0.011275047972698434
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:12:35,356 - src.models.lightgbm_model - INFO -   n_estimators: 415
2025-06-24 12:12:35,357 - src.models.lightgbm_model - INFO -   subsample: 0.9669236408061986
2025-06-24 12:12:35,357 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8191316566472541
2025-06-24 12:12:35,357 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:12:35,357 - src.models.lightgbm_model - INFO -   reg_alpha: 1.4050075975739774e-07
2025-06-24 12:12:35,357 - src.models.lightgbm_model - INFO -   reg_lambda: 5.2337540258041144e-08
2025-06-24 12:12:35,357 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:12:35,357 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:12:35,357 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:12:35,465 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:12:35,465 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.2018261621401009})})
2025-06-24 12:12:35,465 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:12:35,465 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:12:35,465 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:12:35,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:12:35,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:35,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:35,488 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:35,504 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:35,521 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:35,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:35,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:35,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:35,573 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:12:35,573 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:35,577 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:12:35,578 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:12:35,579 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:12:35,579 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:12:35,579 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:12:35,579 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:35,579 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:35,579 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:12:35,579 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:12:35,583 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:12:35,587 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:12:35,588 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00246553 0.12586291 0.05254944 0.40970142 0.01602507 0.01159462
 0.04256586 0.19919819 0.42880451 0.131557   0.0011549  0.0051351
 0.86921177 0.00115481 0.00115577 0.83166525 0.28915471 0.00115548
 0.47336044 0.55315834 0.90296745 0.47610012 0.15694863 0.00115528
 0.57003857 0.00322062 0.0011555  0.02480123 0.67994671 0.67752589
 0.79726556]
2025-06-24 12:12:35,588 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:12:36,418 - src.training - INFO -   precision: 0.0
2025-06-24 12:12:36,418 - src.training - INFO -   recall: 0.0
2025-06-24 12:12:36,418 - src.training - INFO -   f1: 0.0
2025-06-24 12:12:36,418 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:12:36,418 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:12:36,418 - src.training - INFO -   positive_samples: 270
2025-06-24 12:12:36,418 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:12:36,418 - src.training - INFO -   total_samples: 220940
2025-06-24 12:12:36,418 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:12:36,418 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:12:36,418 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:12:36,418 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:12:36,418 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:12:36,418 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:12:36,418 - src.training - INFO - 모델 학습 완료
2025-06-24 12:12:36,418 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:12:36,418 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:36,418 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:36,418 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:36,418 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:36,440 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:12:36,440 - src.hyperparameter_tuning - ERROR - Trial 40 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:12:36,905 - src.hyperparameter_tuning - INFO - Trial 41: 모델 타입 = lightgbm
2025-06-24 12:12:38,890 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:12:38,890 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:12:38,890 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:12:38,890 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:12:38,890 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:12:38,890 - src.training - INFO - 교차 검증 시작
2025-06-24 12:12:38,890 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:12:38,907 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:12:39,382 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:12:39,382 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:12:39,382 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:12:39,382 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:12:39,382 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:12:39,382 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:12:39,382 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:12:39,382 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:12:39,382 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:12:39,549 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:12:39,550 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:12:39,550 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:12:39,550 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:12:39,550 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:12:39,550 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:12:39,550 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:12:39,550 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:12:39,550 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:12:39,550 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:12:40,980 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:12:42,098 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:12:42,098 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:12:42,104 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:12:42,137 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:12:42,137 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:12:42,137 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:12:42,137 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:12:43,478 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:12:43,751 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:12:43,751 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:12:43,921 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:12:43,921 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:12:43,964 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:12:43,964 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:12:43,964 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:12:43,964 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:12:43,964 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:43,964 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:44,025 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:12:44,026 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:12:44,026 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:44,026 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:44,026 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:12:44,026 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:12:44,026 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:44,092 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:12:44,092 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:12:44,092 - src.training - INFO - 모델 학습 시작
2025-06-24 12:12:44,224 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:12:44,224 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:12:44,224 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:12:44,224 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:12:44,224 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:12:44,224 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:12:44,224 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:12:44,224 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:12:44,224 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:12:44,224 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:12:44,224 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:12:44,224 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:12:44,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:12:44,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:44,225 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:44,315 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:44,383 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:44,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:44,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:44,583 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:44,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:44,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:12:44,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:44,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:12:44,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:44,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:12:44,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:44,737 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:44,755 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:44,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:44,786 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:44,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:44,819 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:44,838 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:44,840 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:12:44,840 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:44,854 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:12:44,854 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:44,854 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:12:44,855 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:44,855 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:12:44,870 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   learning_rate: 0.14846867240458944
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:12:44,873 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:12:44,874 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:12:44,874 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:12:44,874 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:12:44,874 - src.models.lightgbm_model - INFO -   n_estimators: 191
2025-06-24 12:12:44,874 - src.models.lightgbm_model - INFO -   subsample: 0.8708929774415897
2025-06-24 12:12:44,874 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8343084327994883
2025-06-24 12:12:44,874 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:12:44,874 - src.models.lightgbm_model - INFO -   reg_alpha: 0.038025665102475424
2025-06-24 12:12:44,874 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0013016004347222215
2025-06-24 12:12:44,874 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:12:44,874 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:12:44,874 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:12:44,986 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:12:44,987 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.07381940827044955})})
2025-06-24 12:12:44,987 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:12:44,987 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:12:44,987 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:12:44,987 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:12:44,987 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:44,987 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:45,010 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:45,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:45,044 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:45,060 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:45,077 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:45,094 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:45,097 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:12:45,097 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:45,101 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:12:45,106 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:12:45,106 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:12:45,106 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:12:45,106 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:12:45,106 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:45,106 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:45,106 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:12:45,106 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:12:45,110 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:12:45,114 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:12:45,115 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [4.97083672e-002 0.00000000e+000 4.69352631e-135 4.68381646e-271
 3.41507999e-090 1.43057920e-304 8.37127578e-104 1.91613617e-103
 3.89430188e-258 1.22471876e-052 1.88158939e-243 4.48001119e-308
 1.59524781e-267 2.19094490e-140 6.26235973e-257 1.38687253e-261
 7.20326885e-263 2.13521893e-208 1.85820480e-290 1.88970040e-243
 3.08499342e-289 1.85022898e-290 5.17899205e-187 1.41662560e-237
 1.39301473e-284 1.47440595e-203 2.09172565e-097 4.09754765e-295
 4.11521104e-295 3.65202149e-042 1.03719111e-301 1.44983205e-250
 4.50249906e-181 1.22585662e-307 6.99800389e-286 9.99999999e-001
 1.38687425e-205 1.04239739e-174 1.22839789e-171 1.64178252e-014
 7.32536049e-216 1.33027399e-214 4.85068526e-048 1.00000000e+000
 3.73595249e-015 3.08499726e-233 3.45364948e-038 2.51699244e-205
 4.54536596e-283 6.36850344e-210 2.81275285e-009 1.17034240e-264
 1.17276860e-128 5.22829963e-289 3.11342930e-211 2.47504178e-252
 1.00000000e+000 1.88845761e-020 1.06025467e-307 1.00154698e-208
 1.33600843e-214 1.00000000e+000 1.59524980e-211 3.42991434e-013
 3.82963133e-039 2.52767337e-017 4.09755275e-239 4.12571589e-239
 1.77950067e-176 5.56481677e-019 1.54065038e-287 4.88402480e-048
 4.70080599e-210 9.03895167e-075 3.75205715e-015 4.55567825e-019
 4.57531652e-019]
2025-06-24 12:12:45,115 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:12:46,462 - src.training - INFO -   precision: 0.0
2025-06-24 12:12:46,463 - src.training - INFO -   recall: 0.0
2025-06-24 12:12:46,463 - src.training - INFO -   f1: 0.0
2025-06-24 12:12:46,463 - src.training - INFO -   accuracy: 0.9986647958721825
2025-06-24 12:12:46,463 - src.training - INFO -   balanced_accuracy: 0.49994335432999504
2025-06-24 12:12:46,463 - src.training - INFO -   positive_samples: 270
2025-06-24 12:12:46,463 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:12:46,463 - src.training - INFO -   total_samples: 220940
2025-06-24 12:12:46,463 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:12:46,463 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:12:46,463 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:12:46,463 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:12:46,463 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:12:46,463 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:12:46,463 - src.training - INFO - 모델 학습 완료
2025-06-24 12:12:46,463 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9986647958721825, 'balanced_accuracy': 0.49994335432999504, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:12:46,463 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:46,463 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:46,463 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:46,463 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:46,485 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:12:46,485 - src.hyperparameter_tuning - ERROR - Trial 41 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:12:46,943 - src.hyperparameter_tuning - INFO - Trial 42: 모델 타입 = lightgbm
2025-06-24 12:12:48,923 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:12:48,923 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:12:48,923 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:12:48,923 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:12:48,923 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:12:48,923 - src.training - INFO - 교차 검증 시작
2025-06-24 12:12:48,923 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:12:48,941 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:12:49,413 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:12:49,413 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:12:49,413 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:12:49,413 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:12:49,413 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:12:49,413 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:12:49,413 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:12:49,413 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:12:49,413 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:12:49,581 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:12:49,581 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:12:49,581 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:12:49,581 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:12:49,581 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:12:49,581 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:12:49,581 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:12:49,581 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:12:49,581 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:12:49,581 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:12:51,010 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:12:52,129 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:12:52,129 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:12:52,135 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:12:52,168 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:12:52,168 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:12:52,168 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:12:52,168 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:12:53,510 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:12:53,787 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:12:53,787 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:12:53,956 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:12:53,956 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:12:53,999 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:12:54,000 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:12:54,000 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:12:54,000 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:12:54,000 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:54,000 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:54,061 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:12:54,061 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:12:54,061 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:54,061 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:54,061 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:12:54,061 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:12:54,061 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:54,128 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:12:54,128 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:12:54,128 - src.training - INFO - 모델 학습 시작
2025-06-24 12:12:54,260 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:12:54,260 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:12:54,261 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:12:54,261 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:12:54,261 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:12:54,261 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:12:54,261 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:12:54,261 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:12:54,261 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:12:54,261 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:12:54,261 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:12:54,261 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:12:54,261 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:12:54,261 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:54,261 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:54,353 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:54,417 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:54,487 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:54,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:54,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:54,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:54,711 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:12:54,711 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:54,770 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:12:54,770 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:54,770 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:12:54,770 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:54,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:54,789 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:54,804 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:54,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:54,836 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:54,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:54,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:54,875 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:12:54,875 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:54,890 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:12:54,891 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:54,891 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:12:54,891 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:54,891 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:12:54,905 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   learning_rate: 0.2412867497654646
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   n_estimators: 106
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   subsample: 0.9782025922068486
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7164598832699864
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   reg_alpha: 0.036410500614397844
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO -   reg_lambda: 0.003168728953122613
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:12:54,908 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:12:54,989 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:12:54,989 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.04236450171234435})})
2025-06-24 12:12:54,989 - src.models.lightgbm_model - INFO -   - Best Iteration: 3
2025-06-24 12:12:54,989 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:12:54,989 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:12:54,989 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:12:54,989 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:54,990 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:12:55,009 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:12:55,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:12:55,042 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:12:55,058 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:12:55,075 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:12:55,092 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:12:55,095 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:12:55,095 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:55,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:12:55,100 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:12:55,100 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:12:55,100 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:12:55,100 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:12:55,100 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:55,100 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:12:55,100 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:12:55,100 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:12:55,104 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:12:55,108 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:12:55,109 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00000000e+000 6.62953503e-209 9.20142503e-130 2.68396107e-151
 9.75420851e-111 1.44624761e-051 3.34403578e-089 4.95817140e-030
 1.93376720e-230 1.83911535e-177 6.49232171e-237 1.00000000e+000
 4.59173447e-167 5.76930712e-010 9.20484167e-004]
2025-06-24 12:12:55,109 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:12:56,459 - src.training - INFO -   precision: 0.0
2025-06-24 12:12:56,459 - src.training - INFO -   recall: 0.0
2025-06-24 12:12:56,459 - src.training - INFO -   f1: 0.0
2025-06-24 12:12:56,459 - src.training - INFO -   accuracy: 0.9987734226486829
2025-06-24 12:12:56,459 - src.training - INFO -   balanced_accuracy: 0.4999977341731998
2025-06-24 12:12:56,459 - src.training - INFO -   positive_samples: 270
2025-06-24 12:12:56,459 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:12:56,459 - src.training - INFO -   total_samples: 220940
2025-06-24 12:12:56,459 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:12:56,459 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:12:56,459 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:12:56,459 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:12:56,459 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:12:56,459 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:12:56,459 - src.training - INFO - 모델 학습 완료
2025-06-24 12:12:56,459 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987734226486829, 'balanced_accuracy': 0.4999977341731998, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:12:56,459 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:56,459 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:56,459 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:12:56,459 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:12:56,481 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:12:56,481 - src.hyperparameter_tuning - ERROR - Trial 42 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:12:56,953 - src.hyperparameter_tuning - INFO - Trial 43: 모델 타입 = lightgbm
2025-06-24 12:12:58,898 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:12:58,899 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:12:58,899 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:12:58,899 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:12:58,899 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:12:58,899 - src.training - INFO - 교차 검증 시작
2025-06-24 12:12:58,899 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:12:58,915 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:12:59,355 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:12:59,355 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:12:59,355 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:12:59,355 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:12:59,355 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:12:59,355 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:12:59,355 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:12:59,355 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:12:59,355 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:12:59,532 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:12:59,532 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:12:59,532 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:12:59,532 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:12:59,532 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:12:59,532 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:12:59,532 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:12:59,532 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:12:59,532 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:12:59,532 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:13:00,828 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:13:01,832 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:13:01,832 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:13:01,838 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:13:01,869 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:13:01,869 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:13:01,869 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:13:01,869 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:13:03,086 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:13:03,335 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:13:03,335 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:13:03,495 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:13:03,496 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:13:03,536 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:13:03,536 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:13:03,536 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:13:03,536 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:13:03,536 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:03,536 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:03,593 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:13:03,593 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:13:03,593 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:03,593 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:03,593 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:13:03,593 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:13:03,593 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:03,651 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:13:03,651 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:13:03,651 - src.training - INFO - 모델 학습 시작
2025-06-24 12:13:03,778 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:13:03,778 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:13:03,778 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:13:03,778 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:13:03,778 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:13:03,778 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:13:03,778 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:13:03,778 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:13:03,778 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:13:03,778 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:13:03,778 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:13:03,778 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:13:03,778 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:13:03,778 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:03,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:03,857 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:03,911 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:03,969 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:04,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:04,085 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:04,158 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:04,175 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:13:04,175 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:04,252 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:13:04,252 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:04,252 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:13:04,252 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:04,252 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:04,270 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:04,284 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:04,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:04,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:04,326 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:04,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:04,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:13:04,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:04,362 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:13:04,362 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:04,362 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:13:04,362 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:04,362 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:13:04,375 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   learning_rate: 0.25509211387708103
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:13:04,378 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO -   n_estimators: 102
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO -   subsample: 0.9347795544485059
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7225612134262269
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO -   reg_alpha: 0.09307218475795079
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO -   reg_lambda: 4.574102204301514e-07
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:13:04,379 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:13:04,459 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:13:04,459 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.0423645014304019})})
2025-06-24 12:13:04,459 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:13:04,459 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:13:04,460 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:13:04,460 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:13:04,460 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:04,461 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:04,481 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:04,496 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:04,511 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:04,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:04,540 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:04,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:04,560 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:13:04,560 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:04,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:13:04,566 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:13:04,566 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:13:04,566 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:13:04,566 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:13:04,566 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:04,566 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:04,566 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:13:04,566 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:13:04,570 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:13:04,574 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:13:04,574 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00000000e+000 7.28948128e-224 4.64610675e-139 7.94086892e-162
 2.51643896e-118 8.45742055e-055 1.47233812e-095 4.94833488e-032
 1.24587786e-246 3.46001126e-190 4.84479353e-253 1.00000000e+000
 3.39888802e-179 2.38832135e-010 9.08037895e-004]
2025-06-24 12:13:04,575 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:13:05,775 - src.training - INFO -   precision: 0.0
2025-06-24 12:13:05,775 - src.training - INFO -   recall: 0.0
2025-06-24 12:13:05,775 - src.training - INFO -   f1: 0.0
2025-06-24 12:13:05,776 - src.training - INFO -   accuracy: 0.9987734226486829
2025-06-24 12:13:05,776 - src.training - INFO -   balanced_accuracy: 0.4999977341731998
2025-06-24 12:13:05,776 - src.training - INFO -   positive_samples: 270
2025-06-24 12:13:05,776 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:13:05,776 - src.training - INFO -   total_samples: 220940
2025-06-24 12:13:05,776 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:13:05,776 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:13:05,776 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:13:05,776 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:13:05,776 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:13:05,776 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:13:05,776 - src.training - INFO - 모델 학습 완료
2025-06-24 12:13:05,776 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987734226486829, 'balanced_accuracy': 0.4999977341731998, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:13:05,776 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:05,776 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:05,776 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:05,776 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:05,796 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:13:05,796 - src.hyperparameter_tuning - ERROR - Trial 43 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:13:06,249 - src.hyperparameter_tuning - INFO - Trial 44: 모델 타입 = lightgbm
2025-06-24 12:13:08,069 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:13:08,069 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:13:08,069 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:13:08,069 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:13:08,069 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:13:08,069 - src.training - INFO - 교차 검증 시작
2025-06-24 12:13:08,069 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:13:08,086 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:13:08,532 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:13:08,532 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:13:08,532 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:13:08,532 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:13:08,532 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:13:08,532 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:13:08,532 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:13:08,532 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:13:08,532 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:13:08,722 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:13:08,722 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:13:08,723 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:13:08,723 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:13:08,723 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:13:08,723 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:13:08,723 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:13:08,723 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:13:08,723 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:13:08,723 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:13:10,003 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:13:11,008 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:13:11,008 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:13:11,014 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:13:11,045 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:13:11,045 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:13:11,045 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:13:11,045 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:13:12,364 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:13:12,640 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:13:12,640 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:13:12,809 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:13:12,809 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:13:12,852 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:13:12,852 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:13:12,852 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:13:12,852 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:13:12,852 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:12,852 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:12,914 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:13:12,914 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:13:12,914 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:12,914 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:12,914 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:13:12,914 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:13:12,914 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:12,981 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:13:12,981 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:13:12,981 - src.training - INFO - 모델 학습 시작
2025-06-24 12:13:13,113 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:13:13,113 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:13:13,113 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:13:13,113 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:13:13,113 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:13:13,113 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:13:13,113 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:13:13,113 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:13:13,113 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:13:13,113 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:13:13,113 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:13:13,113 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:13:13,113 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:13:13,113 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:13,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:13,205 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:13,271 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:13,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:13,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:13,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:13,548 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:13,566 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:13:13,566 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:13,635 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:13:13,635 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:13,635 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:13:13,635 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:13,636 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:13,654 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:13,669 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:13,685 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:13,701 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:13,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:13,737 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:13,740 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:13:13,740 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:13,757 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:13:13,757 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:13,757 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:13:13,757 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:13,758 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:13:13,772 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   learning_rate: 0.07833496593122344
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   n_estimators: 138
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   subsample: 0.9809894888764809
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6152707077416952
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   reg_alpha: 1.5922221763803453e-08
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0012816940458560044
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:13:13,775 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:13:13,900 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:13:13,900 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 5.1840932903951975})})
2025-06-24 12:13:13,900 - src.models.lightgbm_model - INFO -   - Best Iteration: 4
2025-06-24 12:13:13,900 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:13:13,901 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:13:13,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:13:13,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:13,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:13,921 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:13,937 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:13,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:13,969 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:13,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:14,004 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:14,006 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:13:14,006 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:14,009 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:13:14,014 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:13:14,014 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:13:14,014 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:13:14,014 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:13:14,014 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:14,014 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:14,014 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:13:14,014 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:13:14,018 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:13:14,022 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:13:14,025 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [1.78956632e-001 9.99999799e-001 0.00000000e+000 9.65812892e-089
 5.84694983e-001 9.67180269e-040 2.99190040e-138 1.53188264e-047
 1.00000000e+000 2.50023725e-001 1.00000000e+000 6.15998637e-001
 1.37877506e-068 9.86358859e-047 2.91309069e-149 4.21141213e-042
 2.85644906e-142 8.35294777e-001 9.04164522e-062 4.35356257e-043
 6.03548193e-040 4.12952617e-035 4.72910854e-129 6.84766574e-052
 1.18626926e-039 1.00000000e+000 9.99999890e-001 5.78985031e-038
 4.43989103e-050 9.45872372e-138 4.49854002e-243 5.55753816e-001
 4.32534617e-031 8.92438259e-031 2.29857589e-251 4.07960320e-001
 3.05768566e-039 6.88703893e-088 6.33354764e-082 5.98131523e-004
 1.16146425e-142 4.35891928e-068 9.57118125e-135 9.03050197e-142
 1.92326969e-026 9.99953156e-001 3.05336277e-088 1.65808300e-122
 1.88851741e-003 1.00000000e+000 5.14006048e-221 2.39616763e-236
 1.31454428e-236 1.97814504e-241 2.48061592e-010 2.35435211e-010
 5.40569119e-078 3.64247045e-002 9.20957127e-149 8.82903609e-045
 6.15516182e-047 1.23721548e-027 9.99423733e-001 9.99999997e-001
 6.45545318e-004 2.03167430e-002 3.11831769e-046 4.45776633e-050
 1.35082858e-129 3.27379558e-065 1.58140884e-009 3.46348942e-002
 1.22399729e-041 7.29604707e-005 8.67833023e-001 7.49408123e-075
 1.00000000e+000 9.99999991e-001 4.41014036e-064 2.95002456e-236
 2.17729836e-087 3.02420707e-019 1.42673096e-001 3.52233409e-007
 9.99851920e-001 3.65030039e-282 1.74666741e-002 6.22630707e-001
 3.54491051e-071 6.23646877e-240 1.41823878e-158 4.91060328e-174
 9.99999937e-001 1.41497541e-005 2.24703950e-262 1.52516744e-107
 1.03499194e-064 2.67742098e-015 2.37541229e-242 3.11514216e-259
 4.82427568e-108 6.17994291e-047 6.65706026e-197 9.99995193e-001
 2.03494882e-007 1.78311876e-009 3.50722919e-181 9.99999990e-001
 9.99999966e-001 9.99999982e-001 2.92812493e-291 1.23822127e-057
 3.26668270e-179 5.06193915e-161 2.70016530e-097 9.98048438e-001
 1.74171969e-005 6.70448032e-155 3.71647764e-050 3.15017883e-013
 5.99636464e-028 1.00000000e+000 1.00000000e+000 9.97840961e-001
 9.20893853e-111 1.72188625e-174 3.06616046e-009 9.99999590e-001
 3.18658869e-248 1.28356377e-168 1.77941208e-071 7.45046315e-176
 2.21942565e-164 3.74332483e-094 6.11391751e-061 2.75135710e-009
 4.66670833e-030 6.39346115e-002 3.17478278e-005 8.38228244e-188
 1.77584998e-001 4.04778512e-009 2.93767321e-024 2.15307189e-177
 4.15585730e-236 9.33158015e-212 9.87852700e-001 1.00000000e+000
 5.63722896e-009 9.99998702e-001 1.34410664e-300 7.14755545e-070
 6.15283100e-002 7.57534829e-236 1.22881497e-056 2.29324860e-085
 7.24997561e-085 1.06750204e-001 1.00000000e+000 9.99999965e-001
 1.80008267e-077 2.81985158e-221 4.38767111e-195 1.48080165e-236
 3.66638786e-169 5.35540650e-028 7.89165969e-009 5.83841427e-039
 8.91480112e-221 1.18458434e-064 3.25857907e-154 4.52289116e-182
 9.96125495e-001 1.00000000e+000 8.09598159e-019 6.46942032e-008
 1.13505272e-014 2.85595236e-005 5.50614090e-005 5.49974563e-060
 6.43337263e-007 9.71210611e-065 9.99999983e-001 1.01870121e-001
 2.00357010e-257 3.39229327e-217 9.61583336e-018 1.00000000e+000
 9.99999943e-001 1.00000000e+000 9.99999632e-001 8.46898286e-016
 1.91039757e-179 3.83434921e-006 2.65469816e-026 9.99999999e-001
 8.91699523e-001 2.04527032e-007 9.99999989e-001 1.41309568e-055
 2.18865813e-204 2.29099614e-014 7.49232927e-073 8.16543974e-001
 4.04815533e-158 2.85542877e-132 4.86406100e-006 8.15700714e-068
 1.33847718e-215 9.23187172e-006 2.66789611e-007 3.10451843e-177
 2.11902617e-027 9.99999931e-001 1.93962732e-001 2.19585948e-023
 7.23337317e-003 4.70351653e-008 9.80029153e-001 9.86896500e-220
 3.02201278e-185 6.18999124e-001 9.99621283e-001 6.08108635e-004
 9.99730200e-001 1.00000000e+000 4.62298174e-195 4.04397658e-038
 7.01407814e-197 7.11293234e-019 1.29949012e-193 5.37311784e-004
 6.86577839e-002 2.85072579e-003 9.60498506e-001 5.69766174e-197
 6.25462463e-001 1.68249640e-052 5.26150917e-067 4.40842483e-195
 7.86822299e-179 8.22515318e-008 9.75710934e-001 9.98763837e-001
 1.00000000e+000 1.29475109e-005 9.09031139e-068 9.93751240e-001
 6.16234062e-201 9.99995077e-001 3.46442011e-003 1.00362073e-004
 2.54676458e-014 2.19561182e-023 3.83127389e-005 1.03433255e-052
 1.27679738e-022 9.99951583e-001 1.76849665e-002 2.23400011e-006
 1.00000000e+000 3.60634866e-011 3.52861896e-186 6.70190068e-024
 9.90548799e-001 1.00000000e+000 1.19237779e-183 1.73081790e-002
 3.69000952e-154 4.21923453e-001 1.00000000e+000 2.75843943e-020
 9.81506666e-001 9.99999665e-001 1.42601445e-011 9.99963678e-001
 3.16080515e-023 8.89819348e-009 9.99999910e-001 2.87795014e-011
 4.52662369e-014 2.34626483e-023 3.99343450e-190 9.14480271e-001
 3.13374291e-202 1.58603848e-187 3.24534000e-006 2.64177479e-003
 9.99966538e-001 3.82251112e-220 2.52701520e-004 2.52716138e-014
 3.33919685e-191 9.99351352e-001 2.24871328e-018 4.16185039e-002
 1.40510849e-011 1.00000000e+000 5.12732165e-192 1.55698205e-019
 1.00000000e+000 9.99999994e-001 4.27921089e-249 1.74756503e-017
 2.50795324e-199 7.31660452e-001 3.40252979e-216 9.99999225e-001
 9.99997230e-001 5.72489316e-032 9.99999999e-001 2.45987227e-205
 1.21285084e-006 2.07781735e-227 1.33846531e-061 3.22600460e-193
 7.18540940e-191 9.35161178e-031 9.99591255e-001 6.42622648e-197
 5.72052480e-197 7.60413695e-011 4.27880727e-020 1.62500102e-220
 1.04325395e-181 9.84097071e-023 1.73940623e-193 2.65109679e-014
 3.39481765e-185 1.00000000e+000 9.12302054e-002 4.47945691e-207
 4.09384521e-256 2.57924994e-035 4.84296024e-047 3.96416374e-190
 9.25751900e-022 2.78140993e-029 3.88289388e-021 1.86284841e-034
 9.59496762e-192 3.68190664e-210 2.01769197e-072 7.67772082e-006
 5.90914979e-012 1.29851464e-044 2.59457716e-006 1.30446452e-203
 1.00000000e+000 1.97194119e-003 1.69058718e-024 3.67282337e-200
 6.97652962e-001 1.06462279e-023 1.40582350e-194 2.00809458e-010
 6.92297114e-205 3.06223635e-004 1.00000000e+000 1.00000000e+000
 9.99999999e-001 6.73955403e-005 2.33348431e-188 1.37784676e-032
 7.34605531e-199 2.22416358e-067 1.98335476e-006 1.01734700e-052
 1.76713547e-017 1.56634319e-024 4.33760610e-001]
2025-06-24 12:13:14,025 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:13:15,405 - src.training - INFO -   precision: 0.0026335781210433023
2025-06-24 12:13:15,405 - src.training - INFO -   recall: 0.1925925925925926
2025-06-24 12:13:15,405 - src.training - INFO -   f1: 0.005196102922807894
2025-06-24 12:13:15,405 - src.training - INFO -   accuracy: 0.9098805105458495
2025-06-24 12:13:15,405 - src.training - INFO -   balanced_accuracy: 0.5516753691199696
2025-06-24 12:13:15,405 - src.training - INFO -   positive_samples: 270
2025-06-24 12:13:15,405 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:13:15,405 - src.training - INFO -   total_samples: 220940
2025-06-24 12:13:15,405 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:13:15,405 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:13:15,405 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:13:15,405 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:13:15,405 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:13:15,405 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:13:15,405 - src.training - INFO - 모델 학습 완료
2025-06-24 12:13:15,405 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0026335781210433023, 'recall': 0.1925925925925926, 'f1': 0.005196102922807894, 'accuracy': 0.9098805105458495, 'balanced_accuracy': 0.5516753691199696, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:13:15,405 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:15,405 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:15,405 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:15,405 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:15,425 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:13:15,425 - src.hyperparameter_tuning - ERROR - Trial 44 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:13:15,896 - src.hyperparameter_tuning - INFO - Trial 45: 모델 타입 = lightgbm
2025-06-24 12:13:17,867 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:13:17,867 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:13:17,867 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:13:17,867 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:13:17,867 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:13:17,867 - src.training - INFO - 교차 검증 시작
2025-06-24 12:13:17,867 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:13:17,884 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:13:18,358 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:13:18,358 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:13:18,359 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:13:18,359 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:13:18,359 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:13:18,359 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:13:18,359 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:13:18,359 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:13:18,359 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:13:18,534 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:13:18,534 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:13:18,534 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:13:18,534 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:13:18,534 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:13:18,534 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:13:18,534 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:13:18,534 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:13:18,534 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:13:18,534 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:13:19,963 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:13:21,079 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:13:21,079 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:13:21,085 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:13:21,118 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:13:21,118 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:13:21,118 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:13:21,118 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:13:22,442 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:13:22,729 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:13:22,729 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:13:22,892 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:13:22,892 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:13:22,933 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:13:22,933 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:13:22,933 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:13:22,933 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:13:22,933 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:22,933 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:22,990 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:13:22,990 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:13:22,990 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:22,990 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:22,990 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:13:22,990 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:13:22,991 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:23,048 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:13:23,048 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:13:23,049 - src.training - INFO - 모델 학습 시작
2025-06-24 12:13:23,176 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:13:23,176 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:13:23,176 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:13:23,176 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:13:23,176 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:13:23,176 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:13:23,176 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:13:23,176 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:13:23,176 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:13:23,176 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:13:23,176 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:13:23,176 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:13:23,176 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:13:23,176 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:23,177 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:23,255 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:23,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:23,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:23,424 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:23,482 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:23,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:23,571 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:13:23,571 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:23,646 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:13:23,646 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:23,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:13:23,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:23,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:23,675 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:23,689 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:23,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:23,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:23,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:23,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:23,750 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:13:23,750 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:23,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:13:23,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:23,767 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:13:23,767 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:23,767 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:13:23,781 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:13:23,784 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   learning_rate: 0.27530905857751087
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   n_estimators: 586
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   subsample: 0.8681307862883496
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6944908837064435
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   reg_alpha: 0.8680387619861649
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO -   reg_lambda: 1.4638647501485204e-05
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:13:23,785 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:13:23,876 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:13:23,876 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.04236450102439964})})
2025-06-24 12:13:23,876 - src.models.lightgbm_model - INFO -   - Best Iteration: 4
2025-06-24 12:13:23,876 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:13:23,877 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:13:23,877 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:13:23,877 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:23,878 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:23,895 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:23,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:23,925 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:23,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:23,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:23,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:23,974 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:13:23,974 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:23,978 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:13:23,980 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:13:23,980 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:13:23,980 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:13:23,980 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:13:23,980 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:23,980 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:23,980 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:13:23,980 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:13:23,984 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:13:23,988 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:13:23,988 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00000000e+000 1.76175727e-246 3.91851787e-153 1.05079633e-177
 9.28574749e-130 1.23335130e-059 3.46274215e-105 4.59928245e-035
 4.72435787e-271 2.03306752e-209 2.97142855e-277 1.00000000e+000
 1.48452068e-197 6.50322520e-011 8.90114014e-004]
2025-06-24 12:13:23,988 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:13:25,330 - src.training - INFO -   precision: 0.0
2025-06-24 12:13:25,330 - src.training - INFO -   recall: 0.0
2025-06-24 12:13:25,330 - src.training - INFO -   f1: 0.0
2025-06-24 12:13:25,330 - src.training - INFO -   accuracy: 0.9987734226486829
2025-06-24 12:13:25,330 - src.training - INFO -   balanced_accuracy: 0.4999977341731998
2025-06-24 12:13:25,330 - src.training - INFO -   positive_samples: 270
2025-06-24 12:13:25,330 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:13:25,330 - src.training - INFO -   total_samples: 220940
2025-06-24 12:13:25,330 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:13:25,330 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:13:25,330 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:13:25,330 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:13:25,332 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:13:25,332 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:13:25,332 - src.training - INFO - 모델 학습 완료
2025-06-24 12:13:25,332 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987734226486829, 'balanced_accuracy': 0.4999977341731998, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:13:25,332 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:25,332 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:25,332 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:25,332 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:25,351 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:13:25,352 - src.hyperparameter_tuning - ERROR - Trial 45 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:13:25,824 - src.hyperparameter_tuning - INFO - Trial 46: 모델 타입 = lightgbm
2025-06-24 12:13:27,790 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:13:27,790 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:13:27,790 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:13:27,790 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:13:27,790 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:13:27,790 - src.training - INFO - 교차 검증 시작
2025-06-24 12:13:27,790 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:13:27,807 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:13:28,283 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:13:28,283 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:13:28,283 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:13:28,283 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:13:28,283 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:13:28,283 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:13:28,283 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:13:28,283 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:13:28,283 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:13:28,459 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:13:28,459 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:13:28,459 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:13:28,459 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:13:28,459 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:13:28,459 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:13:28,459 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:13:28,459 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:13:28,459 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:13:28,459 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:13:29,885 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:13:31,004 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:13:31,004 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:13:31,010 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:13:31,043 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:13:31,043 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:13:31,043 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:13:31,043 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:13:32,374 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:13:32,648 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:13:32,648 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:13:32,817 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:13:32,817 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:13:32,860 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:13:32,860 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:13:32,860 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:13:32,860 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:13:32,860 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:32,860 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:32,921 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:13:32,921 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:13:32,921 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:32,921 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:32,921 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:13:32,921 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:13:32,921 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:32,987 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:13:32,987 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:13:32,987 - src.training - INFO - 모델 학습 시작
2025-06-24 12:13:33,119 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:13:33,119 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:13:33,119 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:13:33,119 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:13:33,119 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:13:33,119 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:13:33,119 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:13:33,119 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:13:33,119 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:13:33,119 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:13:33,119 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:13:33,119 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:13:33,119 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:13:33,119 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:33,119 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:33,212 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:33,275 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:33,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:33,412 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:33,478 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:33,555 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:33,570 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:13:33,570 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:33,629 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:13:33,629 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:33,629 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:13:33,629 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:33,630 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:33,648 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:33,663 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:33,680 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:33,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:33,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:33,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:33,734 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:13:33,734 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:33,750 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:13:33,750 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:33,750 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:13:33,750 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:33,750 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:13:33,764 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:13:33,767 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:13:33,767 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   learning_rate: 0.018613904894262213
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   n_estimators: 679
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   subsample: 0.8397731563837441
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7847955924362217
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00028346613819381497
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO -   reg_lambda: 4.625234997700745e-08
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:13:33,768 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:13:37,998 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:13:37,999 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.38651913973113844})})
2025-06-24 12:13:37,999 - src.models.lightgbm_model - INFO -   - Best Iteration: 679
2025-06-24 12:13:37,999 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:13:37,999 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:13:37,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:13:37,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:37,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:38,019 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:38,035 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:38,053 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:38,069 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:38,086 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:38,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:38,107 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:13:38,107 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:38,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:13:38,317 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:13:38,317 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:13:38,317 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:13:38,317 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:13:38,317 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:38,317 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:38,317 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:13:38,317 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:13:38,321 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:13:38,325 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:13:38,329 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.03025976 0.01217524 0.00638745 ... 0.00830723 0.00453797 0.00751393]
2025-06-24 12:13:38,329 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:13:39,189 - src.training - INFO -   precision: 0.0
2025-06-24 12:13:39,189 - src.training - INFO -   recall: 0.0
2025-06-24 12:13:39,189 - src.training - INFO -   f1: 0.0
2025-06-24 12:13:39,189 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:13:39,189 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:13:39,189 - src.training - INFO -   positive_samples: 270
2025-06-24 12:13:39,189 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:13:39,189 - src.training - INFO -   total_samples: 220940
2025-06-24 12:13:39,189 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:13:39,189 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:13:39,189 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:13:39,189 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:13:39,189 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:13:39,189 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:13:39,189 - src.training - INFO - 모델 학습 완료
2025-06-24 12:13:39,189 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:13:39,189 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:39,189 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:39,189 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:39,189 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:39,211 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:13:39,212 - src.hyperparameter_tuning - ERROR - Trial 46 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:13:39,669 - src.hyperparameter_tuning - INFO - Trial 47: 모델 타입 = lightgbm
2025-06-24 12:13:41,624 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:13:41,624 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:13:41,624 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:13:41,624 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:13:41,625 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:13:41,625 - src.training - INFO - 교차 검증 시작
2025-06-24 12:13:41,625 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:13:41,642 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:13:42,118 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:13:42,118 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:13:42,118 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:13:42,118 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:13:42,118 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:13:42,118 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:13:42,118 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:13:42,119 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:13:42,119 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:13:42,280 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:13:42,280 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:13:42,280 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:13:42,280 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:13:42,280 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:13:42,280 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:13:42,280 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:13:42,280 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:13:42,280 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:13:42,280 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:13:43,697 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:13:44,808 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:13:44,808 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:13:44,814 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:13:44,847 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:13:44,847 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:13:44,847 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:13:44,847 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:13:46,171 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:13:46,444 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:13:46,444 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:13:46,612 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:13:46,613 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:13:46,656 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:13:46,656 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:13:46,656 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:13:46,656 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:13:46,656 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:46,656 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:46,717 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:13:46,718 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:13:46,718 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:46,718 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:46,718 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:13:46,718 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:13:46,718 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:46,782 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:13:46,782 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:13:46,782 - src.training - INFO - 모델 학습 시작
2025-06-24 12:13:46,914 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:13:46,915 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:13:46,915 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:13:46,915 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:13:46,915 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:13:46,915 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:13:46,915 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:13:46,915 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:13:46,915 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:13:46,915 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:13:46,915 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:13:46,915 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:13:46,915 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:13:46,915 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:46,915 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:47,006 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:47,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:47,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:47,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:47,273 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:47,350 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:47,365 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:13:47,365 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:47,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:13:47,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:47,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:13:47,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:47,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:47,444 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:47,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:47,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:47,490 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:47,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:47,526 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:47,529 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:13:47,529 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:47,544 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:13:47,544 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:47,544 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:13:47,545 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:47,545 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:13:47,560 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   learning_rate: 0.1157664679474774
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   n_estimators: 229
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   subsample: 0.8590432620885792
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7095581332466844
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   reg_alpha: 9.362299125893935e-06
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO -   reg_lambda: 4.299262614105582e-06
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:13:47,563 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:13:47,684 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:13:47,684 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 1.6359703809333332})})
2025-06-24 12:13:47,684 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:13:47,684 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:13:47,685 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:13:47,685 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:13:47,685 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:47,685 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:47,704 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:47,721 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:47,738 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:47,754 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:47,771 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:47,789 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:47,791 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:13:47,791 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:47,795 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:13:47,796 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:13:47,796 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:13:47,796 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:13:47,796 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:13:47,796 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:47,796 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:47,796 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:13:47,796 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:13:47,800 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:13:47,804 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:13:47,806 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [7.23090009e-001 2.18047413e-003 9.99999501e-001 0.00000000e+000
 2.27610934e-149 5.80657682e-018 1.07160072e-089 6.75649141e-015
 8.87252929e-001 5.69092999e-010 9.99998491e-001 9.99999704e-001
 9.99999998e-001 3.31491336e-206 5.06103912e-050 7.52336236e-008
 3.11036304e-138 2.23003242e-116 4.56034283e-237 3.84532006e-247
 1.00000000e+000 2.35488106e-060 5.36330381e-269 1.99550855e-128
 4.98611489e-100 1.72980424e-032 8.09332195e-007 2.32497639e-293
 2.69934329e-139 3.24047693e-267 2.79070925e-002 6.66591044e-145
 4.62021908e-180 3.16471959e-107 3.66730381e-003 4.61255542e-002
 2.97375436e-262 4.38028184e-107 9.99997213e-001 5.66359602e-082
 9.99999964e-001 2.96568745e-002 6.16569849e-016 3.36617769e-019
 8.85430589e-024 4.23993041e-175 2.34870085e-011 2.15054435e-021
 3.54263621e-107 2.56229519e-020 2.17191414e-111 6.13135533e-052
 3.44736268e-016 8.83673058e-024 8.67870918e-013 6.80364143e-178
 3.24149582e-082 1.56319518e-036 2.33354615e-271 3.69349110e-117
 8.36800207e-097 1.38656530e-101 1.04948658e-131 1.60798429e-033
 6.17796140e-016 6.72641624e-025 1.14942540e-275 7.60209997e-039
 5.32253736e-009 2.89012144e-034 2.15764388e-115 2.41934644e-031
 1.13193987e-005 7.62830505e-017 1.00000000e+000 9.76489286e-037
 9.48980719e-024 9.92530869e-001 3.74510474e-242 2.21679021e-144
 2.08560546e-108 7.58701022e-039 1.08200164e-152 3.71235926e-032
 3.86132892e-090 4.42813531e-014 2.86489303e-001 1.01319087e-070
 3.64718516e-106 5.33601511e-054 2.49659021e-028 6.68664199e-056
 2.84016616e-024 2.52993863e-132 2.02827658e-049 7.97588633e-038
 1.75883685e-060 2.03465948e-072 9.22513534e-050 1.65390748e-083
 1.10404139e-145 1.66355843e-062 1.51331391e-151 2.53718670e-024
 6.64147532e-137 6.70870925e-014 5.35479237e-133 1.19064458e-272
 2.62560107e-295 4.52758923e-107 7.73395894e-068 4.48922891e-151
 1.41707348e-069 1.18083505e-155 1.48609556e-062 3.92946370e-052
 1.18801381e-087 9.98185498e-291 1.77653886e-144 1.26869766e-169
 3.01773341e-114 1.58702362e-144]
2025-06-24 12:13:47,806 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:13:48,659 - src.training - INFO -   precision: 0.0
2025-06-24 12:13:48,660 - src.training - INFO -   recall: 0.0
2025-06-24 12:13:48,660 - src.training - INFO -   f1: 0.0
2025-06-24 12:13:48,660 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:13:48,660 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:13:48,660 - src.training - INFO -   positive_samples: 270
2025-06-24 12:13:48,660 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:13:48,660 - src.training - INFO -   total_samples: 220940
2025-06-24 12:13:48,660 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:13:48,660 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:13:48,660 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:13:48,660 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:13:48,660 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:13:48,660 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:13:48,660 - src.training - INFO - 모델 학습 완료
2025-06-24 12:13:48,660 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:13:48,660 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:48,660 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:48,660 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:48,660 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:48,681 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:13:48,682 - src.hyperparameter_tuning - ERROR - Trial 47 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:13:49,155 - src.hyperparameter_tuning - INFO - Trial 48: 모델 타입 = lightgbm
2025-06-24 12:13:51,134 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:13:51,134 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:13:51,134 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:13:51,134 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:13:51,134 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:13:51,134 - src.training - INFO - 교차 검증 시작
2025-06-24 12:13:51,134 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:13:51,151 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:13:51,626 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:13:51,626 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:13:51,627 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:13:51,627 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:13:51,627 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:13:51,627 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:13:51,627 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:13:51,627 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:13:51,627 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:13:51,791 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:13:51,791 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:13:51,791 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:13:51,791 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:13:51,791 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:13:51,791 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:13:51,791 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:13:51,791 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:13:51,791 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:13:51,791 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:13:53,209 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:13:54,326 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:13:54,326 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:13:54,332 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:13:54,364 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:13:54,365 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:13:54,365 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:13:54,365 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:13:55,681 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:13:55,955 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:13:55,955 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:13:56,124 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:13:56,124 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:13:56,167 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:13:56,167 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:13:56,167 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:13:56,167 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:13:56,167 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:56,167 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:56,231 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:13:56,232 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:13:56,232 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:56,232 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:56,232 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:13:56,232 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:13:56,232 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:56,291 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:13:56,291 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:13:56,291 - src.training - INFO - 모델 학습 시작
2025-06-24 12:13:56,419 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:13:56,419 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:13:56,419 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:13:56,419 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:13:56,419 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:13:56,419 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:13:56,419 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:13:56,419 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:13:56,419 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:13:56,419 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:13:56,419 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:13:56,419 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:13:56,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:13:56,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:56,420 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:56,500 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:56,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:56,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:56,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:56,732 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:56,804 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:56,820 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:13:56,820 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:56,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:13:56,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:56,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:13:56,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:56,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:56,898 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:56,913 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:56,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:56,946 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:56,964 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:56,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:56,986 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:13:56,986 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:57,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:13:57,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:57,002 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:13:57,002 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:57,002 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:13:57,017 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   learning_rate: 0.04501141750765259
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:13:57,020 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   n_estimators: 491
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   subsample: 0.7686789648690272
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.938230383948912
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   reg_alpha: 1.9222588699778864e-07
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0003774952037839346
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:13:57,021 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:13:57,136 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:13:57,136 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 2.2608417269767713})})
2025-06-24 12:13:57,136 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:13:57,136 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:13:57,137 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:13:57,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:13:57,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:57,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:13:57,159 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:13:57,175 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:13:57,192 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:13:57,208 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:13:57,226 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:13:57,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:13:57,246 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:13:57,247 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:57,250 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:13:57,252 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:13:57,252 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:13:57,252 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:13:57,252 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:13:57,252 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:57,252 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:13:57,252 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:13:57,252 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:13:57,256 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:13:57,260 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:13:57,261 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [1.01133992e-002 1.65257868e-002 9.92312833e-001 9.99714297e-001
 9.99999956e-001 9.99999956e-001 3.65243545e-001 1.16238004e-032
 9.99893396e-001 8.75454895e-001 2.01517744e-105 2.81078675e-032
 1.21783776e-002 5.15870649e-003 2.23026686e-008 9.08814867e-001
 1.00000000e+000 1.84786970e-004 1.12265487e-003 9.99250362e-001
 1.70816247e-024 3.22618948e-180 1.38564146e-001 6.31324913e-095
 1.01071685e-169 6.14859979e-001 1.24635977e-006 2.50640320e-093
 2.57710928e-229 3.24954743e-233 4.01261519e-168 9.87788066e-001
 9.99999999e-001 9.99999999e-001 7.51014596e-005 1.88316296e-004
 5.31983942e-026 3.39380125e-022 0.00000000e+000 5.81231400e-004
 1.61692007e-024 5.55787506e-053 5.94284657e-091 8.23925357e-004
 1.67491225e-050 5.92606250e-033 3.16805137e-051 1.12089875e-033
 9.99999999e-001 1.76248593e-089 2.22236662e-093 2.02269917e-105
 6.17771123e-001 6.82888756e-004 5.48773875e-148 2.35268745e-031
 3.97461123e-115 5.75313904e-113 1.28266858e-026 2.73666805e-001
 4.03838753e-051 8.68963818e-231 3.01707215e-009 1.00266081e-013
 1.19959688e-009 9.99999997e-001 3.23873339e-003 5.71527952e-012
 1.73157267e-095 1.60477341e-089 9.99999999e-001 3.02160242e-011
 2.29403109e-104 1.44912838e-114 1.82100086e-150 9.99906286e-001
 2.95759343e-245 2.53190786e-235 9.99975942e-001 2.34650182e-229
 7.61230221e-107 8.54847008e-024 9.10746076e-103 2.11201273e-024
 2.15943875e-100 9.99981494e-001 1.96645018e-035 2.83664584e-026
 3.48261776e-053 6.28276868e-014 6.29197653e-105 8.07536345e-103
 5.53114742e-105 9.96962113e-001 1.42883527e-033 3.63114854e-006
 4.80865459e-117 1.23219652e-035 1.10614554e-028 5.10116815e-113
 2.48983298e-002 1.36410705e-110 3.78309671e-008 6.40430538e-099
 4.04556882e-109 3.00920084e-022 5.57837644e-029 2.38649829e-018
 1.65045542e-032 3.00016863e-001 4.33909797e-105 8.60231653e-004
 2.34464011e-024 1.62537667e-033 8.04692561e-020 1.00623329e-026
 2.74098726e-115 3.23375759e-059 3.03503920e-010 1.02710283e-034
 2.08607061e-031 3.68355919e-109 1.14414648e-041 4.59388218e-051
 9.99932024e-001 1.77746946e-026 1.73000649e-008 5.89596418e-049
 5.83381592e-020 3.01314903e-117 6.16587304e-004 1.32315086e-148
 1.03799099e-148 4.76994148e-107 1.55402386e-005 2.17866992e-146
 5.15681001e-008 1.14105658e-150 1.65439405e-027 2.93943128e-006
 1.50515499e-148 5.46751136e-004 4.25748229e-045 8.12680610e-001
 7.38911603e-001 1.53202609e-142 4.26236243e-006]
2025-06-24 12:13:57,262 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:13:58,116 - src.training - INFO -   precision: 0.0
2025-06-24 12:13:58,116 - src.training - INFO -   recall: 0.0
2025-06-24 12:13:58,116 - src.training - INFO -   f1: 0.0
2025-06-24 12:13:58,116 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:13:58,116 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:13:58,116 - src.training - INFO -   positive_samples: 270
2025-06-24 12:13:58,116 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:13:58,116 - src.training - INFO -   total_samples: 220940
2025-06-24 12:13:58,116 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:13:58,116 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:13:58,116 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:13:58,116 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:13:58,116 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:13:58,116 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:13:58,116 - src.training - INFO - 모델 학습 완료
2025-06-24 12:13:58,116 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:13:58,116 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:58,116 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:58,116 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:13:58,116 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:13:58,138 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:13:58,138 - src.hyperparameter_tuning - ERROR - Trial 48 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:13:58,605 - src.hyperparameter_tuning - INFO - Trial 49: 모델 타입 = lightgbm
2025-06-24 12:14:00,593 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:14:00,593 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:14:00,593 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:14:00,593 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:14:00,593 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:14:00,593 - src.training - INFO - 교차 검증 시작
2025-06-24 12:14:00,593 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:14:00,611 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:14:01,085 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:14:01,085 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:14:01,085 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:14:01,085 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:14:01,085 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:14:01,085 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:14:01,085 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:14:01,085 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:14:01,085 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:14:01,247 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:14:01,247 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:14:01,247 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:14:01,247 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:14:01,247 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:14:01,247 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:14:01,247 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:14:01,247 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:14:01,247 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:14:01,247 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:14:02,678 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:14:03,790 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:14:03,790 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:14:03,797 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:14:03,829 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:14:03,829 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:14:03,829 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:14:03,829 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:14:05,166 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:14:05,439 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:14:05,439 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:14:05,608 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:14:05,608 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:14:05,651 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:14:05,651 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:14:05,651 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:14:05,651 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:14:05,651 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:05,651 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:05,713 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:14:05,713 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:14:05,713 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:05,713 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:05,713 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:14:05,713 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:14:05,713 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:05,779 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:14:05,779 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:14:05,779 - src.training - INFO - 모델 학습 시작
2025-06-24 12:14:05,911 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:14:05,911 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:14:05,911 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:14:05,911 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:14:05,911 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:14:05,911 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:14:05,911 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:14:05,911 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:14:05,911 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:14:05,911 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:14:05,911 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:14:05,911 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:14:05,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:14:05,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:05,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:06,004 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:06,070 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:06,139 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:06,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:06,270 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:06,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:06,363 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:14:06,363 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:06,423 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:14:06,423 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:06,423 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:14:06,423 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:06,423 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:06,441 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:06,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:06,473 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:06,489 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:06,506 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:06,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:06,527 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:14:06,527 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:06,543 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:14:06,543 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:06,543 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:14:06,543 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:06,543 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:14:06,558 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   learning_rate: 0.04456142083634507
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   n_estimators: 501
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   subsample: 0.6712272117787375
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9018775086353922
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   reg_alpha: 4.064788428993522e-07
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO -   reg_lambda: 2.000138432123276e-06
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:14:06,561 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:14:06,670 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:14:06,670 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 2.4493744206886956})})
2025-06-24 12:14:06,670 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:14:06,670 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:14:06,670 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:14:06,670 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:14:06,670 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:06,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:06,693 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:06,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:06,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:06,741 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:06,758 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:06,775 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:06,777 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:14:06,777 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:06,781 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:14:06,783 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:14:06,783 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:14:06,783 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:14:06,783 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:14:06,783 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:06,783 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:06,783 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:14:06,783 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:14:06,787 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:14:06,791 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:14:06,793 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [2.35097392e-002 9.98286749e-001 9.99758719e-001 9.99999989e-001
 3.33668897e-001 8.99294837e-001 9.99421873e-001 9.97789937e-001
 9.99971854e-001 9.98108665e-001 2.01070517e-082 9.99699027e-001
 1.89342491e-002 2.55838565e-002 2.58230907e-001 1.00000000e+000
 9.40353831e-004 7.53949745e-004 1.00000000e+000 8.77428055e-001
 6.14885416e-002 1.00000000e+000 3.37215030e-178 9.99999986e-001
 2.18180551e-001 9.99278907e-001 2.32757590e-072 3.90357367e-168
 9.42503590e-004 7.91079695e-014 1.13151907e-101 1.39121898e-103
 1.89308553e-070 2.41112281e-101 9.99998819e-001 7.86695080e-014
 3.17489059e-166 9.99998226e-001 9.99378721e-001 2.26383688e-006
 2.72779960e-007 3.05515732e-006 1.20182169e-113 1.77108917e-004
 2.72988665e-007 1.19640694e-045 0.00000000e+000 8.26186753e-014
 1.31241612e-004 2.88840185e-030 7.55673684e-004 1.00000000e+000
 2.63051026e-012 9.93085425e-001 5.84593591e-002 1.58156904e-005
 2.80676709e-026 1.00000000e+000 1.29785071e-021 1.34676830e-023
 3.42853037e-007 1.77367783e-027 2.34649427e-105 8.12868080e-010
 1.20107086e-014 5.12704602e-115 5.68571295e-017 1.68649163e-108
 1.53165898e-001 2.19990848e-022 2.29936601e-015 4.89595579e-031
 4.65954815e-007 5.54750059e-027 1.65587101e-025 9.97770295e-001
 1.69125456e-031 9.59635413e-005 1.18976746e-033 6.82073182e-029
 1.00000000e+000 2.95012278e-036 2.60174116e-002 5.54558203e-017
 6.84800862e-001 1.37554677e-029 6.56406803e-012 8.46200044e-001
 1.99176286e-008 9.37728600e-042 9.89148950e-001 2.45062855e-105
 9.99161735e-001 1.17879001e-029 5.65419948e-017 6.81837292e-019
 2.38603194e-017 6.75780003e-025 2.93366061e-019 9.73072743e-044
 8.84269754e-117 1.18935598e-023 2.07309087e-016 3.43807394e-010
 2.08694035e-050 9.89605249e-001 1.72849431e-023 4.65578931e-108
 1.09067331e-007 6.23955072e-002 5.11730122e-024 2.28282573e-024
 3.44455936e-020 1.81210017e-011 9.53819874e-009 2.98116154e-025
 9.99998932e-001 5.64236687e-028 1.07246944e-036 1.71891401e-023
 1.99552006e-018 6.21348448e-035 9.98539734e-001 9.13289317e-009
 9.38355621e-005 3.50563104e-091 4.78274868e-005 1.56961832e-016
 1.22808008e-098 2.11970974e-100 1.11520007e-091]
2025-06-24 12:14:06,793 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:14:07,647 - src.training - INFO -   precision: 0.0
2025-06-24 12:14:07,647 - src.training - INFO -   recall: 0.0
2025-06-24 12:14:07,648 - src.training - INFO -   f1: 0.0
2025-06-24 12:14:07,648 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:14:07,648 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:14:07,648 - src.training - INFO -   positive_samples: 270
2025-06-24 12:14:07,648 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:14:07,648 - src.training - INFO -   total_samples: 220940
2025-06-24 12:14:07,648 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:14:07,648 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:14:07,648 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:14:07,648 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:14:07,648 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:14:07,648 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:14:07,648 - src.training - INFO - 모델 학습 완료
2025-06-24 12:14:07,648 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:14:07,648 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:07,648 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:07,648 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:07,648 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:07,669 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:14:07,670 - src.hyperparameter_tuning - ERROR - Trial 49 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:14:08,124 - src.hyperparameter_tuning - INFO - Trial 50: 모델 타입 = lightgbm
2025-06-24 12:14:10,087 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:14:10,087 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:14:10,087 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:14:10,087 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:14:10,087 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:14:10,087 - src.training - INFO - 교차 검증 시작
2025-06-24 12:14:10,087 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:14:10,104 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:14:10,579 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:14:10,579 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:14:10,579 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:14:10,579 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:14:10,579 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:14:10,579 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:14:10,579 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:14:10,579 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:14:10,579 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:14:10,755 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:14:10,755 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:14:10,755 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:14:10,755 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:14:10,755 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:14:10,755 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:14:10,755 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:14:10,755 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:14:10,755 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:14:10,755 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:14:12,168 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:14:13,274 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:14:13,274 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:14:13,280 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:14:13,313 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:14:13,313 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:14:13,313 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:14:13,313 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:14:14,634 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:14:14,908 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:14:14,908 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:14:15,077 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:14:15,077 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:14:15,120 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:14:15,120 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:14:15,120 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:14:15,120 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:14:15,120 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:15,120 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:15,181 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:14:15,182 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:14:15,182 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:15,182 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:15,182 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:14:15,182 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:14:15,182 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:15,247 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:14:15,247 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:14:15,247 - src.training - INFO - 모델 학습 시작
2025-06-24 12:14:15,378 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:14:15,378 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:14:15,378 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:14:15,378 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:14:15,378 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:14:15,378 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:14:15,378 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:14:15,378 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:14:15,378 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:14:15,378 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:14:15,378 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:14:15,379 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:14:15,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:14:15,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:15,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:15,470 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:15,534 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:15,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:15,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:15,736 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:15,814 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:15,830 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:14:15,830 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:15,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:14:15,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:15,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:14:15,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:15,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:15,908 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:15,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:15,940 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:15,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:15,973 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:15,991 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:15,993 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:14:15,993 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:16,009 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:14:16,009 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:16,009 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:14:16,009 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:16,009 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:14:16,023 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:14:16,026 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:14:16,026 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:14:16,026 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:14:16,026 - src.models.lightgbm_model - INFO -   learning_rate: 0.290418521132395
2025-06-24 12:14:16,026 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:14:16,026 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:14:16,026 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:14:16,026 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:14:16,026 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:14:16,026 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   n_estimators: 159
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   subsample: 0.9225056922895069
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7250240183255933
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00026721139800634484
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00020530127189201668
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:14:16,027 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:14:16,110 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:14:16,110 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.04236450072621369})})
2025-06-24 12:14:16,110 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:14:16,110 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:14:16,110 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:14:16,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:14:16,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:16,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:16,133 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:16,149 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:16,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:16,182 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:16,198 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:16,216 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:16,218 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:14:16,218 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:16,222 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:14:16,224 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:14:16,224 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:14:16,224 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:14:16,224 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:14:16,224 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:16,224 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:16,224 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:14:16,224 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:14:16,228 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:14:16,232 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:14:16,233 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00000000e+000 6.01129704e-264 5.13023690e-164 6.16594712e-190
 1.47728314e-138 2.49514470e-063 1.22914004e-112 2.07602874e-037
 7.22487876e-290 2.92516490e-224 8.09180220e-296 1.00000000e+000
 9.56470749e-212 2.44229052e-011 8.76949512e-004]
2025-06-24 12:14:16,233 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:14:17,603 - src.training - INFO -   precision: 0.0
2025-06-24 12:14:17,603 - src.training - INFO -   recall: 0.0
2025-06-24 12:14:17,603 - src.training - INFO -   f1: 0.0
2025-06-24 12:14:17,603 - src.training - INFO -   accuracy: 0.9987734226486829
2025-06-24 12:14:17,603 - src.training - INFO -   balanced_accuracy: 0.4999977341731998
2025-06-24 12:14:17,603 - src.training - INFO -   positive_samples: 270
2025-06-24 12:14:17,603 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:14:17,603 - src.training - INFO -   total_samples: 220940
2025-06-24 12:14:17,603 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:14:17,603 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:14:17,603 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:14:17,603 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:14:17,604 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:14:17,604 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:14:17,604 - src.training - INFO - 모델 학습 완료
2025-06-24 12:14:17,604 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987734226486829, 'balanced_accuracy': 0.4999977341731998, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:14:17,604 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:17,604 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:17,604 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:17,604 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:17,625 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:14:17,625 - src.hyperparameter_tuning - ERROR - Trial 50 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:14:18,088 - src.hyperparameter_tuning - INFO - Trial 51: 모델 타입 = lightgbm
2025-06-24 12:14:20,082 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:14:20,082 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:14:20,082 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:14:20,082 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:14:20,082 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:14:20,082 - src.training - INFO - 교차 검증 시작
2025-06-24 12:14:20,082 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:14:20,099 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:14:20,576 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:14:20,577 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:14:20,577 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:14:20,577 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:14:20,577 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:14:20,577 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:14:20,577 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:14:20,577 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:14:20,577 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:14:20,754 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:14:20,754 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:14:20,754 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:14:20,754 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:14:20,754 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:14:20,754 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:14:20,754 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:14:20,754 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:14:20,754 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:14:20,754 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:14:22,186 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:14:23,294 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:14:23,294 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:14:23,301 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:14:23,333 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:14:23,333 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:14:23,333 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:14:23,333 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:14:24,667 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:14:24,943 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:14:24,943 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:14:25,112 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:14:25,112 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:14:25,155 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:14:25,155 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:14:25,155 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:14:25,155 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:14:25,155 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:25,155 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:25,217 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:14:25,217 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:14:25,217 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:25,217 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:25,217 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:14:25,217 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:14:25,217 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:25,283 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:14:25,283 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:14:25,283 - src.training - INFO - 모델 학습 시작
2025-06-24 12:14:25,415 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:14:25,415 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:14:25,415 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:14:25,415 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:14:25,415 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:14:25,415 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:14:25,415 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:14:25,415 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:14:25,415 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:14:25,415 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:14:25,415 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:14:25,415 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:14:25,415 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:14:25,415 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:25,416 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:25,507 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:25,571 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:25,641 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:25,707 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:25,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:25,851 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:25,866 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:14:25,866 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:25,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:14:25,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:25,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:14:25,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:25,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:25,944 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:25,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:25,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:25,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:26,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:26,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:26,031 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:14:26,031 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:26,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:14:26,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:26,046 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:14:26,046 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:26,046 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:14:26,060 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   learning_rate: 0.04626861687271454
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   n_estimators: 268
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   subsample: 0.9106897940640452
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7417098336200938
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   reg_alpha: 1.8418106371843009e-06
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0002443452622146951
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:14:26,064 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:14:26,183 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:14:26,183 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 2.9857736223814606})})
2025-06-24 12:14:26,183 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:14:26,183 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:14:26,184 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:14:26,184 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:14:26,184 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:26,184 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:26,206 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:26,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:26,240 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:26,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:26,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:26,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:26,292 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:14:26,292 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:26,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:14:26,298 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:14:26,298 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:14:26,298 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:14:26,298 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:14:26,298 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:26,298 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:26,298 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:14:26,298 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:14:26,302 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:14:26,306 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:14:26,308 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [2.02431108e-002 9.97924518e-001 9.99908447e-001 1.40115630e-084
 4.46420751e-080 9.99999996e-001 3.54344918e-001 2.29849261e-002
 6.21920922e-004 9.99861752e-001 9.24923846e-001 9.99657422e-001
 9.99533359e-001 9.99994981e-001 9.99997789e-001 2.99418733e-104
 9.99814313e-001 1.51490308e-002 2.79124039e-002 2.97821504e-001
 1.00000000e+000 2.04927302e-002 9.13456073e-004 6.80212254e-004
 9.99891797e-001 1.00000000e+000 9.01689961e-001 7.82200826e-005
 3.84031392e-106 1.00000000e+000 2.44014874e-185 9.99999994e-001
 2.39985840e-001 9.99539899e-001 1.08010962e-095 6.86305386e-175
 9.15624497e-004 8.42131816e-094 0.00000000e+000 1.03972522e-093
 9.99998917e-001 6.60645001e-173 9.99999051e-001 9.99968100e-001
 9.26495871e-004 5.73864721e-007 1.21436102e-006 2.75833656e-005
 9.99893142e-001 9.99854666e-001 1.86502306e-003 5.74320616e-007
 1.01170860e-077 9.99997281e-001 9.99991782e-001 8.22523502e-005
 5.91048311e-002 1.00234940e-049 8.64186264e-055 6.81827366e-004
 1.00000000e+000 1.37813839e-012 9.99999952e-001 9.98468949e-001
 3.88712574e-005 9.99998921e-001 8.10645211e-092 1.00000000e+000
 9.66218672e-041 8.41660615e-043 7.36896709e-004 8.65405753e-001
 9.88678059e-026 9.99999999e-001 1.33831238e-011 3.29324389e-006
 4.05488763e-001 3.27601465e-005 1.40472693e-076 9.94805029e-001
 2.24470569e-004 6.61887741e-001 4.74314253e-076 9.99904970e-001
 7.50049090e-051 1.77549496e-091 8.48043434e-018 8.74351902e-045
 9.96420019e-001 1.87392078e-054 1.00995081e-024 1.65900769e-049
 7.53831855e-050 8.80982638e-020 1.00000000e+000 2.14824644e-059
 1.80385644e-052 1.76476596e-072 1.16687399e-007 1.11800722e-073
 9.99202059e-001 7.25646711e-048 9.99275894e-001 4.83979069e-007
 9.81335988e-001 9.99802462e-001 4.83642167e-007 3.27355580e-011
 1.97727320e-013 1.30619050e-001 9.73881662e-076 9.99237209e-001
 6.54269710e-046 9.98183853e-001 9.99999989e-001 6.02398510e-004
 1.59697878e-047 1.90187195e-054 6.29807112e-044 1.72398385e-009
 9.39559766e-011 6.28729563e-008 1.25583931e-001 1.15981392e-082
 9.99524576e-001 9.99999945e-001 3.01012850e-026 2.65090895e-035
 5.60047679e-018 1.79426104e-033 1.83331701e-045 1.00000000e+000
 6.01012387e-008 8.79017932e-004 7.23012793e-042 9.14011105e-001
 7.42951049e-074 1.66364876e-071 5.06514381e-072 3.38946597e-069
 4.74293338e-065 3.24004333e-069]
2025-06-24 12:14:26,308 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:14:27,183 - src.training - INFO -   precision: 0.0
2025-06-24 12:14:27,183 - src.training - INFO -   recall: 0.0
2025-06-24 12:14:27,183 - src.training - INFO -   f1: 0.0
2025-06-24 12:14:27,183 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:14:27,183 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:14:27,183 - src.training - INFO -   positive_samples: 270
2025-06-24 12:14:27,183 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:14:27,183 - src.training - INFO -   total_samples: 220940
2025-06-24 12:14:27,183 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:14:27,183 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:14:27,183 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:14:27,183 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:14:27,183 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:14:27,183 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:14:27,183 - src.training - INFO - 모델 학습 완료
2025-06-24 12:14:27,184 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:14:27,184 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:27,184 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:27,184 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:27,184 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:27,205 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:14:27,205 - src.hyperparameter_tuning - ERROR - Trial 51 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:14:27,675 - src.hyperparameter_tuning - INFO - Trial 52: 모델 타입 = lightgbm
2025-06-24 12:14:29,656 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:14:29,657 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:14:29,657 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:14:29,657 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:14:29,657 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:14:29,657 - src.training - INFO - 교차 검증 시작
2025-06-24 12:14:29,657 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:14:29,674 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:14:30,150 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:14:30,150 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:14:30,150 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:14:30,150 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:14:30,150 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:14:30,150 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:14:30,150 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:14:30,150 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:14:30,150 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:14:30,327 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:14:30,327 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:14:30,327 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:14:30,327 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:14:30,327 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:14:30,327 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:14:30,327 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:14:30,327 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:14:30,327 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:14:30,327 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:14:31,748 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:14:32,859 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:14:32,859 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:14:32,865 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:14:32,897 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:14:32,897 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:14:32,897 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:14:32,897 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:14:34,210 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:14:34,482 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:14:34,482 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:14:34,651 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:14:34,651 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:14:34,695 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:14:34,695 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:14:34,695 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:14:34,695 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:14:34,695 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:34,695 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:34,756 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:14:34,757 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:14:34,757 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:34,757 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:34,757 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:14:34,757 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:14:34,757 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:34,822 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:14:34,822 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:14:34,822 - src.training - INFO - 모델 학습 시작
2025-06-24 12:14:34,953 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:14:34,953 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:14:34,953 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:14:34,953 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:14:34,953 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:14:34,953 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:14:34,953 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:14:34,953 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:14:34,953 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:14:34,953 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:14:34,953 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:14:34,953 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:14:34,953 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:14:34,953 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:34,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:35,044 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:35,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:35,181 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:35,245 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:35,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:35,389 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:35,404 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:14:35,404 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:35,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:14:35,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:35,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:14:35,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:35,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:35,483 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:35,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:35,514 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:35,530 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:35,547 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:35,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:35,568 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:14:35,568 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:35,584 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:14:35,584 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:35,584 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:14:35,584 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:35,584 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:14:35,598 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:14:35,601 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:14:35,601 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:14:35,601 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:14:35,601 - src.models.lightgbm_model - INFO -   learning_rate: 0.014351896462110058
2025-06-24 12:14:35,601 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:14:35,601 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:14:35,601 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:14:35,601 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:14:35,601 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   n_estimators: 279
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   subsample: 0.9098323765740216
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6805097576883523
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   reg_alpha: 9.876164012834767e-06
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00043258146557880546
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:14:35,602 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:14:37,438 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:14:37,438 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.46259241896519404})})
2025-06-24 12:14:37,438 - src.models.lightgbm_model - INFO -   - Best Iteration: 279
2025-06-24 12:14:37,438 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:14:37,438 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:14:37,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:14:37,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:37,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:37,460 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:37,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:37,494 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:37,510 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:37,528 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:37,546 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:37,549 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:14:37,549 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:37,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:14:37,617 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:14:37,617 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:14:37,617 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:14:37,617 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:14:37,618 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:37,618 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:37,618 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:14:37,618 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:14:37,622 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:14:37,626 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:14:37,630 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.03089965 0.15364152 0.04968912 ... 0.01962431 0.01006388 0.0181705 ]
2025-06-24 12:14:37,630 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:14:38,445 - src.training - INFO -   precision: 0.0
2025-06-24 12:14:38,445 - src.training - INFO -   recall: 0.0
2025-06-24 12:14:38,445 - src.training - INFO -   f1: 0.0
2025-06-24 12:14:38,445 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:14:38,445 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:14:38,445 - src.training - INFO -   positive_samples: 270
2025-06-24 12:14:38,445 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:14:38,445 - src.training - INFO -   total_samples: 220940
2025-06-24 12:14:38,445 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:14:38,445 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:14:38,445 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:14:38,445 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:14:38,446 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:14:38,446 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:14:38,446 - src.training - INFO - 모델 학습 완료
2025-06-24 12:14:38,446 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:14:38,446 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:38,446 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:38,446 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:38,446 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:38,469 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:14:38,469 - src.hyperparameter_tuning - ERROR - Trial 52 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:14:38,931 - src.hyperparameter_tuning - INFO - Trial 53: 모델 타입 = lightgbm
2025-06-24 12:14:40,943 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:14:40,943 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:14:40,944 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:14:40,944 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:14:40,944 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:14:40,944 - src.training - INFO - 교차 검증 시작
2025-06-24 12:14:40,944 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:14:40,961 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:14:41,433 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:14:41,433 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:14:41,433 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:14:41,433 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:14:41,433 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:14:41,433 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:14:41,433 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:14:41,433 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:14:41,433 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:14:41,610 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:14:41,610 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:14:41,610 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:14:41,610 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:14:41,610 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:14:41,610 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:14:41,610 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:14:41,610 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:14:41,610 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:14:41,610 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:14:43,033 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:14:44,146 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:14:44,146 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:14:44,152 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:14:44,185 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:14:44,185 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:14:44,185 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:14:44,185 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:14:45,502 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:14:45,776 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:14:45,777 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:14:45,946 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:14:45,946 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:14:45,989 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:14:45,989 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:14:45,989 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:14:45,989 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:14:45,989 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:45,989 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:46,051 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:14:46,051 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:14:46,051 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:46,051 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:46,051 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:14:46,051 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:14:46,051 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:46,116 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:14:46,116 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:14:46,117 - src.training - INFO - 모델 학습 시작
2025-06-24 12:14:46,249 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:14:46,249 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:14:46,249 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:14:46,249 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:14:46,249 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:14:46,249 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:14:46,249 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:14:46,249 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:14:46,249 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:14:46,250 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:14:46,250 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:14:46,250 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:14:46,250 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:14:46,250 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:46,250 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:46,342 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:46,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:46,478 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:46,541 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:46,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:46,687 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:46,702 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:14:46,702 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:46,761 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:14:46,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:46,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:14:46,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:46,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:46,780 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:46,795 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:46,811 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:46,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:46,844 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:46,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:46,866 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:14:46,866 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:46,881 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:14:46,881 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:46,881 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:14:46,881 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:46,881 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:14:46,895 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:14:46,898 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:14:46,898 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:14:46,898 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:14:46,898 - src.models.lightgbm_model - INFO -   learning_rate: 0.01101143323170547
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   n_estimators: 244
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   subsample: 0.955661418017538
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7547290521673672
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   reg_alpha: 0.005728189372702293
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00034863193096353577
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:14:46,899 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:14:47,007 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:14:47,007 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.17327776227338088})})
2025-06-24 12:14:47,007 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:14:47,007 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:14:47,008 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:14:47,008 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:14:47,008 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:47,008 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:47,030 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:47,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:47,064 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:47,080 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:47,097 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:47,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:47,117 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:14:47,117 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:47,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:14:47,122 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:14:47,122 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:14:47,122 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:14:47,122 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:14:47,122 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:47,122 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:47,122 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:14:47,122 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:14:47,126 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:14:47,130 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:14:47,131 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00223806 0.09565535 0.0482339  0.37413578 0.00529605 0.03923088
 0.2318319  0.01140716 0.0011552  0.00115555 0.86657144 0.00115605
 0.05220808 0.80254425 0.29943273 0.01054347 0.00115625 0.51264638
 0.90182236 0.5052929  0.08621039 0.52935662 0.00314521 0.0011609
 0.22142587 0.80033558 0.63196839 0.23749413 0.89977311]
2025-06-24 12:14:47,131 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:14:47,965 - src.training - INFO -   precision: 0.0
2025-06-24 12:14:47,965 - src.training - INFO -   recall: 0.0
2025-06-24 12:14:47,965 - src.training - INFO -   f1: 0.0
2025-06-24 12:14:47,965 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:14:47,965 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:14:47,965 - src.training - INFO -   positive_samples: 270
2025-06-24 12:14:47,965 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:14:47,965 - src.training - INFO -   total_samples: 220940
2025-06-24 12:14:47,965 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:14:47,965 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:14:47,965 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:14:47,965 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:14:47,965 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:14:47,965 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:14:47,965 - src.training - INFO - 모델 학습 완료
2025-06-24 12:14:47,965 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:14:47,965 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:47,965 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:47,965 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:47,965 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:47,986 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:14:47,987 - src.hyperparameter_tuning - ERROR - Trial 53 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:14:48,453 - src.hyperparameter_tuning - INFO - Trial 54: 모델 타입 = lightgbm
2025-06-24 12:14:50,464 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:14:50,464 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:14:50,464 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:14:50,464 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:14:50,464 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:14:50,464 - src.training - INFO - 교차 검증 시작
2025-06-24 12:14:50,464 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:14:50,481 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:14:50,958 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:14:50,958 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:14:50,958 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:14:50,958 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:14:50,958 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:14:50,958 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:14:50,958 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:14:50,959 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:14:50,959 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:14:51,123 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:14:51,123 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:14:51,123 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:14:51,123 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:14:51,123 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:14:51,123 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:14:51,123 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:14:51,123 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:14:51,123 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:14:51,123 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:14:52,545 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:14:53,653 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:14:53,653 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:14:53,659 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:14:53,691 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:14:53,691 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:14:53,691 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:14:53,691 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:14:54,997 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:14:55,267 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:14:55,268 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:14:55,437 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:14:55,437 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:14:55,480 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:14:55,480 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:14:55,480 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:14:55,480 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:14:55,480 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:55,480 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:55,542 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:14:55,542 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:14:55,542 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:55,542 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:55,542 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:14:55,542 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:14:55,542 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:55,605 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:14:55,605 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:14:55,605 - src.training - INFO - 모델 학습 시작
2025-06-24 12:14:55,737 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:14:55,737 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:14:55,737 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:14:55,737 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:14:55,737 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:14:55,737 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:14:55,737 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:14:55,737 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:14:55,737 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:14:55,737 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:14:55,737 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:14:55,737 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:14:55,737 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:14:55,737 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:55,737 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:55,830 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:55,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:55,964 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:56,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:56,096 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:56,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:56,189 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:14:56,189 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:56,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:14:56,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:56,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:14:56,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:56,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:56,267 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:56,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:56,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:56,313 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:56,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:56,349 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:56,352 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:14:56,352 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:56,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:14:56,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:56,368 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:14:56,368 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:56,368 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:14:56,382 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   learning_rate: 0.23007412010384362
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:14:56,385 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO -   n_estimators: 127
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO -   subsample: 0.7279404430539564
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6206627106206245
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO -   reg_alpha: 0.04292928217605174
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO -   reg_lambda: 1.663530223372295e-05
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:14:56,386 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:14:56,478 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:14:56,478 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.04272103070912044})})
2025-06-24 12:14:56,478 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:14:56,478 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:14:56,480 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:14:56,480 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:14:56,481 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:56,481 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:14:56,503 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:14:56,519 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:14:56,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:14:56,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:14:56,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:14:56,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:14:56,591 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:14:56,591 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:56,595 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:14:56,596 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:14:56,596 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:14:56,596 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:14:56,596 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:14:56,597 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:56,597 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:14:56,597 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:14:56,597 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:14:56,600 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:14:56,604 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:14:56,605 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00000000e+000 4.86401271e-197 2.14293182e-122 6.26134537e-143
 1.05751158e-104 5.55866326e-049 3.61931038e-084 1.90244040e-028
 1.42119610e-217 2.29627839e-167 4.69427175e-224 1.00000000e+000
 1.88462597e-157 6.80677415e-001 1.33361893e-009 1.00000000e+000
 1.17638676e-009 9.30718274e-004 9.99999965e-001]
2025-06-24 12:14:56,605 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:14:57,985 - src.training - INFO -   precision: 0.0
2025-06-24 12:14:57,985 - src.training - INFO -   recall: 0.0
2025-06-24 12:14:57,985 - src.training - INFO -   f1: 0.0
2025-06-24 12:14:57,985 - src.training - INFO -   accuracy: 0.9987734226486829
2025-06-24 12:14:57,985 - src.training - INFO -   balanced_accuracy: 0.4999977341731998
2025-06-24 12:14:57,985 - src.training - INFO -   positive_samples: 270
2025-06-24 12:14:57,985 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:14:57,985 - src.training - INFO -   total_samples: 220940
2025-06-24 12:14:57,985 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:14:57,985 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:14:57,985 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:14:57,985 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:14:57,985 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:14:57,985 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:14:57,985 - src.training - INFO - 모델 학습 완료
2025-06-24 12:14:57,985 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987734226486829, 'balanced_accuracy': 0.4999977341731998, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:14:57,985 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:57,985 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:57,985 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:14:57,985 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:14:58,005 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:14:58,005 - src.hyperparameter_tuning - ERROR - Trial 54 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:14:58,467 - src.hyperparameter_tuning - INFO - Trial 55: 모델 타입 = lightgbm
2025-06-24 12:15:00,455 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:15:00,455 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:15:00,455 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:15:00,455 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:15:00,455 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:15:00,455 - src.training - INFO - 교차 검증 시작
2025-06-24 12:15:00,455 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:15:00,472 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:15:00,944 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:15:00,944 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:15:00,944 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:15:00,944 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:15:00,944 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:15:00,944 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:15:00,944 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:15:00,944 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:15:00,944 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:15:01,121 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:15:01,121 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:15:01,121 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:15:01,121 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:15:01,121 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:15:01,121 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:15:01,121 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:15:01,121 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:15:01,121 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:15:01,121 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:15:02,534 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:15:03,641 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:15:03,641 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:15:03,647 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:15:03,679 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:15:03,679 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:15:03,679 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:15:03,679 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:15:05,003 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:15:05,282 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:15:05,282 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:15:05,451 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:15:05,451 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:15:05,494 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:15:05,494 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:15:05,494 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:15:05,494 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:15:05,494 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:05,494 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:05,556 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:15:05,556 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:15:05,556 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:05,556 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:05,556 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:15:05,556 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:15:05,556 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:05,622 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:15:05,622 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:15:05,622 - src.training - INFO - 모델 학습 시작
2025-06-24 12:15:05,753 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:15:05,754 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:15:05,754 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:15:05,754 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:15:05,754 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:15:05,754 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:15:05,754 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:15:05,754 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:15:05,754 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:15:05,754 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:15:05,754 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:15:05,754 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:15:05,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:15:05,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:05,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:05,846 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:05,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:05,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:06,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:06,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:06,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:06,204 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:15:06,204 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:06,263 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:15:06,263 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:06,263 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:15:06,263 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:06,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:06,282 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:06,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:06,313 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:06,329 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:06,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:06,365 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:06,368 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:15:06,368 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:06,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:15:06,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:06,383 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:15:06,383 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:06,383 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:15:06,397 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:15:06,400 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:15:06,400 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:15:06,400 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:15:06,400 - src.models.lightgbm_model - INFO -   learning_rate: 0.014051076643229292
2025-06-24 12:15:06,400 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:15:06,400 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   n_estimators: 241
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   subsample: 0.8590511636512334
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8701911882213408
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   reg_alpha: 2.453517913555448e-06
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00015053544431522443
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:15:06,401 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:15:07,907 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:15:07,907 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.4678627867087594})})
2025-06-24 12:15:07,907 - src.models.lightgbm_model - INFO -   - Best Iteration: 241
2025-06-24 12:15:07,907 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:15:07,907 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:15:07,907 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:15:07,907 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:07,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:07,928 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:07,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:07,961 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:07,977 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:07,995 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:08,013 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:08,015 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:15:08,015 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:08,019 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:15:08,075 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:15:08,075 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:15:08,075 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:15:08,075 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:15:08,075 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:08,075 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:08,075 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:15:08,075 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:15:08,079 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:15:08,083 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:15:08,087 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.02845758 0.11116915 0.02624129 ... 0.01086253 0.01314304 0.01147498]
2025-06-24 12:15:08,087 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:15:08,902 - src.training - INFO -   precision: 0.0
2025-06-24 12:15:08,902 - src.training - INFO -   recall: 0.0
2025-06-24 12:15:08,902 - src.training - INFO -   f1: 0.0
2025-06-24 12:15:08,902 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:15:08,902 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:15:08,902 - src.training - INFO -   positive_samples: 270
2025-06-24 12:15:08,902 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:15:08,902 - src.training - INFO -   total_samples: 220940
2025-06-24 12:15:08,902 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:15:08,902 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:15:08,902 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:15:08,902 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:15:08,902 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:15:08,902 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:15:08,902 - src.training - INFO - 모델 학습 완료
2025-06-24 12:15:08,902 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:15:08,902 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:08,913 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:08,913 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:08,913 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:08,936 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:15:08,936 - src.hyperparameter_tuning - ERROR - Trial 55 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:15:09,396 - src.hyperparameter_tuning - INFO - Trial 56: 모델 타입 = lightgbm
2025-06-24 12:15:11,347 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:15:11,347 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:15:11,347 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:15:11,347 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:15:11,347 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:15:11,347 - src.training - INFO - 교차 검증 시작
2025-06-24 12:15:11,347 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:15:11,365 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:15:11,839 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:15:11,840 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:15:11,840 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:15:11,840 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:15:11,840 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:15:11,840 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:15:11,840 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:15:11,840 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:15:11,840 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:15:12,014 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:15:12,014 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:15:12,014 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:15:12,014 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:15:12,014 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:15:12,014 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:15:12,014 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:15:12,014 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:15:12,014 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:15:12,014 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:15:13,439 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:15:14,541 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:15:14,541 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:15:14,547 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:15:14,580 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:15:14,580 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:15:14,580 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:15:14,580 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:15:15,883 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:15:16,158 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:15:16,158 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:15:16,325 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:15:16,326 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:15:16,368 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:15:16,369 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:15:16,369 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:15:16,369 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:15:16,369 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:16,369 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:16,431 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:15:16,431 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:15:16,431 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:16,431 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:16,431 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:15:16,431 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:15:16,431 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:16,497 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:15:16,497 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:15:16,497 - src.training - INFO - 모델 학습 시작
2025-06-24 12:15:16,629 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:15:16,629 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:15:16,629 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:15:16,629 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:15:16,629 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:15:16,629 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:15:16,629 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:15:16,629 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:15:16,629 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:15:16,629 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:15:16,629 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:15:16,629 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:15:16,629 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:15:16,629 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:16,629 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:16,717 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:16,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:16,851 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:16,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:16,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:17,062 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:17,080 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:15:17,080 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:17,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:15:17,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:17,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:15:17,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:17,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:17,170 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:17,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:17,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:17,218 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:17,235 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:17,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:17,256 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:15:17,256 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:17,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:15:17,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:17,274 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:15:17,274 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:17,274 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:15:17,288 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   learning_rate: 0.01152577901891465
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   n_estimators: 936
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   subsample: 0.9786635434970814
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9893660340951003
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   reg_alpha: 1.1119281058685535e-07
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO -   reg_lambda: 4.954319149917846e-05
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:15:17,292 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:15:17,408 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:15:17,408 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.22300569828392794})})
2025-06-24 12:15:17,408 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:15:17,408 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:15:17,409 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:15:17,409 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:15:17,409 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:17,409 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:17,430 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:17,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:17,462 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:17,478 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:17,495 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:17,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:17,514 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:15:17,514 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:17,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:15:17,519 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:15:17,519 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:15:17,519 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:15:17,519 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:15:17,519 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:17,519 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:17,519 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:15:17,519 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:15:17,523 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:15:17,527 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:15:17,528 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.0026662  0.13811883 0.05699041 0.44443484 0.00563892 0.01219726
 0.04598798 0.21889555 0.46431874 0.14441535 0.00115462 0.11229398
 0.00530659 0.88956095 0.00115452 0.85608393 0.31661821 0.00115521
 0.51027542 0.59105417 0.919115   0.51308166 0.17245106 0.00115501
 0.00329401 0.00115523 0.02651271 0.71512812 0.71281049 0.8248963
 0.00115525]
2025-06-24 12:15:17,528 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:15:18,339 - src.training - INFO -   precision: 0.0
2025-06-24 12:15:18,339 - src.training - INFO -   recall: 0.0
2025-06-24 12:15:18,339 - src.training - INFO -   f1: 0.0
2025-06-24 12:15:18,339 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:15:18,339 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:15:18,339 - src.training - INFO -   positive_samples: 270
2025-06-24 12:15:18,339 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:15:18,339 - src.training - INFO -   total_samples: 220940
2025-06-24 12:15:18,339 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:15:18,339 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:15:18,339 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:15:18,339 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:15:18,339 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:15:18,339 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:15:18,339 - src.training - INFO - 모델 학습 완료
2025-06-24 12:15:18,339 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:15:18,339 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:18,339 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:18,339 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:18,339 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:18,360 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:15:18,360 - src.hyperparameter_tuning - ERROR - Trial 56 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:15:18,827 - src.hyperparameter_tuning - INFO - Trial 57: 모델 타입 = lightgbm
2025-06-24 12:15:20,802 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:15:20,802 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:15:20,802 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:15:20,802 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:15:20,802 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:15:20,803 - src.training - INFO - 교차 검증 시작
2025-06-24 12:15:20,803 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:15:20,819 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:15:21,295 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:15:21,295 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:15:21,295 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:15:21,295 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:15:21,295 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:15:21,295 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:15:21,295 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:15:21,295 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:15:21,295 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:15:21,461 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:15:21,461 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:15:21,461 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:15:21,461 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:15:21,461 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:15:21,461 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:15:21,461 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:15:21,461 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:15:21,461 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:15:21,461 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:15:22,880 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:15:23,989 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:15:23,989 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:15:23,995 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:15:24,028 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:15:24,028 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:15:24,028 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:15:24,028 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:15:25,339 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:15:25,614 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:15:25,614 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:15:25,782 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:15:25,782 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:15:25,825 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:15:25,825 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:15:25,825 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:15:25,826 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:15:25,826 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:25,826 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:25,887 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:15:25,887 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:15:25,887 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:25,887 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:25,887 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:15:25,887 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:15:25,887 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:25,954 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:15:25,954 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:15:25,954 - src.training - INFO - 모델 학습 시작
2025-06-24 12:15:26,086 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:15:26,086 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:15:26,086 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:15:26,086 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:15:26,086 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:15:26,086 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:15:26,086 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:15:26,086 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:15:26,086 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:15:26,086 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:15:26,086 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:15:26,086 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:15:26,086 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:15:26,086 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:26,087 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:26,177 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:26,243 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:26,309 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:26,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:26,442 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:26,519 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:26,535 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:15:26,535 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:26,594 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:15:26,594 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:26,594 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:15:26,594 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:26,595 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:26,613 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:26,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:26,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:26,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:26,679 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:26,696 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:26,699 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:15:26,699 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:26,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:15:26,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:26,714 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:15:26,714 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:26,714 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:15:26,730 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:15:26,733 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:15:26,733 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:15:26,733 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:15:26,733 - src.models.lightgbm_model - INFO -   learning_rate: 0.012995370638296627
2025-06-24 12:15:26,733 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:15:26,733 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:15:26,733 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:15:26,733 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:15:26,733 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   n_estimators: 422
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   subsample: 0.9356845861715655
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7303361205668435
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   reg_alpha: 4.1428913353536936e-08
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO -   reg_lambda: 0.1900832350854392
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:15:26,734 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:15:26,853 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:15:26,853 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.37869858229132486})})
2025-06-24 12:15:26,853 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:15:26,853 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:15:26,853 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:15:26,854 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:15:26,854 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:26,854 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:26,875 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:26,891 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:26,907 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:26,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:26,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:26,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:26,959 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:15:26,959 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:26,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:15:26,964 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:15:26,964 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:15:26,964 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:15:26,964 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:15:26,964 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:26,964 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:26,964 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:15:26,964 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:15:26,968 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:15:26,972 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:15:26,974 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00276305 0.23083333 0.09086294 0.64776139 0.00688801 0.01640368
 0.07188583 0.36043838 0.66811143 0.24138865 0.00115296 0.10974729
 0.00643258 0.96132524 0.00115285 0.09671137 0.94641184 0.4983498
 0.00115362 0.71242721 0.78179217 0.97343202 0.71501457 0.2875169
 0.0011534  0.00375895 0.00115365 0.03909652 0.86973676 0.86828018
 0.93139699]
2025-06-24 12:15:26,974 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:15:27,787 - src.training - INFO -   precision: 0.0
2025-06-24 12:15:27,787 - src.training - INFO -   recall: 0.0
2025-06-24 12:15:27,787 - src.training - INFO -   f1: 0.0
2025-06-24 12:15:27,787 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:15:27,787 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:15:27,787 - src.training - INFO -   positive_samples: 270
2025-06-24 12:15:27,787 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:15:27,787 - src.training - INFO -   total_samples: 220940
2025-06-24 12:15:27,787 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:15:27,787 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:15:27,787 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:15:27,787 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:15:27,787 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:15:27,787 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:15:27,787 - src.training - INFO - 모델 학습 완료
2025-06-24 12:15:27,787 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:15:27,787 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:27,787 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:27,787 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:27,787 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:27,809 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:15:27,809 - src.hyperparameter_tuning - ERROR - Trial 57 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:15:28,276 - src.hyperparameter_tuning - INFO - Trial 58: 모델 타입 = lightgbm
2025-06-24 12:15:30,254 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:15:30,254 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:15:30,254 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:15:30,254 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:15:30,254 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:15:30,254 - src.training - INFO - 교차 검증 시작
2025-06-24 12:15:30,254 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:15:30,271 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:15:30,746 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:15:30,746 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:15:30,746 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:15:30,746 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:15:30,746 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:15:30,746 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:15:30,746 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:15:30,747 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:15:30,747 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:15:30,915 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:15:30,915 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:15:30,915 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:15:30,915 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:15:30,915 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:15:30,915 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:15:30,915 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:15:30,915 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:15:30,915 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:15:30,915 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:15:32,219 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:15:33,215 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:15:33,215 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:15:33,221 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:15:33,251 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:15:33,252 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:15:33,252 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:15:33,252 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:15:34,428 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:15:34,687 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:15:34,687 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:15:34,847 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:15:34,847 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:15:34,887 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:15:34,887 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:15:34,888 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:15:34,888 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:15:34,888 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:34,888 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:34,944 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:15:34,944 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:15:34,944 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:34,944 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:34,944 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:15:34,944 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:15:34,944 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:35,002 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:15:35,002 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:15:35,002 - src.training - INFO - 모델 학습 시작
2025-06-24 12:15:35,129 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:15:35,129 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:15:35,129 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:15:35,129 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:15:35,129 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:15:35,129 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:15:35,129 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:15:35,129 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:15:35,129 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:15:35,129 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:15:35,129 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:15:35,129 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:15:35,129 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:15:35,129 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:35,129 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:35,208 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:35,263 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:35,320 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:35,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:35,434 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:35,504 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:35,519 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:15:35,519 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:35,584 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:15:35,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:35,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:15:35,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:35,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:35,602 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:35,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:35,630 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:35,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:35,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:35,674 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:35,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:15:35,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:35,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:15:35,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:35,691 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:15:35,691 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:35,691 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:15:35,707 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:15:35,710 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:15:35,710 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:15:35,710 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:15:35,710 - src.models.lightgbm_model - INFO -   learning_rate: 0.0243578987251887
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   n_estimators: 63
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   subsample: 0.9798298153051339
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6568556354408778
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   reg_alpha: 4.1621895459365375e-06
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO -   reg_lambda: 0.023910360185325986
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:15:35,711 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:15:35,837 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:15:35,837 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 1.6032658690091148})})
2025-06-24 12:15:35,837 - src.models.lightgbm_model - INFO -   - Best Iteration: 4
2025-06-24 12:15:35,837 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:15:35,837 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:15:35,838 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:15:35,838 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:35,838 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:35,859 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:35,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:35,888 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:35,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:35,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:35,934 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:35,937 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:15:35,937 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:35,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:15:35,946 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:15:35,946 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:15:35,946 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:15:35,946 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:15:35,946 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:35,946 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:35,946 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:15:35,946 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:15:35,950 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:15:35,954 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:15:35,956 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [6.00301716e-003 9.47108625e-001 9.53745635e-001 9.57952334e-001
 8.14637238e-001 1.53264154e-003 3.36784508e-003 1.73734770e-002
 1.32880912e-001 7.31568695e-001 9.60434471e-001 3.98458437e-001
 9.62155875e-001 4.30362948e-005 9.11589701e-001 2.46119726e-002
 5.26260681e-002 9.99996555e-001 2.18890254e-003 1.02558554e-003
 3.48060676e-002 9.99986039e-001 2.08134005e-090 5.74125021e-002
 9.99994694e-001 9.44435521e-001 2.44715225e-005 1.45636981e-090
 3.20613761e-090 2.85648357e-005 2.13951542e-014 9.99992416e-001
 8.85772711e-001 9.00513266e-001 1.52899441e-009 9.31682265e-001
 8.84299562e-001 9.16127402e-001 8.67679576e-015 9.43901435e-001
 6.79285717e-008 9.85963037e-001 7.50541377e-008 9.70201889e-001
 5.55831355e-215 9.58351440e-001 9.98957735e-001 2.30410400e-001
 4.02007480e-003 1.74953158e-002 9.90119381e-001 9.74117844e-001
 6.77836353e-004 5.56718119e-007 2.32064549e-005 1.04318895e-013
 6.20229311e-003 5.56950908e-007 8.75284867e-001 6.29000863e-010
 3.39108757e-004 9.74259420e-001 2.56848920e-021 9.32288840e-001
 9.99426513e-001 9.99180615e-001 2.02890953e-014 3.35721555e-001
 3.36601765e-009 9.94726313e-001 1.00000000e+000 9.52067455e-001
 5.88354151e-003 5.12233918e-006 9.66914930e-001 1.43651296e-002
 9.30127182e-001 8.02513246e-032 9.97912059e-001 7.41350579e-191
 3.69468938e-007 3.65950270e-007 2.18502239e-076 2.53985418e-027
 4.05823053e-213 9.98715672e-001 2.11863589e-026 5.54829297e-007
 5.94780643e-001 9.53866558e-001 4.95907389e-013 7.61307797e-006
 2.18512996e-009 1.67597214e-005 4.05269281e-032 3.33655786e-033
 1.81338245e-001 3.14350756e-003 9.99094741e-001 4.08387069e-003
 3.80368142e-002 3.11367574e-003 2.74950375e-021 5.16064095e-016
 9.93260146e-001 4.99284401e-001 2.13900690e-026 2.20167527e-003
 3.33424436e-003 3.31207321e-007 1.99306697e-003 3.14477961e-119
 3.04663386e-208 6.02444648e-177 9.51195054e-001 2.67985568e-021
 5.51737061e-215 2.21869876e-004 1.08800335e-005 3.02780358e-026
 8.84034645e-003 2.24810246e-005 1.48531690e-005 8.33789284e-012
 5.47113429e-215 1.05321938e-013 2.96149622e-021 3.21213448e-026
 9.25052976e-001 9.68938703e-001 3.21634080e-015 1.07786948e-171
 1.15128411e-003 4.05122303e-003 9.99125062e-001 4.88137400e-003
 4.34500775e-005 6.03944558e-033 4.05391055e-003 2.41108979e-005
 2.12217868e-001 9.11232137e-001 9.97619161e-001 1.76827203e-021
 9.32384308e-001 2.22615651e-003 8.24764005e-001 2.20621199e-015
 9.36463396e-001 9.99955511e-001 9.93916415e-001 5.02952809e-006
 4.84546823e-017 8.02280374e-001 2.37907688e-003 1.71874493e-005
 4.31743692e-021 7.60942610e-004 8.10322431e-215 9.09594667e-212
 4.08115511e-005 2.69228833e-002 6.15032728e-005 2.40124542e-001
 9.98902021e-001 1.44761617e-002 3.64992228e-002 1.00000000e+000
 5.48853055e-006 3.60098681e-003 2.17160870e-015 2.67106302e-004
 7.73185411e-091 9.82244798e-001 9.68433762e-004 5.96483594e-010
 8.63114567e-033 9.97777365e-001 6.09751579e-033 3.28566697e-010
 3.60026931e-014 9.95972304e-001 5.06021977e-004 4.72844819e-005
 8.05347273e-021 9.10832727e-001 8.76903643e-001 1.72090321e-005
 9.99837763e-001 2.20374091e-002 9.79071281e-003 9.89259526e-014
 9.82674941e-001 1.20927328e-008 1.65003088e-003 7.88326885e-001
 7.57665525e-001 9.46362463e-001 6.51813197e-003 8.76034271e-001
 1.49161833e-004 7.13547415e-003 2.02791104e-002 9.92243818e-001
 7.31186785e-027 9.99995326e-001 9.99977105e-001 3.50821681e-003
 9.98515215e-001 2.56028383e-001 9.98524059e-001 2.17081718e-010
 1.98743238e-025 1.61079737e-013 9.99990830e-001 7.56440187e-021
 6.70683519e-026 9.57420468e-024 4.67546538e-004 9.99774862e-001
 3.66004685e-002 9.49364848e-026 3.61037326e-012 1.00000000e+000
 2.47978520e-001 8.70306516e-001 2.38205729e-003 1.26297335e-007
 6.09456494e-002 1.60802413e-005 3.42734492e-002 3.43235734e-002
 9.56817840e-001 8.71471270e-001 8.67939281e-003 6.30991882e-005
 3.98924514e-018 1.30079614e-030 3.58243388e-001 1.45753612e-003
 1.00945415e-020 2.24724998e-003 2.56542686e-002 3.12721410e-039
 4.78334888e-002 9.91195543e-001 3.35791473e-031 3.00198250e-023
 2.67189224e-002 1.79730219e-031 4.64613310e-067 3.34628159e-031
 9.99999736e-001 2.08434249e-033 2.14224634e-026 8.40661272e-026
 1.97820231e-004 5.51958131e-001 9.19655277e-001 5.15548966e-003
 9.99999340e-001 2.29262900e-026 2.59716700e-021 9.88162054e-001
 8.98923253e-010 1.14199089e-013 3.16513361e-020 1.16153661e-026
 9.97187711e-001 5.36419236e-001 6.23157478e-025 3.34674419e-031
 9.41190179e-001 9.97254100e-001 1.39475672e-021 4.68506800e-031
 9.50764353e-001 9.76590603e-001 2.16863679e-031 1.20941770e-031
 3.60552910e-057 6.35545349e-001 1.62351910e-005 3.27795749e-002
 9.99985716e-001]
2025-06-24 12:15:35,956 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:15:37,122 - src.training - INFO -   precision: 0.01002865329512894
2025-06-24 12:15:37,122 - src.training - INFO -   recall: 0.025925925925925925
2025-06-24 12:15:37,122 - src.training - INFO -   f1: 0.014462809917355372
2025-06-24 12:15:37,122 - src.training - INFO -   accuracy: 0.9956820856341088
2025-06-24 12:15:37,122 - src.training - INFO -   balanced_accuracy: 0.5113972766440252
2025-06-24 12:15:37,122 - src.training - INFO -   positive_samples: 270
2025-06-24 12:15:37,122 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:15:37,122 - src.training - INFO -   total_samples: 220940
2025-06-24 12:15:37,122 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:15:37,122 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:15:37,122 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:15:37,122 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:15:37,122 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:15:37,122 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:15:37,122 - src.training - INFO - 모델 학습 완료
2025-06-24 12:15:37,122 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.01002865329512894, 'recall': 0.025925925925925925, 'f1': 0.014462809917355372, 'accuracy': 0.9956820856341088, 'balanced_accuracy': 0.5113972766440252, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:15:37,122 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:37,122 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:37,122 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:37,122 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:37,144 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:15:37,144 - src.hyperparameter_tuning - ERROR - Trial 58 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:15:37,588 - src.hyperparameter_tuning - INFO - Trial 59: 모델 타입 = lightgbm
2025-06-24 12:15:39,373 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:15:39,373 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:15:39,373 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:15:39,373 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:15:39,373 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:15:39,373 - src.training - INFO - 교차 검증 시작
2025-06-24 12:15:39,373 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:15:39,390 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:15:39,836 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:15:39,836 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:15:39,836 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:15:39,836 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:15:39,836 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:15:39,836 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:15:39,836 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:15:39,836 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:15:39,836 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:15:40,022 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:15:40,022 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:15:40,022 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:15:40,022 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:15:40,023 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:15:40,023 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:15:40,023 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:15:40,023 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:15:40,023 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:15:40,023 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:15:41,287 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:15:42,282 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:15:42,282 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:15:42,288 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:15:42,319 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:15:42,319 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:15:42,319 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:15:42,319 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:15:43,495 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:15:43,748 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:15:43,749 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:15:43,910 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:15:43,910 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:15:43,951 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:15:43,951 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:15:43,951 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:15:43,951 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:15:43,951 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:43,951 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:44,008 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:15:44,008 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:15:44,008 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:44,008 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:44,008 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:15:44,008 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:15:44,008 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:44,065 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:15:44,065 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:15:44,065 - src.training - INFO - 모델 학습 시작
2025-06-24 12:15:44,192 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:15:44,192 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:15:44,192 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:15:44,192 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:15:44,192 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:15:44,192 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:15:44,192 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:15:44,193 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:15:44,193 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:15:44,193 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:15:44,193 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:15:44,193 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:15:44,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:15:44,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:44,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:44,271 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:44,327 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:44,384 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:44,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:44,499 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:44,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:44,588 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:15:44,588 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:44,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:15:44,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:44,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:15:44,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:44,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:44,684 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:44,697 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:44,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:44,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:44,740 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:44,756 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:44,759 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:15:44,759 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:44,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:15:44,774 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:44,774 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:15:44,774 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:44,774 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:15:44,788 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   learning_rate: 0.037784635758023766
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   n_estimators: 370
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   subsample: 0.7770963706797112
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9232241494131918
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   reg_alpha: 0.003536898282548045
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO -   reg_lambda: 2.3442692590540967e-07
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:15:44,791 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:15:44,907 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:15:44,907 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 1.19737023043695})})
2025-06-24 12:15:44,907 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:15:44,907 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:15:44,908 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:15:44,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:15:44,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:44,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:44,929 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:44,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:44,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:44,973 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:44,988 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:45,005 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:45,008 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:15:45,008 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:45,011 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:15:45,013 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:15:45,014 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:15:45,014 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:15:45,014 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:15:45,014 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:45,014 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:45,014 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:15:45,014 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:15:45,018 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:15:45,022 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:15:45,023 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [1.52605716e-002 1.86364764e-001 4.12024902e-001 9.97660155e-001
 9.99999507e-001 1.69323370e-001 7.00394027e-001 9.95102407e-001
 2.38564373e-003 8.83258534e-002 9.84058582e-001 6.80019380e-001
 1.55889324e-068 2.73769877e-004 1.29883092e-001 1.00000000e+000
 9.90936040e-004 9.99999999e-001 5.94270972e-004 3.82384803e-143
 5.32025525e-060 1.30501865e-134 9.96556729e-001 9.92856489e-004
 0.00000000e+000 7.43696866e-084 1.78499875e-085 2.21661621e-058
 6.03750450e-001 9.90989373e-001 5.43719308e-133 9.99963735e-001
 3.51426685e-001 1.70746408e-007 2.32295714e-008 2.75664628e-005
 5.23024244e-094 8.61282924e-004 3.64818674e-011 1.36182111e-002
 9.89696935e-001 9.97036761e-001 5.33920215e-006 2.08714616e-006
 2.52758091e-002 9.99999988e-001 1.39386684e-011 9.04652435e-004
 3.35526960e-002 7.26386769e-007 9.96452644e-001 9.99998224e-001
 9.99914562e-001 2.47617626e-021 1.54317819e-034 3.92585824e-011
 1.87160488e-017 2.78667731e-002 5.89819336e-054 1.65458360e-004
 2.32446408e-008 1.41566655e-055 6.82217721e-007 5.95860787e-007
 1.14004620e-009 9.99907821e-001 1.66706912e-001 7.24746124e-007
 1.40466842e-003 9.99992804e-001 9.93889801e-001 6.67462249e-008
 9.99999523e-001 6.27605061e-001 8.22904869e-001 3.60279748e-004
 7.96090454e-001 1.55555937e-004 3.64582165e-011 9.98995200e-001
 9.85958359e-001 3.02663044e-011 9.99980134e-001 1.77105448e-009
 9.65123788e-001 3.06368759e-007 8.09183485e-001 9.59779640e-001
 3.65855099e-001 9.99756591e-001 3.65167546e-001 5.14476875e-003
 4.14805852e-064 1.90553980e-008 1.07375290e-002 1.36659694e-008
 2.19806941e-003 2.35423732e-042 5.66774309e-011 4.37315689e-010
 1.27451793e-006 2.22099143e-001 3.47217441e-053 3.21231995e-001
 1.48650555e-011 2.88487413e-018 5.98919946e-019 5.94324344e-023
 7.15980182e-011 1.47082390e-004 1.45324668e-008 5.84316297e-035
 8.78821339e-022 9.12502050e-013 1.83029310e-024 1.45768633e-020
 9.01464511e-017 7.35691320e-041 4.32974429e-024 1.19124807e-019]
2025-06-24 12:15:45,023 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:15:45,799 - src.training - INFO -   precision: 0.0
2025-06-24 12:15:45,799 - src.training - INFO -   recall: 0.0
2025-06-24 12:15:45,799 - src.training - INFO -   f1: 0.0
2025-06-24 12:15:45,800 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:15:45,800 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:15:45,800 - src.training - INFO -   positive_samples: 270
2025-06-24 12:15:45,800 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:15:45,800 - src.training - INFO -   total_samples: 220940
2025-06-24 12:15:45,800 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:15:45,800 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:15:45,800 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:15:45,800 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:15:45,800 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:15:45,800 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:15:45,800 - src.training - INFO - 모델 학습 완료
2025-06-24 12:15:45,800 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:15:45,800 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:45,800 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:45,800 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:45,800 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:45,822 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:15:45,822 - src.hyperparameter_tuning - ERROR - Trial 59 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:15:46,264 - src.hyperparameter_tuning - INFO - Trial 60: 모델 타입 = lightgbm
2025-06-24 12:15:48,074 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:15:48,074 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:15:48,074 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:15:48,074 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:15:48,074 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:15:48,074 - src.training - INFO - 교차 검증 시작
2025-06-24 12:15:48,074 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:15:48,092 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:15:48,540 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:15:48,540 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:15:48,540 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:15:48,540 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:15:48,540 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:15:48,540 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:15:48,540 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:15:48,540 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:15:48,540 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:15:48,728 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:15:48,728 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:15:48,728 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:15:48,728 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:15:48,728 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:15:48,728 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:15:48,728 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:15:48,728 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:15:48,728 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:15:48,728 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:15:50,003 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:15:50,994 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:15:50,994 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:15:51,000 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:15:51,031 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:15:51,031 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:15:51,031 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:15:51,031 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:15:52,217 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:15:52,467 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:15:52,467 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:15:52,627 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:15:52,627 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:15:52,668 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:15:52,668 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:15:52,668 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:15:52,668 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:15:52,668 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:52,668 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:52,725 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:15:52,725 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:15:52,725 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:52,725 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:52,725 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:15:52,725 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:15:52,725 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:52,782 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:15:52,782 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:15:52,782 - src.training - INFO - 모델 학습 시작
2025-06-24 12:15:52,911 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:15:52,911 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:15:52,911 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:15:52,911 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:15:52,911 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:15:52,911 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:15:52,911 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:15:52,911 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:15:52,911 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:15:52,911 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:15:52,911 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:15:52,911 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:15:52,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:15:52,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:52,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:52,992 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:53,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:53,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:53,161 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:53,220 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:53,290 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:53,309 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:15:53,309 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:53,387 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:15:53,387 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:53,387 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:15:53,387 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:53,388 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:53,405 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:53,419 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:53,433 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:53,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:53,461 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:53,478 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:53,480 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:15:53,480 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:53,495 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:15:53,495 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:53,495 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:15:53,495 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:53,495 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:15:53,509 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:15:53,512 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:15:53,512 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:15:53,512 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:15:53,512 - src.models.lightgbm_model - INFO -   learning_rate: 0.013392554103156165
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   n_estimators: 322
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   subsample: 0.9930389295165857
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7907448629965969
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   reg_alpha: 4.7450984765898067e-05
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0010911443024531817
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:15:53,513 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:15:53,623 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:15:53,624 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.4308271433391891})})
2025-06-24 12:15:53,624 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:15:53,624 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:15:53,624 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:15:53,624 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:15:53,624 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:53,625 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:15:53,645 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:15:53,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:15:53,674 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:15:53,688 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:15:53,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:15:53,721 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:15:53,723 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:15:53,723 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:53,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:15:53,728 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:15:53,729 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:15:53,729 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:15:53,729 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:15:53,729 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:53,729 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:15:53,729 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:15:53,729 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:15:53,732 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:15:53,736 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:15:53,738 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00283668 0.26230007 0.10273619 0.69723879 0.00727043 0.01776714
 0.08092024 0.40500859 0.71654545 0.27413792 0.00115251 0.12444937
 0.0067757  0.97118666 0.0011524  0.10946192 0.95951352 0.54972204
 0.00115319 0.75791443 0.82075846 0.98049782 0.76030081 0.32544498
 0.00115296 0.00389547 0.00115323 0.04338242 0.89687848 0.89565245
 0.94756989]
2025-06-24 12:15:53,738 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:15:54,533 - src.training - INFO -   precision: 0.0
2025-06-24 12:15:54,533 - src.training - INFO -   recall: 0.0
2025-06-24 12:15:54,533 - src.training - INFO -   f1: 0.0
2025-06-24 12:15:54,533 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:15:54,533 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:15:54,533 - src.training - INFO -   positive_samples: 270
2025-06-24 12:15:54,533 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:15:54,533 - src.training - INFO -   total_samples: 220940
2025-06-24 12:15:54,533 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:15:54,533 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:15:54,533 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:15:54,533 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:15:54,533 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:15:54,533 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:15:54,533 - src.training - INFO - 모델 학습 완료
2025-06-24 12:15:54,533 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:15:54,533 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:54,533 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:54,534 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:15:54,534 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:15:54,557 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:15:54,557 - src.hyperparameter_tuning - ERROR - Trial 60 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:15:54,998 - src.hyperparameter_tuning - INFO - Trial 61: 모델 타입 = lightgbm
2025-06-24 12:15:56,791 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:15:56,792 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:15:56,792 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:15:56,792 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:15:56,792 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:15:56,792 - src.training - INFO - 교차 검증 시작
2025-06-24 12:15:56,792 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:15:56,808 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:15:57,249 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:15:57,249 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:15:57,249 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:15:57,249 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:15:57,249 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:15:57,249 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:15:57,249 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:15:57,249 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:15:57,249 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:15:57,436 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:15:57,436 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:15:57,436 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:15:57,436 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:15:57,436 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:15:57,436 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:15:57,436 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:15:57,436 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:15:57,436 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:15:57,436 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:15:58,720 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:15:59,715 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:15:59,715 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:15:59,721 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:15:59,751 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:15:59,751 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:15:59,751 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:15:59,751 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:16:00,954 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:16:01,203 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:16:01,203 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:16:01,363 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:16:01,364 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:16:01,404 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:16:01,404 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:16:01,404 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:16:01,404 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:16:01,404 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:01,404 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:01,461 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:16:01,461 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:16:01,461 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:01,461 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:01,461 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:16:01,461 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:16:01,461 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:01,519 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:16:01,519 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:16:01,519 - src.training - INFO - 모델 학습 시작
2025-06-24 12:16:01,646 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:16:01,647 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:16:01,647 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:16:01,647 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:16:01,647 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:16:01,647 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:16:01,647 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:16:01,647 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:16:01,647 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:16:01,647 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:16:01,647 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:16:01,647 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:16:01,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:16:01,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:01,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:01,726 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:01,782 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:01,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:01,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:01,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:02,024 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:02,042 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:16:02,043 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:02,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:16:02,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:02,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:16:02,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:02,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:02,140 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:02,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:02,168 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:02,182 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:02,196 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:02,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:02,217 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:16:02,217 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:02,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:16:02,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:02,231 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:16:02,231 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:02,231 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:16:02,245 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   learning_rate: 0.20631446752870816
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   n_estimators: 640
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   subsample: 0.9191117622824656
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9791371619540743
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   reg_alpha: 0.004839904917374925
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO -   reg_lambda: 0.05499931806892378
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:16:02,249 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:16:02,328 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:16:02,328 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.042208154373949355})})
2025-06-24 12:16:02,328 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:16:02,328 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:16:02,328 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:16:02,328 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:16:02,328 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:02,329 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:02,349 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:02,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:02,378 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:02,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:02,407 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:02,424 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:02,427 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:16:02,427 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:02,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:16:02,433 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:16:02,433 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:16:02,433 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:16:02,433 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:16:02,433 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:02,433 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:02,433 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:16:02,433 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:16:02,437 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:16:02,441 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:16:02,442 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [4.76023064e-272 1.46854603e-198 0.00000000e+000]
2025-06-24 12:16:02,442 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:16:03,225 - src.training - INFO -   precision: 0.0
2025-06-24 12:16:03,226 - src.training - INFO -   recall: 0.0
2025-06-24 12:16:03,226 - src.training - INFO -   f1: 0.0
2025-06-24 12:16:03,226 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:16:03,226 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:16:03,226 - src.training - INFO -   positive_samples: 270
2025-06-24 12:16:03,226 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:16:03,226 - src.training - INFO -   total_samples: 220940
2025-06-24 12:16:03,226 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:16:03,226 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:16:03,226 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:16:03,226 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:16:03,226 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:16:03,226 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:16:03,226 - src.training - INFO - 모델 학습 완료
2025-06-24 12:16:03,226 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:16:03,226 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:03,226 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:03,226 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:03,226 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:03,248 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:16:03,248 - src.hyperparameter_tuning - ERROR - Trial 61 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:16:03,700 - src.hyperparameter_tuning - INFO - Trial 62: 모델 타입 = lightgbm
2025-06-24 12:16:05,482 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:16:05,482 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:16:05,482 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:16:05,482 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:16:05,482 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:16:05,482 - src.training - INFO - 교차 검증 시작
2025-06-24 12:16:05,482 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:16:05,499 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:16:05,941 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:16:05,941 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:16:05,941 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:16:05,941 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:16:05,941 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:16:05,941 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:16:05,941 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:16:05,941 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:16:05,941 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:16:06,127 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:16:06,127 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:16:06,127 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:16:06,127 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:16:06,127 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:16:06,127 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:16:06,127 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:16:06,127 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:16:06,127 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:16:06,127 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:16:07,402 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:16:08,427 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:16:08,427 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:16:08,432 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:16:08,463 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:16:08,463 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:16:08,463 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:16:08,463 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:16:09,649 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:16:09,910 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:16:09,910 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:16:10,071 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:16:10,071 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:16:10,115 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:16:10,115 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:16:10,115 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:16:10,115 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:16:10,115 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:10,115 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:10,178 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:16:10,178 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:16:10,178 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:10,178 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:10,178 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:16:10,178 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:16:10,178 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:10,246 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:16:10,246 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:16:10,246 - src.training - INFO - 모델 학습 시작
2025-06-24 12:16:10,378 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:16:10,378 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:16:10,378 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:16:10,378 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:16:10,378 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:16:10,378 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:16:10,378 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:16:10,378 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:16:10,378 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:16:10,378 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:16:10,378 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:16:10,378 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:16:10,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:16:10,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:10,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:10,471 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:10,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:10,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:10,670 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:10,735 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:10,814 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:10,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:16:10,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:10,904 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:16:10,904 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:10,904 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:16:10,904 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:10,904 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:10,923 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:10,938 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:10,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:10,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:10,988 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:11,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:11,008 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:16:11,008 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:11,024 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:16:11,024 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:11,024 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:16:11,024 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:11,024 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:16:11,038 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   learning_rate: 0.11777951352006992
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   n_estimators: 794
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   subsample: 0.9090816368216922
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8767543710522415
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   reg_alpha: 0.006240465758217293
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO -   reg_lambda: 0.1929493759775437
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:16:11,041 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:16:11,160 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:16:11,160 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.4643779217698055})})
2025-06-24 12:16:11,160 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:16:11,160 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:16:11,161 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:16:11,161 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:16:11,161 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:11,161 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:11,183 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:11,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:11,216 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:11,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:11,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:11,265 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:11,268 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:16:11,268 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:11,271 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:16:11,275 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:16:11,275 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:16:11,275 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:16:11,275 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:16:11,275 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:11,275 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:11,275 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:16:11,275 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:16:11,279 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:16:11,283 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:16:11,285 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [4.89665840e-001 5.26889601e-001 5.91860253e-008 0.00000000e+000
 4.37220822e-003 5.00211472e-001 9.99999956e-001 6.49762829e-254
 9.99999945e-001 4.09501080e-001 4.21309033e-042 2.09309796e-029
 3.61230585e-001 1.00000000e+000 5.00132062e-001 9.99999964e-001
 3.11330733e-001 9.38969935e-004 8.09088778e-004 1.84510191e-011
 1.89254301e-226 6.29617362e-029 1.80855576e-300 2.88771512e-222
 1.74192609e-008 1.00000000e+000 8.43923796e-004 2.86303025e-024
 2.19934570e-029 9.99999920e-001 4.77019046e-004 2.35040762e-001
 1.64926636e-130 2.10800957e-222 6.56128084e-254 2.12711139e-081
 3.35536171e-152 3.12597424e-037 1.22097785e-273 3.19927488e-079
 2.03801561e-058 1.31775518e-065 9.99994295e-001 8.43656002e-004
 1.00000000e+000 3.81371440e-004 5.84903720e-004 1.23997035e-042
 2.65461106e-119 6.41172679e-228 2.63333629e-212 1.19592422e-306
 6.11503850e-003 1.20245984e-302 4.85401740e-131 3.87833448e-066
 1.33096075e-157 1.15102852e-008 7.19017026e-045 4.84321435e-279
 6.37443163e-082 4.37970285e-037 1.01082165e-048 7.97806434e-147
 2.18756746e-173 7.96030845e-295 1.71448889e-125 8.99902050e-110
 3.23177096e-025 5.63679507e-120 1.26511674e-113 4.50376974e-055
 1.36986764e-060 7.04151309e-110]
2025-06-24 12:16:11,285 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:16:12,647 - src.training - INFO -   precision: 0.0
2025-06-24 12:16:12,647 - src.training - INFO -   recall: 0.0
2025-06-24 12:16:12,647 - src.training - INFO -   f1: 0.0
2025-06-24 12:16:12,647 - src.training - INFO -   accuracy: 0.9979677740563049
2025-06-24 12:16:12,647 - src.training - INFO -   balanced_accuracy: 0.4995944170027643
2025-06-24 12:16:12,647 - src.training - INFO -   positive_samples: 270
2025-06-24 12:16:12,647 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:16:12,647 - src.training - INFO -   total_samples: 220940
2025-06-24 12:16:12,647 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:16:12,647 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:16:12,647 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:16:12,647 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:16:12,647 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:16:12,648 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:16:12,648 - src.training - INFO - 모델 학습 완료
2025-06-24 12:16:12,648 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9979677740563049, 'balanced_accuracy': 0.4995944170027643, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:16:12,648 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:12,648 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:12,648 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:12,648 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:12,669 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:16:12,669 - src.hyperparameter_tuning - ERROR - Trial 62 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:16:13,131 - src.hyperparameter_tuning - INFO - Trial 63: 모델 타입 = lightgbm
2025-06-24 12:16:15,109 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:16:15,109 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:16:15,109 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:16:15,109 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:16:15,109 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:16:15,109 - src.training - INFO - 교차 검증 시작
2025-06-24 12:16:15,109 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:16:15,127 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:16:15,605 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:16:15,605 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:16:15,605 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:16:15,605 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:16:15,605 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:16:15,605 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:16:15,605 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:16:15,605 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:16:15,605 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:16:15,777 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:16:15,777 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:16:15,777 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:16:15,777 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:16:15,777 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:16:15,777 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:16:15,778 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:16:15,778 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:16:15,778 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:16:15,778 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:16:17,180 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:16:18,284 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:16:18,284 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:16:18,291 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:16:18,323 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:16:18,323 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:16:18,323 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:16:18,323 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:16:19,647 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:16:19,925 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:16:19,925 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:16:20,093 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:16:20,093 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:16:20,137 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:16:20,137 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:16:20,137 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:16:20,137 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:16:20,137 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:20,137 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:20,199 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:16:20,199 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:16:20,199 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:20,199 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:20,199 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:16:20,199 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:16:20,199 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:20,266 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:16:20,266 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:16:20,266 - src.training - INFO - 모델 학습 시작
2025-06-24 12:16:20,398 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:16:20,398 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:16:20,398 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:16:20,398 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:16:20,398 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:16:20,398 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:16:20,398 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:16:20,398 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:16:20,398 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:16:20,398 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:16:20,398 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:16:20,398 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:16:20,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:16:20,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:20,399 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:20,492 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:20,555 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:20,625 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:20,691 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:20,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:20,837 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:20,857 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:16:20,857 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:20,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:16:20,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:20,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:16:20,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:20,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:20,945 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:20,961 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:20,977 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:20,993 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:21,011 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:21,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:21,031 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:16:21,031 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:21,047 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:16:21,047 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:21,047 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:16:21,047 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:21,047 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:16:21,060 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:16:21,063 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:16:21,063 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:16:21,063 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:16:21,063 - src.models.lightgbm_model - INFO -   learning_rate: 0.09793797122243625
2025-06-24 12:16:21,063 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:16:21,063 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:16:21,063 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:16:21,063 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:16:21,063 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:16:21,063 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:16:21,063 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:16:21,063 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:16:21,063 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   n_estimators: 476
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   subsample: 0.9967673037942351
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6753418692406054
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   reg_alpha: 8.980199765738657e-08
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO -   reg_lambda: 3.7275096189380217
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:16:21,064 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:16:21,189 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:16:21,189 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 4.468013519263726})})
2025-06-24 12:16:21,189 - src.models.lightgbm_model - INFO -   - Best Iteration: 4
2025-06-24 12:16:21,189 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:16:21,190 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:16:21,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:16:21,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:21,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:21,212 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:21,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:21,246 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:21,262 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:21,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:21,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:21,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:16:21,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:21,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:16:21,303 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:16:21,303 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:16:21,303 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:16:21,303 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:16:21,303 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:21,303 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:21,303 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:16:21,303 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:16:21,306 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:16:21,311 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:16:21,313 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [4.60535802e-001 1.00000000e+000 0.00000000e+000 4.19466102e-087
 1.00000000e+000 3.93035175e-002 2.97282792e-077 1.00000000e+000
 1.15306951e-168 2.88614583e-045 2.86777143e-047 4.71284805e-001
 1.00000000e+000 1.00695029e-014 8.47492316e-011 1.88238239e-052
 7.62102634e-068 7.02654128e-086 5.23912016e-054 5.47040189e-054
 6.15842963e-017 1.00000000e+000 2.22915128e-027 2.34077949e-077
 7.95745766e-068 3.10406384e-077 3.01355516e-045 5.39647114e-086
 1.38341841e-076 2.88167230e-002 4.74845045e-241 1.45907174e-078
 5.63469915e-086 3.73102403e-097 7.33672898e-086 5.20576575e-056
 2.32755749e-027 8.02133894e-300 4.10984797e-016 9.99948189e-001
 6.96335521e-001 3.83837848e-085 2.01560535e-147 3.73896211e-298
 1.39038545e-076 2.78110684e-004 6.22920960e-219 1.51264328e-146
 1.25473719e-065 1.96548043e-052 1.87614880e-023 9.83680691e-215
 6.70938983e-199 4.14605995e-109 8.06186906e-032 1.53647136e-169
 6.96767497e-094 1.00000000e+000 1.00000000e+000 1.10320259e-005
 1.15171836e-003 4.37983495e-087 4.89450842e-075 2.38867863e-142
 3.64170052e-019 1.05140225e-014 6.62490991e-001 4.39938799e-001
 3.22339853e-002 9.98102376e-001 7.84744427e-002 7.64695090e-002
 1.16012950e-012 1.44448962e-076 7.72912414e-071 1.45176422e-076
 4.16004172e-004 1.00000000e+000 1.39738402e-078 1.00000000e+000
 3.18292720e-143 1.72072677e-179 6.12352388e-133 2.29287773e-180
 3.23508063e-111 2.44411355e-077 4.33183154e-207 5.43557504e-056
 1.17818132e-007 2.71727203e-175 4.00782426e-085 5.90435234e-294
 1.11899859e-247 5.55432624e-008 2.99436962e-047 5.41913338e-110
 5.19001922e-110 2.86079423e-275 3.87775363e-137 4.32908837e-109
 8.29248585e-005 7.27526400e-094 4.03900653e-109 1.31168902e-201
 1.38094270e-136 1.81161296e-279 3.09830548e-111 7.08611732e-252
 7.05391730e-001 6.67578695e-197 4.43358169e-001 2.95596426e-159
 5.58951950e-117 3.98405081e-093 3.86824241e-109 2.45543853e-105
 2.61539815e-084 2.69275211e-045 6.76594726e-256 2.50832455e-016
 1.16156479e-060 1.95767848e-002 7.78816028e-041 8.70688664e-148
 5.25713146e-086 1.30550604e-038 2.49193219e-230 9.99256921e-001
 2.18917138e-098 4.50608618e-001 5.19950055e-131 4.30453934e-285
 5.64686903e-263 1.32632497e-156 3.02960193e-165 4.42375024e-210
 7.95166884e-243 1.25568148e-238 2.01402160e-207 5.85511602e-004
 2.18687327e-037 5.40166074e-274 2.83808174e-013 1.38160474e-191
 9.99964643e-001 9.99355186e-001 9.03805758e-173 9.56470849e-088
 1.25497611e-038 5.93973438e-219 1.86127299e-235 1.53342118e-064
 1.98140828e-061 5.56781087e-108 1.48761822e-231 3.08415182e-150
 1.74783271e-202 1.32126205e-138 3.57915891e-092 1.38097045e-301
 1.16899335e-102 9.99999995e-001 9.99999662e-001 5.03486654e-086
 1.63341850e-042 4.35270091e-098 9.41916614e-035 4.60732255e-086
 1.31166266e-036 3.54478113e-115 2.35476578e-038 4.24427427e-130
 5.57192029e-025 2.66526798e-006 7.95505396e-244 1.30630997e-089
 2.31973981e-117 3.82094499e-025 1.07228545e-033 3.23034550e-119
 4.55141370e-102 9.99996220e-001 4.78417184e-161 1.88269869e-060
 9.91667225e-135 2.77362584e-077 9.99980792e-001 3.58702805e-047
 1.22316203e-160 2.28763979e-104 4.73528648e-159 4.17436708e-021
 1.16595182e-119 8.04154802e-195 3.95905896e-096 4.29246926e-085
 8.93726740e-002 5.10384336e-054 4.54043687e-001 4.35394952e-218
 1.98990938e-098 4.10770563e-079 1.00000000e+000 9.88149927e-001
 8.91720842e-259 1.48876033e-011 1.95305533e-154 4.86343006e-009
 1.30779842e-134 2.40622382e-158 9.99998521e-001 1.78789421e-048
 5.51317360e-098 5.34524144e-214 5.79938348e-102 5.21260025e-026
 9.99992487e-001 7.05122066e-002 7.74573773e-165 2.18776241e-100
 3.09073860e-121 2.85822447e-209 2.69889089e-165 6.90021379e-165
 3.97521470e-024 9.92422255e-265 3.04169815e-032 4.97916697e-153
 1.69437342e-307 3.60223592e-016 6.06133832e-100 1.21066358e-158
 1.54718161e-106 1.05523309e-175 4.03988679e-257 7.96779629e-004
 2.84862094e-103 1.95889743e-011 2.51732557e-028 7.58479324e-162
 3.41843171e-012 9.99747694e-001 1.40894790e-016 1.60153499e-201
 1.35767501e-222 8.54015719e-083 6.91434889e-204 6.15195630e-158
 2.00590588e-001 1.69246094e-113 7.90991805e-136 1.00000000e+000
 1.54082542e-220 3.37371860e-206 8.86627006e-123 2.59899182e-087
 8.76803393e-039 1.32359782e-253 9.84335078e-010 1.11104487e-104
 7.07734365e-093 1.24342585e-008 4.07651644e-033 8.79668118e-026
 9.99993481e-001 9.99998373e-001 1.13099798e-171 7.59367524e-273
 1.33634292e-012 5.59199505e-158 3.67096059e-149 1.11230035e-298
 2.71185715e-025 9.99997450e-001 1.03714799e-051 4.88805927e-054]
2025-06-24 12:16:21,313 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:16:22,613 - src.training - INFO -   precision: 0.003248776145972408
2025-06-24 12:16:22,613 - src.training - INFO -   recall: 0.27037037037037037
2025-06-24 12:16:22,613 - src.training - INFO -   f1: 0.006420404573438874
2025-06-24 12:16:22,613 - src.training - INFO -   accuracy: 0.8977369421562416
2025-06-24 12:16:22,613 - src.training - INFO -   balanced_accuracy: 0.5844374623411194
2025-06-24 12:16:22,613 - src.training - INFO -   positive_samples: 270
2025-06-24 12:16:22,613 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:16:22,613 - src.training - INFO -   total_samples: 220940
2025-06-24 12:16:22,613 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:16:22,613 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:16:22,613 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:16:22,613 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:16:22,613 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:16:22,613 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:16:22,613 - src.training - INFO - 모델 학습 완료
2025-06-24 12:16:22,613 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003248776145972408, 'recall': 0.27037037037037037, 'f1': 0.006420404573438874, 'accuracy': 0.8977369421562416, 'balanced_accuracy': 0.5844374623411194, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:16:22,613 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:22,613 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:22,613 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:22,613 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:22,635 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:16:22,635 - src.hyperparameter_tuning - ERROR - Trial 63 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:16:23,102 - src.hyperparameter_tuning - INFO - Trial 64: 모델 타입 = lightgbm
2025-06-24 12:16:25,097 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:16:25,097 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:16:25,097 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:16:25,097 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:16:25,097 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:16:25,097 - src.training - INFO - 교차 검증 시작
2025-06-24 12:16:25,097 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:16:25,113 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:16:25,589 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:16:25,590 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:16:25,590 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:16:25,590 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:16:25,590 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:16:25,590 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:16:25,590 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:16:25,590 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:16:25,590 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:16:25,758 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:16:25,758 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:16:25,758 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:16:25,758 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:16:25,758 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:16:25,758 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:16:25,758 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:16:25,758 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:16:25,758 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:16:25,758 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:16:27,162 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:16:28,263 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:16:28,263 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:16:28,269 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:16:28,301 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:16:28,301 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:16:28,301 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:16:28,301 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:16:29,627 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:16:29,900 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:16:29,900 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:16:30,069 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:16:30,069 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:16:30,112 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:16:30,112 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:16:30,112 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:16:30,112 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:16:30,112 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:30,113 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:30,174 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:16:30,174 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:16:30,174 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:30,174 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:30,174 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:16:30,174 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:16:30,174 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:30,243 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:16:30,243 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:16:30,243 - src.training - INFO - 모델 학습 시작
2025-06-24 12:16:30,376 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:16:30,376 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:16:30,376 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:16:30,376 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:16:30,376 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:16:30,376 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:16:30,376 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:16:30,376 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:16:30,376 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:16:30,376 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:16:30,376 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:16:30,376 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:16:30,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:16:30,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:30,377 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:30,470 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:30,533 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:30,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:30,669 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:30,735 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:30,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:30,832 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:16:30,832 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:30,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:16:30,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:30,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:16:30,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:30,903 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:30,922 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:30,938 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:30,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:30,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:30,989 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:31,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:31,009 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:16:31,009 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:31,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:16:31,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:31,025 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:16:31,025 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:31,025 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:16:31,038 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   learning_rate: 0.23145281835013243
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:16:31,041 - src.models.lightgbm_model - INFO -   n_estimators: 638
2025-06-24 12:16:31,042 - src.models.lightgbm_model - INFO -   subsample: 0.907064620097668
2025-06-24 12:16:31,042 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9209736153619249
2025-06-24 12:16:31,042 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 12:16:31,042 - src.models.lightgbm_model - INFO -   reg_alpha: 3.201950386797834e-06
2025-06-24 12:16:31,042 - src.models.lightgbm_model - INFO -   reg_lambda: 2.4154728839413724
2025-06-24 12:16:31,042 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:16:31,042 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:16:31,042 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:16:31,141 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:16:31,141 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.0672587763608499})})
2025-06-24 12:16:31,141 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:16:31,141 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:16:31,142 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:16:31,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:16:31,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:31,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:31,164 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:31,181 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:31,198 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:31,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:31,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:31,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:31,250 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:16:31,250 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:31,253 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:16:31,258 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:16:31,258 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:16:31,258 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:16:31,258 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:16:31,258 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:31,258 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:31,258 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:16:31,258 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:16:31,261 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:16:31,266 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:16:31,267 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [2.85273859e-099 1.53067561e-077 0.00000000e+000 7.00440840e-070
 1.00000000e+000 1.39523754e-083 2.60032101e-105 1.28884032e-034
 5.52694630e-249 1.04109755e-202 2.47148308e-069 1.62877097e-042
 7.72021947e-070 5.48120164e-207 3.21479338e-003 9.99998375e-001
 1.78960306e-281 8.73939171e-021 2.92973228e-018]
2025-06-24 12:16:31,267 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:16:32,145 - src.training - INFO -   precision: 0.0
2025-06-24 12:16:32,145 - src.training - INFO -   recall: 0.0
2025-06-24 12:16:32,145 - src.training - INFO -   f1: 0.0
2025-06-24 12:16:32,145 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:16:32,145 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:16:32,145 - src.training - INFO -   positive_samples: 270
2025-06-24 12:16:32,145 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:16:32,145 - src.training - INFO -   total_samples: 220940
2025-06-24 12:16:32,145 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:16:32,145 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:16:32,145 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:16:32,145 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:16:32,145 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:16:32,145 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:16:32,145 - src.training - INFO - 모델 학습 완료
2025-06-24 12:16:32,145 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:16:32,145 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:32,145 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:32,145 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:32,145 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:32,165 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:16:32,167 - src.hyperparameter_tuning - ERROR - Trial 64 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:16:32,633 - src.hyperparameter_tuning - INFO - Trial 65: 모델 타입 = lightgbm
2025-06-24 12:16:34,631 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:16:34,631 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:16:34,631 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:16:34,631 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:16:34,632 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:16:34,632 - src.training - INFO - 교차 검증 시작
2025-06-24 12:16:34,632 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:16:34,649 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:16:35,124 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:16:35,124 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:16:35,124 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:16:35,124 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:16:35,124 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:16:35,124 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:16:35,124 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:16:35,124 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:16:35,124 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:16:35,294 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:16:35,294 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:16:35,294 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:16:35,294 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:16:35,294 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:16:35,294 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:16:35,294 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:16:35,294 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:16:35,294 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:16:35,294 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:16:36,694 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:16:37,787 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:16:37,787 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:16:37,791 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:16:37,823 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:16:37,823 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:16:37,823 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:16:37,823 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:16:39,124 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:16:39,398 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:16:39,398 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:16:39,567 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:16:39,567 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:16:39,610 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:16:39,610 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:16:39,610 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:16:39,610 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:16:39,610 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:39,610 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:39,672 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:16:39,672 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:16:39,672 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:39,672 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:39,672 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:16:39,672 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:16:39,672 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:39,740 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:16:39,741 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:16:39,741 - src.training - INFO - 모델 학습 시작
2025-06-24 12:16:39,873 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:16:39,873 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:16:39,873 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:16:39,873 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:16:39,873 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:16:39,873 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:16:39,873 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:16:39,873 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:16:39,873 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:16:39,873 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:16:39,873 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:16:39,873 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:16:39,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:16:39,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:39,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:39,966 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:40,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:40,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:40,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:40,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:40,307 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:40,327 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:16:40,327 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:40,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:16:40,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:40,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:16:40,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:40,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:40,416 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:40,432 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:40,449 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:40,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:40,481 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:40,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:40,501 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:16:40,501 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:40,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:16:40,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:40,516 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:16:40,516 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:40,516 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:16:40,529 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   learning_rate: 0.08262932660150138
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   n_estimators: 183
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   subsample: 0.7919491296324828
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8068076317620303
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   reg_alpha: 1.340701300805756e-07
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO -   reg_lambda: 8.105531124505632
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:16:40,533 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:16:40,657 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:16:40,657 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 5.805501613923801})})
2025-06-24 12:16:40,657 - src.models.lightgbm_model - INFO -   - Best Iteration: 4
2025-06-24 12:16:40,657 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:16:40,658 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:16:40,658 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:16:40,658 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:40,658 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:40,680 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:40,696 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:40,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:40,729 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:40,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:40,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:40,767 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:16:40,767 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:40,769 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:16:40,771 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:16:40,772 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:16:40,772 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:16:40,772 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:16:40,772 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:40,772 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:40,772 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:16:40,772 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:16:40,775 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:16:40,780 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:16:40,782 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [2.22049785e-001 0.00000000e+000 8.42855238e-094 5.47975479e-001
 1.17478685e-046 1.99373994e-160 1.00000000e+000 1.00000000e+000
 2.78681390e-001 1.00000000e+000 2.15554668e-001 1.78438714e-072
 4.95690617e-054 4.83520095e-172 5.45509082e-010 1.14594271e-164
 9.83418134e-001 2.76656500e-065 2.37491471e-048 2.14143207e-047
 1.27635517e-002 4.30307154e-158 1.00000000e+000 4.54158162e-040
 1.00207365e-055 1.02809162e-256 9.95573937e-001 1.84445839e-265
 9.84026569e-001 2.53553221e-044 7.79673540e-093 2.30312007e-035
 1.30678693e-086 4.16437492e-004 2.82042685e-084 3.85122722e-070
 2.87183215e-063 2.47327816e-162 3.26530029e-026 1.85228266e-070
 9.99999595e-001 8.74925683e-092 5.97105313e-063 8.24987622e-002
 9.66129439e-001 1.00000000e+000 1.00000000e+000 1.03784098e-005
 5.82959356e-006 1.89429656e-002 1.04357721e-169 2.92924253e-047
 1.64728876e-188 1.81912712e-091 3.15247276e-005 2.35586629e-015
 9.67351184e-001 4.51338771e-004 1.07293723e-002 1.06984474e-051
 2.06960128e-158 1.00632970e-055 3.34035780e-154 6.48779252e-069
 3.36091175e-187 2.46407667e-002 9.99999993e-001 1.96007064e-002
 9.72367883e-001 1.59398273e-249 1.68276261e-090 2.56979736e-024
 4.14067697e-004 3.71244503e-028 9.99993934e-001 9.81997157e-001
 9.99912656e-001 1.27305439e-088 1.54037639e-001 4.04731426e-003
 1.35981939e-005 3.82291706e-112 1.35650987e-084 6.73465151e-067
 5.14551529e-052 2.01929586e-014 5.67914059e-163 3.68278784e-114
 9.19548496e-065 6.17907185e-010 9.99997909e-001 1.00000000e+000
 1.00000000e+000 1.27990885e-067 4.57083904e-183 7.94852891e-112
 4.14535798e-002 7.41965927e-165 1.27135614e-182 8.37849546e-003
 6.64095784e-001 1.87099956e-003 1.05180556e-003 1.42713995e-043
 6.78914382e-026 4.49216324e-277 1.98465351e-062 7.76968464e-001
 2.66105291e-168 1.40025460e-066 8.09339937e-091 1.74253872e-016
 2.12919912e-168 9.99838067e-001 1.66312597e-264 1.14721154e-251
 9.43359116e-224 9.03557771e-055 5.30845019e-176 1.28570048e-035
 2.03919248e-019 1.68477873e-179 1.59280867e-179 9.99909036e-001
 8.78493148e-032 1.25662235e-003 1.21948721e-044 9.93763545e-001
 9.99999159e-001 1.33362352e-007 5.60345874e-012 4.83476297e-183
 7.00672887e-001 2.23498007e-003 2.18942091e-080 1.00000000e+000
 5.01917922e-170 3.06450869e-090 6.61410240e-088 3.46515738e-181
 8.06478571e-001 5.29598113e-001 1.48193949e-002 1.00000000e+000
 4.61363278e-182 1.11881388e-173 1.04559474e-019 7.21949078e-172
 3.26279964e-188 1.00000000e+000 6.41418368e-008 7.82807036e-070
 3.45119632e-188 9.99970924e-001 3.59845757e-018 1.18954556e-162
 4.39655988e-016 1.35998118e-005 1.85169631e-001 1.51545373e-016
 4.50092879e-080 1.00000000e+000 1.00000000e+000 7.28871217e-017
 8.45022516e-001 2.23192174e-049 1.00000000e+000 1.94527846e-016
 7.31166796e-189 3.18111253e-088 3.15227958e-002 2.62685309e-253
 3.51713635e-059 1.74240455e-188 3.62697584e-072 4.98083975e-001
 1.00000000e+000 7.36940729e-058 5.37667039e-001 8.25693072e-226
 4.39708297e-016 9.98714499e-001 1.00000000e+000 3.55497350e-187
 9.96192551e-001 3.21816774e-227 2.44009560e-007 9.99663372e-001
 3.28734084e-220 7.18277133e-003 5.19224735e-209 2.51578921e-168
 9.99999929e-001 9.89239546e-001 2.88039934e-001 1.01875474e-191
 3.14257488e-013 1.21311807e-040 8.67068544e-001 4.62370032e-225
 5.98094933e-003 2.09189743e-004 1.46931713e-216 1.07395540e-224
 4.21671093e-001 4.21645877e-220 1.61122934e-221 4.47895111e-183
 1.00000000e+000 2.18650023e-174 9.99998823e-001 6.66666782e-001
 1.00000000e+000 7.25939697e-008 9.47067214e-001 1.12144082e-223
 9.99888146e-001 1.57231695e-038 1.10835159e-012 1.88849168e-017
 3.55007334e-188 8.91684529e-194 3.32025069e-010 1.73019955e-188
 1.00000000e+000 2.52905581e-004 1.59920093e-189 4.28858908e-196
 9.99999999e-001 6.82335337e-024 5.10815699e-003 9.85286638e-002
 8.12380905e-004 1.32369211e-039 4.81713725e-047 6.53443055e-025
 2.15972068e-040 3.53335146e-074 3.39172580e-001 7.53489938e-002
 1.74102057e-008 3.69053602e-222 2.32073836e-205 1.00000000e+000
 3.97124571e-226 2.30250438e-011 9.99937976e-001 2.95110188e-217
 1.25628687e-002 1.79558391e-017 9.41517792e-001 1.70993417e-224
 1.74333436e-001 9.99939548e-001 1.00000000e+000 9.99999998e-001
 6.04050492e-012 4.41414688e-006 9.57199634e-013 9.41511241e-001
 2.17952089e-001 3.97033729e-011 9.39282005e-001 1.52219369e-086
 9.99377653e-001 9.99999996e-001 1.00000000e+000 6.62607064e-213
 5.60722475e-177 9.99987883e-001 3.66279208e-222 6.65975873e-209
 3.68008364e-005 3.06636079e-192 1.00000000e+000 8.79945081e-196
 9.96960287e-001 9.99997566e-001 7.35753249e-213 1.60908979e-180
 3.55933574e-221 4.96510582e-192 9.99999921e-001 2.67649475e-027
 4.63960133e-221 7.68383498e-009 6.33289441e-229 8.78776941e-013
 9.99999979e-001 8.88017704e-002 1.78540983e-016 9.99966563e-001
 1.00000000e+000 9.99998621e-001 8.16799521e-013 8.14142006e-024
 2.21045724e-015 9.89136428e-012 9.99700580e-001 1.43054165e-222
 1.36996789e-223 1.10743472e-010 6.24935625e-181 9.79300306e-001
 9.62893237e-001 1.41687468e-232 1.00000000e+000 2.61826216e-038
 1.14434775e-007 2.05497586e-220 3.56851150e-200 2.67617634e-027
 4.38277675e-027 8.02357866e-008 4.06842857e-220 1.94173853e-216
 1.00000000e+000 1.58658102e-218 6.13305588e-042 1.31849494e-208
 1.95807886e-027 2.07372647e-217 7.22571014e-223 6.50145194e-011
 1.81493260e-012 6.42175641e-007 1.05610229e-008 5.43693110e-010
 6.03384424e-220 8.34771912e-220 9.91502027e-001 8.35491380e-001
 6.07407360e-008 1.87980081e-031 1.19943352e-004 6.08373101e-191
 5.16546936e-024 1.00000000e+000 1.68842862e-228 1.09032248e-016
 8.84310943e-001 3.96588993e-006 4.07591514e-015 3.87840157e-013
 1.26695152e-001 4.38225536e-027 1.02013580e-020 7.16101214e-217
 7.22817255e-006 6.94454933e-234 1.23927508e-004 5.01040988e-189
 1.53220610e-219 6.51608418e-188 1.43300557e-020 4.97184075e-024
 1.00000000e+000 3.29317934e-022 3.87243366e-006 3.45614479e-215
 1.00000000e+000 1.41367378e-219 1.19675441e-216 3.28853899e-209
 6.83746124e-209 1.49445251e-192 3.98411514e-216 9.81564595e-001
 9.99810888e-001 7.09141760e-215 7.23944005e-001 9.99936665e-001
 4.13143738e-196 9.01568706e-001 2.79565797e-222 7.36928420e-220
 2.69690037e-216 3.41446372e-060 9.99996722e-001 3.08646328e-229
 9.71475106e-228 1.50785569e-004 6.04778373e-004 7.59100474e-057
 1.16218484e-015 2.51738468e-204 1.96356017e-218 2.41133807e-220
 7.54124260e-202 1.87097363e-025 2.35908783e-036 9.99998725e-001
 2.47643540e-208 2.31684584e-047 3.59794510e-232 4.36546307e-012
 9.99996900e-001 1.99123771e-020 1.00000000e+000 2.74223299e-192
 5.38436912e-028 3.13396978e-188 4.28863760e-194 2.09672626e-225
 5.74566496e-196 9.99999863e-001 1.60095028e-184 1.00025996e-217
 6.07908802e-219 2.23790722e-221 9.89746404e-001 8.45072493e-035
 2.59867724e-026 2.32071350e-040 1.21525030e-217 9.01777591e-203
 1.13693149e-007 5.69682605e-051 1.21135443e-072 2.45376940e-005
 5.41244979e-222 5.42716219e-225 9.97671671e-001 1.77499676e-222
 8.42754482e-001 3.87659248e-027 9.99999699e-001 9.39539968e-030
 2.03248594e-034 9.96148908e-001 1.12391522e-223 1.96697556e-215
 2.17562677e-007 5.67432135e-036 3.76450907e-216 1.82337206e-196
 5.46383692e-199 7.15815345e-223 4.55848400e-011 3.82567950e-228
 1.53563387e-003 1.16022740e-002 7.77633356e-220 9.89871081e-001
 1.00843951e-225 9.99996653e-001 2.48826665e-216 6.01199627e-188
 3.88460767e-212 3.16799743e-211 9.99987463e-001 6.79919227e-220
 9.94572811e-001 9.99999050e-001 2.67752929e-220 3.77208675e-120
 9.99996065e-001 6.66900082e-006 1.00000000e+000 2.38201908e-022
 8.66856633e-030 4.92632302e-110 3.45543914e-001 3.03461747e-005]
2025-06-24 12:16:40,782 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:16:42,157 - src.training - INFO -   precision: 0.0027533571635590766
2025-06-24 12:16:42,157 - src.training - INFO -   recall: 0.2111111111111111
2025-06-24 12:16:42,157 - src.training - INFO -   f1: 0.0054358191874880795
2025-06-24 12:16:42,157 - src.training - INFO -   accuracy: 0.905594278989771
2025-06-24 12:16:42,157 - src.training - INFO -   balanced_accuracy: 0.5587775612654391
2025-06-24 12:16:42,157 - src.training - INFO -   positive_samples: 270
2025-06-24 12:16:42,157 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:16:42,157 - src.training - INFO -   total_samples: 220940
2025-06-24 12:16:42,157 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:16:42,157 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:16:42,157 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:16:42,157 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:16:42,157 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:16:42,157 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:16:42,157 - src.training - INFO - 모델 학습 완료
2025-06-24 12:16:42,157 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0027533571635590766, 'recall': 0.2111111111111111, 'f1': 0.0054358191874880795, 'accuracy': 0.905594278989771, 'balanced_accuracy': 0.5587775612654391, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:16:42,157 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:42,157 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:42,157 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:42,157 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:42,180 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:16:42,180 - src.hyperparameter_tuning - ERROR - Trial 65 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:16:42,641 - src.hyperparameter_tuning - INFO - Trial 66: 모델 타입 = lightgbm
2025-06-24 12:16:44,626 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:16:44,626 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:16:44,626 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:16:44,626 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:16:44,626 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:16:44,626 - src.training - INFO - 교차 검증 시작
2025-06-24 12:16:44,626 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:16:44,642 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:16:45,118 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:16:45,118 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:16:45,118 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:16:45,118 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:16:45,118 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:16:45,118 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:16:45,118 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:16:45,118 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:16:45,118 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:16:45,288 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:16:45,288 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:16:45,288 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:16:45,288 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:16:45,288 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:16:45,288 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:16:45,288 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:16:45,288 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:16:45,288 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:16:45,288 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:16:46,689 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:16:47,792 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:16:47,792 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:16:47,799 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:16:47,831 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:16:47,831 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:16:47,831 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:16:47,831 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:16:49,131 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:16:49,402 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:16:49,402 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:16:49,571 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:16:49,571 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:16:49,614 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:16:49,614 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:16:49,614 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:16:49,614 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:16:49,614 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:49,614 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:49,675 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:16:49,676 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:16:49,676 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:49,676 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:49,676 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:16:49,676 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:16:49,676 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:49,740 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:16:49,740 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:16:49,740 - src.training - INFO - 모델 학습 시작
2025-06-24 12:16:49,872 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:16:49,872 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:16:49,872 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:16:49,872 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:16:49,872 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:16:49,872 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:16:49,872 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:16:49,872 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:16:49,872 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:16:49,872 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:16:49,872 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:16:49,872 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:16:49,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:16:49,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:49,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:49,965 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:50,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:50,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:50,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:50,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:50,307 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:50,323 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:16:50,323 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:50,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:16:50,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:50,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:16:50,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:50,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:50,400 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:50,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:50,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:50,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:50,464 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:50,482 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:50,485 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:16:50,485 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:50,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:16:50,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:50,501 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:16:50,501 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:50,501 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:16:50,517 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   learning_rate: 0.26721247426120437
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   n_estimators: 499
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   subsample: 0.9198592827243435
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.963497212989292
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   reg_alpha: 0.027874863296583702
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO -   reg_lambda: 2.3072404317971444
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:16:50,521 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:16:50,606 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:16:50,606 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.06770410082217271})})
2025-06-24 12:16:50,606 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:16:50,606 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:16:50,607 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:16:50,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:16:50,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:50,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:50,629 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:50,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:50,663 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:50,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:50,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:50,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:50,715 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:16:50,715 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:50,720 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:16:50,722 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:16:50,722 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:16:50,722 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:16:50,722 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:16:50,722 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:50,722 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:50,722 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:16:50,722 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:16:50,726 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:16:50,730 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:16:50,731 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00000000e+000 1.30774678e-082 9.99999999e-001 6.75766988e-042
 4.13493097e-290 1.09901085e-236 9.60001327e-075 1.46322386e-082
 1.26280590e-241 1.20009626e-005 1.00000000e+000 8.85315817e-016]
2025-06-24 12:16:50,731 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:16:51,612 - src.training - INFO -   precision: 0.0
2025-06-24 12:16:51,612 - src.training - INFO -   recall: 0.0
2025-06-24 12:16:51,612 - src.training - INFO -   f1: 0.0
2025-06-24 12:16:51,612 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:16:51,612 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:16:51,612 - src.training - INFO -   positive_samples: 270
2025-06-24 12:16:51,612 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:16:51,612 - src.training - INFO -   total_samples: 220940
2025-06-24 12:16:51,612 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:16:51,612 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:16:51,612 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:16:51,612 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:16:51,613 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:16:51,613 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:16:51,613 - src.training - INFO - 모델 학습 완료
2025-06-24 12:16:51,613 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:16:51,613 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:51,613 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:51,613 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:51,613 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:51,634 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:16:51,634 - src.hyperparameter_tuning - ERROR - Trial 66 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:16:52,096 - src.hyperparameter_tuning - INFO - Trial 67: 모델 타입 = lightgbm
2025-06-24 12:16:54,049 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:16:54,049 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:16:54,049 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:16:54,049 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:16:54,049 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:16:54,049 - src.training - INFO - 교차 검증 시작
2025-06-24 12:16:54,049 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:16:54,065 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:16:54,541 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:16:54,541 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:16:54,541 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:16:54,541 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:16:54,541 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:16:54,541 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:16:54,541 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:16:54,541 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:16:54,541 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:16:54,710 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:16:54,710 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:16:54,710 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:16:54,710 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:16:54,710 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:16:54,710 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:16:54,710 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:16:54,710 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:16:54,710 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:16:54,710 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:16:56,128 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:16:57,225 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:16:57,225 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:16:57,231 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:16:57,263 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:16:57,263 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:16:57,263 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:16:57,263 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:16:58,558 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:16:58,832 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:16:58,833 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:16:59,001 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:16:59,001 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:16:59,044 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:16:59,044 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:16:59,044 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:16:59,044 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:16:59,044 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:59,044 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:16:59,106 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:16:59,106 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:16:59,106 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:59,106 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:59,106 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:16:59,106 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:16:59,106 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:59,173 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:16:59,173 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:16:59,173 - src.training - INFO - 모델 학습 시작
2025-06-24 12:16:59,304 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:16:59,304 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:16:59,304 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:16:59,304 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:16:59,304 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:16:59,304 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:16:59,304 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:16:59,304 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:16:59,304 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:16:59,304 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:16:59,304 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:16:59,304 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:16:59,304 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:16:59,304 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:59,304 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:59,397 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:59,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:59,534 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:59,598 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:59,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:59,740 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:59,760 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:16:59,760 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:59,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:16:59,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:59,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:16:59,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:59,831 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:16:59,849 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:16:59,865 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:16:59,883 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:16:59,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:16:59,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:16:59,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:16:59,938 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:16:59,938 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:16:59,953 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:16:59,953 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:59,953 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:16:59,953 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:16:59,953 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:16:59,967 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   learning_rate: 0.03411556844809027
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   n_estimators: 289
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   subsample: 0.9954727896923288
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8624191262425692
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   reg_alpha: 0.08490060659676064
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO -   reg_lambda: 4.145642930639667e-08
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:16:59,971 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:17:00,082 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:17:00,082 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 1.2996779416788904})})
2025-06-24 12:17:00,082 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:17:00,082 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:17:00,082 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:17:00,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:17:00,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:00,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:00,105 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:00,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:00,138 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:00,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:00,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:00,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:00,190 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:17:00,190 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:00,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:17:00,194 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:17:00,195 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:17:00,195 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:17:00,195 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:17:00,195 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:00,195 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:00,195 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:17:00,195 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:17:00,198 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:17:00,203 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:17:00,204 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [1.22017185e-002 2.54420109e-002 7.03305354e-001 9.92122876e-001
 9.99996204e-001 1.11337375e-001 5.33766832e-001 9.84732364e-001
 1.42045164e-005 4.01566428e-004 9.88014734e-001 2.45253659e-001
 1.35617010e-056 5.96919701e-003 8.71657336e-002 9.99999996e-001
 1.03145981e-003 9.99999990e-001 2.11063339e-008 9.98841774e-003
 2.98382336e-066 7.50868268e-100 1.39097120e-060 7.04414350e-053
 3.80254016e-092 1.03326444e-003 1.51106507e-058 6.86790411e-049
 0.00000000e+000 2.68577170e-061 4.38283394e-057 7.44562506e-001
 8.73137402e-001 1.10292418e-090 9.99814192e-001 8.37604283e-001
 1.27564863e-007 2.55165461e-007 1.19506554e-008 1.08512988e-006
 1.81099083e-091 2.42892863e-005 1.24420630e-012 9.99428968e-001
 6.51562626e-001 2.85543969e-006 5.07131936e-001 5.20165715e-001
 9.99999871e-001 9.98402407e-001 5.91041069e-006 2.47142898e-002
 5.71166368e-006 9.99790144e-001 2.66010120e-082 2.04314902e-051
 9.25970699e-063 9.99999769e-001 9.99992376e-001 1.18960012e-063
 7.92971603e-020 1.55383974e-025 2.11218593e-004 9.99992763e-001
 2.55314912e-007 4.10137189e-065 1.82846725e-070 2.67506734e-007
 7.26803897e-008 2.78343582e-011 7.04298300e-003 5.37501492e-002
 2.14810625e-002 1.03382604e-007 9.99997862e-001 9.99958889e-001
 9.99778906e-001 9.98808937e-001 2.84819510e-001 1.60238330e-001
 1.24347799e-012 9.99980302e-001 5.18920711e-004 9.99999404e-001
 3.77465179e-001 1.41686308e-005 1.23921410e-007 7.26766824e-001
 5.48092393e-001 8.09877051e-073 3.24693930e-009 8.78968507e-005
 4.13973437e-010 6.94572219e-027 5.53960647e-009 2.56392429e-002
 1.85047686e-011 5.56436538e-006 4.59243372e-008 5.89554939e-063
 1.51986471e-002 9.97486611e-001 3.29947801e-020 9.99999781e-001
 2.16273796e-013 3.32156130e-001 6.94483664e-002 3.92889164e-062
 9.99345507e-001 9.99999444e-001]
2025-06-24 12:17:00,204 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:17:01,083 - src.training - INFO -   precision: 0.0
2025-06-24 12:17:01,083 - src.training - INFO -   recall: 0.0
2025-06-24 12:17:01,083 - src.training - INFO -   f1: 0.0
2025-06-24 12:17:01,083 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:17:01,083 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:17:01,083 - src.training - INFO -   positive_samples: 270
2025-06-24 12:17:01,083 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:17:01,083 - src.training - INFO -   total_samples: 220940
2025-06-24 12:17:01,083 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:17:01,083 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:17:01,083 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:17:01,083 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:17:01,083 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:17:01,083 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:17:01,083 - src.training - INFO - 모델 학습 완료
2025-06-24 12:17:01,083 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:17:01,083 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:01,083 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:01,083 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:01,083 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:01,105 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:17:01,105 - src.hyperparameter_tuning - ERROR - Trial 67 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:17:01,566 - src.hyperparameter_tuning - INFO - Trial 68: 모델 타입 = lightgbm
2025-06-24 12:17:03,539 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:17:03,539 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:17:03,539 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:17:03,539 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:17:03,539 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:17:03,539 - src.training - INFO - 교차 검증 시작
2025-06-24 12:17:03,539 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:17:03,555 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:17:04,031 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:17:04,031 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:17:04,031 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:17:04,031 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:17:04,031 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:17:04,031 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:17:04,031 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:17:04,031 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:17:04,031 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:17:04,198 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:17:04,198 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:17:04,198 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:17:04,198 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:17:04,198 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:17:04,198 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:17:04,199 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:17:04,199 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:17:04,199 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:17:04,199 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:17:05,596 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:17:06,706 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:17:06,706 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:17:06,712 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:17:06,744 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:17:06,744 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:17:06,744 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:17:06,744 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:17:07,962 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:17:08,214 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:17:08,214 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:17:08,374 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:17:08,374 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:17:08,415 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:17:08,415 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:17:08,415 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:17:08,415 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:17:08,415 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:08,415 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:08,471 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:17:08,471 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:17:08,472 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:08,472 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:08,472 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:17:08,472 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:17:08,472 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:08,529 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:17:08,529 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:17:08,529 - src.training - INFO - 모델 학습 시작
2025-06-24 12:17:08,656 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:17:08,656 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:17:08,656 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:17:08,656 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:17:08,656 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:17:08,656 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:17:08,656 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:17:08,656 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:17:08,656 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:17:08,656 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:17:08,656 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:17:08,656 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:17:08,656 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:17:08,656 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:08,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:08,735 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:08,791 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:08,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:08,904 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:08,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:09,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:09,052 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:17:09,052 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:09,131 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:17:09,132 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:09,132 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:17:09,132 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:09,132 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:09,150 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:09,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:09,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:09,191 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:09,206 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:09,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:09,226 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:17:09,226 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:09,241 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:17:09,241 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:09,241 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:17:09,241 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:09,241 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:17:09,255 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   learning_rate: 0.010895804627521117
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:17:09,258 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   n_estimators: 114
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   subsample: 0.9877046581819738
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.713960293382886
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   reg_alpha: 7.824522303665411e-05
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO -   reg_lambda: 1.0245299767812447e-05
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:17:09,259 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:17:09,366 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:17:09,366 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.1730024441154183})})
2025-06-24 12:17:09,366 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:17:09,366 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:17:09,367 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:17:09,367 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:17:09,367 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:09,367 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:09,388 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:09,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:09,418 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:09,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:09,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:09,464 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:09,467 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:17:09,467 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:09,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:17:09,473 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:17:09,473 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:17:09,473 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:17:09,473 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:17:09,473 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:09,473 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:09,473 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:17:09,473 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:17:09,476 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:17:09,481 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:17:09,482 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00240437 0.1091018  0.04644902 0.3589307  0.0146863  0.01073859
 0.03784845 0.17198733 0.37655928 0.11396403 0.00115533 0.00488612
 0.83246642 0.00115524 0.00115617 0.78862401 0.25042816 0.00115589
 0.41820076 0.49479235 0.87308539 0.42078625 0.13567855 0.0011557
 0.51135575 0.00311269 0.00115591 0.02241536 0.62271531 0.62019143
 0.74953649]
2025-06-24 12:17:09,482 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:17:10,258 - src.training - INFO -   precision: 0.0
2025-06-24 12:17:10,258 - src.training - INFO -   recall: 0.0
2025-06-24 12:17:10,258 - src.training - INFO -   f1: 0.0
2025-06-24 12:17:10,258 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:17:10,258 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:17:10,258 - src.training - INFO -   positive_samples: 270
2025-06-24 12:17:10,258 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:17:10,258 - src.training - INFO -   total_samples: 220940
2025-06-24 12:17:10,258 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:17:10,258 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:17:10,258 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:17:10,258 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:17:10,259 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:17:10,259 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:17:10,259 - src.training - INFO - 모델 학습 완료
2025-06-24 12:17:10,259 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:17:10,259 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:10,259 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:10,259 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:10,259 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:10,282 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:17:10,282 - src.hyperparameter_tuning - ERROR - Trial 68 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:17:10,718 - src.hyperparameter_tuning - INFO - Trial 69: 모델 타입 = lightgbm
2025-06-24 12:17:12,522 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:17:12,523 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:17:12,523 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:17:12,523 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:17:12,523 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:17:12,523 - src.training - INFO - 교차 검증 시작
2025-06-24 12:17:12,523 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:17:12,540 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:17:12,981 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:17:12,981 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:17:12,982 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:17:12,982 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:17:12,982 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:17:12,982 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:17:12,982 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:17:12,982 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:17:12,982 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:17:13,169 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:17:13,169 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:17:13,169 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:17:13,169 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:17:13,169 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:17:13,169 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:17:13,169 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:17:13,169 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:17:13,169 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:17:13,169 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:17:14,430 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:17:15,414 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:17:15,414 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:17:15,420 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:17:15,451 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:17:15,451 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:17:15,451 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:17:15,452 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:17:16,642 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:17:16,891 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:17:16,892 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:17:17,051 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:17:17,052 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:17:17,092 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:17:17,092 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:17:17,092 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:17:17,093 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:17:17,093 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:17,093 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:17,149 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:17:17,149 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:17:17,149 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:17,149 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:17,149 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:17:17,149 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:17:17,149 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:17,207 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:17:17,207 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:17:17,207 - src.training - INFO - 모델 학습 시작
2025-06-24 12:17:17,337 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:17:17,337 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:17:17,337 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:17:17,337 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:17:17,337 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:17:17,337 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:17:17,337 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:17:17,337 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:17:17,337 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:17:17,337 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:17:17,337 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:17:17,337 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:17:17,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:17:17,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:17,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:17,418 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:17,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:17,531 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:17,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:17,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:17,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:17,734 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:17:17,734 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:17,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:17:17,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:17,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:17:17,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:17,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:17,830 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:17,844 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:17,858 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:17,871 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:17,886 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:17,903 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:17,905 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:17:17,905 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:17,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:17:17,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:17,920 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:17:17,920 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:17,920 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:17:17,934 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:17:17,937 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:17:17,937 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:17:17,937 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:17:17,937 - src.models.lightgbm_model - INFO -   learning_rate: 0.25937689302480815
2025-06-24 12:17:17,937 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:17:17,937 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:17:17,937 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:17:17,937 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:17:17,937 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:17:17,937 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:17:17,937 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:17:17,937 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:17:17,937 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:17:17,937 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   n_estimators: 637
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   subsample: 0.8132826784244788
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9883787656176392
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0002750548279866881
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO -   reg_lambda: 0.16932376258571966
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:17:17,938 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:17:18,025 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:17:18,025 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.042208154373949355})})
2025-06-24 12:17:18,025 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:17:18,025 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:17:18,025 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:17:18,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:17:18,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:18,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:18,047 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:18,061 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:18,076 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:18,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:18,105 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:18,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:18,125 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:17:18,125 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:18,128 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:17:18,131 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:17:18,131 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:17:18,131 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:17:18,131 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:17:18,131 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:18,131 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:18,131 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:17:18,131 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:17:18,134 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:17:18,138 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:17:18,139 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:17:18,139 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:17:18,865 - src.training - INFO -   precision: 0.0
2025-06-24 12:17:18,865 - src.training - INFO -   recall: 0.0
2025-06-24 12:17:18,865 - src.training - INFO -   f1: 0.0
2025-06-24 12:17:18,865 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:17:18,865 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:17:18,865 - src.training - INFO -   positive_samples: 270
2025-06-24 12:17:18,865 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:17:18,865 - src.training - INFO -   total_samples: 220940
2025-06-24 12:17:18,865 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:17:18,865 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:17:18,865 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:17:18,865 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:17:18,865 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:17:18,865 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:17:18,865 - src.training - INFO - 모델 학습 완료
2025-06-24 12:17:18,865 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:17:18,865 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:18,865 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:18,865 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:18,865 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:18,887 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:17:18,887 - src.hyperparameter_tuning - ERROR - Trial 69 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:17:19,334 - src.hyperparameter_tuning - INFO - Trial 70: 모델 타입 = lightgbm
2025-06-24 12:17:21,123 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:17:21,123 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:17:21,123 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:17:21,123 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:17:21,123 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:17:21,123 - src.training - INFO - 교차 검증 시작
2025-06-24 12:17:21,123 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:17:21,140 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:17:21,585 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:17:21,585 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:17:21,585 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:17:21,585 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:17:21,585 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:17:21,585 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:17:21,585 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:17:21,585 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:17:21,585 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:17:21,771 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:17:21,771 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:17:21,771 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:17:21,771 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:17:21,771 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:17:21,771 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:17:21,771 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:17:21,771 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:17:21,771 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:17:21,771 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:17:23,038 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:17:24,031 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:17:24,031 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:17:24,036 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:17:24,067 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:17:24,067 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:17:24,067 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:17:24,067 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:17:25,260 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:17:25,509 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:17:25,509 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:17:25,669 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:17:25,669 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:17:25,710 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:17:25,710 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:17:25,710 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:17:25,710 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:17:25,710 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:25,710 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:25,767 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:17:25,767 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:17:25,767 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:25,767 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:25,767 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:17:25,767 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:17:25,767 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:25,825 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:17:25,825 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:17:25,825 - src.training - INFO - 모델 학습 시작
2025-06-24 12:17:25,953 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:17:25,953 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:17:25,953 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:17:25,953 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:17:25,953 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:17:25,953 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:17:25,953 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:17:25,953 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:17:25,953 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:17:25,953 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:17:25,953 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:17:25,953 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:17:25,953 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:17:25,953 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:25,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:26,032 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:26,088 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:26,145 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:26,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:26,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:26,329 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:26,348 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:17:26,348 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:26,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:17:26,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:26,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:17:26,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:26,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:26,444 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:26,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:26,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:26,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:26,500 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:26,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:26,520 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:17:26,520 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:26,535 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:17:26,535 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:26,535 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:17:26,535 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:26,535 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:17:26,550 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:17:26,553 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   learning_rate: 0.177494251885488
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   n_estimators: 102
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   subsample: 0.918729073413142
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7056806877358163
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   reg_alpha: 0.025250959484224886
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO -   reg_lambda: 0.006352357324010403
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:17:26,554 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:17:26,642 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:17:26,642 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.042208258204749216})})
2025-06-24 12:17:26,642 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:17:26,642 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:17:26,643 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:17:26,643 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:17:26,643 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:26,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:26,664 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:26,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:26,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:26,707 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:26,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:26,739 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:26,741 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:17:26,742 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:26,745 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:17:26,747 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:17:26,747 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:17:26,747 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:17:26,747 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:17:26,747 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:26,747 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:26,747 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:17:26,747 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:17:26,751 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:17:26,755 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:17:26,756 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [3.24862000e-028 7.52872826e-025 0.00000000e+000 1.58504038e-165
 1.12610485e-144 7.88705506e-022 8.56649574e-005 7.57768329e-083
 1.09811680e-008 1.09144165e-098 5.73610022e-028 3.07989885e-034
 2.13831843e-018 1.29913576e-007 2.40979455e-062 1.62197031e-160
 8.30816748e-123 1.53300672e-166 1.59424350e-027 3.69801987e-115
 2.92468534e-209 4.54192251e-045 7.05511876e-158 8.38066609e-089]
2025-06-24 12:17:26,756 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:17:27,520 - src.training - INFO -   precision: 0.0
2025-06-24 12:17:27,520 - src.training - INFO -   recall: 0.0
2025-06-24 12:17:27,520 - src.training - INFO -   f1: 0.0
2025-06-24 12:17:27,520 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:17:27,520 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:17:27,520 - src.training - INFO -   positive_samples: 270
2025-06-24 12:17:27,520 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:17:27,520 - src.training - INFO -   total_samples: 220940
2025-06-24 12:17:27,520 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:17:27,520 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:17:27,520 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:17:27,520 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:17:27,520 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:17:27,520 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:17:27,520 - src.training - INFO - 모델 학습 완료
2025-06-24 12:17:27,520 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:17:27,520 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:27,520 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:27,520 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:27,520 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:27,542 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:17:27,542 - src.hyperparameter_tuning - ERROR - Trial 70 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:17:27,984 - src.hyperparameter_tuning - INFO - Trial 71: 모델 타입 = lightgbm
2025-06-24 12:17:29,783 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:17:29,783 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:17:29,783 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:17:29,783 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:17:29,783 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:17:29,783 - src.training - INFO - 교차 검증 시작
2025-06-24 12:17:29,783 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:17:29,800 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:17:30,242 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:17:30,242 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:17:30,242 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:17:30,242 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:17:30,242 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:17:30,242 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:17:30,242 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:17:30,242 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:17:30,242 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:17:30,429 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:17:30,429 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:17:30,429 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:17:30,429 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:17:30,429 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:17:30,429 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:17:30,429 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:17:30,429 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:17:30,429 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:17:30,430 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:17:31,712 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:17:32,696 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:17:32,696 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:17:32,702 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:17:32,733 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:17:32,733 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:17:32,733 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:17:32,733 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:17:33,927 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:17:34,178 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:17:34,179 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:17:34,344 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:17:34,345 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:17:34,386 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:17:34,386 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:17:34,386 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:17:34,386 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:17:34,386 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:34,386 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:34,443 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:17:34,443 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:17:34,443 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:34,443 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:34,443 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:17:34,443 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:17:34,443 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:34,502 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:17:34,502 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:17:34,502 - src.training - INFO - 모델 학습 시작
2025-06-24 12:17:34,631 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:17:34,631 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:17:34,631 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:17:34,631 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:17:34,631 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:17:34,631 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:17:34,631 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:17:34,631 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:17:34,631 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:17:34,631 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:17:34,631 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:17:34,631 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:17:34,631 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:17:34,631 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:34,632 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:34,711 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:34,766 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:34,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:34,879 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:34,937 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:35,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:35,024 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:17:35,024 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:35,102 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:17:35,102 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:35,102 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:17:35,102 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:35,102 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:35,120 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:35,133 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:35,148 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:35,161 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:35,175 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:35,192 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:35,195 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:17:35,195 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:35,208 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:17:35,208 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:35,208 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:17:35,208 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:35,208 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:17:35,223 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   learning_rate: 0.010223558971712843
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   n_estimators: 238
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   subsample: 0.8573493791304942
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8271633881952485
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   reg_alpha: 6.3457550338440205
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO -   reg_lambda: 6.236529703823544e-05
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:17:35,226 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:17:35,327 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:17:35,327 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.12038886923644099})})
2025-06-24 12:17:35,327 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:17:35,327 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:17:35,328 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:17:35,328 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:17:35,328 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:35,328 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:35,349 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:35,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:35,378 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:35,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:35,408 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:35,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:35,427 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:17:35,427 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:35,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:17:35,432 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:17:35,432 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:17:35,432 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:17:35,432 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:17:35,432 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:35,432 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:35,432 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:17:35,432 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:17:35,436 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:17:35,440 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:17:35,441 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00229964 0.09985685 0.06102825 0.18222484 0.0079024  0.05300015
 0.00447395 0.77799714 0.0392486  0.26448459 0.06464157 0.82862159
 0.47078035 0.01639656 0.32232133 0.69125148]
2025-06-24 12:17:35,441 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:17:36,216 - src.training - INFO -   precision: 0.0
2025-06-24 12:17:36,216 - src.training - INFO -   recall: 0.0
2025-06-24 12:17:36,216 - src.training - INFO -   f1: 0.0
2025-06-24 12:17:36,216 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:17:36,216 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:17:36,216 - src.training - INFO -   positive_samples: 270
2025-06-24 12:17:36,216 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:17:36,216 - src.training - INFO -   total_samples: 220940
2025-06-24 12:17:36,216 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:17:36,216 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:17:36,216 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:17:36,216 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:17:36,216 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:17:36,216 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:17:36,217 - src.training - INFO - 모델 학습 완료
2025-06-24 12:17:36,217 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:17:36,217 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:36,217 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:36,217 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:36,217 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:36,238 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:17:36,238 - src.hyperparameter_tuning - ERROR - Trial 71 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:17:36,684 - src.hyperparameter_tuning - INFO - Trial 72: 모델 타입 = lightgbm
2025-06-24 12:17:38,470 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:17:38,471 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:17:38,471 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:17:38,471 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:17:38,471 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:17:38,471 - src.training - INFO - 교차 검증 시작
2025-06-24 12:17:38,471 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:17:38,487 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:17:38,937 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:17:38,937 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:17:38,937 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:17:38,937 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:17:38,937 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:17:38,937 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:17:38,937 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:17:38,937 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:17:38,937 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:17:39,128 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:17:39,128 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:17:39,128 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:17:39,128 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:17:39,128 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:17:39,128 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:17:39,128 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:17:39,128 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:17:39,128 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:17:39,128 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:17:40,390 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:17:41,377 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:17:41,378 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:17:41,386 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:17:41,416 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:17:41,416 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:17:41,416 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:17:41,416 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:17:42,609 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:17:42,864 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:17:42,864 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:17:43,025 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:17:43,025 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:17:43,066 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:17:43,066 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:17:43,066 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:17:43,066 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:17:43,066 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:43,066 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:43,122 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:17:43,122 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:17:43,122 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:43,122 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:43,122 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:17:43,123 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:17:43,123 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:43,181 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:17:43,181 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:17:43,181 - src.training - INFO - 모델 학습 시작
2025-06-24 12:17:43,309 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:17:43,309 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:17:43,309 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:17:43,310 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:17:43,310 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:17:43,310 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:17:43,310 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:17:43,310 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:17:43,310 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:17:43,310 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:17:43,310 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:17:43,310 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:17:43,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:17:43,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:43,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:43,392 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:43,448 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:43,506 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:43,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:43,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:43,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:43,706 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:17:43,706 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:43,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:17:43,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:43,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:17:43,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:43,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:43,802 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:43,815 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:43,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:43,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:43,857 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:43,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:43,877 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:17:43,878 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:43,892 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:17:43,892 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:43,892 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:17:43,892 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:43,892 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:17:43,905 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:17:43,908 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:17:43,908 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:17:43,908 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:17:43,908 - src.models.lightgbm_model - INFO -   learning_rate: 0.01104335128836903
2025-06-24 12:17:43,908 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:17:43,908 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   n_estimators: 75
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   subsample: 0.6781084312540145
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7597809396166235
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   reg_alpha: 0.012321329666818695
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO -   reg_lambda: 1.497375237926033e-05
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:17:43,909 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:17:44,006 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:17:44,006 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.16522987077120305})})
2025-06-24 12:17:44,006 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:17:44,007 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:17:44,007 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:17:44,007 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:17:44,007 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:44,008 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:44,029 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:44,044 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:44,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:44,074 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:44,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:44,107 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:44,110 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:17:44,110 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:44,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:17:44,115 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:17:44,116 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:17:44,116 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:17:44,116 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:17:44,116 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:44,116 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:44,116 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:17:44,116 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:17:44,119 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:17:44,123 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:17:44,125 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00257571 0.11607217 0.02182769 0.13595673 0.32395527 0.84765754
 0.4394959  0.88554897]
2025-06-24 12:17:44,125 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:17:44,933 - src.training - INFO -   precision: 0.0
2025-06-24 12:17:44,933 - src.training - INFO -   recall: 0.0
2025-06-24 12:17:44,933 - src.training - INFO -   f1: 0.0
2025-06-24 12:17:44,933 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:17:44,933 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:17:44,933 - src.training - INFO -   positive_samples: 270
2025-06-24 12:17:44,933 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:17:44,933 - src.training - INFO -   total_samples: 220940
2025-06-24 12:17:44,933 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:17:44,933 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:17:44,933 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:17:44,933 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:17:44,933 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:17:44,933 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:17:44,933 - src.training - INFO - 모델 학습 완료
2025-06-24 12:17:44,933 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:17:44,933 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:44,933 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:44,933 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:44,933 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:44,956 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:17:44,956 - src.hyperparameter_tuning - ERROR - Trial 72 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:17:45,423 - src.hyperparameter_tuning - INFO - Trial 73: 모델 타입 = lightgbm
2025-06-24 12:17:47,376 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:17:47,376 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:17:47,376 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:17:47,376 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:17:47,376 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:17:47,376 - src.training - INFO - 교차 검증 시작
2025-06-24 12:17:47,376 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:17:47,393 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:17:47,870 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:17:47,870 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:17:47,870 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:17:47,870 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:17:47,870 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:17:47,870 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:17:47,870 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:17:47,870 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:17:47,870 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:17:48,047 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:17:48,047 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:17:48,047 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:17:48,047 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:17:48,047 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:17:48,047 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:17:48,047 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:17:48,047 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:17:48,047 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:17:48,047 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:17:49,441 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:17:50,449 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:17:50,449 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:17:50,458 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:17:50,488 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:17:50,488 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:17:50,488 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:17:50,488 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:17:51,695 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:17:51,950 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:17:51,950 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:17:52,110 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:17:52,110 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:17:52,151 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:17:52,151 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:17:52,151 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:17:52,151 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:17:52,151 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:52,151 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:52,208 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:17:52,208 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:17:52,208 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:52,208 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:52,208 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:17:52,208 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:17:52,208 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:52,267 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:17:52,267 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:17:52,267 - src.training - INFO - 모델 학습 시작
2025-06-24 12:17:52,394 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:17:52,395 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:17:52,395 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:17:52,395 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:17:52,395 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:17:52,395 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:17:52,395 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:17:52,395 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:17:52,395 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:17:52,395 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:17:52,395 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:17:52,395 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:17:52,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:17:52,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:52,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:52,473 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:52,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:52,584 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:52,641 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:52,702 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:52,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:52,789 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:17:52,789 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:52,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:17:52,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:52,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:17:52,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:52,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:52,884 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:52,898 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:52,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:52,925 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:52,940 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:52,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:52,960 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:17:52,960 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:52,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:17:52,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:52,975 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:17:52,975 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:52,975 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:17:52,987 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   learning_rate: 0.011553096542620205
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   n_estimators: 247
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   subsample: 0.747162017552321
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7950842267316494
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0018224377809980205
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO -   reg_lambda: 1.7914983429947623e-06
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:17:52,991 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:17:53,104 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:17:53,104 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.2154954955215457})})
2025-06-24 12:17:53,104 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:17:53,105 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:17:53,105 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:17:53,105 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:17:53,105 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:53,106 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:17:53,127 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:17:53,142 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:17:53,156 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:17:53,171 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:17:53,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:17:53,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:17:53,206 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:17:53,207 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:53,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:17:53,211 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:17:53,212 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:17:53,212 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:17:53,212 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:17:53,212 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:53,212 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:17:53,212 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:17:53,212 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:17:53,216 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:17:53,220 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:17:53,221 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.0023108  0.11661845 0.05749504 0.44825853 0.00570377 0.04637627
 0.28397845 0.01274966 0.00115459 0.00115495 0.90847276 0.00115548
 0.06242198 0.85855823 0.36361728 0.01174002 0.00115569 0.59512664
 0.93455385 0.58766686 0.10481575 0.61193646 0.00330211 0.00116057
 0.27148265 0.85678061 0.71082236 0.29075248 0.93306673]
2025-06-24 12:17:53,221 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:17:54,012 - src.training - INFO -   precision: 0.0
2025-06-24 12:17:54,012 - src.training - INFO -   recall: 0.0
2025-06-24 12:17:54,012 - src.training - INFO -   f1: 0.0
2025-06-24 12:17:54,012 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:17:54,012 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:17:54,012 - src.training - INFO -   positive_samples: 270
2025-06-24 12:17:54,012 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:17:54,012 - src.training - INFO -   total_samples: 220940
2025-06-24 12:17:54,012 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:17:54,012 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:17:54,012 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:17:54,012 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:17:54,012 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:17:54,012 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:17:54,012 - src.training - INFO - 모델 학습 완료
2025-06-24 12:17:54,012 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:17:54,012 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:54,012 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:54,012 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:17:54,013 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:17:54,034 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:17:54,034 - src.hyperparameter_tuning - ERROR - Trial 73 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:17:54,488 - src.hyperparameter_tuning - INFO - Trial 74: 모델 타입 = lightgbm
2025-06-24 12:17:56,269 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:17:56,270 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:17:56,270 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:17:56,270 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:17:56,270 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:17:56,270 - src.training - INFO - 교차 검증 시작
2025-06-24 12:17:56,270 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:17:56,286 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:17:56,730 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:17:56,730 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:17:56,730 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:17:56,730 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:17:56,730 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:17:56,730 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:17:56,730 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:17:56,730 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:17:56,730 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:17:56,921 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:17:56,921 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:17:56,922 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:17:56,922 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:17:56,922 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:17:56,922 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:17:56,922 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:17:56,922 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:17:56,922 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:17:56,922 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:17:58,188 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:17:59,179 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:17:59,179 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:17:59,187 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:17:59,218 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:17:59,218 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:17:59,218 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:17:59,218 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:18:00,399 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:18:00,658 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:18:00,658 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:18:00,818 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:18:00,819 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:18:00,859 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:18:00,859 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:18:00,859 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:18:00,859 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:18:00,859 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:00,859 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:00,918 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:18:00,918 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:18:00,918 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:00,918 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:00,918 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:18:00,918 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:18:00,918 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:00,979 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:18:00,979 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:18:00,979 - src.training - INFO - 모델 학습 시작
2025-06-24 12:18:01,108 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:18:01,108 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:18:01,108 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:18:01,109 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:18:01,109 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:18:01,109 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:18:01,109 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:18:01,109 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:18:01,109 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:18:01,109 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:18:01,109 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:18:01,109 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:18:01,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:18:01,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:01,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:01,187 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:01,241 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:01,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:01,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:01,411 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:01,481 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:01,497 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:18:01,497 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:01,573 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:18:01,573 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:01,573 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:18:01,573 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:01,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:01,591 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:01,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:01,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:01,632 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:01,647 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:01,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:01,667 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:18:01,667 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:01,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:18:01,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:01,682 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:18:01,682 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:01,682 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:18:01,694 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   learning_rate: 0.011753336951856434
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   n_estimators: 524
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   subsample: 0.9891693958404111
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9514716436114984
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00024521964811999016
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO -   reg_lambda: 8.233075249489115e-07
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:18:01,698 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:18:01,811 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:18:01,812 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.2434538595166217})})
2025-06-24 12:18:01,812 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:18:01,812 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:18:01,812 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:18:01,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:18:01,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:01,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:01,834 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:01,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:01,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:01,877 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:01,892 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:01,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:01,912 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:18:01,913 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:01,916 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:18:01,917 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:18:01,918 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:18:01,918 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:18:01,918 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:18:01,918 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:01,918 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:01,918 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:18:01,918 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:18:01,922 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:18:01,926 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:18:01,927 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00270998 0.15009515 0.061324   0.47644479 0.00581646 0.01277092
 0.04931916 0.23795357 0.49687691 0.15697386 0.00115436 0.12184835
 0.00546716 0.90557398 0.00115427 0.87562552 0.34270823 0.00115496
 0.54369259 0.62454743 0.93160856 0.54653248 0.18754813 0.00115476
 0.00336206 0.00115499 0.02816508 0.74495668 0.74275163 0.84732558
 0.00115501]
2025-06-24 12:18:01,927 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:18:02,723 - src.training - INFO -   precision: 0.0
2025-06-24 12:18:02,723 - src.training - INFO -   recall: 0.0
2025-06-24 12:18:02,723 - src.training - INFO -   f1: 0.0
2025-06-24 12:18:02,723 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:18:02,723 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:18:02,723 - src.training - INFO -   positive_samples: 270
2025-06-24 12:18:02,723 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:18:02,723 - src.training - INFO -   total_samples: 220940
2025-06-24 12:18:02,723 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:18:02,723 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:18:02,723 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:18:02,723 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:18:02,724 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:18:02,724 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:18:02,724 - src.training - INFO - 모델 학습 완료
2025-06-24 12:18:02,724 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:18:02,724 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:02,724 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:02,724 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:02,724 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:02,745 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:18:02,746 - src.hyperparameter_tuning - ERROR - Trial 74 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:18:03,186 - src.hyperparameter_tuning - INFO - Trial 75: 모델 타입 = lightgbm
2025-06-24 12:18:05,001 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:18:05,001 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:18:05,002 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:18:05,002 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:18:05,002 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:18:05,002 - src.training - INFO - 교차 검증 시작
2025-06-24 12:18:05,002 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:18:05,019 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:18:05,463 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:18:05,463 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:18:05,463 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:18:05,463 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:18:05,463 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:18:05,463 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:18:05,463 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:18:05,463 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:18:05,463 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:18:05,651 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:18:05,651 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:18:05,651 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:18:05,651 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:18:05,651 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:18:05,651 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:18:05,651 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:18:05,651 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:18:05,651 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:18:05,651 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:18:06,923 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:18:07,916 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:18:07,916 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:18:07,925 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:18:07,956 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:18:07,956 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:18:07,956 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:18:07,956 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:18:09,161 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:18:09,415 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:18:09,415 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:18:09,578 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:18:09,578 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:18:09,620 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:18:09,620 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:18:09,620 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:18:09,620 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:18:09,620 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:09,620 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:09,677 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:18:09,677 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:18:09,677 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:09,677 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:09,677 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:18:09,677 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:18:09,677 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:09,736 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:18:09,736 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:18:09,736 - src.training - INFO - 모델 학습 시작
2025-06-24 12:18:09,865 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:18:09,865 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:18:09,865 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:18:09,865 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:18:09,865 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:18:09,865 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:18:09,865 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:18:09,865 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:18:09,865 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:18:09,865 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:18:09,865 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:18:09,865 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:18:09,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:18:09,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:09,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:09,943 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:09,998 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:10,055 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:10,109 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:10,167 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:10,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:10,254 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:18:10,254 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:10,330 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:18:10,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:10,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:18:10,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:10,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:10,348 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:10,362 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:10,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:10,389 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:10,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:10,421 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:10,425 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:18:10,425 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:10,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:18:10,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:10,439 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:18:10,439 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:10,439 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:18:10,452 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   learning_rate: 0.014055955749627964
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:18:10,455 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 12:18:10,456 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:18:10,456 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:18:10,456 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:18:10,456 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:18:10,456 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:18:10,456 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:18:10,456 - src.models.lightgbm_model - INFO -   n_estimators: 618
2025-06-24 12:18:10,456 - src.models.lightgbm_model - INFO -   subsample: 0.994078962273043
2025-06-24 12:18:10,456 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9628068566874967
2025-06-24 12:18:10,456 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:18:10,456 - src.models.lightgbm_model - INFO -   reg_alpha: 1.7045950496210627e-07
2025-06-24 12:18:10,456 - src.models.lightgbm_model - INFO -   reg_lambda: 1.4969991210844438e-07
2025-06-24 12:18:10,456 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:18:10,456 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:18:10,456 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:18:14,060 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:18:14,060 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.3977388816144754})})
2025-06-24 12:18:14,060 - src.models.lightgbm_model - INFO -   - Best Iteration: 618
2025-06-24 12:18:14,060 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:18:14,060 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:18:14,060 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:18:14,060 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:14,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:14,081 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:14,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:14,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:14,125 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:14,140 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:14,157 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:14,160 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:18:14,160 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:14,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:18:14,327 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:18:14,327 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:18:14,327 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:18:14,327 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:18:14,327 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:14,327 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:14,327 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:18:14,327 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:18:14,332 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:18:14,336 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:18:14,340 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.02175172 0.08556535 0.01752494 ... 0.01149454 0.00823283 0.01195902]
2025-06-24 12:18:14,340 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:18:15,070 - src.training - INFO -   precision: 0.0
2025-06-24 12:18:15,070 - src.training - INFO -   recall: 0.0
2025-06-24 12:18:15,070 - src.training - INFO -   f1: 0.0
2025-06-24 12:18:15,070 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:18:15,070 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:18:15,070 - src.training - INFO -   positive_samples: 270
2025-06-24 12:18:15,070 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:18:15,070 - src.training - INFO -   total_samples: 220940
2025-06-24 12:18:15,070 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:18:15,070 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:18:15,070 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:18:15,070 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:18:15,071 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:18:15,071 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:18:15,071 - src.training - INFO - 모델 학습 완료
2025-06-24 12:18:15,071 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:18:15,071 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:15,071 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:15,071 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:15,071 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:15,093 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:18:15,094 - src.hyperparameter_tuning - ERROR - Trial 75 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:18:15,536 - src.hyperparameter_tuning - INFO - Trial 76: 모델 타입 = lightgbm
2025-06-24 12:18:17,372 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:18:17,373 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:18:17,373 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:18:17,373 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:18:17,373 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:18:17,373 - src.training - INFO - 교차 검증 시작
2025-06-24 12:18:17,373 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:18:17,390 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:18:17,832 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:18:17,832 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:18:17,832 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:18:17,832 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:18:17,832 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:18:17,832 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:18:17,832 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:18:17,832 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:18:17,832 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:18:18,019 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:18:18,019 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:18:18,019 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:18:18,019 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:18:18,019 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:18:18,019 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:18:18,019 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:18:18,019 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:18:18,019 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:18:18,019 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:18:19,297 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:18:20,282 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:18:20,282 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:18:20,290 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:18:20,321 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:18:20,321 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:18:20,321 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:18:20,321 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:18:21,517 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:18:21,771 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:18:21,771 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:18:21,938 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:18:21,938 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:18:21,979 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:18:21,980 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:18:21,980 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:18:21,980 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:18:21,980 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:21,980 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:22,037 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:18:22,037 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:18:22,037 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:22,037 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:22,037 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:18:22,037 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:18:22,037 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:22,096 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:18:22,096 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:18:22,096 - src.training - INFO - 모델 학습 시작
2025-06-24 12:18:22,224 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:18:22,224 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:18:22,224 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:18:22,224 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:18:22,224 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:18:22,224 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:18:22,224 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:18:22,224 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:18:22,224 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:18:22,224 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:18:22,224 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:18:22,224 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:18:22,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:18:22,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:22,225 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:22,303 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:22,357 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:22,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:22,468 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:22,526 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:22,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:22,613 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:18:22,613 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:22,690 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:18:22,690 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:22,690 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:18:22,690 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:22,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:22,708 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:22,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:22,736 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:22,750 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:22,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:22,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:22,784 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:18:22,784 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:22,799 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:18:22,799 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:22,799 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:18:22,799 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:22,799 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:18:22,811 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   learning_rate: 0.014382301203605658
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   n_estimators: 294
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   subsample: 0.813367284981703
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6667604087961482
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   reg_alpha: 0.5236641876898316
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO -   reg_lambda: 0.001302575573185227
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:18:22,815 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:18:22,910 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:18:22,910 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.5369439239428295})})
2025-06-24 12:18:22,910 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:18:22,910 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:18:22,910 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:18:22,910 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:18:22,910 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:22,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:22,932 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:22,947 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:22,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:22,977 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:22,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:23,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:23,013 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:18:23,013 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:23,017 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:18:23,018 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:18:23,019 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:18:23,019 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:18:23,019 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:18:23,019 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:23,019 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:23,019 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:18:23,019 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:18:23,022 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:18:23,026 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:18:23,035 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.0032708  0.35373547 0.05161885 0.4092433  0.74710739 0.98630053
 0.84871786 0.99104021]
2025-06-24 12:18:23,035 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:18:23,829 - src.training - INFO -   precision: 0.0
2025-06-24 12:18:23,829 - src.training - INFO -   recall: 0.0
2025-06-24 12:18:23,829 - src.training - INFO -   f1: 0.0
2025-06-24 12:18:23,829 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:18:23,829 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:18:23,829 - src.training - INFO -   positive_samples: 270
2025-06-24 12:18:23,829 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:18:23,829 - src.training - INFO -   total_samples: 220940
2025-06-24 12:18:23,829 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:18:23,829 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:18:23,829 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:18:23,830 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:18:23,830 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:18:23,830 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:18:23,830 - src.training - INFO - 모델 학습 완료
2025-06-24 12:18:23,830 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:18:23,830 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:23,830 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:23,830 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:23,830 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:23,852 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:18:23,852 - src.hyperparameter_tuning - ERROR - Trial 76 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:18:24,291 - src.hyperparameter_tuning - INFO - Trial 77: 모델 타입 = lightgbm
2025-06-24 12:18:26,107 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:18:26,107 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:18:26,107 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:18:26,107 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:18:26,107 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:18:26,107 - src.training - INFO - 교차 검증 시작
2025-06-24 12:18:26,107 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:18:26,125 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:18:26,571 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:18:26,571 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:18:26,571 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:18:26,571 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:18:26,571 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:18:26,571 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:18:26,571 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:18:26,571 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:18:26,571 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:18:26,756 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:18:26,756 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:18:26,756 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:18:26,756 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:18:26,756 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:18:26,756 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:18:26,756 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:18:26,756 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:18:26,756 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:18:26,756 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:18:28,020 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:18:29,011 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:18:29,011 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:18:29,019 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:18:29,050 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:18:29,050 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:18:29,050 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:18:29,050 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:18:30,238 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:18:30,493 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:18:30,493 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:18:30,653 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:18:30,653 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:18:30,694 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:18:30,694 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:18:30,694 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:18:30,694 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:18:30,694 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:30,694 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:30,751 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:18:30,751 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:18:30,751 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:30,751 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:30,751 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:18:30,751 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:18:30,751 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:30,809 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:18:30,810 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:18:30,810 - src.training - INFO - 모델 학습 시작
2025-06-24 12:18:30,938 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:18:30,938 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:18:30,938 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:18:30,938 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:18:30,938 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:18:30,938 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:18:30,938 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:18:30,938 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:18:30,938 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:18:30,938 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:18:30,938 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:18:30,938 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:18:30,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:18:30,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:30,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:31,019 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:31,075 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:31,133 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:31,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:31,245 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:31,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:31,331 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:18:31,331 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:31,408 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:18:31,408 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:31,408 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:18:31,408 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:31,408 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:31,426 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:31,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:31,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:31,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:31,481 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:31,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:31,502 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:18:31,502 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:31,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:18:31,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:31,517 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:18:31,517 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:31,517 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:18:31,529 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   learning_rate: 0.032830204245609645
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   n_estimators: 213
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   subsample: 0.7387052798810849
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7471890196742816
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   reg_alpha: 0.057631857456785014
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00021904515925321266
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:18:31,533 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:18:31,635 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:18:31,635 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 2.4182145893841906})})
2025-06-24 12:18:31,635 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:18:31,635 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:18:31,636 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:18:31,636 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:18:31,636 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:31,637 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:31,657 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:31,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:31,687 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:31,701 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:31,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:31,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:31,736 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:18:31,736 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:31,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:18:31,741 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:18:31,742 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:18:31,742 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:18:31,742 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:18:31,742 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:31,742 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:31,742 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:18:31,742 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:18:31,745 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:18:31,749 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:18:31,751 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [1.03046570e-002 2.23517537e-002 1.00381503e-002 9.98618328e-001
 9.92356679e-001 9.99852689e-001 3.36172397e-163 2.85208057e-003
 3.92553796e-001 3.52239773e-001 9.23872632e-015 8.40222774e-002
 9.99999983e-001 9.95737874e-001 9.90688592e-001 3.00176610e-002
 2.34027811e-159 4.60587776e-003 9.99999987e-001 9.95261549e-001
 3.62999033e-012 1.42364492e-005 9.93715372e-001 5.85957870e-305
 8.20119290e-013 1.64715475e-304 7.17431936e-307 9.99999979e-001
 6.21688377e-001 9.66917565e-001 9.79288874e-001 3.87308412e-020
 9.99908936e-001 9.99989818e-001 1.28925031e-009 2.69626360e-016
 3.83701246e-162 0.00000000e+000 1.81878769e-014 1.38994847e-305
 5.70929447e-009 9.99999911e-001 9.90441193e-001 8.41707065e-309
 8.89327833e-008 9.99992021e-001 1.27002085e-001 9.36069695e-012
 4.42066992e-019 8.26457387e-001 9.60709602e-308 1.46837125e-004
 2.07178368e-009 1.01506217e-006 9.99987092e-001 6.18726261e-004
 1.07118781e-002 5.10246325e-001 9.99986459e-001]
2025-06-24 12:18:31,751 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:18:32,500 - src.training - INFO -   precision: 0.0
2025-06-24 12:18:32,500 - src.training - INFO -   recall: 0.0
2025-06-24 12:18:32,500 - src.training - INFO -   f1: 0.0
2025-06-24 12:18:32,500 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:18:32,500 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:18:32,500 - src.training - INFO -   positive_samples: 270
2025-06-24 12:18:32,500 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:18:32,500 - src.training - INFO -   total_samples: 220940
2025-06-24 12:18:32,500 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:18:32,500 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:18:32,500 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:18:32,500 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:18:32,501 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:18:32,501 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:18:32,501 - src.training - INFO - 모델 학습 완료
2025-06-24 12:18:32,501 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:18:32,501 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:32,501 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:32,501 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:32,501 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:32,523 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:18:32,523 - src.hyperparameter_tuning - ERROR - Trial 77 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:18:32,971 - src.hyperparameter_tuning - INFO - Trial 78: 모델 타입 = lightgbm
2025-06-24 12:18:34,754 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:18:34,755 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:18:34,755 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:18:34,755 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:18:34,755 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:18:34,755 - src.training - INFO - 교차 검증 시작
2025-06-24 12:18:34,755 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:18:34,772 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:18:35,212 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:18:35,212 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:18:35,212 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:18:35,212 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:18:35,212 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:18:35,212 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:18:35,212 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:18:35,212 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:18:35,212 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:18:35,400 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:18:35,400 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:18:35,400 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:18:35,400 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:18:35,400 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:18:35,400 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:18:35,400 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:18:35,400 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:18:35,400 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:18:35,400 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:18:36,670 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:18:37,660 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:18:37,661 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:18:37,666 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:18:37,697 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:18:37,697 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:18:37,697 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:18:37,697 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:18:38,891 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:18:39,143 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:18:39,143 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:18:39,303 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:18:39,303 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:18:39,344 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:18:39,344 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:18:39,344 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:18:39,344 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:18:39,344 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:39,344 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:39,401 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:18:39,401 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:18:39,401 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:39,401 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:39,401 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:18:39,401 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:18:39,401 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:39,459 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:18:39,459 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:18:39,459 - src.training - INFO - 모델 학습 시작
2025-06-24 12:18:39,587 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:18:39,587 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:18:39,587 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:18:39,587 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:18:39,587 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:18:39,588 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:18:39,588 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:18:39,588 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:18:39,588 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:18:39,588 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:18:39,588 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:18:39,588 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:18:39,588 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:18:39,588 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:39,588 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:39,667 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:39,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:39,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:39,836 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:39,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:39,965 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:39,981 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:18:39,981 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:40,059 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:18:40,060 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:40,060 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:18:40,060 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:40,060 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:40,078 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:40,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:40,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:40,119 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:40,133 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:40,150 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:40,153 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:18:40,153 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:40,168 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:18:40,168 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:40,168 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:18:40,168 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:40,168 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:18:40,182 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   learning_rate: 0.13451292527267816
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   n_estimators: 544
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   subsample: 0.7723722814051354
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7044255682160845
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   reg_alpha: 3.0396044506125463e-08
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO -   reg_lambda: 5.434879440485431
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:18:40,186 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:18:40,291 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:18:40,292 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.3559093189472268})})
2025-06-24 12:18:40,292 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:18:40,292 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:18:40,292 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:18:40,292 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:18:40,292 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:40,293 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:40,314 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:40,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:40,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:40,357 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:40,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:40,390 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:40,393 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:18:40,393 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:40,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:18:40,399 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:18:40,399 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:18:40,399 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:18:40,399 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:18:40,399 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:40,399 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:40,399 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:18:40,399 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:18:40,403 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:18:40,407 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:18:40,409 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [6.34203976e-001 1.34742290e-100 1.52647804e-085 0.00000000e+000
 5.49168156e-121 8.95136482e-243 1.56189627e-117 1.08740727e-105
 1.40249472e-149 8.46011419e-089 7.41242038e-144 4.47131257e-083
 1.30083994e-084 4.82869784e-082 2.79771133e-085 9.65743564e-059
 3.11601885e-127 6.11495258e-093 1.00000000e+000 9.53787041e-071
 4.54236277e-231 5.50104571e-048 1.07394447e-117 4.92475206e-126
 2.62353747e-292 7.09760000e-085 2.55204798e-076 1.24353415e-091
 4.39420233e-126 4.14954210e-020 2.46954114e-100 2.27913503e-091
 1.53182683e-286 2.20288684e-082 4.73358001e-091 5.48867955e-077
 1.54030364e-017 9.99986792e-001 7.92080834e-074 1.52173804e-083
 2.88889861e-099 1.54351287e-110 7.17680615e-110 2.64310667e-111
 1.26031775e-116 2.26405948e-020 1.50858052e-104 5.70863971e-143
 4.03742559e-082 2.86392011e-120 3.82590703e-087 1.93180268e-129
 4.41988634e-151 1.25741145e-116 4.81221263e-040 2.60836107e-227
 6.43244696e-276 7.95080220e-152 9.99992794e-001 8.14076370e-012
 7.19339414e-110 2.23261853e-107 1.36245956e-125 3.94632004e-154
 2.08932049e-177 2.55352699e-099 4.68219142e-102 4.38167036e-172
 8.22734641e-102 1.03850614e-082 3.24449818e-105 1.05587558e-124
 1.49868617e-079 1.44147123e-108 6.79820707e-035 2.49343080e-075
 2.29461680e-045 1.18444466e-179 2.28932541e-045 2.62443666e-037
 1.04674609e-145 1.60926603e-015 1.73009587e-116 5.60054868e-237
 3.43594865e-115 8.77645505e-013 2.22747011e-107 2.08450251e-177
 5.36261179e-076 2.48398755e-174 1.76945215e-102 2.50565235e-153
 2.66615928e-090 7.65579976e-021 1.54708044e-110 4.85418371e-019
 4.72302848e-081 9.99999981e-001 3.27279600e-084 3.09494908e-153
 3.88572030e-255 8.14903485e-250 4.99218670e-151 6.54599147e-127
 6.58680079e-301 6.48939238e-148 8.22010898e-229 7.95378105e-011
 9.99999384e-001 4.88518872e-068 5.77763199e-301 7.67349485e-021
 7.44307982e-289]
2025-06-24 12:18:40,409 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:18:41,194 - src.training - INFO -   precision: 0.0
2025-06-24 12:18:41,194 - src.training - INFO -   recall: 0.0
2025-06-24 12:18:41,194 - src.training - INFO -   f1: 0.0
2025-06-24 12:18:41,194 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:18:41,194 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:18:41,194 - src.training - INFO -   positive_samples: 270
2025-06-24 12:18:41,194 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:18:41,194 - src.training - INFO -   total_samples: 220940
2025-06-24 12:18:41,194 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:18:41,194 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:18:41,194 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:18:41,194 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:18:41,195 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:18:41,195 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:18:41,195 - src.training - INFO - 모델 학습 완료
2025-06-24 12:18:41,195 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:18:41,195 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:41,195 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:41,195 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:41,195 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:41,217 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:18:41,217 - src.hyperparameter_tuning - ERROR - Trial 78 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:18:41,651 - src.hyperparameter_tuning - INFO - Trial 79: 모델 타입 = lightgbm
2025-06-24 12:18:43,494 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:18:43,494 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:18:43,494 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:18:43,494 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:18:43,494 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:18:43,494 - src.training - INFO - 교차 검증 시작
2025-06-24 12:18:43,494 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:18:43,511 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:18:43,953 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:18:43,953 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:18:43,953 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:18:43,953 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:18:43,953 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:18:43,953 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:18:43,953 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:18:43,953 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:18:43,953 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:18:44,139 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:18:44,139 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:18:44,139 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:18:44,139 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:18:44,139 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:18:44,139 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:18:44,139 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:18:44,139 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:18:44,139 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:18:44,139 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:18:45,399 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:18:46,383 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:18:46,383 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:18:46,389 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:18:46,420 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:18:46,420 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:18:46,420 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:18:46,420 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:18:47,606 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:18:47,858 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:18:47,858 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:18:48,021 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:18:48,021 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:18:48,062 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:18:48,062 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:18:48,062 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:18:48,062 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:18:48,062 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:48,062 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:48,119 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:18:48,119 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:18:48,119 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:48,119 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:48,119 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:18:48,119 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:18:48,119 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:48,178 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:18:48,179 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:18:48,179 - src.training - INFO - 모델 학습 시작
2025-06-24 12:18:48,306 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:18:48,306 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:18:48,306 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:18:48,306 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:18:48,306 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:18:48,306 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:18:48,306 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:18:48,306 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:18:48,306 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:18:48,306 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:18:48,306 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:18:48,306 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:18:48,306 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:18:48,306 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:48,306 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:48,385 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:48,441 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:48,499 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:48,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:48,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:48,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:48,700 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:18:48,700 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:48,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:18:48,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:48,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:18:48,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:48,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:48,797 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:48,810 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:48,825 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:48,838 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:48,853 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:48,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:48,872 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:18:48,872 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:48,887 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:18:48,887 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:48,887 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:18:48,887 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:48,887 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:18:48,901 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   learning_rate: 0.013391454239596375
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:18:48,904 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   n_estimators: 355
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   subsample: 0.7421243490147498
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7450680159966896
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   reg_alpha: 0.14123876693839205
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO -   reg_lambda: 4.3274813662214877e-08
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:18:48,905 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:18:48,995 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:18:48,995 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.39348183169944556})})
2025-06-24 12:18:48,995 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:18:48,995 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:18:48,996 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:18:48,996 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:18:48,996 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:48,996 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:49,017 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:49,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:49,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:49,060 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:49,075 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:49,092 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:49,095 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:18:49,095 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:49,099 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:18:49,101 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:18:49,101 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:18:49,101 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:18:49,101 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:18:49,101 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:49,101 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:49,101 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:18:49,101 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:18:49,105 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:18:49,109 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:18:49,110 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00304699 0.26380651 0.04009947 0.30854276 0.63262127 0.97116305
 0.75779548 0.98048106]
2025-06-24 12:18:49,110 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:18:49,886 - src.training - INFO -   precision: 0.0
2025-06-24 12:18:49,886 - src.training - INFO -   recall: 0.0
2025-06-24 12:18:49,887 - src.training - INFO -   f1: 0.0
2025-06-24 12:18:49,887 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:18:49,887 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:18:49,887 - src.training - INFO -   positive_samples: 270
2025-06-24 12:18:49,887 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:18:49,887 - src.training - INFO -   total_samples: 220940
2025-06-24 12:18:49,887 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:18:49,887 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:18:49,887 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:18:49,887 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:18:49,887 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:18:49,887 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:18:49,887 - src.training - INFO - 모델 학습 완료
2025-06-24 12:18:49,887 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:18:49,887 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:49,887 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:49,887 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:49,887 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:49,909 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:18:49,909 - src.hyperparameter_tuning - ERROR - Trial 79 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:18:50,341 - src.hyperparameter_tuning - INFO - Trial 80: 모델 타입 = lightgbm
2025-06-24 12:18:52,133 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:18:52,133 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:18:52,133 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:18:52,133 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:18:52,133 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:18:52,133 - src.training - INFO - 교차 검증 시작
2025-06-24 12:18:52,133 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:18:52,150 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:18:52,597 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:18:52,597 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:18:52,597 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:18:52,597 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:18:52,597 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:18:52,597 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:18:52,597 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:18:52,597 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:18:52,597 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:18:52,784 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:18:52,784 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:18:52,784 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:18:52,785 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:18:52,785 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:18:52,785 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:18:52,785 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:18:52,785 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:18:52,785 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:18:52,785 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:18:54,039 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:18:55,028 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:18:55,028 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:18:55,034 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:18:55,064 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:18:55,064 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:18:55,064 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:18:55,065 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:18:56,249 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:18:56,502 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:18:56,502 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:18:56,663 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:18:56,663 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:18:56,704 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:18:56,704 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:18:56,704 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:18:56,704 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:18:56,704 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:56,704 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:18:56,762 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:18:56,762 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:18:56,762 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:56,762 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:56,762 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:18:56,762 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:18:56,762 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:56,820 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:18:56,821 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:18:56,821 - src.training - INFO - 모델 학습 시작
2025-06-24 12:18:56,948 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:18:56,948 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:18:56,948 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:18:56,948 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:18:56,948 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:18:56,948 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:18:56,948 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:18:56,948 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:18:56,948 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:18:56,949 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:18:56,949 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:18:56,949 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:18:56,949 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:18:56,949 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:56,949 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:57,028 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:57,085 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:57,145 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:57,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:57,261 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:57,332 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:57,348 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:18:57,348 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:57,428 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:18:57,428 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:57,428 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:18:57,428 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:57,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:57,446 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:57,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:57,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:57,488 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:57,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:57,519 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:57,522 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:18:57,522 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:57,537 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:18:57,537 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:57,538 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:18:57,538 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:18:57,538 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:18:57,551 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:18:57,554 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   learning_rate: 0.016387648368896796
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   n_estimators: 387
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   subsample: 0.8500126055014097
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7826035602055952
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   reg_alpha: 0.029173036969492167
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO -   reg_lambda: 8.129107599490419e-08
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:18:57,555 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:18:59,857 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:18:59,857 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.42471386002946754})})
2025-06-24 12:18:59,857 - src.models.lightgbm_model - INFO -   - Best Iteration: 387
2025-06-24 12:18:59,857 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:18:59,858 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:18:59,858 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:18:59,858 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:59,858 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:18:59,880 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:18:59,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:18:59,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:18:59,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:18:59,940 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:18:59,957 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:18:59,960 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:18:59,960 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:18:59,964 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:19:00,050 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:19:00,050 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:19:00,051 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:19:00,051 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:19:00,051 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:00,051 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:00,051 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:19:00,051 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:19:00,055 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:19:00,059 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:19:00,064 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.02835407 0.16158192 0.02471056 ... 0.01474694 0.00678081 0.01212211]
2025-06-24 12:19:00,064 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:19:00,841 - src.training - INFO -   precision: 0.0
2025-06-24 12:19:00,841 - src.training - INFO -   recall: 0.0
2025-06-24 12:19:00,841 - src.training - INFO -   f1: 0.0
2025-06-24 12:19:00,841 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:19:00,841 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:19:00,841 - src.training - INFO -   positive_samples: 270
2025-06-24 12:19:00,841 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:19:00,841 - src.training - INFO -   total_samples: 220940
2025-06-24 12:19:00,841 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:19:00,841 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:19:00,841 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:19:00,841 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:19:00,841 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:19:00,841 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:19:00,841 - src.training - INFO - 모델 학습 완료
2025-06-24 12:19:00,841 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:19:00,841 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:00,841 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:00,841 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:00,841 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:00,864 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:19:00,864 - src.hyperparameter_tuning - ERROR - Trial 80 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:19:01,305 - src.hyperparameter_tuning - INFO - Trial 81: 모델 타입 = lightgbm
2025-06-24 12:19:03,124 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:19:03,124 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:19:03,124 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:19:03,124 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:19:03,124 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:19:03,124 - src.training - INFO - 교차 검증 시작
2025-06-24 12:19:03,124 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:19:03,141 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:19:03,597 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:19:03,597 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:19:03,597 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:19:03,597 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:19:03,597 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:19:03,597 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:19:03,597 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:19:03,597 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:19:03,597 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:19:03,784 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:19:03,785 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:19:03,785 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:19:03,785 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:19:03,785 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:19:03,785 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:19:03,785 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:19:03,785 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:19:03,785 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:19:03,785 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:19:05,074 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:19:06,064 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:19:06,065 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:19:06,071 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:19:06,101 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:19:06,101 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:19:06,101 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:19:06,101 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:19:07,274 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:19:07,527 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:19:07,527 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:19:07,693 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:19:07,693 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:19:07,734 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:19:07,734 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:19:07,734 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:19:07,734 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:19:07,734 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:07,734 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:07,792 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:19:07,792 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:19:07,792 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:07,792 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:07,792 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:19:07,792 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:19:07,792 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:07,853 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:19:07,854 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:19:07,854 - src.training - INFO - 모델 학습 시작
2025-06-24 12:19:07,986 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:19:07,986 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:19:07,986 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:19:07,986 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:19:07,986 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:19:07,986 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:19:07,986 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:19:07,986 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:19:07,986 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:19:07,986 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:19:07,986 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:19:07,986 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:19:07,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:19:07,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:07,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:08,066 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:08,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:08,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:08,233 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:08,291 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:08,361 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:08,380 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:19:08,380 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:08,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:19:08,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:08,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:19:08,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:08,458 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:08,475 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:08,489 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:08,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:08,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:08,531 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:08,548 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:08,550 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:19:08,550 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:08,567 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:19:08,567 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:08,567 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:19:08,567 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:08,567 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:19:08,580 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   learning_rate: 0.028812670129085078
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:19:08,583 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:19:08,584 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:19:08,584 - src.models.lightgbm_model - INFO -   n_estimators: 380
2025-06-24 12:19:08,584 - src.models.lightgbm_model - INFO -   subsample: 0.9338386316560942
2025-06-24 12:19:08,584 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6462537723366828
2025-06-24 12:19:08,584 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 12:19:08,584 - src.models.lightgbm_model - INFO -   reg_alpha: 0.2757710124039573
2025-06-24 12:19:08,584 - src.models.lightgbm_model - INFO -   reg_lambda: 6.767123001149569e-06
2025-06-24 12:19:08,584 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:19:08,584 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:19:08,584 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:19:08,697 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:19:08,697 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 1.559082592979477})})
2025-06-24 12:19:08,697 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:19:08,697 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:19:08,698 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:19:08,698 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:19:08,698 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:08,698 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:08,720 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:08,734 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:08,749 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:08,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:08,778 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:08,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:08,798 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:19:08,798 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:08,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:19:08,803 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:19:08,804 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:19:08,804 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:19:08,804 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:19:08,804 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:08,804 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:08,804 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:19:08,804 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:19:08,807 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:19:08,811 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:19:08,813 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [7.37799906e-003 9.09708729e-001 9.41573034e-001 9.54685631e-001
 9.99925519e-001 4.16286806e-002 2.84511162e-001 9.22908429e-001
 9.46491211e-001 6.93772643e-002 3.02984896e-004 9.48316269e-001
 1.58866745e-017 9.62454105e-001 4.65262081e-002 9.99999768e-001
 1.06530630e-003 9.60848195e-001 9.99999506e-001 8.76948193e-001
 4.62351501e-059 5.10457752e-011 1.06688017e-003 3.16779353e-118
 9.99977781e-001 2.55296818e-051 0.00000000e+000 4.51628173e-005
 9.97193843e-001 9.68821588e-001 7.13250025e-005 1.97213699e-011
 5.89054776e-024 9.83907391e-004 1.97311249e-011 4.63952050e-007
 4.66048191e-029 9.99251970e-001 1.34451469e-252 5.92235226e-010
 5.95863363e-001 6.87010211e-001 9.99995729e-001 3.43284157e-002
 1.11376959e-002 2.72298999e-010 9.21061902e-002 9.99618302e-001
 2.44431058e-028 3.93291341e-008 1.89270307e-017 2.24446917e-004
 8.87323149e-049 1.49746828e-022 3.25258617e-016 9.99998275e-001
 9.99966922e-001 1.07850284e-072 1.53329536e-006 1.93714253e-005
 8.16435722e-008 1.31074236e-010 8.14393318e-004 4.35349342e-004
 1.30634875e-005 1.84317865e-016 2.57338020e-021 9.51045184e-001
 9.32164434e-001 1.12671933e-006 1.11104650e-007 9.09378603e-002
 1.95172067e-007 6.15361506e-004 3.68074916e-030 3.64869421e-008
 9.99105318e-001 9.99431863e-001 4.06572501e-012 5.28219511e-001
 4.07934590e-017 9.99956441e-001 9.92073617e-001 1.60697338e-056
 9.99997728e-001 4.06439096e-002 8.94008861e-001 4.61442166e-002
 2.49032307e-011 1.80362699e-012 4.16768739e-072 6.34746931e-010
 7.85712070e-007 2.67268700e-004 2.01183582e-014 5.19564408e-252
 9.96534742e-001 9.99998841e-001 1.21299702e-027 9.99879702e-001
 9.99975756e-001 1.17927621e-002]
2025-06-24 12:19:08,813 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:19:09,594 - src.training - INFO -   precision: 0.0
2025-06-24 12:19:09,594 - src.training - INFO -   recall: 0.0
2025-06-24 12:19:09,594 - src.training - INFO -   f1: 0.0
2025-06-24 12:19:09,594 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:19:09,594 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:19:09,594 - src.training - INFO -   positive_samples: 270
2025-06-24 12:19:09,594 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:19:09,594 - src.training - INFO -   total_samples: 220940
2025-06-24 12:19:09,594 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:19:09,594 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:19:09,594 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:19:09,594 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:19:09,595 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:19:09,595 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:19:09,595 - src.training - INFO - 모델 학습 완료
2025-06-24 12:19:09,595 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:19:09,595 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:09,595 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:09,595 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:09,595 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:09,617 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:19:09,617 - src.hyperparameter_tuning - ERROR - Trial 81 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:19:10,058 - src.hyperparameter_tuning - INFO - Trial 82: 모델 타입 = lightgbm
2025-06-24 12:19:11,851 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:19:11,851 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:19:11,851 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:19:11,851 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:19:11,851 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:19:11,851 - src.training - INFO - 교차 검증 시작
2025-06-24 12:19:11,851 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:19:11,868 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:19:12,317 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:19:12,317 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:19:12,317 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:19:12,317 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:19:12,317 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:19:12,317 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:19:12,317 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:19:12,317 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:19:12,317 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:19:12,506 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:19:12,506 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:19:12,506 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:19:12,506 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:19:12,506 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:19:12,506 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:19:12,506 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:19:12,506 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:19:12,506 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:19:12,506 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:19:13,760 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:19:14,749 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:19:14,749 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:19:14,755 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:19:14,785 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:19:14,785 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:19:14,785 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:19:14,785 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:19:15,954 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:19:16,208 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:19:16,209 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:19:16,368 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:19:16,368 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:19:16,409 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:19:16,409 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:19:16,409 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:19:16,409 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:19:16,409 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:16,409 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:16,466 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:19:16,466 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:19:16,466 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:16,466 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:16,466 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:19:16,466 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:19:16,466 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:16,524 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:19:16,524 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:19:16,524 - src.training - INFO - 모델 학습 시작
2025-06-24 12:19:16,652 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:19:16,652 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:19:16,652 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:19:16,652 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:19:16,652 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:19:16,652 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:19:16,652 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:19:16,652 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:19:16,652 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:19:16,652 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:19:16,652 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:19:16,652 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:19:16,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:19:16,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:16,653 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:16,731 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:16,787 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:16,845 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:16,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:16,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:17,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:17,047 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:19:17,047 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:17,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:19:17,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:17,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:19:17,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:17,127 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:17,144 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:17,158 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:17,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:17,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:17,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:17,218 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:17,221 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:19:17,221 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:17,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:19:17,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:17,236 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:19:17,236 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:17,236 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:19:17,250 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   learning_rate: 0.013322651649114106
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   n_estimators: 359
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   subsample: 0.7988299648218256
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6458615893666039
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0012707172893200852
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO -   reg_lambda: 2.0263387507142536e-08
2025-06-24 12:19:17,253 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:19:17,254 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:19:17,254 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:19:17,367 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:19:17,367 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.4171745835610155})})
2025-06-24 12:19:17,367 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:19:17,367 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:19:17,367 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:19:17,367 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:19:17,367 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:17,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:17,389 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:17,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:17,419 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:17,434 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:17,449 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:17,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:17,469 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:19:17,470 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:17,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:19:17,475 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:19:17,475 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:19:17,476 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:19:17,476 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:19:17,476 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:17,476 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:17,476 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:19:17,476 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:19:17,479 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:19:17,483 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:19:17,484 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00282358 0.29523725 0.10055135 0.76071013 0.0803184  0.01751936
 0.07925843 0.51391946 0.00115259 0.00671402 0.96964827 0.00115248
 0.00115362 0.95745419 0.5407262  0.00115327 0.00115386 0.8143177
 0.97940399 0.86922544 0.31858218 0.00115304 0.82625782 0.00387109
 0.0011533  0.04259688 0.89249493 0.89122978 0.00115482 0.94501147
 0.5014493 ]
2025-06-24 12:19:17,484 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:19:18,273 - src.training - INFO -   precision: 0.0
2025-06-24 12:19:18,273 - src.training - INFO -   recall: 0.0
2025-06-24 12:19:18,284 - src.training - INFO -   f1: 0.0
2025-06-24 12:19:18,284 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:19:18,284 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:19:18,284 - src.training - INFO -   positive_samples: 270
2025-06-24 12:19:18,284 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:19:18,284 - src.training - INFO -   total_samples: 220940
2025-06-24 12:19:18,284 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:19:18,284 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:19:18,284 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:19:18,284 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:19:18,285 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:19:18,285 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:19:18,285 - src.training - INFO - 모델 학습 완료
2025-06-24 12:19:18,285 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:19:18,285 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:18,285 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:18,285 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:18,285 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:18,307 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:19:18,307 - src.hyperparameter_tuning - ERROR - Trial 82 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:19:18,744 - src.hyperparameter_tuning - INFO - Trial 83: 모델 타입 = lightgbm
2025-06-24 12:19:20,544 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:19:20,544 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:19:20,544 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:19:20,544 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:19:20,544 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:19:20,544 - src.training - INFO - 교차 검증 시작
2025-06-24 12:19:20,544 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:19:20,561 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:19:21,005 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:19:21,005 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:19:21,005 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:19:21,005 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:19:21,005 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:19:21,005 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:19:21,005 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:19:21,005 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:19:21,005 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:19:21,195 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:19:21,195 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:19:21,195 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:19:21,195 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:19:21,195 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:19:21,195 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:19:21,195 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:19:21,195 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:19:21,195 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:19:21,195 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:19:22,462 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:19:23,458 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:19:23,458 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:19:23,464 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:19:23,495 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:19:23,495 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:19:23,495 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:19:23,495 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:19:24,667 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:19:24,926 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:19:24,926 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:19:25,086 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:19:25,087 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:19:25,127 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:19:25,128 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:19:25,128 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:19:25,128 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:19:25,128 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:25,128 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:25,184 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:19:25,184 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:19:25,184 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:25,185 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:25,185 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:19:25,185 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:19:25,185 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:25,244 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:19:25,244 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:19:25,244 - src.training - INFO - 모델 학습 시작
2025-06-24 12:19:25,372 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:19:25,372 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:19:25,372 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:19:25,372 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:19:25,372 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:19:25,372 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:19:25,372 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:19:25,372 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:19:25,372 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:19:25,372 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:19:25,372 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:19:25,372 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:19:25,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:19:25,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:25,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:25,451 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:25,506 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:25,564 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:25,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:25,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:25,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:25,766 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:19:25,766 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:25,843 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:19:25,843 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:25,843 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:19:25,843 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:25,844 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:25,861 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:25,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:25,889 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:25,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:25,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:25,934 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:25,936 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:19:25,936 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:25,951 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:19:25,951 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:25,951 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:19:25,951 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:25,951 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:19:25,964 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   learning_rate: 0.0616777321699868
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   n_estimators: 251
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   subsample: 0.7538906961151701
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7727035980856184
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   reg_alpha: 2.009663818872544e-07
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00558113046943291
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:19:25,967 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:19:26,092 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:19:26,092 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 2.75494715908249})})
2025-06-24 12:19:26,092 - src.models.lightgbm_model - INFO -   - Best Iteration: 3
2025-06-24 12:19:26,092 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:19:26,092 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:19:26,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:19:26,093 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:26,093 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:26,114 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:26,128 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:26,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:26,157 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:26,172 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:26,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:26,193 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:19:26,193 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:26,196 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:19:26,198 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:19:26,198 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:19:26,198 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:19:26,198 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:19:26,198 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:26,198 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:26,199 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:19:26,199 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:19:26,202 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:19:26,206 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:19:26,208 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [6.66397595e-002 1.60830200e-003 7.31105917e-003 0.00000000e+000
 1.08999919e-073 9.39548175e-001 1.46484202e-003 4.42160480e-001
 7.83730362e-001 9.97011483e-001 9.99344805e-001 9.99999929e-001
 7.13131888e-021 1.00000000e+000 7.65822134e-002 5.01186211e-001
 9.03404583e-001 1.00000000e+000 4.58806313e-009 3.91930540e-009
 1.24290658e-009 1.12240469e-003 1.25159335e-003 3.97250061e-004
 9.99999996e-001 9.99993389e-001 1.00471060e-003 9.99999573e-001
 6.87807968e-069 1.06174007e-009 1.86218866e-228 1.22640350e-093
 1.00000000e+000 9.99999911e-001 7.17001004e-001 2.49896945e-106
 1.00000000e+000 1.04150503e-079 1.58143618e-214 2.61050983e-003
 2.12221285e-092 2.53897311e-068 9.99999907e-001 3.88674276e-008
 9.99999676e-001 4.55745292e-121 1.03445341e-123 4.58852001e-077
 1.38923374e-024 9.74601324e-001 4.03027721e-031 2.10784417e-136
 6.96727458e-212 9.99999977e-001 6.52569367e-003 3.70067424e-005
 6.30004808e-013 2.54809833e-014 1.00000000e+000 1.00000000e+000
 2.48204990e-150 2.95280845e-074 1.01031493e-002 6.30672074e-013
 9.99908862e-001 9.28645070e-134 9.34975426e-090 2.72635032e-075
 9.99999315e-001 9.06571082e-001 4.12750165e-008 7.02726098e-012
 2.22739853e-003 1.53704155e-012 3.39366400e-004 1.21810000e-137
 7.08535844e-004 1.00000000e+000 3.98310760e-004 1.39714181e-001
 1.73745579e-010 3.31040624e-001 1.00000000e+000 9.99999793e-001
 6.96204812e-038 1.94975751e-043 1.87524655e-089 1.30351573e-003
 7.48189807e-012 3.17172969e-004 3.99658889e-052 3.85186784e-104
 1.36885146e-002 4.48302934e-018 3.45024269e-072 1.52116590e-014
 1.04129178e-004 1.00000000e+000 2.32643231e-069 4.45226248e-021
 8.09455429e-006 6.92228178e-089 1.37944099e-013 1.19300559e-116
 9.86122200e-001 4.13972943e-210 3.80025982e-011 2.39766622e-004
 1.29191628e-010 3.18862341e-133 1.73275830e-012 1.71721056e-108
 1.12316881e-042 4.16000692e-005 4.24459919e-004 9.98753913e-075
 9.94332192e-001 8.61219848e-014 4.26112888e-001 2.54937532e-045
 1.39178577e-003 9.59613860e-013 2.98444516e-010 3.78248290e-001
 5.57334220e-015 9.59930585e-001 4.54186497e-072 1.37798151e-013
 5.46539668e-028 1.00000000e+000 2.70789126e-119 1.20113803e-072
 9.92404746e-148 6.45477302e-003 1.86073171e-051 9.93657310e-014
 4.08416786e-003 1.69870960e-016 4.13161992e-030 1.00000000e+000
 2.37259818e-011 9.99999895e-001 1.00000000e+000 1.44296138e-004
 2.89631225e-007 9.20590005e-002 1.00000000e+000 9.24781798e-090
 1.82382521e-207 1.50651567e-018 2.23187550e-011 1.52458844e-144
 4.95680573e-071 9.99999832e-001 1.34279897e-071 2.37757999e-115
 6.00095189e-046 3.05947788e-004 4.13001891e-008 9.99997203e-001
 2.91554803e-002 1.79674768e-035 6.80438414e-030 1.30209979e-024
 1.73448711e-034 9.99998379e-001 9.99999992e-001 7.12698028e-001
 1.00000000e+000 1.65332014e-021 3.00196611e-059 8.83535385e-143
 7.00207813e-108 3.59121518e-010 9.83602159e-001 2.90785843e-020
 6.50029078e-005 5.52161877e-017 6.12942007e-010 2.72858893e-002
 9.99999987e-001 4.61021182e-022 3.88420772e-024 1.06054731e-016
 9.95928150e-001 1.00000000e+000 2.36148232e-159 1.00000000e+000
 9.82820712e-004 3.73548468e-019 9.41485902e-021 1.53298840e-012
 5.99497057e-024 9.99999875e-001 9.96986073e-001 1.82833290e-025
 9.99999998e-001 1.09817149e-017 9.76517295e-007 3.94067870e-017
 5.23599360e-010 5.33523081e-015 1.71437592e-044 5.97337711e-017
 4.35516445e-021 9.99995521e-001 5.72336901e-008 9.99999300e-001
 9.99999998e-001 3.58719044e-022 6.71623410e-023 1.68405157e-007
 6.95539758e-065 4.24814887e-030 9.25545428e-004 9.99977672e-001
 1.91616156e-062 1.21455595e-030 2.76353185e-016 9.99685105e-001
 1.60373238e-199 1.17538298e-001 8.85340199e-007 7.06547543e-012
 2.46728276e-032 4.98042237e-008 2.70249254e-042 7.68908292e-210
 2.92473335e-001 1.63848518e-117 8.18873011e-053 1.05822128e-002
 2.79102921e-212 7.58729832e-051 1.10196527e-041 2.96639853e-002
 3.28593508e-200 4.57295623e-012 9.01646634e-001 4.43233975e-047
 9.99924440e-001 2.41489350e-020 9.99270768e-001 8.23733964e-069
 2.14822716e-019 9.99956742e-001 1.49034908e-041 4.17379952e-047]
2025-06-24 12:19:26,208 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:19:27,442 - src.training - INFO -   precision: 0.0039768618944323935
2025-06-24 12:19:27,443 - src.training - INFO -   recall: 0.12222222222222222
2025-06-24 12:19:27,443 - src.training - INFO -   f1: 0.007703081232492998
2025-06-24 12:19:27,443 - src.training - INFO -   accuracy: 0.9615189644247307
2025-06-24 12:19:27,443 - src.training - INFO -   balanced_accuracy: 0.5423840526074631
2025-06-24 12:19:27,443 - src.training - INFO -   positive_samples: 270
2025-06-24 12:19:27,443 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:19:27,443 - src.training - INFO -   total_samples: 220940
2025-06-24 12:19:27,443 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:19:27,443 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:19:27,443 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:19:27,443 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:19:27,443 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:19:27,443 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:19:27,443 - src.training - INFO - 모델 학습 완료
2025-06-24 12:19:27,443 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0039768618944323935, 'recall': 0.12222222222222222, 'f1': 0.007703081232492998, 'accuracy': 0.9615189644247307, 'balanced_accuracy': 0.5423840526074631, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:19:27,443 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:27,443 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:27,443 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:27,443 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:27,465 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:19:27,465 - src.hyperparameter_tuning - ERROR - Trial 83 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:19:27,907 - src.hyperparameter_tuning - INFO - Trial 84: 모델 타입 = lightgbm
2025-06-24 12:19:29,722 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:19:29,722 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:19:29,722 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:19:29,722 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:19:29,722 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:19:29,722 - src.training - INFO - 교차 검증 시작
2025-06-24 12:19:29,722 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:19:29,740 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:19:30,183 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:19:30,183 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:19:30,183 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:19:30,183 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:19:30,183 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:19:30,183 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:19:30,183 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:19:30,183 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:19:30,183 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:19:30,368 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:19:30,368 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:19:30,368 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:19:30,368 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:19:30,368 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:19:30,368 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:19:30,368 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:19:30,368 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:19:30,368 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:19:30,368 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:19:31,620 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:19:32,603 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:19:32,603 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:19:32,609 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:19:32,639 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:19:32,639 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:19:32,639 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:19:32,640 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:19:33,809 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:19:34,059 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:19:34,059 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:19:34,219 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:19:34,219 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:19:34,260 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:19:34,260 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:19:34,260 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:19:34,260 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:19:34,260 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:34,260 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:34,318 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:19:34,318 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:19:34,318 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:34,318 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:34,318 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:19:34,319 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:19:34,319 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:34,375 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:19:34,375 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:19:34,375 - src.training - INFO - 모델 학습 시작
2025-06-24 12:19:34,503 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:19:34,503 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:19:34,503 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:19:34,503 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:19:34,503 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:19:34,503 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:19:34,503 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:19:34,503 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:19:34,503 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:19:34,503 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:19:34,503 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:19:34,503 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:19:34,504 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:19:34,504 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:34,504 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:34,583 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:34,638 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:34,696 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:34,750 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:34,808 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:34,879 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:34,898 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:19:34,898 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:34,974 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:19:34,974 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:34,974 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:19:34,974 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:34,974 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:34,992 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:35,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:35,020 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:35,034 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:35,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:35,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:35,068 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:19:35,068 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:35,085 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:19:35,085 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:35,086 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:19:35,086 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:35,086 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:19:35,098 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   learning_rate: 0.013965202367946683
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:19:35,101 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   n_estimators: 64
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   subsample: 0.8020310217531182
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7381375080532766
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   reg_alpha: 3.6702751027317935
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO -   reg_lambda: 3.0338922499526e-06
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:19:35,102 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:19:35,209 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:19:35,209 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.4867970075947727})})
2025-06-24 12:19:35,209 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:19:35,209 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:19:35,209 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:19:35,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:19:35,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:35,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:35,228 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:35,243 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:35,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:35,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:35,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:35,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:35,306 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:19:35,306 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:35,309 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:19:35,312 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:19:35,312 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:19:35,312 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:19:35,312 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:19:35,312 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:35,312 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:35,312 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:19:35,312 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:19:35,316 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:19:35,320 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:19:35,321 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.0029463  0.36991053 0.22047522 0.60351462 0.01582242 0.18737017
 0.00730264 0.98499023 0.13042626 0.74532507 0.23522124 0.99027787
 0.90979278 0.04222522 0.81089696 0.97266558]
2025-06-24 12:19:35,321 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:19:36,047 - src.training - INFO -   precision: 0.0
2025-06-24 12:19:36,047 - src.training - INFO -   recall: 0.0
2025-06-24 12:19:36,047 - src.training - INFO -   f1: 0.0
2025-06-24 12:19:36,047 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:19:36,047 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:19:36,047 - src.training - INFO -   positive_samples: 270
2025-06-24 12:19:36,047 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:19:36,047 - src.training - INFO -   total_samples: 220940
2025-06-24 12:19:36,047 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:19:36,047 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:19:36,047 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:19:36,047 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:19:36,047 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:19:36,047 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:19:36,047 - src.training - INFO - 모델 학습 완료
2025-06-24 12:19:36,047 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:19:36,047 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:36,047 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:36,047 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:36,047 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:36,069 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:19:36,069 - src.hyperparameter_tuning - ERROR - Trial 84 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:19:36,511 - src.hyperparameter_tuning - INFO - Trial 85: 모델 타입 = lightgbm
2025-06-24 12:19:38,339 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:19:38,339 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:19:38,339 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:19:38,339 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:19:38,339 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:19:38,339 - src.training - INFO - 교차 검증 시작
2025-06-24 12:19:38,339 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:19:38,357 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:19:38,801 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:19:38,801 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:19:38,801 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:19:38,801 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:19:38,801 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:19:38,801 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:19:38,801 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:19:38,801 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:19:38,801 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:19:38,986 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:19:38,986 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:19:38,986 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:19:38,986 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:19:38,986 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:19:38,986 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:19:38,986 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:19:38,986 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:19:38,986 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:19:38,986 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:19:40,254 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:19:41,278 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:19:41,278 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:19:41,284 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:19:41,318 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:19:41,318 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:19:41,318 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:19:41,318 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:19:42,493 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:19:42,748 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:19:42,748 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:19:42,908 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:19:42,908 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:19:42,949 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:19:42,949 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:19:42,949 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:19:42,949 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:19:42,949 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:42,949 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:43,006 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:19:43,006 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:19:43,006 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:43,006 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:43,006 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:19:43,006 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:19:43,006 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:43,063 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:19:43,064 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:19:43,064 - src.training - INFO - 모델 학습 시작
2025-06-24 12:19:43,190 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:19:43,190 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:19:43,190 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:19:43,190 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:19:43,190 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:19:43,190 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:19:43,190 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:19:43,191 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:19:43,191 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:19:43,191 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:19:43,191 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:19:43,191 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:19:43,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:19:43,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:43,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:43,269 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:43,323 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:43,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:43,435 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:43,494 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:43,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:43,580 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:19:43,580 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:43,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:19:43,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:43,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:19:43,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:43,653 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:43,670 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:43,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:43,698 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:43,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:43,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:43,742 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:43,745 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:19:43,745 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:43,760 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:19:43,760 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:43,760 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:19:43,760 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:43,760 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:19:43,773 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO -   learning_rate: 0.020515384954703512
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:19:43,776 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   n_estimators: 282
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   subsample: 0.9335490493980534
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.623466104536039
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   reg_alpha: 0.021997005291518986
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO -   reg_lambda: 4.165725661285899e-06
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:19:43,777 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:19:45,498 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:19:45,498 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.5088740919992694})})
2025-06-24 12:19:45,498 - src.models.lightgbm_model - INFO -   - Best Iteration: 282
2025-06-24 12:19:45,498 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:19:45,499 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:19:45,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:19:45,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:45,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:45,518 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:45,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:45,547 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:45,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:45,576 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:45,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:45,596 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:19:45,596 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:45,601 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:19:45,666 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:19:45,666 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:19:45,666 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:19:45,666 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:19:45,666 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:45,666 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:45,666 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:19:45,666 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:19:45,670 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:19:45,674 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:19:45,679 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.03604674 0.04637795 0.01705314 ... 0.00723783 0.01295858 0.00729297]
2025-06-24 12:19:45,679 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:19:46,834 - src.training - INFO -   precision: 0.007326007326007326
2025-06-24 12:19:46,834 - src.training - INFO -   recall: 0.007407407407407408
2025-06-24 12:19:46,834 - src.training - INFO -   f1: 0.007366482504604052
2025-06-24 12:19:46,834 - src.training - INFO -   accuracy: 0.9975604236444283
2025-06-24 12:19:46,834 - src.training - INFO -   balanced_accuracy: 0.5030896646408497
2025-06-24 12:19:46,834 - src.training - INFO -   positive_samples: 270
2025-06-24 12:19:46,834 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:19:46,834 - src.training - INFO -   total_samples: 220940
2025-06-24 12:19:46,834 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:19:46,834 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:19:46,834 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:19:46,834 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:19:46,835 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:19:46,835 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:19:46,835 - src.training - INFO - 모델 학습 완료
2025-06-24 12:19:46,835 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.007326007326007326, 'recall': 0.007407407407407408, 'f1': 0.007366482504604052, 'accuracy': 0.9975604236444283, 'balanced_accuracy': 0.5030896646408497, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:19:46,835 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:46,835 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:46,835 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:46,835 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:46,858 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:19:46,858 - src.hyperparameter_tuning - ERROR - Trial 85 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:19:47,296 - src.hyperparameter_tuning - INFO - Trial 86: 모델 타입 = lightgbm
2025-06-24 12:19:49,112 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:19:49,112 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:19:49,112 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:19:49,112 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:19:49,112 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:19:49,112 - src.training - INFO - 교차 검증 시작
2025-06-24 12:19:49,112 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:19:49,130 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:19:49,574 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:19:49,574 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:19:49,574 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:19:49,574 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:19:49,574 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:19:49,574 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:19:49,574 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:19:49,574 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:19:49,574 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:19:49,759 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:19:49,759 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:19:49,759 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:19:49,759 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:19:49,759 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:19:49,759 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:19:49,759 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:19:49,759 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:19:49,759 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:19:49,759 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:19:51,010 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:19:51,988 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:19:51,988 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:19:51,994 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:19:52,025 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:19:52,025 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:19:52,025 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:19:52,025 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:19:53,199 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:19:53,454 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:19:53,454 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:19:53,614 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:19:53,614 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:19:53,655 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:19:53,655 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:19:53,655 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:19:53,655 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:19:53,655 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:53,655 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:53,712 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:19:53,712 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:19:53,712 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:53,712 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:53,712 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:19:53,712 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:19:53,712 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:53,769 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:19:53,770 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:19:53,770 - src.training - INFO - 모델 학습 시작
2025-06-24 12:19:53,897 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:19:53,897 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:19:53,897 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:19:53,897 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:19:53,897 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:19:53,897 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:19:53,897 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:19:53,897 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:19:53,897 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:19:53,897 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:19:53,897 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:19:53,897 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:19:53,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:19:53,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:53,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:53,978 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:54,036 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:54,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:54,150 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:54,208 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:54,279 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:54,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:19:54,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:54,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:19:54,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:54,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:19:54,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:54,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:54,393 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:54,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:54,421 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:54,434 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:54,449 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:54,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:54,468 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:19:54,468 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:54,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:19:54,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:54,482 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:19:54,482 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:54,482 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:19:54,496 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   learning_rate: 0.021693771587376565
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   n_estimators: 535
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   subsample: 0.8235118228678971
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8704502679481306
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0610499077626023
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO -   reg_lambda: 0.012752046480554677
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:19:54,499 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:19:56,039 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:19:56,039 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.6039772553501194})})
2025-06-24 12:19:56,039 - src.models.lightgbm_model - INFO -   - Best Iteration: 246
2025-06-24 12:19:56,041 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:19:56,041 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:19:56,041 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:19:56,041 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:56,042 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:19:56,060 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:19:56,075 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:19:56,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:19:56,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:19:56,119 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:19:56,137 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:19:56,139 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:19:56,139 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:56,144 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:19:56,197 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:19:56,197 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:19:56,197 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:19:56,197 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:19:56,197 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:56,197 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:19:56,197 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:19:56,198 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:19:56,201 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:19:56,205 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:19:56,209 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.04452402 0.10519999 0.02209915 ... 0.00908019 0.00543148 0.00902974]
2025-06-24 12:19:56,209 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:19:57,357 - src.training - INFO -   precision: 0.00778642936596218
2025-06-24 12:19:57,357 - src.training - INFO -   recall: 0.025925925925925925
2025-06-24 12:19:57,357 - src.training - INFO -   f1: 0.011976047904191617
2025-06-24 12:19:57,357 - src.training - INFO -   accuracy: 0.9947723363809179
2025-06-24 12:19:57,357 - src.training - INFO -   balanced_accuracy: 0.5109418454571851
2025-06-24 12:19:57,357 - src.training - INFO -   positive_samples: 270
2025-06-24 12:19:57,357 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:19:57,357 - src.training - INFO -   total_samples: 220940
2025-06-24 12:19:57,357 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:19:57,357 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:19:57,357 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:19:57,357 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:19:57,357 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:19:57,357 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:19:57,357 - src.training - INFO - 모델 학습 완료
2025-06-24 12:19:57,358 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.00778642936596218, 'recall': 0.025925925925925925, 'f1': 0.011976047904191617, 'accuracy': 0.9947723363809179, 'balanced_accuracy': 0.5109418454571851, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:19:57,358 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:57,358 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:57,358 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:19:57,358 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:19:57,378 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:19:57,378 - src.hyperparameter_tuning - ERROR - Trial 86 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:19:57,815 - src.hyperparameter_tuning - INFO - Trial 87: 모델 타입 = lightgbm
2025-06-24 12:19:59,616 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:19:59,616 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:19:59,616 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:19:59,616 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:19:59,616 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:19:59,616 - src.training - INFO - 교차 검증 시작
2025-06-24 12:19:59,616 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:19:59,634 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:20:00,077 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:20:00,077 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:20:00,077 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:20:00,077 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:20:00,077 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:20:00,077 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:20:00,077 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:20:00,077 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:20:00,077 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:20:00,263 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:20:00,263 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:20:00,263 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:20:00,263 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:20:00,263 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:20:00,263 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:20:00,263 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:20:00,263 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:20:00,263 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:20:00,263 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:20:01,522 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:20:02,502 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:20:02,502 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:20:02,508 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:20:02,539 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:20:02,539 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:20:02,539 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:20:02,539 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:20:03,701 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:20:03,954 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:20:03,955 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:20:04,116 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:20:04,116 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:20:04,157 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:20:04,157 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:20:04,157 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:20:04,157 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:20:04,157 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:04,157 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:04,214 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:20:04,214 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:20:04,214 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:04,214 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:04,214 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:20:04,214 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:20:04,214 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:04,273 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:20:04,273 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:20:04,273 - src.training - INFO - 모델 학습 시작
2025-06-24 12:20:04,402 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:20:04,402 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:20:04,402 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:20:04,402 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:20:04,403 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:20:04,403 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:20:04,403 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:20:04,403 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:20:04,403 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:20:04,403 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:20:04,403 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:20:04,403 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:20:04,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:20:04,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:04,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:04,482 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:04,538 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:04,597 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:04,653 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:04,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:04,786 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:04,803 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:20:04,803 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:04,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:20:04,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:04,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:20:04,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:04,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:04,901 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:04,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:04,929 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:04,943 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:04,957 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:04,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:04,977 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:20:04,977 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:04,991 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:20:04,991 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:04,991 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:20:04,991 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:04,991 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:20:05,004 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   learning_rate: 0.024711510032408103
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   n_estimators: 192
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   subsample: 0.9443071136293535
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6746393972227877
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   reg_alpha: 0.019859199259979823
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO -   reg_lambda: 4.537043874713633e-06
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:20:05,008 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:20:05,123 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:20:05,123 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 1.7636964799376313})})
2025-06-24 12:20:05,123 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:20:05,123 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:20:05,123 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:20:05,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:20:05,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:05,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:05,142 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:05,157 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:05,172 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:05,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:05,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:05,219 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:05,222 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:20:05,222 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:05,226 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:20:05,228 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:20:05,229 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:20:05,229 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:20:05,229 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:20:05,229 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:05,229 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:05,229 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:20:05,229 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:20:05,232 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:20:05,236 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:20:05,237 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [6.86049732e-003 9.65928821e-001 8.46898084e-001 6.97415159e-002
 2.14698570e-002 1.55198483e-001 7.73066434e-001 9.78175271e-001
 2.26924393e-001 9.69407718e-001 1.99680151e-005 9.44671034e-001
 2.86837047e-002 9.99994823e-001 1.14316664e-003 9.99990365e-001
 9.92414219e-088 1.47864719e-005 1.00774502e-017 8.83784517e-001
 8.49200345e-001 6.11024057e-008 4.62761590e-021 4.39973587e-011
 9.92464508e-001 2.35075156e-255 1.50607698e-001 1.34826892e-003
 9.84746223e-001 9.80310071e-001 7.25023834e-004 2.01362062e-007
 2.50624450e-004 6.84716218e-003 2.01447483e-007 4.70573436e-013
 9.16363257e-001 3.45711918e-004 3.24245184e-013 9.67198079e-001
 3.96211971e-001 9.99087159e-001 4.65366909e-001 9.98204284e-001
 9.59592735e-001 1.91339291e-006 9.96511101e-001 7.13306317e-037
 9.99072885e-001 1.57083540e-009 9.99338131e-001 8.28503273e-006
 9.99975752e-001 9.99694693e-001 3.38345074e-033 5.94292206e-002
 7.09786621e-017 3.27775777e-003 4.57477470e-025 2.05448256e-006
 3.46106144e-004 9.99002001e-001 2.81808349e-036 2.07465100e-001
 4.23867305e-032 2.32297938e-001 9.99947417e-001 3.59794679e-016
 7.52919659e-003 1.79885078e-001 2.37813465e-003 9.53542791e-002
 2.50803903e-004 8.00203077e-008 1.67656892e-001 9.45098787e-001
 6.54954271e-006 5.46102421e-003 9.05365458e-001 7.25356968e-004
 1.03367498e-012 1.35126457e-031 7.60373857e-007 4.27429675e-003
 1.07862462e-032 9.99713479e-001 8.55144352e-001 2.50919197e-004
 4.51545532e-004 7.66974573e-003 9.68749167e-001 2.20254660e-001]
2025-06-24 12:20:05,237 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:20:06,033 - src.training - INFO -   precision: 0.0
2025-06-24 12:20:06,034 - src.training - INFO -   recall: 0.0
2025-06-24 12:20:06,034 - src.training - INFO -   f1: 0.0
2025-06-24 12:20:06,034 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:20:06,034 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:20:06,034 - src.training - INFO -   positive_samples: 270
2025-06-24 12:20:06,034 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:20:06,034 - src.training - INFO -   total_samples: 220940
2025-06-24 12:20:06,034 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:20:06,034 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:20:06,034 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:20:06,034 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:20:06,034 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:20:06,034 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:20:06,034 - src.training - INFO - 모델 학습 완료
2025-06-24 12:20:06,034 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:20:06,034 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:06,034 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:06,034 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:06,034 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:06,056 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:20:06,056 - src.hyperparameter_tuning - ERROR - Trial 87 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:20:06,516 - src.hyperparameter_tuning - INFO - Trial 88: 모델 타입 = lightgbm
2025-06-24 12:20:08,490 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:20:08,490 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:20:08,490 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:20:08,490 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:20:08,490 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:20:08,490 - src.training - INFO - 교차 검증 시작
2025-06-24 12:20:08,490 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:20:08,506 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:20:08,982 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:20:08,982 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:20:08,982 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:20:08,982 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:20:08,982 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:20:08,982 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:20:08,982 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:20:08,982 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:20:08,982 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:20:09,147 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:20:09,147 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:20:09,147 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:20:09,147 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:20:09,147 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:20:09,147 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:20:09,147 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:20:09,147 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:20:09,147 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:20:09,147 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:20:10,552 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:20:11,639 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:20:11,639 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:20:11,647 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:20:11,679 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:20:11,679 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:20:11,679 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:20:11,679 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:20:12,955 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:20:13,227 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:20:13,227 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:20:13,395 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:20:13,395 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:20:13,438 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:20:13,438 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:20:13,438 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:20:13,438 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:20:13,438 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:13,438 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:13,500 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:20:13,500 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:20:13,500 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:13,500 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:13,500 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:20:13,500 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:20:13,500 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:13,565 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:20:13,565 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:20:13,565 - src.training - INFO - 모델 학습 시작
2025-06-24 12:20:13,697 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:20:13,697 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:20:13,697 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:20:13,697 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:20:13,697 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:20:13,697 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:20:13,697 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:20:13,697 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:20:13,697 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:20:13,697 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:20:13,697 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:20:13,697 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:20:13,697 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:20:13,697 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:13,698 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:13,789 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:13,857 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:13,927 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:13,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:14,058 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:14,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:14,152 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:20:14,152 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:14,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:20:14,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:14,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:20:14,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:14,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:14,242 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:14,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:14,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:14,290 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:14,308 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:14,326 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:14,329 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:20:14,329 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:14,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:20:14,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:14,344 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:20:14,344 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:14,344 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:20:14,358 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   learning_rate: 0.010653350987046539
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   n_estimators: 247
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   subsample: 0.9439070358251208
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6723727827093818
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   reg_alpha: 3.127246269059942
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO -   reg_lambda: 8.967182337118219e-07
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:20:14,361 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:20:14,476 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:20:14,476 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.1564559322714117})})
2025-06-24 12:20:14,476 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:20:14,476 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:20:14,476 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:20:14,477 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:20:14,477 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:14,477 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:14,496 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:14,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:14,529 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:14,545 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:14,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:14,595 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:14,598 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:20:14,598 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:14,601 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:20:14,603 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:20:14,603 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:20:14,603 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:20:14,603 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:20:14,603 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:14,603 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:14,603 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:20:14,603 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:20:14,608 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:20:14,612 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:20:14,613 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.0025048  0.09944057 0.04290843 0.32797962 0.00500681 0.01022439
 0.03510015 0.15618771 0.34452478 0.10382082 0.00115561 0.08150512
 0.00473328 0.80491465 0.00115552 0.75715006 0.22755483 0.00115615
 0.38389406 0.45745237 0.85009803 0.3863523  0.12339256 0.00115596
 0.00304559 0.00115617 0.02100914 0.58411859 0.58156813 0.71535072
 0.00115619]
2025-06-24 12:20:14,613 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:20:15,384 - src.training - INFO -   precision: 0.0
2025-06-24 12:20:15,384 - src.training - INFO -   recall: 0.0
2025-06-24 12:20:15,384 - src.training - INFO -   f1: 0.0
2025-06-24 12:20:15,384 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:20:15,384 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:20:15,384 - src.training - INFO -   positive_samples: 270
2025-06-24 12:20:15,384 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:20:15,384 - src.training - INFO -   total_samples: 220940
2025-06-24 12:20:15,384 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:20:15,384 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:20:15,384 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:20:15,384 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:20:15,384 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:20:15,384 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:20:15,384 - src.training - INFO - 모델 학습 완료
2025-06-24 12:20:15,384 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:20:15,384 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:15,384 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:15,384 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:15,384 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:15,407 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:20:15,408 - src.hyperparameter_tuning - ERROR - Trial 88 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:20:15,846 - src.hyperparameter_tuning - INFO - Trial 89: 모델 타입 = lightgbm
2025-06-24 12:20:17,651 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:20:17,652 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:20:17,652 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:20:17,652 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:20:17,652 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:20:17,652 - src.training - INFO - 교차 검증 시작
2025-06-24 12:20:17,652 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:20:17,669 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:20:18,108 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:20:18,108 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:20:18,108 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:20:18,108 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:20:18,108 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:20:18,108 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:20:18,108 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:20:18,108 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:20:18,108 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:20:18,292 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:20:18,292 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:20:18,292 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:20:18,292 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:20:18,292 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:20:18,292 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:20:18,292 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:20:18,292 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:20:18,292 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:20:18,292 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:20:19,539 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:20:20,517 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:20:20,517 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:20:20,523 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:20:20,554 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:20:20,554 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:20:20,554 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:20:20,554 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:20:21,722 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:20:21,975 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:20:21,975 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:20:22,136 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:20:22,136 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:20:22,177 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:20:22,177 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:20:22,177 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:20:22,177 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:20:22,177 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:22,177 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:22,234 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:20:22,234 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:20:22,235 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:22,235 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:22,235 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:20:22,235 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:20:22,235 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:22,293 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:20:22,293 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:20:22,293 - src.training - INFO - 모델 학습 시작
2025-06-24 12:20:22,421 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:20:22,421 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:20:22,421 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:20:22,421 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:20:22,421 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:20:22,421 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:20:22,421 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:20:22,422 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:20:22,422 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:20:22,422 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:20:22,422 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:20:22,422 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:20:22,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:20:22,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:22,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:22,501 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:22,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:22,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:22,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:22,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:22,801 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:22,818 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:20:22,818 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:22,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:20:22,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:22,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:20:22,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:22,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:22,915 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:22,929 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:22,943 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:22,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:22,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:22,988 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:22,990 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:20:22,990 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:23,004 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:20:23,004 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:23,004 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:20:23,004 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:23,005 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:20:23,018 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   learning_rate: 0.1115873743660968
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:20:23,021 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO -   n_estimators: 333
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO -   subsample: 0.672161261498229
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8658789014598572
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO -   reg_alpha: 1.304271382149324e-05
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00030334553924171384
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:20:23,022 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:20:23,138 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:20:23,139 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 3.082937378898115})})
2025-06-24 12:20:23,139 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:20:23,139 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:20:23,139 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:20:23,139 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:20:23,139 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:23,140 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:23,158 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:23,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:23,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:23,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:23,218 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:23,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:23,239 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:20:23,239 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:23,243 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:20:23,248 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:20:23,248 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:20:23,248 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:20:23,248 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:20:23,248 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:23,248 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:23,248 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:20:23,248 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:20:23,252 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:20:23,256 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:20:23,257 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [5.91112917e-001 9.99579112e-001 9.99999994e-001 0.00000000e+000
 1.31032425e-099 4.11588451e-087 1.01921611e-006 1.45298618e-087
 9.34150103e-005 1.00000000e+000 8.39365815e-001 1.00000000e+000
 9.99999997e-001 2.23466969e-198 3.33678338e-054 2.41753315e-020
 9.87956996e-058 3.53128124e-108 5.01420843e-070 1.20423070e-128
 4.30201094e-091 3.66475963e-064 7.90042933e-004 6.18169470e-119
 1.03318674e-149 7.23272373e-124 1.59580185e-097 4.61897465e-049
 4.28935826e-001 1.57363877e-282 6.72630626e-090 2.49636052e-257
 1.60496173e-097 3.54499474e-173 9.99745335e-001 1.51653831e-252
 2.69363065e-103 1.00000000e+000 1.00000000e+000 9.99966887e-001
 3.26144240e-013 1.00000000e+000 8.48964667e-009 3.26769467e-013
 2.15358331e-168 3.22346829e-010 4.29048563e-081 2.60646881e-076
 4.19300025e-095 1.13755981e-013 5.21141039e-093 1.31742372e-114
 2.64796317e-082 6.61515593e-235 5.30724930e-006 9.94087249e-001
 4.48503580e-221 4.07021711e-136 5.11641194e-214 4.64319760e-129
 4.19412218e-127 2.47265575e-131 2.53572558e-035 3.30059408e-083
 1.03388699e-046 1.26090952e-008 3.45025805e-223 5.24735186e-113
 2.21242774e-065 6.32820622e-095 5.63321647e-011 2.54724647e-090
 4.37012977e-018 3.85453500e-156 7.69493782e-028 7.06876900e-002
 1.99918629e-023 5.87337357e-048 7.16305831e-010 1.38478635e-021
 1.63243624e-056 2.53119518e-211 3.59774951e-017 5.44771949e-233
 1.98226438e-058 9.99999984e-001 1.34396328e-044 1.43153253e-104
 7.68021465e-028 8.16457317e-040 3.37073462e-257 3.57692773e-291
 2.69823616e-027 9.05222374e-001 9.95731614e-001 4.94386268e-148
 1.54143100e-225 2.71856670e-106 3.83110221e-041 4.65061249e-003
 3.22560031e-097 4.78326540e-088 1.47456739e-085 5.09300041e-107
 1.15846452e-261 8.51571162e-070 2.04772033e-252 1.19525680e-091
 1.44106332e-099 1.03856052e-031 2.17298259e-286 6.00332352e-150
 1.39886483e-140 1.96004542e-224 1.87502331e-084 4.17403581e-040
 6.18442120e-109 1.22304598e-077 6.42165228e-001 9.99999929e-001
 3.13114544e-138 1.67958692e-140 1.22932960e-295 4.34469194e-303
 1.53315829e-037 1.16025623e-132 4.89447418e-074 1.77876181e-139
 4.08046592e-284 3.84524620e-250 9.60861728e-254 5.27575157e-305
 7.06298271e-102 2.84183891e-246 1.01963914e-287 2.29708623e-126
 7.38325054e-242 2.01869119e-281 4.09424083e-269 6.90250262e-116
 2.57899867e-161 2.35567782e-030 1.56318502e-294 1.18985079e-036
 6.70037744e-157 3.44074710e-012 1.83242036e-098 4.76163126e-033
 2.83352732e-010 1.39495457e-006 1.47307474e-260 1.14723701e-001
 1.43454556e-044 7.89173989e-016 5.54889176e-278 3.38679383e-025
 1.82413254e-043 2.61878853e-004 6.54562157e-008]
2025-06-24 12:20:23,257 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:20:24,462 - src.training - INFO -   precision: 0.0
2025-06-24 12:20:24,462 - src.training - INFO -   recall: 0.0
2025-06-24 12:20:24,462 - src.training - INFO -   f1: 0.0
2025-06-24 12:20:24,462 - src.training - INFO -   accuracy: 0.9975196886032407
2025-06-24 12:20:24,462 - src.training - INFO -   balanced_accuracy: 0.4993701001495446
2025-06-24 12:20:24,462 - src.training - INFO -   positive_samples: 270
2025-06-24 12:20:24,462 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:20:24,462 - src.training - INFO -   total_samples: 220940
2025-06-24 12:20:24,462 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:20:24,462 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:20:24,462 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:20:24,462 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:20:24,463 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:20:24,463 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:20:24,463 - src.training - INFO - 모델 학습 완료
2025-06-24 12:20:24,463 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9975196886032407, 'balanced_accuracy': 0.4993701001495446, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:20:24,463 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:24,463 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:24,463 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:24,463 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:24,485 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:20:24,486 - src.hyperparameter_tuning - ERROR - Trial 89 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:20:24,924 - src.hyperparameter_tuning - INFO - Trial 90: 모델 타입 = lightgbm
2025-06-24 12:20:26,733 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:20:26,733 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:20:26,733 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:20:26,733 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:20:26,733 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:20:26,733 - src.training - INFO - 교차 검증 시작
2025-06-24 12:20:26,733 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:20:26,750 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:20:27,191 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:20:27,191 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:20:27,191 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:20:27,191 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:20:27,191 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:20:27,191 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:20:27,191 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:20:27,191 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:20:27,191 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:20:27,376 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:20:27,376 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:20:27,376 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:20:27,376 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:20:27,376 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:20:27,376 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:20:27,376 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:20:27,376 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:20:27,376 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:20:27,376 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:20:28,628 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:20:29,608 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:20:29,608 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:20:29,614 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:20:29,645 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:20:29,645 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:20:29,645 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:20:29,645 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:20:30,803 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:20:31,058 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:20:31,058 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:20:31,218 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:20:31,218 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:20:31,259 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:20:31,259 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:20:31,259 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:20:31,259 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:20:31,259 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:31,259 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:31,316 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:20:31,316 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:20:31,316 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:31,316 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:31,316 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:20:31,316 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:20:31,316 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:31,373 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:20:31,374 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:20:31,374 - src.training - INFO - 모델 학습 시작
2025-06-24 12:20:31,501 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:20:31,502 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:20:31,502 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:20:31,502 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:20:31,502 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:20:31,502 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:20:31,502 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:20:31,502 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:20:31,502 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:20:31,502 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:20:31,502 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:20:31,502 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:20:31,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:20:31,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:31,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:31,581 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:31,636 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:31,694 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:31,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:31,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:31,877 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:31,896 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:20:31,896 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:31,974 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:20:31,974 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:31,974 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:20:31,974 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:31,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:31,992 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:32,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:32,020 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:32,034 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:32,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:32,065 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:32,067 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:20:32,067 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:32,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:20:32,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:32,082 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:20:32,082 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:32,082 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:20:32,095 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   learning_rate: 0.012448614137605875
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   n_estimators: 204
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   subsample: 0.9859693804355485
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7094677511690122
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   reg_alpha: 3.233555849562989e-08
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00018444449591045555
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:20:32,099 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:20:32,213 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:20:32,213 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.3106796484225406})})
2025-06-24 12:20:32,213 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 12:20:32,213 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:20:32,214 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:20:32,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:20:32,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:32,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:32,232 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:32,247 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:32,262 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:32,276 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:32,291 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:32,309 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:32,312 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:20:32,312 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:32,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:20:32,316 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:20:32,317 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:20:32,317 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:20:32,317 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:20:32,317 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:32,317 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:32,317 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:20:32,317 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:20:32,320 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:20:32,324 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:20:32,325 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.0026648  0.22167413 0.07654087 0.6542474  0.06174447 0.01469371
 0.06096758 0.40350103 0.00115358 0.00598831 0.94234426 0.00115347
 0.00115454 0.92175859 0.42791043 0.00115421 0.00115477 0.71877457
 0.95951716 0.79033164 0.23987722 0.00115399 0.73382111 0.00357879
 0.00115424 0.0338563  0.82269195 0.82089686 0.00115566 0.90154844
 0.39233204]
2025-06-24 12:20:32,325 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:20:33,102 - src.training - INFO -   precision: 0.0
2025-06-24 12:20:33,102 - src.training - INFO -   recall: 0.0
2025-06-24 12:20:33,102 - src.training - INFO -   f1: 0.0
2025-06-24 12:20:33,102 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:20:33,102 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:20:33,102 - src.training - INFO -   positive_samples: 270
2025-06-24 12:20:33,102 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:20:33,102 - src.training - INFO -   total_samples: 220940
2025-06-24 12:20:33,102 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:20:33,102 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:20:33,102 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:20:33,102 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:20:33,103 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:20:33,103 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:20:33,103 - src.training - INFO - 모델 학습 완료
2025-06-24 12:20:33,103 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:20:33,103 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:33,103 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:33,103 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:33,103 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:33,125 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:20:33,125 - src.hyperparameter_tuning - ERROR - Trial 90 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:20:33,571 - src.hyperparameter_tuning - INFO - Trial 91: 모델 타입 = lightgbm
2025-06-24 12:20:35,348 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:20:35,348 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:20:35,348 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:20:35,348 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:20:35,348 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:20:35,348 - src.training - INFO - 교차 검증 시작
2025-06-24 12:20:35,348 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:20:35,366 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:20:35,818 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:20:35,819 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:20:35,819 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:20:35,819 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:20:35,819 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:20:35,819 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:20:35,819 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:20:35,819 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:20:35,819 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:20:35,999 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:20:35,999 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:20:35,999 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:20:35,999 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:20:35,999 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:20:35,999 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:20:35,999 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:20:35,999 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:20:35,999 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:20:35,999 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:20:37,257 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:20:38,236 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:20:38,236 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:20:38,242 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:20:38,272 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:20:38,273 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:20:38,273 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:20:38,273 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:20:39,432 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:20:39,681 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:20:39,681 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:20:39,841 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:20:39,842 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:20:39,882 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:20:39,882 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:20:39,882 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:20:39,882 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:20:39,882 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:39,882 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:39,939 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:20:39,939 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:20:39,939 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:39,939 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:39,939 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:20:39,939 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:20:39,939 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:39,999 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:20:39,999 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:20:39,999 - src.training - INFO - 모델 학습 시작
2025-06-24 12:20:40,131 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:20:40,131 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:20:40,131 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:20:40,131 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:20:40,131 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:20:40,131 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:20:40,131 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:20:40,131 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:20:40,131 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:20:40,131 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:20:40,131 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:20:40,131 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:20:40,131 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:20:40,131 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:40,132 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:40,212 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:40,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:40,325 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:40,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:40,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:40,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:40,524 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:20:40,524 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:40,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:20:40,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:40,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:20:40,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:40,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:40,620 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:40,633 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:40,648 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:40,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:40,675 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:40,692 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:40,695 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:20:40,695 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:40,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:20:40,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:40,710 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:20:40,710 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:40,710 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:20:40,723 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   learning_rate: 0.07917764560509782
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:20:40,726 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   n_estimators: 101
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   subsample: 0.8048879426596536
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7851801952696728
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0016922387545076475
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO -   reg_lambda: 2.3708508456644085e-05
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:20:40,727 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:20:40,848 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:20:40,848 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 7.241722855783776})})
2025-06-24 12:20:40,848 - src.models.lightgbm_model - INFO -   - Best Iteration: 3
2025-06-24 12:20:40,848 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:20:40,848 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:20:40,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:20:40,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:40,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:40,867 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:40,882 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:40,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:40,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:40,926 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:40,943 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:40,946 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:20:40,946 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:40,949 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:20:40,951 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:20:40,951 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:20:40,951 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:20:40,951 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:20:40,951 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:40,951 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:40,951 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:20:40,951 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:20:40,955 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:20:40,959 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:20:40,961 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [1.75128717e-001 9.99999940e-001 9.99999966e-001 0.00000000e+000
 1.38391541e-089 5.88751214e-001 3.69778218e-041 4.21580140e-143
 9.99999675e-001 1.00000000e+000 1.00000000e+000 1.00000000e+000
 1.35425928e-178 4.03351896e-001 6.26339937e-001 9.99999983e-001
 6.37818187e-001 3.34941630e-069 1.00000000e+000 3.17145724e-048
 3.12486335e-154 4.35285205e-042 9.99999999e-001 3.64345572e-147
 9.43129077e-001 2.60048076e-062 2.13515591e-043 3.06517640e-041
 5.07523751e-035 3.97000216e-142 1.00000000e+000 2.70115620e-185
 6.68883839e-038 1.83124785e-050 7.04542241e-245 8.67394315e-001
 5.87249993e-031 2.36840210e-031 5.93751998e-031 2.93155599e-253
 2.05438217e-167 3.35494204e-305 6.66590824e-001 3.48218567e-040
 1.03722967e-088 1.02999083e-160 1.07446942e-082 1.11490831e-001
 1.01182326e-081 3.15413101e-068 2.44886162e-061 3.43102667e-146
 4.48070458e-026 5.09192137e-164 1.00000000e+000 1.00000000e+000
 1.30322723e-088 9.99158040e-001 8.31544455e-302 1.00000000e+000
 9.99999994e-001 2.58163711e-005 1.28377768e-010 3.24122998e-008
 5.73196983e-008 1.00000000e+000 5.68416613e-078 3.38822956e-002
 2.94267046e-153 1.28552343e-010 2.13615995e-044 5.46178043e-179
 2.94921965e-165 3.81006454e-001 9.99988034e-001 9.99999995e-001
 1.19365833e-001 4.40278135e-005 2.98654772e-047 7.78585810e-005
 2.93188743e-004 2.05359173e-164 1.83870005e-050 1.21778360e-134
 8.64648235e-066 1.00000000e+000 1.94414074e-176 9.99997516e-001
 1.74391825e-007 1.18230795e-253 2.24234367e-006 1.85757029e-001
 2.55290003e-157 1.02959453e-157 7.30983492e-162 6.61514811e-064
 2.20609378e-238 9.76754749e-088 1.09154349e-086 5.52709024e-003
 9.99999962e-001 7.46007602e-004 9.99999407e-001 4.46693429e-086
 1.40828053e-002 3.66487941e-155 7.17609731e-132 3.35365119e-302
 1.00000000e+000 1.47862907e-158 3.34911897e-051 2.62824581e-074
 2.18178946e-264 4.03576572e-108 3.25766374e-241 8.14235547e-065
 4.81627085e-303 8.11475376e-015 4.28563666e-109 3.26029450e-007
 2.08793372e-166 9.99999984e-001 9.99999990e-001 1.76024275e-097
 2.01888434e-003 1.34427175e-161 9.49033237e-001 7.86929468e-015
 5.52604991e-032 9.95861531e-001 2.20454990e-012 1.19374442e-299
 9.99963209e-001 1.00000000e+000 9.99608935e-001 4.20846844e-251
 2.88034704e-242 2.16391615e-199 2.62889360e-048 1.08938682e-185
 2.99830461e-159 3.06437638e-004 3.07386863e-003 1.00000000e+000
 9.34031557e-150 2.93985165e-001 5.41793647e-004 1.10760452e-187
 3.10373076e-074 1.00000000e+000 3.57256283e-086 3.36426715e-085
 4.24091257e-001 4.95483915e-171 6.31645809e-022 4.09605415e-043
 1.00000000e+000 9.99220508e-001 3.87771227e-183 2.27820308e-018
 3.11505543e-020 8.58044865e-019 1.59053695e-180 1.77663653e-072
 1.83889036e-002 7.63540597e-001 7.11820684e-003 9.74309788e-206
 6.24884550e-040 1.86298531e-156 9.67804327e-001 4.46376981e-009
 5.36340853e-196 1.53276443e-027 9.99978657e-001 9.51500270e-001
 1.44864013e-001 1.50735153e-201 8.81930490e-001 3.73606994e-198
 9.99664607e-001 9.99945989e-001 7.05501980e-038 1.75814481e-188
 1.00000000e+000 9.75462647e-005 5.35608487e-002 9.99999954e-001
 9.92305609e-001 1.00000000e+000 3.36319287e-006 7.93092367e-001
 7.21812765e-001 4.70233092e-150 3.70304825e-005 1.88680092e-014
 1.00000000e+000 3.58245091e-019 1.00000000e+000 2.14857620e-023
 5.86700693e-004 1.00000000e+000 1.68950110e-002 4.05064882e-200
 5.30189375e-192 7.59404363e-208 9.99999255e-001 4.22582958e-017
 9.99995082e-001 1.25171589e-194 2.20154982e-194 3.05560982e-207
 9.99873227e-001 3.94623438e-199 4.17398183e-002 1.48773787e-008
 9.99999999e-001 5.28989689e-210 3.33911972e-008 9.93684415e-001
 1.53356658e-196 9.99996375e-001 1.00000000e+000 1.00000000e+000
 1.79693202e-192 8.49823169e-012 5.37617196e-203 9.92635925e-001
 9.99956900e-001 2.04332955e-005 4.77582225e-036 9.99999891e-001
 1.98084351e-006 2.40169551e-102 7.21676030e-187 2.52437089e-098
 5.42931147e-100 9.99637716e-001 4.61298968e-102 3.28996327e-005
 2.62137556e-008 4.10060998e-042 3.25799395e-090 1.81393472e-044
 8.24473605e-001 3.29866955e-099 6.29328727e-079 7.79661187e-001
 9.99999999e-001 2.85698029e-149 1.33732792e-088 3.44126527e-091
 1.53316861e-080 1.29314023e-208 1.00000000e+000 5.91958308e-205
 9.10582133e-001 5.83027016e-001 1.00000000e+000 1.00000000e+000
 2.43154100e-137 9.99908322e-001 9.99999984e-001 2.12039550e-029]
2025-06-24 12:20:40,961 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:20:42,113 - src.training - INFO -   precision: 0.003992220288668236
2025-06-24 12:20:42,113 - src.training - INFO -   recall: 0.14444444444444443
2025-06-24 12:20:42,113 - src.training - INFO -   f1: 0.007769698177109274
2025-06-24 12:20:42,113 - src.training - INFO -   accuracy: 0.9549153616366435
2025-06-24 12:20:42,113 - src.training - INFO -   balanced_accuracy: 0.5501757274562821
2025-06-24 12:20:42,113 - src.training - INFO -   positive_samples: 270
2025-06-24 12:20:42,113 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:20:42,113 - src.training - INFO -   total_samples: 220940
2025-06-24 12:20:42,113 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:20:42,113 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:20:42,113 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:20:42,113 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:20:42,114 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:20:42,114 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:20:42,114 - src.training - INFO - 모델 학습 완료
2025-06-24 12:20:42,114 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003992220288668236, 'recall': 0.14444444444444443, 'f1': 0.007769698177109274, 'accuracy': 0.9549153616366435, 'balanced_accuracy': 0.5501757274562821, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:20:42,114 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:42,114 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:42,114 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:42,114 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:42,134 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:20:42,134 - src.hyperparameter_tuning - ERROR - Trial 91 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:20:42,591 - src.hyperparameter_tuning - INFO - Trial 92: 모델 타입 = lightgbm
2025-06-24 12:20:44,546 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:20:44,547 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:20:44,547 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:20:44,547 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:20:44,547 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:20:44,547 - src.training - INFO - 교차 검증 시작
2025-06-24 12:20:44,547 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:20:44,563 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:20:45,035 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:20:45,035 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:20:45,035 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:20:45,035 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:20:45,035 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:20:45,035 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:20:45,035 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:20:45,035 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:20:45,035 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:20:45,201 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:20:45,201 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:20:45,202 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:20:45,202 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:20:45,202 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:20:45,202 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:20:45,202 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:20:45,202 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:20:45,202 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:20:45,202 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:20:46,588 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:20:47,669 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:20:47,669 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:20:47,676 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:20:47,710 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:20:47,710 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:20:47,710 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:20:47,710 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:20:48,993 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:20:49,263 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:20:49,263 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:20:49,432 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:20:49,432 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:20:49,475 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:20:49,475 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:20:49,475 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:20:49,475 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:20:49,475 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:49,475 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:49,537 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:20:49,537 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:20:49,537 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:49,537 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:49,537 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:20:49,537 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:20:49,537 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:49,603 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:20:49,603 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:20:49,603 - src.training - INFO - 모델 학습 시작
2025-06-24 12:20:49,735 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:20:49,735 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:20:49,735 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:20:49,735 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:20:49,735 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:20:49,735 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:20:49,735 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:20:49,735 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:20:49,735 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:20:49,735 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:20:49,735 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:20:49,735 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:20:49,735 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:20:49,735 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:49,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:49,826 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:49,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:49,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:50,024 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:50,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:50,167 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:50,184 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:20:50,184 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:50,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:20:50,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:50,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:20:50,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:50,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:50,267 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:50,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:50,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:50,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:50,332 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:50,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:50,353 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:20:50,354 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:50,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:20:50,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:50,370 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:20:50,370 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:50,370 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:20:50,381 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:20:50,384 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   learning_rate: 0.13071959783305928
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   n_estimators: 52
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   subsample: 0.8834315198321664
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9292170257320477
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   reg_alpha: 2.77803021221577e-05
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO -   reg_lambda: 7.984331602891662e-08
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:20:50,385 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:20:50,503 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:20:50,503 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.43169917056156754})})
2025-06-24 12:20:50,504 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:20:50,504 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:20:50,506 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:20:50,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:20:50,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:50,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:50,525 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:50,541 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:50,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:50,574 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:50,592 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:20:50,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:20:50,613 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:20:50,613 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:50,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:20:50,621 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:20:50,621 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:20:50,621 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:20:50,621 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:20:50,621 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:50,621 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:50,621 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:20:50,621 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:20:50,625 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:20:50,629 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:20:50,630 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [7.03351528e-001 1.99091858e-065 1.35334806e-055 0.00000000e+000
 3.15657395e-117 3.31848177e-235 6.93107674e-082 2.08796210e-102
 2.21641099e-105 5.90278778e-057 8.07822908e-100 2.15140929e-051
 3.64978820e-054 1.14659418e-051 2.43838320e-055 5.99110596e-057
 2.48251770e-083 4.83794495e-090 1.00000000e+000 1.29019331e-068
 7.87470778e-224 1.03795990e-167 4.49645652e-114 2.38355855e-213
 3.62969699e-082 4.87618103e-283 2.02570039e-054 4.17903110e-046
 1.04285192e-059 2.99095898e-122 3.76643867e-018 3.58712037e-065
 1.87894946e-059 1.95789426e-277 2.09044357e-018 3.76310635e-056
 2.79196454e-047 1.18324035e-015 1.00000000e+000 4.31259665e-010
 3.98347709e-053 3.91507974e-064 6.93593450e-080 1.03817529e-078
 7.95160030e-079 5.35664037e-084 1.54456826e-073 1.26362317e-098
 1.51804762e-084 2.07750800e-084 7.47409933e-106 7.70021561e-107
 5.34463590e-084 1.59393404e-037 2.89005229e-159 2.05158243e-267
 1.99347905e-267 8.02785120e-102 5.48189381e-155 1.00000000e+000
 2.68540039e-289 1.04050712e-078 1.07376265e-042 1.02034955e-089
 1.95148628e-149 2.01134058e-132 7.27755770e-035 2.98571031e-127
 7.05216426e-071 7.66026913e-053 1.03190900e-074 4.68719409e-212
 7.13768675e-081 3.63052854e-076 3.82884869e-045 7.28508518e-129
 1.07135630e-042 2.76759327e-101 1.70538163e-010 6.86061998e-073
 1.42502085e-229 1.35549447e-111 7.78640270e-008 2.00683308e-132
 2.55801153e-046 1.08142570e-123 4.71147308e-072 2.78902177e-103
 2.05073602e-058 1.14626535e-015 6.95151315e-080 3.38906699e-187
 4.11079256e-017 1.00000000e+000 2.66131706e-054 5.61420757e-129
 2.62265414e-186 3.89316736e-181 1.86475575e-106 2.14893854e-103
 4.50524919e-204 8.33237442e-124 1.00405682e-160 1.80903511e-294
 3.95122208e-009 6.92570942e-269 1.00000000e+000 3.96642701e-204
 1.14883995e-015 2.32752589e-192 1.81743011e-232]
2025-06-24 12:20:50,630 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:20:52,002 - src.training - INFO -   precision: 0.0
2025-06-24 12:20:52,002 - src.training - INFO -   recall: 0.0
2025-06-24 12:20:52,002 - src.training - INFO -   f1: 0.0
2025-06-24 12:20:52,002 - src.training - INFO -   accuracy: 0.9984565945505567
2025-06-24 12:20:52,002 - src.training - INFO -   balanced_accuracy: 0.49983912629718585
2025-06-24 12:20:52,002 - src.training - INFO -   positive_samples: 270
2025-06-24 12:20:52,002 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:20:52,002 - src.training - INFO -   total_samples: 220940
2025-06-24 12:20:52,002 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:20:52,002 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:20:52,002 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:20:52,002 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:20:52,002 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:20:52,002 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:20:52,002 - src.training - INFO - 모델 학습 완료
2025-06-24 12:20:52,002 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9984565945505567, 'balanced_accuracy': 0.49983912629718585, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:20:52,002 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:52,002 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:52,002 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:52,003 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:52,022 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:20:52,022 - src.hyperparameter_tuning - ERROR - Trial 92 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:20:52,480 - src.hyperparameter_tuning - INFO - Trial 93: 모델 타입 = lightgbm
2025-06-24 12:20:54,424 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:20:54,424 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:20:54,424 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:20:54,424 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:20:54,424 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:20:54,424 - src.training - INFO - 교차 검증 시작
2025-06-24 12:20:54,424 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:20:54,441 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:20:54,914 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:20:54,914 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:20:54,914 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:20:54,914 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:20:54,914 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:20:54,914 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:20:54,914 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:20:54,914 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:20:54,914 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:20:55,081 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:20:55,081 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:20:55,081 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:20:55,081 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:20:55,081 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:20:55,081 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:20:55,081 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:20:55,081 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:20:55,081 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:20:55,081 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:20:56,463 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:20:57,544 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:20:57,545 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:20:57,551 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:20:57,585 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:20:57,585 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:20:57,585 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:20:57,585 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:20:58,868 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:20:59,143 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:20:59,143 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:20:59,311 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:20:59,312 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:20:59,355 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:20:59,355 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:20:59,355 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:20:59,355 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:20:59,355 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:59,355 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:20:59,418 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:20:59,418 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:20:59,418 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:59,418 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:59,418 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:20:59,418 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:20:59,418 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:20:59,485 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:20:59,485 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:20:59,485 - src.training - INFO - 모델 학습 시작
2025-06-24 12:20:59,616 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:20:59,616 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:20:59,616 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:20:59,616 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:20:59,617 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:20:59,617 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:20:59,617 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:20:59,617 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:20:59,617 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:20:59,617 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:20:59,617 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:20:59,617 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:20:59,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:20:59,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:20:59,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:20:59,709 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:20:59,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:20:59,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:20:59,905 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:20:59,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:00,050 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:00,066 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:21:00,066 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:00,130 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:21:00,130 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:00,130 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:21:00,130 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:00,131 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:00,149 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:00,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:00,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:00,196 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:00,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:00,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:00,234 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:21:00,234 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:00,250 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:21:00,250 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:00,250 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:21:00,250 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:00,251 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:21:00,262 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO -   learning_rate: 0.14773162936493442
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:21:00,265 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   n_estimators: 76
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   subsample: 0.9174205038035793
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8111813877740024
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   reg_alpha: 1.0973723308501162e-07
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO -   reg_lambda: 2.8435594260676385e-08
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:21:00,266 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:21:00,385 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:21:00,385 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.08016375673711232})})
2025-06-24 12:21:00,385 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:21:00,385 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:21:00,387 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:21:00,387 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:21:00,387 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:00,387 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:00,407 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:00,424 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:00,441 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:00,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:00,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:00,492 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:00,495 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:21:00,495 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:00,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:21:00,502 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:21:00,503 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:21:00,503 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:21:00,503 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:21:00,503 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:00,503 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:00,503 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:21:00,503 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:21:00,506 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:21:00,511 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:21:00,512 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [6.75810635e-002 0.00000000e+000 2.65378612e-134 1.51857138e-269
 1.08235284e-089 2.31351078e-289 1.80583903e-298 3.19513368e-103
 7.06604114e-103 1.08924869e-256 2.15764395e-052 4.05885269e-235
 7.54110147e-293 3.44481901e-254 1.27038004e-139 7.63422272e-245
 2.79827751e-248 9.39810845e-251 4.76038501e-200 3.32323980e-278
 4.07626223e-235 8.53857088e-276 3.30904639e-278 1.25456022e-179
 2.85732516e-229 2.32948132e-272 2.01580846e-195 7.42064983e-097
 1.21291066e-281 1.21811317e-281 2.07330333e-039 1.62337475e-286
 1.64342099e-238 1.01909786e-173 6.03781550e-306 4.68692165e-274
 1.00000000e+000 2.99415439e-197 2.19381444e-167 1.05514111e-170
 6.79467110e-012 1.15276528e-207 4.41726971e-207 2.94514356e-045
 1.00000000e+000 1.99956840e-014 9.13626307e-225 5.15805932e-038
 3.51147571e-197 2.94794791e-271 9.36408313e-202 1.40764336e-008
 3.52685915e-263 6.16337827e-128 3.62907072e-277 7.16998821e-203
 2.86278830e-240 8.36457859e-018 9.11260554e-296 3.10964129e-201
 4.43621660e-207 1.00000000e+000 3.68595320e-203 3.03411814e-012
 2.10034775e-036 1.08027998e-014 1.29781330e-230 1.30668894e-230
 1.27778514e-304 8.99527015e-299 3.82155660e-169 2.42378130e-016
 1.05158600e-275 2.96528517e-045 1.06806868e-201 2.05083613e-074
 1.28652382e-304 2.00814511e-014 4.30998849e-018 4.32847523e-018]
2025-06-24 12:21:00,512 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:21:01,873 - src.training - INFO -   precision: 0.0
2025-06-24 12:21:01,873 - src.training - INFO -   recall: 0.0
2025-06-24 12:21:01,873 - src.training - INFO -   f1: 0.0
2025-06-24 12:21:01,874 - src.training - INFO -   accuracy: 0.9986285869466823
2025-06-24 12:21:01,874 - src.training - INFO -   balanced_accuracy: 0.49992522771559345
2025-06-24 12:21:01,874 - src.training - INFO -   positive_samples: 270
2025-06-24 12:21:01,874 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:21:01,874 - src.training - INFO -   total_samples: 220940
2025-06-24 12:21:01,874 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:21:01,874 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:21:01,874 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:21:01,874 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:21:01,874 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:21:01,874 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:21:01,874 - src.training - INFO - 모델 학습 완료
2025-06-24 12:21:01,874 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9986285869466823, 'balanced_accuracy': 0.49992522771559345, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:21:01,874 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:01,874 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:01,874 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:01,874 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:01,894 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:21:01,894 - src.hyperparameter_tuning - ERROR - Trial 93 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:21:02,353 - src.hyperparameter_tuning - INFO - Trial 94: 모델 타입 = lightgbm
2025-06-24 12:21:04,292 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:21:04,292 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:21:04,292 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:21:04,292 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:21:04,292 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:21:04,292 - src.training - INFO - 교차 검증 시작
2025-06-24 12:21:04,292 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:21:04,309 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:21:04,786 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:21:04,786 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:21:04,786 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:21:04,786 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:21:04,786 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:21:04,787 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:21:04,787 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:21:04,787 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:21:04,787 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:21:04,956 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:21:04,956 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:21:04,956 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:21:04,956 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:21:04,956 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:21:04,956 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:21:04,956 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:21:04,956 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:21:04,956 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:21:04,956 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:21:06,351 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:21:07,440 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:21:07,440 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:21:07,446 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:21:07,481 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:21:07,481 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:21:07,481 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:21:07,481 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:21:08,762 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:21:09,034 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:21:09,034 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:21:09,203 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:21:09,204 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:21:09,247 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:21:09,247 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:21:09,247 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:21:09,247 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:21:09,247 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:09,247 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:09,310 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:21:09,310 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:21:09,310 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:09,310 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:09,310 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:21:09,310 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:21:09,310 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:09,376 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:21:09,376 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:21:09,376 - src.training - INFO - 모델 학습 시작
2025-06-24 12:21:09,508 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:21:09,508 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:21:09,508 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:21:09,508 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:21:09,508 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:21:09,508 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:21:09,508 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:21:09,508 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:21:09,508 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:21:09,508 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:21:09,508 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:21:09,508 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:21:09,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:21:09,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:09,509 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:09,600 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:09,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:09,735 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:09,800 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:09,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:09,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:09,962 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:21:09,962 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:10,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:21:10,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:10,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:21:10,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:10,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:10,045 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:10,060 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:10,077 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:10,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:10,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:10,129 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:10,132 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:21:10,132 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:10,148 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:21:10,148 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:10,148 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:21:10,148 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:10,148 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:21:10,159 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   learning_rate: 0.09037801360066658
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   n_estimators: 347
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   subsample: 0.7979074037176289
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6201993700872295
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   reg_alpha: 2.8563004079619658e-08
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO -   reg_lambda: 0.05761023118415791
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:21:10,163 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:21:10,336 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:21:10,336 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 7.362019525811522})})
2025-06-24 12:21:10,336 - src.models.lightgbm_model - INFO -   - Best Iteration: 12
2025-06-24 12:21:10,336 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:21:10,339 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:21:10,339 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:21:10,339 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:10,339 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:10,358 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:10,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:10,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:10,407 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:10,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:10,443 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:10,446 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:21:10,447 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:10,452 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:21:10,457 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:21:10,457 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:21:10,457 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:21:10,457 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:21:10,457 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:10,457 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:10,457 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:21:10,457 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:21:10,461 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:21:10,465 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:21:10,467 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [2.64750175e-001 0.00000000e+000 1.00000000e+000 5.47792472e-001
 3.27410894e-001 1.00000000e+000 2.72751784e-212 8.20752598e-001
 3.81546811e-010 9.00555674e-196 2.97013883e-121 2.17446792e-079
 4.11193193e-196 1.00000000e+000 3.88918110e-028 2.16276562e-022
 1.00236272e-305 8.06727979e-269 1.65925939e-194 2.42027665e-206
 1.72568006e-002 1.00000000e+000 9.98460371e-001 5.10021827e-008
 4.52849751e-297 5.15810051e-010 2.75048237e-255 9.95072668e-001
 6.09460214e-020 1.52813615e-013 7.25203667e-001 3.77254521e-005
 4.17470074e-001 1.99921155e-270 7.70188378e-023 1.97388638e-234
 3.41936290e-092 1.16205451e-014 2.90820719e-284 1.27174507e-009
 7.27915799e-026 4.61403604e-191 1.39472650e-018 1.51718864e-002
 9.79868918e-001 7.97892472e-010 2.25409121e-016 1.02553341e-026
 9.99967699e-001 1.00000000e+000 2.59833721e-056 6.39978328e-229
 7.81072500e-001 4.30141069e-253 4.91103662e-120 9.96871729e-001
 1.64969501e-004 3.28571880e-003 5.88631031e-010 1.95370460e-097
 9.84061936e-001 7.56309120e-002 1.25139626e-243 9.98954429e-001
 3.09374939e-271 1.88239212e-064 1.24200046e-064 3.13378691e-228
 5.32920964e-274 9.35803743e-001 3.56484007e-023 1.00273250e-119
 2.97655396e-005 1.16064002e-048 2.40061157e-278 2.17682985e-120
 4.39174115e-261 7.36625663e-244 5.38442304e-026 4.42242837e-244
 6.46647705e-105 5.16341726e-047 1.03953278e-259 1.54254041e-239
 1.14591471e-055 5.78564809e-045 9.99998210e-001 9.99976025e-001
 7.82541110e-101 2.25181800e-007 9.96498743e-001 8.79317146e-030
 1.09024499e-210 1.11061288e-231 1.38185268e-021 2.70198294e-045
 7.84643858e-001 8.61240195e-001 4.19657513e-123 3.85929366e-023
 6.57552193e-001 4.06072929e-017 7.36978458e-017 4.66677335e-006
 4.31285312e-294 4.83215955e-023 9.72906115e-001 5.06677718e-018
 1.39983432e-012 9.99999916e-001 3.45039557e-149 1.44975065e-014
 4.36681742e-043 2.73711070e-257 5.71979028e-016 2.77304101e-013
 9.99999200e-001 4.11129490e-254 2.33661698e-033 3.09530983e-027
 6.32312872e-303 8.07181967e-032 4.73447369e-299 1.00000000e+000
 1.43485828e-187 9.35049164e-043 1.56620471e-008 1.01247905e-164
 3.08760348e-069 8.15124781e-166 3.18281512e-097 6.10834391e-033
 9.99999998e-001 3.38380578e-008 3.13508539e-020 1.23925510e-002
 2.22411451e-038 1.08368237e-020 9.51895695e-001 2.06398583e-003
 1.52349366e-003 4.85200547e-005 2.02558059e-300 6.41760409e-299
 2.26292028e-068 5.91183440e-107 5.75567585e-061 3.58196546e-015
 1.37468033e-004 1.87310861e-021 4.10215816e-039 1.99384807e-199
 2.45995095e-187 5.13109755e-008 3.14646940e-131 4.14919431e-026
 8.01352275e-107 9.99999938e-001 9.99996133e-001 1.58388549e-290
 2.66083699e-067 4.58146961e-008 2.60749316e-021 3.08844841e-234
 1.68462971e-017 5.97183454e-021 1.05202686e-069 2.82130538e-286
 1.22548045e-038 1.01221964e-070 3.71003750e-039 2.30077281e-004
 3.30544485e-001 4.85537310e-015 8.57103438e-303 2.93556989e-008
 1.00000000e+000 2.38120796e-028 8.85920574e-030 9.79290465e-085
 1.00000000e+000 8.36871239e-035 1.53243446e-100 1.76744205e-014
 4.61173560e-035 3.75887174e-013 9.67625147e-020 3.52072380e-092
 1.94541254e-179 1.32743340e-084 4.30860076e-291 6.89250447e-181
 1.46893718e-020 4.14953245e-240 9.98981847e-001 9.60536257e-119
 9.49567544e-153 9.93997634e-001 4.44703659e-258 9.40373255e-029
 2.15841412e-001 7.48491930e-004 4.84653899e-032 3.28290232e-026
 5.77271857e-050 2.33972857e-194 9.97201908e-001 8.26430906e-211
 1.00000000e+000 5.08925565e-070 3.70597757e-186 1.13438338e-034
 3.01143417e-153 1.23514147e-205 3.60752023e-005 1.00000000e+000
 9.46418144e-001 2.67392729e-286 2.71885745e-039 1.07039009e-027
 2.72728398e-295 8.97038079e-017 2.07730576e-016 2.03690608e-091
 8.32642014e-018 1.15534312e-156 2.97487776e-002 2.26369738e-009
 1.89040167e-127 3.05778266e-098 8.61673059e-096 2.51281590e-039
 9.99999726e-001 2.83441997e-284 1.07553221e-019 1.42663924e-021
 1.02649922e-073 2.07722300e-100 2.04018280e-002 1.00000000e+000
 9.97863239e-132 1.30966104e-266 1.19623990e-131 3.14451955e-114
 2.59735159e-092 3.62345136e-124 9.57592690e-185 1.53214251e-096
 8.03467803e-129 8.44315810e-097 1.53495651e-129 1.78092135e-295
 9.97737988e-125 7.07134062e-002 9.95919675e-001 9.25273178e-108
 1.14157381e-041 1.07704458e-003 8.48238079e-284 2.74005298e-047
 4.06516759e-093 5.21803555e-024 2.64825691e-097 2.29643647e-023
 9.99998104e-001 1.77782633e-021 5.06428978e-091 4.42100155e-046
 6.90034754e-127 6.21663714e-087 1.41697561e-207 6.67962577e-244
 1.78643510e-268 1.10490595e-165 1.25254098e-105 1.77510599e-111
 5.86625489e-102 8.27024885e-050 9.88090346e-229 7.39833042e-291
 3.25389876e-025 6.05725670e-001 7.02843928e-066 1.32292583e-004
 2.03575361e-193 2.55988299e-305 1.18277725e-257 6.86467155e-091
 9.99997890e-001 1.70201683e-019 3.45085510e-074 1.27949921e-214
 1.02612257e-155 1.57509179e-081 4.55977077e-001 1.21667985e-213
 8.05005569e-073 7.32497632e-086 2.96805851e-109 2.60148227e-258
 1.69541698e-049 3.37235105e-189 6.74563538e-172 1.06596401e-254
 2.07938137e-246 1.12503428e-101 4.72477446e-247 7.76056363e-006
 1.88754335e-016 1.56031234e-280 1.47479362e-006]
2025-06-24 12:21:10,467 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:21:11,837 - src.training - INFO -   precision: 0.0020545007111733233
2025-06-24 12:21:11,837 - src.training - INFO -   recall: 0.337037037037037
2025-06-24 12:21:11,838 - src.training - INFO -   f1: 0.004084105648183471
2025-06-24 12:21:11,838 - src.training - INFO -   accuracy: 0.7991264596723092
2025-06-24 12:21:11,838 - src.training - INFO -   balanced_accuracy: 0.5683644422961049
2025-06-24 12:21:11,838 - src.training - INFO -   positive_samples: 270
2025-06-24 12:21:11,838 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:21:11,838 - src.training - INFO -   total_samples: 220940
2025-06-24 12:21:11,838 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:21:11,838 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:21:11,838 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:21:11,838 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:21:11,838 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:21:11,838 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:21:11,838 - src.training - INFO - 모델 학습 완료
2025-06-24 12:21:11,838 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0020545007111733233, 'recall': 0.337037037037037, 'f1': 0.004084105648183471, 'accuracy': 0.7991264596723092, 'balanced_accuracy': 0.5683644422961049, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:21:11,838 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:11,838 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:11,838 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:11,838 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:11,858 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:21:11,858 - src.hyperparameter_tuning - ERROR - Trial 94 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:21:12,315 - src.hyperparameter_tuning - INFO - Trial 95: 모델 타입 = lightgbm
2025-06-24 12:21:14,160 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:21:14,160 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:21:14,160 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:21:14,160 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:21:14,160 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:21:14,160 - src.training - INFO - 교차 검증 시작
2025-06-24 12:21:14,160 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:21:14,177 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:21:14,621 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:21:14,621 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:21:14,621 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:21:14,621 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:21:14,621 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:21:14,621 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:21:14,621 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:21:14,621 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:21:14,621 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:21:14,806 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:21:14,806 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:21:14,806 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:21:14,806 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:21:14,806 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:21:14,806 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:21:14,806 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:21:14,806 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:21:14,806 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:21:14,806 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:21:16,063 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:21:17,039 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:21:17,039 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:21:17,045 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:21:17,075 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:21:17,075 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:21:17,075 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:21:17,075 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:21:18,247 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:21:18,497 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:21:18,497 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:21:18,658 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:21:18,658 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:21:18,698 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:21:18,699 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:21:18,699 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:21:18,699 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:21:18,699 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:18,699 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:18,755 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:21:18,756 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:21:18,756 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:18,756 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:18,756 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:21:18,756 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:21:18,756 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:18,813 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:21:18,813 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:21:18,813 - src.training - INFO - 모델 학습 시작
2025-06-24 12:21:18,941 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:21:18,941 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:21:18,941 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:21:18,941 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:21:18,941 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:21:18,941 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:21:18,941 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:21:18,941 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:21:18,941 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:21:18,941 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:21:18,941 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:21:18,941 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:21:18,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:21:18,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:18,942 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:19,022 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:19,076 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:19,138 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:19,192 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:19,251 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:19,321 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:19,336 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:21:19,337 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:19,413 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:21:19,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:19,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:21:19,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:19,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:19,431 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:19,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:19,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:19,473 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:19,487 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:19,505 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:19,508 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:21:19,508 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:19,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:21:19,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:19,523 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:21:19,523 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:19,523 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:21:19,536 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:21:19,539 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:21:19,539 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   learning_rate: 0.01962529301639915
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   n_estimators: 351
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   subsample: 0.6583014670840002
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6788441632166621
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   reg_alpha: 1.7089617347925428
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO -   reg_lambda: 2.802891863786432e-06
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:21:19,540 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:21:21,532 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:21:21,533 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.44448980008652883})})
2025-06-24 12:21:21,533 - src.models.lightgbm_model - INFO -   - Best Iteration: 351
2025-06-24 12:21:21,533 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:21:21,533 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:21:21,533 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:21:21,533 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:21,534 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:21,552 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:21,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:21,582 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:21,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:21,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:21,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:21,632 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:21:21,632 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:21,635 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:21:21,725 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:21:21,726 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:21:21,726 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:21:21,726 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:21:21,726 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:21,726 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:21,726 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:21:21,726 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:21:21,729 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:21:21,733 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:21:21,738 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.04245959 0.02751891 0.01975278 ... 0.00831882 0.013814   0.00665104]
2025-06-24 12:21:21,738 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:21:22,951 - src.training - INFO -   precision: 0.0
2025-06-24 12:21:22,951 - src.training - INFO -   recall: 0.0
2025-06-24 12:21:22,951 - src.training - INFO -   f1: 0.0
2025-06-24 12:21:22,951 - src.training - INFO -   accuracy: 0.9987462659545578
2025-06-24 12:21:22,951 - src.training - INFO -   balanced_accuracy: 0.4999841392123986
2025-06-24 12:21:22,951 - src.training - INFO -   positive_samples: 270
2025-06-24 12:21:22,951 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:21:22,951 - src.training - INFO -   total_samples: 220940
2025-06-24 12:21:22,951 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:21:22,951 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:21:22,951 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:21:22,951 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:21:22,951 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:21:22,951 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:21:22,951 - src.training - INFO - 모델 학습 완료
2025-06-24 12:21:22,951 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987462659545578, 'balanced_accuracy': 0.4999841392123986, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:21:22,951 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:22,951 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:22,951 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:22,951 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:22,974 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:21:22,974 - src.hyperparameter_tuning - ERROR - Trial 95 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:21:23,421 - src.hyperparameter_tuning - INFO - Trial 96: 모델 타입 = lightgbm
2025-06-24 12:21:25,221 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:21:25,221 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:21:25,221 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:21:25,221 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:21:25,221 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:21:25,221 - src.training - INFO - 교차 검증 시작
2025-06-24 12:21:25,221 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:21:25,238 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:21:25,678 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:21:25,679 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:21:25,679 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:21:25,679 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:21:25,679 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:21:25,679 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:21:25,679 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:21:25,679 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:21:25,679 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:21:25,865 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:21:25,865 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:21:25,865 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:21:25,865 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:21:25,865 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:21:25,865 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:21:25,865 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:21:25,865 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:21:25,865 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:21:25,865 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:21:27,104 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:21:28,074 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:21:28,074 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:21:28,080 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:21:28,112 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:21:28,112 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:21:28,112 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:21:28,112 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:21:29,281 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:21:29,530 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:21:29,530 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:21:29,690 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:21:29,691 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:21:29,731 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:21:29,731 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:21:29,731 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:21:29,731 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:21:29,732 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:29,732 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:29,788 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:21:29,788 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:21:29,788 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:29,788 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:29,788 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:21:29,788 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:21:29,788 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:29,846 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:21:29,846 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:21:29,846 - src.training - INFO - 모델 학습 시작
2025-06-24 12:21:29,974 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:21:29,974 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:21:29,974 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:21:29,974 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:21:29,974 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:21:29,974 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:21:29,974 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:21:29,974 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:21:29,974 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:21:29,974 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:21:29,974 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:21:29,974 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:21:29,974 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:21:29,974 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:29,974 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:30,053 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:30,107 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:30,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:30,219 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:30,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:30,349 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:30,365 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:21:30,365 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:30,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:21:30,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:30,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:21:30,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:30,442 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:30,459 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:30,473 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:30,487 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:30,500 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:30,515 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:30,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:30,534 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:21:30,534 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:30,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:21:30,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:30,549 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:21:30,549 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:30,549 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:21:30,561 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:21:30,564 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   learning_rate: 0.059785893972711814
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   n_estimators: 301
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   subsample: 0.7692957149746245
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8490100100820469
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   reg_alpha: 5.170774777522447e-06
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO -   reg_lambda: 5.321098482902928e-07
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:21:30,565 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:21:30,744 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:21:30,744 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 4.905945665161349})})
2025-06-24 12:21:30,744 - src.models.lightgbm_model - INFO -   - Best Iteration: 12
2025-06-24 12:21:30,744 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:21:30,744 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:21:30,744 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:21:30,744 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:30,745 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:30,764 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:30,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:30,794 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:30,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:30,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:30,840 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:30,842 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:21:30,842 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:30,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:21:30,851 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:21:30,851 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:21:30,851 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:21:30,851 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:21:30,851 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:30,851 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:30,851 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:21:30,851 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:21:30,855 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:21:30,859 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:21:30,862 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [1.70213354e-001 9.16738129e-002 0.00000000e+000 4.85031171e-049
 3.41469181e-068 4.54314558e-001 4.52934470e-001 6.63992474e-002
 1.00000000e+000 1.68248910e-001 3.39263747e-001 4.13781957e-002
 2.37586675e-001 3.27235897e-004 9.34602915e-003 7.95226559e-022
 9.99894016e-001 9.06910431e-001 9.99999994e-001 1.57415357e-303
 1.99147350e-007 8.88892983e-002 3.66581500e-008 1.21310827e-001
 1.12741898e-005 1.43774329e-006 1.61344293e-001 5.42504903e-002
 7.88284788e-003 2.64653596e-007 1.82828683e-004 7.09610852e-001
 4.52231033e-002 3.28134726e-007 2.36896510e-006 9.99718488e-001
 4.33106127e-035 7.56380512e-222 1.76890253e-003 1.52003054e-252
 1.00000000e+000 9.99999989e-001 6.09057434e-004 9.99650362e-001
 1.69941675e-172 9.99999992e-001 2.29087137e-001 9.99999997e-001
 3.29142514e-007 1.00000000e+000 1.57641221e-070 7.13226342e-001
 7.24439304e-002 1.61990454e-062 2.70954936e-040 5.25189048e-042
 2.18528828e-007 2.87963202e-039 1.53158556e-019 1.00000000e+000
 9.99809181e-001 3.04831340e-002 1.12207300e-032 9.82275038e-001
 4.25109200e-007 4.93654196e-001 1.13088154e-005 2.19199988e-007
 1.28707960e-065 7.16954222e-020 6.61111249e-001 7.12767617e-168
 4.83712959e-222 9.57578235e-001 4.81532735e-002 9.99829085e-001
 1.11026789e-304 2.40841983e-069 2.64663417e-074 9.52920248e-001
 1.31178654e-050 8.35739308e-061 1.78781621e-266 1.93195765e-090
 1.19413815e-196 3.95322190e-109 5.80472075e-124 5.03341182e-055
 6.76437924e-001 4.36280075e-003 2.78089770e-293 6.34332423e-083
 5.38162397e-163 5.83599468e-077 4.83142064e-181 3.31304342e-055
 1.03084680e-074 4.32016307e-035 1.73606594e-297 5.66706550e-108
 4.12804130e-038 2.93326555e-050 2.96547069e-008 2.75859788e-022
 1.09679390e-298 4.07106322e-078 8.02052676e-002 2.86470064e-231
 6.88648761e-001 1.00000000e+000 2.96999661e-011 2.79271133e-031
 5.59571006e-042 3.01883933e-002 5.16516576e-029 9.01021278e-064
 7.89707178e-022 5.50882588e-023 9.99999986e-001 3.90682177e-074
 3.87817628e-016 8.54299112e-009 2.12158348e-019 7.50839860e-005
 1.80504025e-095 9.47723169e-001 9.99760122e-001 3.35391527e-019
 6.14994077e-269 8.26352073e-003 4.31576479e-167 2.35376703e-144
 9.75620816e-057 4.38468865e-058 2.60259801e-108 1.11242665e-007
 2.91931785e-076 2.56326170e-071 7.16862170e-259 1.90573412e-040
 8.66872529e-280 3.66026461e-007 5.11796259e-014 5.45339155e-009
 2.48232367e-045 1.55251651e-075 1.56483935e-139 4.30403013e-002
 1.14582573e-023 1.03431322e-018 2.68579202e-301 1.08439539e-007
 6.58430273e-003 3.42097840e-050 1.64360405e-069 8.85680157e-001
 9.99323334e-001 1.72512269e-223 7.63301885e-044 1.65175388e-189
 1.39003577e-060 4.09444906e-072 2.43369509e-247 1.64516277e-017
 3.32114829e-281 9.35151520e-001 4.78052070e-167 9.98270782e-001
 9.80981885e-106 1.39490724e-019 9.61835031e-001 1.73015625e-027
 4.45596390e-021 5.84919133e-002 9.47244630e-001 1.00000000e+000
 1.94337052e-287 5.92053635e-001 1.96454193e-219 7.56263681e-093
 3.21403590e-042 8.14524511e-073 3.00922610e-077 3.45312111e-002
 5.00575269e-184 1.57301465e-093 1.31045072e-016 1.38936547e-088
 2.78260530e-003 9.99999986e-001 2.08532001e-008 5.51276581e-046
 7.15943283e-020 5.94727271e-027 5.84451093e-180 4.41195534e-059
 1.18474903e-001 1.89580164e-038 5.54521730e-019 1.00000000e+000
 2.33017003e-070 3.30983047e-051 6.46608303e-106 8.49879500e-060
 1.00000000e+000 9.95757848e-001 2.89156574e-223 7.10781865e-272
 2.74655679e-262 1.03271042e-023 5.37556630e-061 5.91788041e-035
 4.25570651e-019 2.92268505e-295 7.70531143e-262 1.12302176e-054
 7.10258738e-001 7.01263645e-074 3.65766456e-088 4.22318265e-077
 4.83792189e-220 1.55595821e-035 1.91495920e-089 1.00000000e+000
 2.33299653e-242 1.00000000e+000 9.99999945e-001 1.68168273e-235
 5.80500545e-005 1.11365717e-158 1.85465828e-002 2.68017868e-077
 1.03636406e-246 9.99998936e-001 9.47026555e-001 4.77425095e-035
 9.15622336e-001 9.99681251e-001 9.99999930e-001 7.62505238e-184
 8.41190568e-074 9.82862618e-090 1.08412731e-091 1.00000000e+000
 3.62672768e-022 4.78807071e-098 9.57006987e-001 8.41446091e-003
 8.53184949e-003 7.16799854e-087 1.62100931e-144 2.62004971e-084
 3.94778965e-273 3.48881390e-300 3.70839533e-002 2.24324547e-138
 6.66382537e-001 1.82211640e-071 1.25360786e-070 7.99004167e-221
 3.11022660e-178 1.90527972e-068 2.45903694e-127 2.68651023e-153
 1.31673791e-280 1.37553803e-233 2.02817950e-017 3.86522544e-016
 3.07457271e-016 6.15118820e-007 1.37441684e-278 6.86140161e-207
 1.45399413e-028 6.46421464e-020 2.31237702e-216 9.99999995e-001
 1.78854804e-259 1.31963260e-080 8.57808140e-241 9.95698414e-001
 8.83598850e-050 1.56938115e-145 1.08540267e-036 2.72768862e-202
 1.00710929e-103 1.93131674e-142 4.35435537e-090 2.92878606e-011
 2.20668124e-123 8.09592368e-001 1.82163838e-198 9.99756748e-001
 1.00000000e+000 2.69718219e-308 9.99999929e-001 6.55905005e-027
 8.62576477e-008 8.14979370e-003 9.94672754e-001 9.99999497e-001
 7.10359931e-001 1.01643324e-001 2.63613725e-284 7.05355670e-227
 3.88801658e-225 1.81990293e-104 4.04179081e-066 3.91897642e-020
 4.61362907e-010 9.99999992e-001 3.91939561e-008 9.42469975e-008
 3.27234088e-012 9.17218681e-004 5.20966889e-071 5.69009170e-009
 1.19478645e-008 4.25870359e-017 5.49711413e-002 9.04503212e-004
 2.36246777e-011 1.98170143e-172 1.74753902e-091 3.08642823e-180
 4.54724892e-228 1.59646190e-157 2.97472626e-219 2.08756701e-222
 9.73348645e-001 3.90350265e-233 2.21646309e-091 1.42286865e-219
 4.41628425e-034 1.91391576e-262 1.05423954e-050 1.00000000e+000
 9.08746110e-006 9.99999875e-001 2.32968706e-011 4.06114996e-010
 1.72676043e-239 9.99999944e-001 1.21471544e-041 5.30035752e-019
 2.30890266e-161 3.43269792e-046 4.52615274e-009 1.61311233e-058
 2.70922335e-001 1.97560153e-176 7.07270294e-083 9.62773352e-001
 8.76950477e-001 5.17731811e-011 2.08357949e-183 1.45773800e-035
 9.36743548e-219 1.42684979e-158 3.13760668e-008 1.06443979e-007
 1.33104091e-182 9.99253291e-019 4.31889318e-021 6.21827863e-292
 2.86277304e-078 1.80117361e-159 1.62985681e-006 1.62082397e-236
 3.68557743e-224 8.66886231e-001 7.80811425e-079 1.24901500e-219
 8.49290563e-308 2.18517120e-005 2.50380407e-007 7.68319836e-005
 3.09255920e-177 1.22710335e-001 3.74245482e-036 3.91041176e-139
 5.55316029e-055 1.65076197e-184 2.27341303e-275 4.03187785e-016
 6.02114475e-055 3.01257339e-278 5.32324658e-118 6.57912286e-086
 1.20262368e-193 4.34158883e-093 9.94598200e-001 8.46320027e-001
 9.43200879e-001 9.80934960e-001 4.97989364e-042 2.24976866e-230
 1.75003531e-146 6.40968578e-047 7.31662025e-075 4.39020910e-099
 5.05644169e-151 1.25475384e-182 3.99499463e-022 5.07841427e-086
 5.62594338e-083 1.52873683e-290 9.97154713e-001 1.06934873e-007
 4.59616622e-063 1.61330444e-017 1.29642767e-001 2.82951398e-192
 5.62773699e-022 2.29712513e-145 3.87019007e-203 2.81914942e-133
 9.99806497e-001 7.81620910e-003 4.00910623e-054 1.28586632e-008
 6.26934042e-010 5.75392622e-302 6.41474585e-171 1.01645805e-038
 1.10125295e-039 4.15459922e-008 2.13763384e-071 1.74172355e-037
 1.91424467e-207 6.49098970e-073 1.06820128e-179 8.57743926e-274
 4.39251890e-253 4.98608971e-219 9.99999999e-001 1.20041728e-008
 9.45020697e-120 7.55761778e-261 1.27853465e-011 2.89034357e-254
 2.03972608e-218 1.17820804e-008 3.81159303e-016 4.94454279e-246
 3.61936632e-221 2.22785881e-100 7.67154335e-009 6.84301470e-190
 9.99529973e-001 9.28331619e-008 3.15451492e-002 2.29830953e-009
 2.40767967e-011 1.44088994e-008 9.62269304e-001 2.00003724e-017
 9.97067831e-001 9.99945587e-001 5.45836229e-286 4.28108685e-020
 2.03371144e-136 3.68744648e-002 7.79270080e-084 9.65318724e-001
 3.88852576e-175 8.37855936e-216 9.82410961e-007 3.59970941e-218
 1.46469754e-220 2.12972271e-023 1.54744932e-165 9.95048223e-001
 1.97299503e-228 8.50607692e-008 4.46334955e-009 9.99999990e-001
 2.94288571e-103 1.37455921e-045 2.36641183e-016 3.26742467e-092
 9.99988957e-001 8.27551312e-047 1.85172713e-008 3.81861859e-001
 1.05050541e-210 9.99957357e-001 7.51036107e-245 8.78319116e-001
 1.26254192e-012 1.15848967e-220 4.19961142e-017 2.23464723e-018
 1.51565850e-099 1.50962862e-213 2.59905532e-092 6.97456477e-083
 1.77099361e-044 6.83650705e-112 5.25910175e-008 3.02679583e-036
 4.54123683e-002 1.44693722e-235 4.65614076e-004 7.69780270e-141
 7.19742406e-243 9.46541998e-001 2.69300039e-002 9.99999490e-001
 7.83851413e-002 3.28081085e-090 1.41649494e-003 2.24602051e-087
 9.70326808e-001 2.52932644e-046 1.35771834e-010 9.81456561e-087
 1.50478126e-011 9.65939481e-276 3.76591827e-047 5.36365078e-020
 9.84302442e-219 9.95672247e-001 8.33892774e-087 1.31319963e-172
 1.15146028e-014 2.65433682e-003 9.24022667e-046 6.67098524e-045
 2.30924944e-085 5.22213718e-228 6.42881697e-007 6.65657734e-018
 9.72704096e-044 1.65933937e-084 3.16613615e-001 6.71262429e-057
 2.15302995e-045 9.96237546e-051 2.39647453e-044 1.07419517e-305
 2.68839010e-160 1.01310664e-013 3.31264198e-009 2.05565116e-173
 6.18234941e-010 1.58697683e-295 1.87376687e-006 2.87873582e-008
 1.02459833e-082 1.91132887e-238 2.09475442e-127 3.51463228e-236
 6.81759579e-152 7.10903363e-009 1.11744950e-080 6.73121236e-173
 9.88584557e-001 4.11789075e-006 4.94658953e-203 5.71286743e-051
 1.67213663e-180 9.55784698e-010 1.15861980e-242 3.13758597e-183
 1.03106805e-046 4.62206233e-073 3.38076308e-001 9.99999911e-001
 3.60004698e-093 7.68457222e-084 2.00562279e-240 3.42559282e-239
 1.03422715e-235 2.13289632e-003 1.36616031e-238 4.88331146e-112
 6.96331723e-005 1.33571187e-133 1.19082311e-301 4.54142226e-008
 3.35782061e-184 1.94180336e-220 4.78037493e-082 6.03036304e-002
 9.99997637e-001 2.25370018e-234 4.75951797e-223 9.72983272e-001
 4.73891270e-292 9.78929763e-106 5.11355957e-016 9.57562716e-051
 9.33149800e-025 9.99006365e-001 9.99999997e-001 1.89299068e-042
 2.07754125e-023 3.67068722e-013 5.91153105e-022 7.08044617e-215
 3.05314613e-033 1.00000000e+000 4.28776715e-117 9.50784514e-011
 6.88636814e-011 1.31610808e-040 1.71454653e-074 1.07962762e-022
 1.24988526e-035 1.22333804e-012 1.33252051e-055 2.35938540e-014
 4.68967741e-002 5.94639121e-025 3.85386488e-005 3.08044539e-033]
2025-06-24 12:21:30,862 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:21:32,083 - src.training - INFO -   precision: 0.0028114928341219226
2025-06-24 12:21:32,083 - src.training - INFO -   recall: 0.3037037037037037
2025-06-24 12:21:32,083 - src.training - INFO -   f1: 0.005571409158853105
2025-06-24 12:21:32,083 - src.training - INFO -   accuracy: 0.8675115415950032
2025-06-24 12:21:32,083 - src.training - INFO -   balanced_accuracy: 0.5859525451948527
2025-06-24 12:21:32,083 - src.training - INFO -   positive_samples: 270
2025-06-24 12:21:32,083 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:21:32,083 - src.training - INFO -   total_samples: 220940
2025-06-24 12:21:32,083 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:21:32,083 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:21:32,083 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:21:32,083 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:21:32,084 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:21:32,084 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:21:32,084 - src.training - INFO - 모델 학습 완료
2025-06-24 12:21:32,084 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0028114928341219226, 'recall': 0.3037037037037037, 'f1': 0.005571409158853105, 'accuracy': 0.8675115415950032, 'balanced_accuracy': 0.5859525451948527, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:21:32,084 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:32,084 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:32,084 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:32,084 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:32,104 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:21:32,104 - src.hyperparameter_tuning - ERROR - Trial 96 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:21:32,543 - src.hyperparameter_tuning - INFO - Trial 97: 모델 타입 = lightgbm
2025-06-24 12:21:34,349 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:21:34,349 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:21:34,349 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:21:34,349 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:21:34,349 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:21:34,349 - src.training - INFO - 교차 검증 시작
2025-06-24 12:21:34,349 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:21:34,365 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:21:34,839 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:21:34,839 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:21:34,839 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:21:34,839 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:21:34,839 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:21:34,839 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:21:34,839 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:21:34,839 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:21:34,839 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:21:35,006 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:21:35,006 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:21:35,006 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:21:35,006 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:21:35,006 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:21:35,006 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:21:35,006 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:21:35,006 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:21:35,006 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:21:35,006 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:21:36,382 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:21:37,454 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:21:37,454 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:21:37,461 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:21:37,493 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:21:37,493 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:21:37,493 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:21:37,493 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:21:38,762 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:21:39,034 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:21:39,034 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:21:39,203 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:21:39,203 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:21:39,246 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:21:39,246 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:21:39,246 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:21:39,247 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:21:39,247 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:39,247 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:39,308 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:21:39,308 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:21:39,308 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:39,308 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:39,308 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:21:39,308 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:21:39,308 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:39,373 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:21:39,373 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:21:39,373 - src.training - INFO - 모델 학습 시작
2025-06-24 12:21:39,505 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:21:39,505 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:21:39,505 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:21:39,505 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:21:39,505 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:21:39,505 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:21:39,505 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:21:39,505 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:21:39,505 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:21:39,505 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:21:39,505 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:21:39,505 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:21:39,505 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:21:39,505 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:39,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:39,596 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:39,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:39,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:39,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:39,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:39,942 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:39,959 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:21:39,959 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:40,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:21:40,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:40,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:21:40,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:40,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:40,046 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:40,061 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:40,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:40,094 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:40,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:40,129 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:40,132 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:21:40,132 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:40,147 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:21:40,147 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:40,147 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:21:40,147 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:40,147 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:21:40,159 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   learning_rate: 0.06604570337601405
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   n_estimators: 519
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   subsample: 0.8698303161295429
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6420514898937645
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   reg_alpha: 2.9485344396556813e-06
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO -   reg_lambda: 0.09984354356694536
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:21:40,163 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:21:40,267 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:21:40,268 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 6.435579749044097})})
2025-06-24 12:21:40,268 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:21:40,268 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:21:40,268 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:21:40,268 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:21:40,268 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:40,268 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:40,287 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:40,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:40,320 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:40,336 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:40,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:40,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:40,373 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:21:40,373 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:40,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:21:40,380 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:21:40,380 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:21:40,380 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:21:40,380 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:21:40,380 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:40,380 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:40,380 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:21:40,380 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:21:40,384 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:21:40,388 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:21:40,390 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [1.15781793e-001 9.99999988e-001 9.99999997e-001 9.99999928e-001
 1.95854584e-088 1.00000000e+000 4.51398065e-076 6.45012896e-001
 2.18680314e-092 8.60913156e-006 1.00000000e+000 1.00000000e+000
 9.99999998e-001 5.95027658e-049 1.58486928e-148 2.16733083e-010
 0.00000000e+000 9.99998353e-001 8.07642466e-001 1.00000000e+000
 8.24018791e-223 2.76236751e-016 3.09352073e-058 2.00855889e-004
 2.42715093e-052 1.71873089e-126 3.14509021e-005 9.99999879e-001
 1.14941935e-016 9.93695686e-001 2.52287075e-070 1.17265244e-232
 9.99999575e-001 1.91903913e-130 5.07459385e-154 2.98410203e-032
 2.41964302e-198 1.46499031e-022 9.11522373e-268 4.32928314e-204
 5.62493901e-001 9.99997412e-001 2.75889055e-006 4.42180099e-211
 4.17707913e-139 7.50306565e-253 7.42666216e-006 1.30456241e-133
 2.25555506e-223 2.83224536e-136 4.70461621e-127 1.00000000e+000
 2.78718591e-098 5.08741210e-250 9.99999999e-001 2.00515046e-004
 4.43158438e-005 6.05118947e-066 7.60811606e-002 2.44590778e-136
 2.00742424e-004 5.33922669e-038 3.51174289e-009 1.00000000e+000
 1.78712909e-002 1.46996158e-022 3.16633689e-073 9.87003738e-001
 1.00000000e+000 8.84551316e-131 2.84477992e-054 9.20053460e-227
 2.40508266e-092 4.53221670e-115 9.99861969e-001 9.99999983e-001
 5.15766083e-004 1.73255533e-166 4.47588544e-015 2.34620341e-161
 3.38201913e-060 2.30667444e-220 3.03706067e-003 2.17290079e-211
 9.99999997e-001 9.99999906e-001 3.10425599e-184 3.22411902e-082
 2.55522378e-169 4.24461379e-063 1.23911813e-017 7.41928378e-006
 1.93149439e-003 2.65685072e-167 3.03678061e-201 9.96616036e-001
 1.57393750e-010 1.25834762e-006 1.00000000e+000 9.99999984e-001
 1.57408718e-010 1.25822796e-006 9.99246750e-001 9.99999930e-001
 1.00000000e+000 6.45512132e-008 9.99999926e-001 3.99991128e-127
 3.81517051e-125 3.19529455e-018 8.29046326e-139 5.58141649e-017
 6.98688978e-126 6.62276489e-030 6.02607173e-013 4.98979431e-007
 5.65046713e-013]
2025-06-24 12:21:40,390 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:21:41,770 - src.training - INFO -   precision: 0.004914004914004914
2025-06-24 12:21:41,770 - src.training - INFO -   recall: 0.007407407407407408
2025-06-24 12:21:41,770 - src.training - INFO -   f1: 0.005908419497784343
2025-06-24 12:21:41,770 - src.training - INFO -   accuracy: 0.9969539241423011
2025-06-24 12:21:41,770 - src.training - INFO -   balanced_accuracy: 0.5027860438496229
2025-06-24 12:21:41,770 - src.training - INFO -   positive_samples: 270
2025-06-24 12:21:41,770 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:21:41,770 - src.training - INFO -   total_samples: 220940
2025-06-24 12:21:41,770 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:21:41,770 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:21:41,770 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:21:41,770 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:21:41,770 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:21:41,770 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:21:41,770 - src.training - INFO - 모델 학습 완료
2025-06-24 12:21:41,770 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.004914004914004914, 'recall': 0.007407407407407408, 'f1': 0.005908419497784343, 'accuracy': 0.9969539241423011, 'balanced_accuracy': 0.5027860438496229, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:21:41,770 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:41,770 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:41,770 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:41,770 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:41,790 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:21:41,790 - src.hyperparameter_tuning - ERROR - Trial 97 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:21:42,256 - src.hyperparameter_tuning - INFO - Trial 98: 모델 타입 = lightgbm
2025-06-24 12:21:44,244 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:21:44,245 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:21:44,245 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:21:44,245 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:21:44,245 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:21:44,245 - src.training - INFO - 교차 검증 시작
2025-06-24 12:21:44,245 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:21:44,261 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:21:44,734 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:21:44,734 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:21:44,734 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:21:44,734 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:21:44,734 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:21:44,734 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:21:44,734 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:21:44,734 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:21:44,734 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:21:44,901 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:21:44,901 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:21:44,901 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:21:44,901 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:21:44,901 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:21:44,901 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:21:44,901 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:21:44,901 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:21:44,901 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:21:44,901 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:21:46,279 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:21:47,353 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:21:47,353 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:21:47,359 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:21:47,391 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:21:47,391 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:21:47,391 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:21:47,391 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:21:48,659 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:21:48,931 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:21:48,931 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:21:49,100 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:21:49,100 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:21:49,143 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:21:49,143 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:21:49,143 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:21:49,143 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:21:49,143 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:49,143 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:49,205 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:21:49,205 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:21:49,205 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:49,205 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:49,205 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:21:49,205 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:21:49,205 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:49,271 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:21:49,271 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:21:49,271 - src.training - INFO - 모델 학습 시작
2025-06-24 12:21:49,403 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:21:49,403 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:21:49,403 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:21:49,403 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:21:49,403 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:21:49,403 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:21:49,403 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:21:49,403 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:21:49,403 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:21:49,403 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:21:49,403 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:21:49,403 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:21:49,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:21:49,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:49,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:49,496 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:49,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:49,632 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:49,696 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:49,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:49,840 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:49,856 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:21:49,856 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:49,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:21:49,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:49,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:21:49,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:49,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:49,943 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:49,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:49,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:49,991 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:50,009 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:50,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:50,029 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:21:50,029 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:50,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:21:50,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:50,045 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:21:50,045 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:50,045 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:21:50,057 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO -   learning_rate: 0.01507922236142233
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:21:50,060 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   n_estimators: 106
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   subsample: 0.7088377383813869
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7252974875105053
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   reg_alpha: 1.3382070561805859
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO -   reg_lambda: 2.2698954797578017e-06
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:21:50,061 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:21:50,747 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:21:50,747 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.534604799229028})})
2025-06-24 12:21:50,747 - src.models.lightgbm_model - INFO -   - Best Iteration: 106
2025-06-24 12:21:50,747 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:21:50,748 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:21:50,748 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:21:50,748 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:50,748 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:50,767 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:50,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:50,800 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:50,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:50,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:50,852 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:50,854 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:21:50,855 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:50,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:21:50,882 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:21:50,882 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:21:50,882 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:21:50,882 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:21:50,882 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:50,882 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:50,882 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:21:50,882 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:21:50,886 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:21:50,890 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:21:50,894 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.02432473 0.05632459 0.01834167 ... 0.00028155 0.10432028 0.00627171]
2025-06-24 12:21:50,894 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:21:51,731 - src.training - INFO -   precision: 0.0
2025-06-24 12:21:51,731 - src.training - INFO -   recall: 0.0
2025-06-24 12:21:51,731 - src.training - INFO -   f1: 0.0
2025-06-24 12:21:51,731 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:21:51,731 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:21:51,731 - src.training - INFO -   positive_samples: 270
2025-06-24 12:21:51,731 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:21:51,731 - src.training - INFO -   total_samples: 220940
2025-06-24 12:21:51,731 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:21:51,731 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:21:51,731 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:21:51,731 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:21:51,731 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:21:51,731 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:21:51,731 - src.training - INFO - 모델 학습 완료
2025-06-24 12:21:51,731 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:21:51,731 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:51,731 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:51,731 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:51,731 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:51,751 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:21:51,751 - src.hyperparameter_tuning - ERROR - Trial 98 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:21:52,216 - src.hyperparameter_tuning - INFO - Trial 99: 모델 타입 = lightgbm
2025-06-24 12:21:54,179 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:21:54,180 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:21:54,180 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:21:54,180 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:21:54,180 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:21:54,180 - src.training - INFO - 교차 검증 시작
2025-06-24 12:21:54,180 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:21:54,196 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:21:54,674 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:21:54,675 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:21:54,675 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:21:54,675 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:21:54,675 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:21:54,675 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:21:54,675 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:21:54,675 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:21:54,675 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:21:54,842 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:21:54,842 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:21:54,842 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:21:54,842 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:21:54,842 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:21:54,842 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:21:54,842 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:21:54,842 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:21:54,842 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:21:54,842 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:21:56,214 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:21:57,286 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:21:57,286 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:21:57,292 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:21:57,325 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:21:57,325 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:21:57,325 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:21:57,325 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:21:58,589 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:21:58,864 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:21:58,864 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:21:59,033 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:21:59,033 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:21:59,076 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:21:59,076 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:21:59,076 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:21:59,076 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:21:59,076 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:59,077 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:21:59,138 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:21:59,138 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:21:59,138 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:59,138 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:59,139 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:21:59,139 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:21:59,139 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:59,204 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:21:59,204 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:21:59,204 - src.training - INFO - 모델 학습 시작
2025-06-24 12:21:59,336 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:21:59,336 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 12:21:59,336 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:21:59,336 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:21:59,336 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:21:59,336 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:21:59,336 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:21:59,336 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:21:59,336 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:21:59,336 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:21:59,337 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:21:59,337 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:21:59,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:21:59,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:59,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:59,430 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:59,496 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:59,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:59,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:59,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:59,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:59,789 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:21:59,789 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:59,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:21:59,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:59,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:21:59,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:59,858 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:21:59,876 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:21:59,891 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:21:59,908 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:21:59,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:21:59,942 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:21:59,960 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:21:59,962 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:21:59,962 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:21:59,978 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:21:59,978 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:59,978 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:21:59,978 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:21:59,978 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:21:59,990 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   learning_rate: 0.23948788135642862
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 12:21:59,993 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   n_estimators: 373
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   subsample: 0.9214484170067875
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9007921781793666
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0012657970894666144
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO -   reg_lambda: 4.010794088438141e-07
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 12:21:59,994 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:22:00,079 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:22:00,080 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.04236450174936691})})
2025-06-24 12:22:00,080 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 12:22:00,080 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 12:22:00,080 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 12:22:00,080 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:22:00,080 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:00,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:22:00,101 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:22:00,117 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:22:00,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:22:00,150 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:22:00,167 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:22:00,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:22:00,187 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:22:00,187 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:00,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:22:00,191 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:22:00,191 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:22:00,191 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:22:00,191 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:22:00,191 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:22:00,191 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:22:00,191 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:22:00,191 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:22:00,196 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:22:00,200 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:22:00,201 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00000000e+000 5.52221908e-207 1.43480279e-128 6.05709104e-150
 9.22789449e-110 3.77911626e-051 2.18590222e-088 8.95196477e-030
 2.33123213e-228 7.92073352e-176 7.75874239e-235 1.00000000e+000
 1.65431253e-165 6.46944217e-010 9.22118444e-004]
2025-06-24 12:22:00,201 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:22:01,485 - src.training - INFO -   precision: 0.0
2025-06-24 12:22:01,485 - src.training - INFO -   recall: 0.0
2025-06-24 12:22:01,485 - src.training - INFO -   f1: 0.0
2025-06-24 12:22:01,485 - src.training - INFO -   accuracy: 0.9987734226486829
2025-06-24 12:22:01,485 - src.training - INFO -   balanced_accuracy: 0.4999977341731998
2025-06-24 12:22:01,485 - src.training - INFO -   positive_samples: 270
2025-06-24 12:22:01,485 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:22:01,485 - src.training - INFO -   total_samples: 220940
2025-06-24 12:22:01,485 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:22:01,485 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:22:01,485 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:22:01,485 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:22:01,485 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:22:01,485 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:22:01,485 - src.training - INFO - 모델 학습 완료
2025-06-24 12:22:01,485 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987734226486829, 'balanced_accuracy': 0.4999977341731998, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:22:01,485 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:01,485 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:01,485 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:01,485 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:01,506 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:22:01,506 - src.hyperparameter_tuning - ERROR - Trial 99 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:22:01,963 - src.hyperparameter_tuning - WARNING - 유효하지 않은 best_score: -inf
2025-06-24 12:22:01,966 - src.hyperparameter_tuning - INFO - 최적화 완료!
2025-06-24 12:22:01,966 - src.hyperparameter_tuning - INFO -   - 최고 성능: 0.0000
2025-06-24 12:22:01,966 - src.hyperparameter_tuning - INFO -   - 최적 파라미터: {'n_estimators': 406, 'max_depth': 12, 'learning_rate': 0.1205712628744377, 'subsample': 0.8394633936788146, 'colsample_bytree': 0.6624074561769746, 'min_child_weight': 2, 'reg_alpha': 3.3323645788192616e-08, 'reg_lambda': 0.6245760287469893}
2025-06-24 12:22:03,931 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:22:03,931 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:22:03,931 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:22:03,931 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:22:03,931 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:22:03,931 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:22:03,931 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:22:03,931 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:22:04,153 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:22:04,153 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:22:04,153 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:22:04,153 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:22:04,153 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:22:04,154 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:22:04,154 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:22:04,154 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:22:04,154 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:22:04,154 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:22:05,873 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:22:07,223 - src.preprocessing - INFO - 데이터 변환 완료: (1333765, 33)
2025-06-24 12:22:07,223 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:22:08,585 - src.preprocessing - INFO - 데이터 변환 완료: (1333765, 33)
2025-06-24 12:22:08,585 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:22:08,790 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:22:08,790 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:22:08,790 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:22:08,790 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:22:08,790 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:22:08,993 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:22:08,993 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:22:09,056 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 12:22:09,056 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 12:22:09,056 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:22:09,056 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:22:09,056 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:22:09,056 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 12:22:09,056 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(1333765, 6), y=(1333765, 1)
2025-06-24 12:22:09,056 - src.models.lightgbm_model - INFO - Early Stopping 비활성화
2025-06-24 12:22:09,056 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:22:09,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (1333765, 6)
2025-06-24 12:22:09,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:09,057 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:22:09,187 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:22:09,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:22:09,386 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:22:09,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:22:09,574 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:22:09,687 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:22:09,710 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (1333765, 6)
2025-06-24 12:22:09,710 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:09,734 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (1333765, 6)
2025-06-24 12:22:09,734 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(1333765, 6), y=(1333765, 0)
2025-06-24 12:22:09,734 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: []
2025-06-24 12:22:09,734 - src.models.lightgbm_model - ERROR - y 데이터프레임에 컬럼이 없습니다! 타겟 컬럼 매칭을 확인하세요.
2025-06-24 12:22:09,735 - src.models.base_model - INFO - 모델이 models/best_tuned_model.joblib에 저장되었습니다.
2025-06-24 12:22:09,736 - src.hyperparameter_tuning - INFO - 최고 모델 저장 완료: models/best_tuned_model.joblib
2025-06-24 12:22:10,506 - src.hyperparameter_tuning - INFO - Study 저장 완료: models/optuna_study.pkl
2025-06-24 12:22:10,770 - matplotlib.legend - WARNING - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
2025-06-24 12:22:10,927 - __main__ - INFO - === 하이퍼파라미터 튜닝 완료 ===
2025-06-24 12:22:10,927 - __main__ - INFO - 최고 성능: 0.0000
2025-06-24 12:22:10,927 - __main__ - INFO - 최적 파라미터:
2025-06-24 12:22:10,927 - __main__ - INFO -   n_estimators: 406
2025-06-24 12:22:10,927 - __main__ - INFO -   max_depth: 12
2025-06-24 12:22:10,928 - __main__ - INFO -   learning_rate: 0.1205712628744377
2025-06-24 12:22:10,928 - __main__ - INFO -   subsample: 0.8394633936788146
2025-06-24 12:22:10,928 - __main__ - INFO -   colsample_bytree: 0.6624074561769746
2025-06-24 12:22:10,928 - __main__ - INFO -   min_child_weight: 2
2025-06-24 12:22:10,928 - __main__ - INFO -   reg_alpha: 3.3323645788192616e-08
2025-06-24 12:22:10,928 - __main__ - INFO -   reg_lambda: 0.6245760287469893

==================================================
튜닝 결과 요약
==================================================
모델 타입: lightgbm
실험 타입: hyperparameter_tuning
MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/acf4c0d8f13c4e58aeaf6ae27b4aa629
최고 성능: 0.0
최적 파라미터: {'n_estimators': 406, 'max_depth': 12, 'learning_rate': 0.1205712628744377, 'subsample': 0.8394633936788146, 'colsample_bytree': 0.6624074561769746, 'min_child_weight': 2, 'reg_alpha': 3.3323645788192616e-08, 'reg_lambda': 0.6245760287469893}
튜닝 시간: N/A
==================================================
2025-06-24 12:22:10,928 - __main__ - INFO - 실험 결과가 /home/junhyung/Documents/simcare/kbsmc_suicide/results/experiment_results_20250624_122210.txt에 저장되었습니다.
2025-06-24 12:22:10,928 - __main__ - INFO - MLflow Experiment ID: 765186397364671153
2025-06-24 12:22:10,928 - __main__ - INFO - MLflow Run ID: acf4c0d8f13c4e58aeaf6ae27b4aa629
2025-06-24 12:22:10,928 - __main__ - INFO - MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/acf4c0d8f13c4e58aeaf6ae27b4aa629
