2025-06-24 09:42:47,577 - src.hyperparameter_tuning - INFO - MLflow 실험 설정: hyperparameter_tuning (ID: 765186397364671153)
2025-06-24 09:42:47,577 - src.hyperparameter_tuning - INFO - 데이터 로드 중: data/processed/processed_data_with_features.csv
2025-06-24 09:42:47,581 - src.hyperparameter_tuning - INFO - 테스트용 데이터 로드: 1,000 행
2025-06-24 09:42:47,581 - src.hyperparameter_tuning - INFO - 모델 타입: lightgbm
2025-06-24 09:42:47,581 - src.hyperparameter_tuning - INFO - 튜닝 설정 - 시도 횟수: 100, 타임아웃: 3600초
2025-06-24 09:42:47,581 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 튜너 초기화 완료
2025-06-24 09:42:47,581 - src.hyperparameter_tuning - INFO -   - 튜닝 설정: {'data': {'file_path': 'data/processed_data.csv', 'encoding': 'utf-8', 'na_values': ['', 'nan', 'NaN', 'NULL', 'null']}, 'features': {'target_columns': ['suicide_a_next_year'], 'exclude_columns': ['id', 'patient_id', 'visit_date', 'visit_year'], 'categorical_columns': ['gender', 'marital_status', 'education_level', 'income_level', 'residence_type', 'insurance_type', 'primary_diagnosis', 'comorbidity', 'medication_type', 'treatment_type', 'follow_up_status'], 'selected_features': ['age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score'], 'validation': {'scope': 'sample', 'sample_size': 10}, 'enable_feature_engineering': False, 'enable_lagged_features': False, 'lag_periods': [1, 2, 3], 'lagged_features': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}, 'enable_rolling_stats': False, 'rolling_stats': {'window_sizes': [2, 3], 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}}, 'preprocessing': {'time_series_imputation': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp'], 'fallback_strategy': 'mean'}, 'numerical_imputation': {'strategy': 'mean', 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']}, 'categorical_imputation': {'strategy': 'most_frequent', 'columns': ['sex']}, 'categorical_encoding': {'method': 'ordinal'}, 'missing_value_strategy': 'median', 'outlier_detection': {'method': 'iqr', 'threshold': 1.5}, 'scaling': {'method': 'robust', 'with_mean': True, 'with_std': True}, 'feature_selection': {'method': 'variance_threshold', 'threshold': 0.01}}, 'data_split': {'test_ids_ratio': 0.15, 'random_state': 42, 'method': 'stratified_kfold', 'n_splits': 5, 'test_size': 0.2, 'val_size': 0.2}, 'validation': {'strategy': 'group_kfold', 'num_cv_folds': 3, 'test_size': 0.15, 'random_state': 42, 'val_ids_ratio': 0.15, 'validation_start_year': 2021, 'min_train_years': 3, 'max_train_years': 8}, 'time_series': {'date_column': 'dov', 'year_column': 'yov', 'id_column': 'id'}, 'evaluation': {'regression_metrics': ['mae', 'rmse', 'r2'], 'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2'], 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True, 'primary_metric': 'f1_score', 'secondary_metrics': ['recall', 'precision', 'balanced_accuracy', 'roc_auc'], 'cv': {'strategy': 'group_kfold', 'n_folds': 5, 'shuffle': False}}, 'training': {'early_stopping': True, 'patience': 10, 'handle_imbalance': True, 'save_best_model': True, 'model_save_path': 'models/'}, 'logging': {'log_splits_info': True, 'log_fold_details': True, 'level': 'INFO', 'format': '%(asctime)s - %(name)s - %(levelname)s - %(message)s', 'file': 'logs/experiment.log'}, 'output': {'directory': 'results', 'save_model': True, 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True}, 'mlflow': {'experiment_name': 'hyperparameter_tuning', 'experiment_description': '자살 위험 예측 모델 실험', 'tags': ['suicide_prediction', 'healthcare', 'classification', 'regression'], 'nested_runs': True, 'save_artifacts': True, 'log_params': True, 'log_metrics': True, 'log_model': True, 'tracking': {'tracking_uri': 'file:./mlruns', 'experiment_name': 'suicide_prediction', 'nested_runs': True, 'artifact_location': './mlruns'}, 'logging': {'param_logging_level': 'INFO', 'metric_logging_level': 'INFO', 'artifact_logging_level': 'INFO', 'log_experiment_info': True, 'log_fold_results': True, 'log_model_info': True}, 'log_optimization': True}, 'model': {'model_type': 'lightgbm', 'lightgbm': {'num_leaves': 31, 'learning_rate': 0.1, 'feature_fraction': 0.9, 'bagging_fraction': 0.8, 'bagging_freq': 5, 'min_data_in_leaf': 20, 'min_sum_hessian_in_leaf': '1e-3', 'lambda_l1': 0.1, 'lambda_l2': 0.1, 'num_threads': 28, 'verbose': -1, 'early_stopping_rounds': 10, 'max_cat_threshold': 32, 'cat_smooth': 10.0, 'cat_l2': 10.0, 'is_unbalance': True, 'scale_pos_weight': 1.0, 'class_weight': 'balanced', 'boosting_type': 'gbdt', 'objective': 'binary', 'metric': 'binary_logloss', 'max_depth': 6, 'min_gain_to_split': 0.0, 'min_child_samples': 20, 'bagging_seed': 42, 'feature_fraction_seed': 42, 'drop_seed': 42, 'data_random_seed': 42, 'use_focal_loss': False, 'focal_loss': {'alpha': 0.25, 'gamma': 2.0}}}, 'imbalanced_data': {'resampling': {'enabled': False, 'method': 'smote', 'smote': {'k_neighbors': 5, 'sampling_strategy': 'auto'}, 'borderline_smote': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'm_neighbors': 10}, 'adasyn': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'n_neighbors': 5}, 'under_sampling': {'strategy': 'random', 'sampling_strategy': 'auto'}}, 'class_weight': 'balanced', 'scale_pos_weight': 1.0, 'is_unbalance': True}, 'experiment': {'name': 'hyperparameter_tuning_experiment', 'description': 'Optuna 기반 하이퍼파라미터 최적화 실험', 'tags': ['hyperparameter_tuning', 'optuna', 'optimization']}, 'tuning': {'direction': 'maximize', 'n_trials': 50, 'n_jobs': 1, 'early_stopping': {'enabled': True, 'patience': 20, 'min_trials': 30}}, 'sampler': {'type': 'tpe', 'tpe': {'n_startup_trials': 10, 'n_ei_candidates': 24, 'multivariate': True, 'group': False}, 'cmaes': {'x0': {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'min_child_weight': 1, 'reg_alpha': 0.1, 'reg_lambda': 1.0}, 'sigma0': 0.1}}, 'xgboost_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 15, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'scale_pos_weight': {'type': 'float', 'low': 0.5, 'high': 10.0, 'log': True}}, 'lightgbm_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 12, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}}, 'catboost_params': {'iterations': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'depth': {'type': 'int', 'low': 3, 'high': 10, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'l2_leaf_reg': {'type': 'float', 'low': 1, 'high': 10, 'log': True}, 'border_count': {'type': 'int', 'low': 32, 'high': 255, 'log': False}, 'bagging_temperature': {'type': 'float', 'low': 0.1, 'high': 1.0, 'log': False}, 'random_strength': {'type': 'float', 'low': 0.1, 'high': 10.0, 'log': True}}, 'random_forest_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 20, 'log': False}, 'min_samples_split': {'type': 'int', 'low': 2, 'high': 20, 'log': False}, 'min_samples_leaf': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'max_features': {'type': 'categorical', 'choices': ['sqrt', 'log2', 'auto']}}, 'results': {'save_best_model': True, 'model_save_path': 'models/best_tuned_model.joblib', 'save_study': True, 'study_save_path': 'models/optuna_study.pkl', 'create_plots': True, 'plots_save_path': 'data/tuning_results/'}}
2025-06-24 09:42:47,581 - src.hyperparameter_tuning - INFO -   - 튜닝 횟수: 100
2025-06-24 09:42:47,581 - src.hyperparameter_tuning - INFO -   - 타임아웃: 3600초
2025-06-24 09:42:47,581 - __main__ - INFO - 하이퍼파라미터 최적화 실행 중...
2025-06-24 09:42:47,581 - src.hyperparameter_tuning - INFO - === 하이퍼파라미터 튜닝 시작 ===
2025-06-24 09:42:47,582 - src.hyperparameter_tuning - INFO - Trial 0: 모델 타입 = lightgbm
2025-06-24 09:42:47,586 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:47,587 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:47,587 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:47,587 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:47,587 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:47,587 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:47,587 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:47,587 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:47,587 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:47,588 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:47,588 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:47,588 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:47,588 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:47,588 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:47,588 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:47,588 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:47,588 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:47,588 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:47,589 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,589 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,589 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,589 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,589 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,589 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:47,589 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:47,589 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:47,589 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:47,589 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:47,593 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:47,595 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,595 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:47,595 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:47,596 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:47,596 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:47,596 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:47,596 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,598 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,599 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:47,599 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,600 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,600 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,600 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,600 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,600 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,600 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:47,600 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,600 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,600 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:47,600 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:47,600 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,600 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,600 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:47,600 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:47,600 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,601 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,601 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,601 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:47,602 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:47,602 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:47,602 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:47,602 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:47,602 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:47,602 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:47,602 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:47,602 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:47,602 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,602 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:47,602 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:47,602 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:47,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:47,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,603 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,604 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:47,604 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:47,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,604 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,604 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,605 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,605 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,605 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:47,605 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,605 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,605 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,605 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   learning_rate: 0.1205712628744377
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   n_estimators: 406
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   subsample: 0.8394633936788146
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6624074561769746
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   reg_alpha: 3.3323645788192616e-08
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO -   reg_lambda: 0.6245760287469893
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:47,606 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:47,612 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:47,612 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:47,612 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:47,612 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:47,612 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:47,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,612 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,613 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,613 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:47,618 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:47,618 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:47,618 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:47,618 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:47,618 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,618 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,618 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:47,618 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:47,618 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:47,619 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:47,619 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:47,619 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:47,619 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,619 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,619 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,620 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,620 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:47,620 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:47,620 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:47,620 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:47,620 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:47,620 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:47,620 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:47,620 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:47,620 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:47,620 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:47,620 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:47,620 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:47,620 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:47,620 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:47,620 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:47,620 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:47,620 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,620 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,620 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,620 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,623 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:47,623 - src.hyperparameter_tuning - ERROR - Trial 0 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:47,624 - src.hyperparameter_tuning - INFO - Trial 1: 모델 타입 = lightgbm
2025-06-24 09:42:47,628 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:47,628 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:47,628 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:47,628 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:47,628 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:47,628 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:47,628 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:47,628 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:47,628 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:47,629 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:47,629 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:47,629 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:47,629 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:47,629 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:47,629 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:47,629 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:47,629 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:47,629 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:47,630 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,630 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,630 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,630 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,630 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,630 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:47,630 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:47,630 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:47,630 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:47,630 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:47,634 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:47,636 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,636 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:47,636 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:47,636 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:47,636 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:47,636 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:47,636 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,638 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,640 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:47,640 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,640 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,640 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,640 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,640 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,640 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,640 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:47,640 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,640 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,640 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:47,640 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:47,640 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,640 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,640 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:47,641 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:47,641 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,641 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,641 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,641 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:47,642 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:47,642 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:47,642 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:47,642 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:47,642 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:47,642 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:47,642 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:47,642 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:47,642 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,642 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:47,642 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:47,642 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:47,642 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:47,642 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,642 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,643 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,643 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:47,643 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:47,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,644 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,645 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,645 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:47,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,645 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,645 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,645 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:47,645 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   learning_rate: 0.010725209743171997
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   n_estimators: 621
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   subsample: 0.9879639408647978
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9329770563201687
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   reg_alpha: 4.329370014459266e-07
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO -   reg_lambda: 4.4734294104626844e-07
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:47,646 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:47,649 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:47,649 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:47,649 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:47,649 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:47,649 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:47,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,649 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,649 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,649 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,649 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,650 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,650 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,650 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:47,653 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:47,653 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:47,653 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:47,653 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:47,653 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,653 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,653 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:47,653 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:47,654 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:47,654 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:47,654 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:47,654 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:47,654 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,654 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,654 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,655 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,655 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:47,655 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:47,655 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:47,655 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:47,655 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:47,655 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:47,655 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:47,655 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:47,655 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:47,655 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:47,655 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:47,655 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:47,655 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:47,655 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:47,655 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:47,655 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:47,655 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,655 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,655 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,655 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,658 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:47,658 - src.hyperparameter_tuning - ERROR - Trial 1 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:47,659 - src.hyperparameter_tuning - INFO - Trial 2: 모델 타입 = lightgbm
2025-06-24 09:42:47,663 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:47,663 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:47,663 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:47,663 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:47,663 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:47,663 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:47,663 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:47,663 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:47,663 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:47,664 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:47,664 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:47,664 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:47,664 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:47,664 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:47,664 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:47,664 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:47,664 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:47,664 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:47,665 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,665 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,665 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,665 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,665 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,665 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:47,665 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:47,665 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:47,665 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:47,665 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:47,670 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:47,672 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,672 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:47,672 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:47,672 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:47,672 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:47,672 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:47,672 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,674 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,676 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:47,676 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,676 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,676 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,676 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,676 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,676 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,676 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:47,676 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,676 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,676 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:47,676 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:47,676 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,676 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,676 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:47,676 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:47,676 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,677 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,677 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,677 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:47,678 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:47,678 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:47,678 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:47,678 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:47,678 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:47,678 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:47,678 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:47,678 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:47,678 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,678 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:47,678 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:47,678 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:47,678 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:47,678 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,678 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,679 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,679 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,679 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,679 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,679 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,679 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,680 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:47,680 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,680 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:47,680 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,680 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,680 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,680 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,680 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,680 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,681 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,681 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:47,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,681 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,681 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,681 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   learning_rate: 0.04345454109729477
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   n_estimators: 339
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   subsample: 0.7164916560792167
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8447411578889518
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   reg_alpha: 4.258943089524393e-06
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO -   reg_lambda: 1.9826980964985924e-05
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:47,682 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:47,685 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:47,685 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:47,685 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:47,685 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:47,685 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:47,685 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,685 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,685 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,685 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,686 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,686 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,686 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,686 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,686 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,686 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,686 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,686 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:47,692 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:47,692 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:47,692 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:47,692 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:47,692 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,692 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,692 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:47,692 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:47,692 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:47,693 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:47,693 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:47,693 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:47,693 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,693 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,693 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,694 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,694 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:47,694 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:47,694 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:47,694 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:47,694 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:47,694 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:47,694 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:47,694 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:47,694 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:47,694 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:47,694 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:47,694 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:47,694 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:47,694 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:47,694 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:47,694 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:47,694 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,694 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,694 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,694 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,697 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:47,697 - src.hyperparameter_tuning - ERROR - Trial 2 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:47,698 - src.hyperparameter_tuning - INFO - Trial 3: 모델 타입 = lightgbm
2025-06-24 09:42:47,701 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:47,701 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:47,701 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:47,702 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:47,702 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:47,702 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:47,702 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:47,702 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:47,702 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:47,702 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:47,702 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:47,702 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:47,702 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:47,702 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:47,702 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:47,702 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:47,702 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:47,702 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:47,703 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,703 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,703 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,703 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,703 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,703 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:47,703 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:47,703 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:47,703 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:47,703 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:47,707 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:47,709 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,709 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:47,709 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:47,709 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:47,709 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:47,709 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:47,709 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,711 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,713 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:47,713 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,713 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,713 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,713 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,713 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,713 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,713 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:47,713 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,713 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,713 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:47,713 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:47,713 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,713 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,713 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:47,714 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:47,714 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,714 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,714 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,714 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:47,715 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:47,715 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:47,715 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:47,715 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:47,715 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:47,715 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:47,715 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:47,715 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:47,715 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,715 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:47,715 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:47,715 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:47,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:47,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,716 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,716 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:47,716 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,717 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:47,717 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,717 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,717 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,717 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,717 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,718 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,718 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:47,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,718 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,718 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,718 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:47,718 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   learning_rate: 0.019721610970574007
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   n_estimators: 483
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   subsample: 0.8056937753654446
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.836965827544817
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0029369981104377003
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO -   reg_lambda: 3.425445902633376e-07
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:47,719 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:47,721 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:47,721 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:47,721 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:47,721 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:47,721 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:47,721 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,721 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,722 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,722 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,723 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,723 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:47,723 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:47,723 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:47,723 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:47,723 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:47,723 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,723 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,723 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:47,723 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:47,723 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:47,724 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:47,724 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:47,724 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:47,724 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,724 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,724 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,725 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,725 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:47,725 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:47,725 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:47,725 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:47,725 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:47,725 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:47,725 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:47,725 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:47,725 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:47,725 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:47,725 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:47,725 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:47,725 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:47,725 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:47,725 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:47,725 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:47,725 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,725 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,725 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,725 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,727 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:47,727 - src.hyperparameter_tuning - ERROR - Trial 3 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:47,728 - src.hyperparameter_tuning - INFO - Trial 4: 모델 타입 = lightgbm
2025-06-24 09:42:47,732 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:47,732 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:47,732 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:47,732 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:47,732 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:47,732 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:47,732 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:47,732 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:47,732 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:47,733 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:47,733 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:47,733 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:47,733 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:47,733 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:47,733 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:47,733 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:47,733 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:47,733 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:47,734 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,734 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,734 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,734 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,734 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,734 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:47,734 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:47,734 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:47,734 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:47,734 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:47,738 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:47,740 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,740 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:47,740 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:47,740 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:47,740 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:47,740 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:47,740 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,742 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,743 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:47,743 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,743 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,743 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,744 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,744 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,744 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,744 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:47,744 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,744 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,744 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:47,744 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:47,744 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,744 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,744 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:47,744 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:47,744 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,745 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,745 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,745 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:47,746 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:47,746 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:47,746 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:47,746 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:47,746 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:47,746 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:47,746 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:47,746 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:47,746 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,746 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:47,746 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:47,746 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:47,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:47,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,746 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,747 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,747 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,747 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,747 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:47,747 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,747 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:47,747 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,747 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,747 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,747 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,748 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,748 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,748 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,749 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:47,749 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   learning_rate: 0.26690431824362526
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   n_estimators: 111
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   subsample: 0.9233589392465844
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7218455076693483
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   reg_alpha: 0.014391207615728067
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO -   reg_lambda: 9.148975058772307e-05
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:47,749 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:47,752 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:47,752 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:47,752 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:47,752 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:47,752 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:47,752 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,752 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,753 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,753 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,754 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,754 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:47,757 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:47,758 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:47,758 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:47,758 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:47,758 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,758 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,758 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:47,758 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:47,758 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:47,758 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:47,758 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:47,758 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:47,758 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,758 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,759 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,759 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,759 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:47,759 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:47,759 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:47,759 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:47,759 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:47,759 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:47,759 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:47,759 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:47,759 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:47,759 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:47,759 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:47,759 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:47,759 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:47,759 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:47,759 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:47,759 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:47,759 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,759 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,759 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,759 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,762 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:47,762 - src.hyperparameter_tuning - ERROR - Trial 4 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:47,763 - src.hyperparameter_tuning - INFO - Trial 5: 모델 타입 = lightgbm
2025-06-24 09:42:47,766 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:47,767 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:47,767 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:47,767 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:47,767 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:47,767 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:47,767 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:47,767 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:47,767 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:47,767 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:47,767 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:47,767 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:47,767 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:47,767 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:47,768 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:47,768 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:47,768 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:47,768 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:47,768 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,769 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,769 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,769 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,769 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,769 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:47,769 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:47,769 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:47,769 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:47,769 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:47,772 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:47,774 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,774 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:47,774 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:47,774 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:47,774 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:47,774 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:47,774 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,776 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,778 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:47,778 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,778 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,778 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,778 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,778 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,778 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,778 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:47,778 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,778 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,779 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:47,779 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:47,779 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,779 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,779 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:47,779 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:47,779 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,779 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,779 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,779 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:47,780 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:47,780 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:47,780 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:47,780 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:47,780 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:47,780 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:47,780 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:47,780 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:47,780 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,780 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:47,780 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:47,780 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:47,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:47,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,781 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,781 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,782 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:47,782 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:47,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,782 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,782 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,783 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,783 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:47,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,783 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,783 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,783 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:47,783 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   learning_rate: 0.011240768803005551
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   n_estimators: 166
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   subsample: 0.9637281608315128
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7035119926400067
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   reg_alpha: 6.388511557344611e-06
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0004793052550782129
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:47,784 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:47,787 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:47,787 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:47,787 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:47,787 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:47,787 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:47,787 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,787 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,787 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,787 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,787 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,787 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,788 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,788 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,788 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,788 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,788 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,788 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:47,792 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:47,792 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:47,792 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:47,792 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:47,792 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,792 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,792 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:47,792 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:47,792 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:47,792 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:47,792 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:47,792 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:47,793 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,793 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,793 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,793 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,793 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:47,794 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:47,794 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:47,794 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:47,794 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:47,794 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:47,794 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:47,794 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:47,794 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:47,794 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:47,794 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:47,794 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:47,794 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:47,794 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:47,794 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:47,794 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:47,794 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,794 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,794 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,794 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,796 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:47,796 - src.hyperparameter_tuning - ERROR - Trial 5 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:47,797 - src.hyperparameter_tuning - INFO - Trial 6: 모델 타입 = lightgbm
2025-06-24 09:42:47,801 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:47,801 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:47,801 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:47,801 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:47,801 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:47,801 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:47,801 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:47,801 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:47,801 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:47,802 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:47,802 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:47,802 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:47,802 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:47,802 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:47,802 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:47,802 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:47,802 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:47,802 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:47,803 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,803 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,803 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,803 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,803 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,803 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:47,803 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:47,803 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:47,803 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:47,803 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:47,807 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:47,809 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,809 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:47,809 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:47,809 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:47,809 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:47,809 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:47,809 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,811 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,813 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:47,813 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,813 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,813 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,813 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,813 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,813 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,813 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:47,813 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,813 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,813 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:47,813 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:47,814 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,814 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,814 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:47,814 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:47,814 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,814 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,814 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,814 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:47,815 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:47,815 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:47,815 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:47,815 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:47,815 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:47,815 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:47,815 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:47,815 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:47,815 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,815 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:47,815 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:47,815 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:47,815 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:47,815 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,815 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,816 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,816 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:47,816 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,817 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:47,817 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,817 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,817 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,817 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,817 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,817 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,817 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,817 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,818 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,818 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,818 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,818 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,818 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:47,818 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,818 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,818 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,818 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:47,818 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   learning_rate: 0.27051668818999286
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   n_estimators: 569
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   subsample: 0.9100531293444458
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9757995766256756
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   reg_alpha: 0.002404915432737351
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO -   reg_lambda: 1.9809253750493907
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:47,819 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:47,822 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:47,822 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:47,822 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:47,822 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:47,822 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:47,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,822 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,823 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,823 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:47,829 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:47,829 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:47,829 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:47,829 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:47,829 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,829 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,829 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:47,829 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:47,829 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:47,829 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:47,830 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:47,830 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:47,830 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,830 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,830 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,831 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,831 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:47,831 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:47,831 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:47,831 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:47,831 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:47,831 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:47,831 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:47,831 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:47,831 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:47,831 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:47,831 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:47,831 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:47,831 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:47,831 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:47,831 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:47,831 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:47,831 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,831 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,831 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,831 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,834 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:47,834 - src.hyperparameter_tuning - ERROR - Trial 6 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:47,835 - src.hyperparameter_tuning - INFO - Trial 7: 모델 타입 = lightgbm
2025-06-24 09:42:47,838 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:47,839 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:47,839 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:47,839 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:47,839 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:47,839 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:47,839 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:47,839 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:47,839 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:47,839 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:47,840 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:47,840 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:47,840 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:47,840 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:47,840 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:47,840 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:47,840 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:47,840 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:47,841 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,841 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,841 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,841 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,841 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,841 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:47,841 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:47,841 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:47,841 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:47,841 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:47,844 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:47,846 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,846 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:47,846 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:47,846 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:47,846 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:47,847 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:47,847 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,848 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,850 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:47,850 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,850 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,850 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,850 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,850 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,850 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,850 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:47,850 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,850 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,851 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:47,851 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:47,851 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,851 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,851 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:47,851 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:47,851 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,852 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,852 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,852 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:47,852 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:47,853 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:47,853 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:47,853 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:47,853 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:47,853 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:47,853 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:47,853 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:47,853 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,853 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:47,853 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:47,853 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:47,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:47,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,853 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,853 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,853 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,854 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:47,854 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,854 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:47,854 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,854 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,854 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,854 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,855 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,855 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,855 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,856 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:47,856 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   learning_rate: 0.011662890273931383
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   n_estimators: 134
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   subsample: 0.7301321323053057
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7554709158757928
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   reg_alpha: 0.28749982347407854
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO -   reg_lambda: 1.6247252885719427e-05
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:47,856 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:47,859 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:47,859 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:47,859 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:47,859 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:47,859 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:47,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,859 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,860 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,860 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,860 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,860 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,860 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,860 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,860 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,860 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:47,866 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:47,866 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:47,866 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:47,866 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:47,866 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,866 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,866 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:47,866 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:47,866 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:47,867 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:47,867 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:47,867 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:47,867 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,867 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,867 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,868 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,868 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:47,868 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:47,868 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:47,868 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:47,868 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:47,868 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:47,868 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:47,868 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:47,868 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:47,868 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:47,868 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:47,868 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:47,868 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:47,868 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:47,868 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:47,868 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:47,868 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,868 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,868 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,868 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,871 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:47,871 - src.hyperparameter_tuning - ERROR - Trial 7 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:47,872 - src.hyperparameter_tuning - INFO - Trial 8: 모델 타입 = lightgbm
2025-06-24 09:42:47,875 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:47,875 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:47,876 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:47,876 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:47,876 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:47,876 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:47,876 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:47,876 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:47,876 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:47,876 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:47,876 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:47,876 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:47,876 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:47,876 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:47,876 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:47,876 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:47,876 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:47,876 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:47,877 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,877 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,877 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,877 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,877 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,877 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:47,877 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:47,877 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:47,877 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:47,877 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:47,881 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:47,883 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,883 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:47,883 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:47,883 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:47,883 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:47,883 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:47,883 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,885 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,887 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:47,887 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,887 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,887 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,887 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,887 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,887 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,887 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:47,887 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,887 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,887 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:47,888 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:47,888 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,888 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,888 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:47,888 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:47,888 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,888 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,888 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,888 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:47,889 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:47,889 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:47,889 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:47,889 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:47,889 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:47,889 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:47,889 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:47,889 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:47,889 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,889 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:47,889 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:47,889 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:47,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:47,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,890 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,890 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:47,890 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,891 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:47,891 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,891 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,891 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,891 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,891 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,891 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,891 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,891 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,892 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,892 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,892 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,892 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,892 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:47,892 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,892 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,892 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,892 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:47,892 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:47,892 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   learning_rate: 0.016149614799999188
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   n_estimators: 317
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   subsample: 0.9208787923016158
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6298202574719083
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   reg_alpha: 0.08916674715636537
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO -   reg_lambda: 6.143857495033091e-07
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:47,893 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:47,897 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:47,897 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:47,897 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:47,897 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:47,897 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:47,898 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,898 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,898 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,898 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,898 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,898 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,898 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,898 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,899 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,899 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,899 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:47,900 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:47,901 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:47,901 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:47,901 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:47,901 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,901 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,901 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:47,901 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:47,901 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:47,901 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:47,901 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:47,901 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:47,901 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,901 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,902 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,902 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,902 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:47,902 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:47,902 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:47,902 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:47,902 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:47,902 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:47,902 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:47,902 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:47,902 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:47,902 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:47,902 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:47,902 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:47,902 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:47,902 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:47,902 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:47,902 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:47,902 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,902 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,902 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,902 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,905 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:47,905 - src.hyperparameter_tuning - ERROR - Trial 8 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:47,906 - src.hyperparameter_tuning - INFO - Trial 9: 모델 타입 = lightgbm
2025-06-24 09:42:47,909 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:47,910 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:47,910 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:47,910 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:47,910 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:47,910 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:47,910 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:47,910 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:47,910 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:47,910 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:47,910 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:47,910 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:47,910 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:47,910 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:47,910 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:47,910 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:47,911 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:47,911 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:47,911 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,911 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,912 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,912 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,912 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,912 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:47,912 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:47,912 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:47,912 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:47,912 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:47,915 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:47,917 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,917 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:47,917 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:47,917 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:47,917 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:47,917 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:47,917 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,919 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,921 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:47,921 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,921 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,921 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,921 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,921 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,921 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,921 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:47,921 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,921 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,922 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:47,922 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:47,922 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,922 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,922 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:47,922 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:47,922 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,922 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,922 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,922 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:47,923 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:47,923 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:47,923 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:47,923 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:47,923 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:47,923 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:47,923 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:47,923 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:47,923 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,923 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:47,923 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:47,923 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:47,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:47,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,924 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,924 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,925 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:47,925 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:47,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,925 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,925 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,925 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,926 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,926 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,926 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,926 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,926 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:47,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,926 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,926 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,926 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:47,926 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   learning_rate: 0.11069143219393454
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   n_estimators: 55
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   subsample: 0.8916028672163949
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9085081386743783
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   reg_alpha: 1.683416412018213e-05
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO -   reg_lambda: 1.1036250149900698e-07
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:47,927 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:47,929 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:47,930 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:47,930 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:47,930 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:47,930 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:47,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,930 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,931 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,931 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,931 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:47,935 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:47,935 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:47,935 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:47,935 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:47,935 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,935 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,935 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:47,935 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:47,935 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:47,936 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:47,936 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:47,936 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:47,936 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,936 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,936 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,937 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,937 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:47,937 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:47,937 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:47,937 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:47,937 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:47,937 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:47,937 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:47,937 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:47,937 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:47,937 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:47,937 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:47,937 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:47,937 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:47,937 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:47,937 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:47,937 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:47,937 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,937 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,937 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,937 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,940 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:47,940 - src.hyperparameter_tuning - ERROR - Trial 9 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:47,951 - src.hyperparameter_tuning - INFO - Trial 10: 모델 타입 = lightgbm
2025-06-24 09:42:47,954 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:47,955 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:47,955 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:47,955 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:47,955 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:47,955 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:47,955 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:47,955 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:47,955 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:47,956 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:47,956 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:47,956 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:47,956 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:47,956 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:47,956 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:47,956 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:47,956 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:47,956 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:47,957 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,957 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,957 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:47,957 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:47,957 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,957 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:47,957 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:47,957 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:47,957 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:47,957 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:47,960 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:47,962 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,962 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:47,962 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:47,962 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:47,962 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:47,962 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:47,962 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:47,964 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:47,966 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:47,966 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,966 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,966 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:47,966 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:47,967 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,967 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:47,967 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:47,967 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,967 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,967 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:47,967 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:47,967 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,967 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,967 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:47,967 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:47,967 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,968 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,968 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:47,968 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:47,969 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:47,969 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:47,969 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:47,969 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:47,969 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:47,969 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:47,969 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:47,969 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:47,969 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,969 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:47,969 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:47,969 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:47,969 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:47,969 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,969 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,969 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,969 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,970 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:47,970 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:47,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,971 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,971 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,971 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,971 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:47,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   learning_rate: 0.09315744902122479
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   n_estimators: 901
2025-06-24 09:42:47,972 - src.models.lightgbm_model - INFO -   subsample: 0.6071847502459278
2025-06-24 09:42:47,973 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6061470949312417
2025-06-24 09:42:47,973 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:42:47,973 - src.models.lightgbm_model - INFO -   reg_alpha: 1.3686680646913267e-08
2025-06-24 09:42:47,973 - src.models.lightgbm_model - INFO -   reg_lambda: 6.099006535330825
2025-06-24 09:42:47,973 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:47,973 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:47,973 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:47,993 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:47,993 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:47,993 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:47,993 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:47,993 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:47,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:47,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:47,993 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:47,993 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:47,993 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:47,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:47,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:47,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:47,994 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:47,994 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:47,994 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:47,994 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:47,995 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:47,995 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:47,995 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,995 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,995 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:47,995 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:47,995 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:47,995 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:47,995 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:47,995 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:47,995 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,995 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,996 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,996 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:47,996 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:47,996 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:47,996 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:47,996 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:47,996 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:47,996 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:47,996 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:47,996 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:47,996 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:47,996 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:47,996 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:47,996 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:47,996 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:47,996 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:47,996 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:47,996 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:47,996 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,996 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,996 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:47,996 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:47,999 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:47,999 - src.hyperparameter_tuning - ERROR - Trial 10 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,010 - src.hyperparameter_tuning - INFO - Trial 11: 모델 타입 = lightgbm
2025-06-24 09:42:48,014 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,015 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,015 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,015 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,015 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,015 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,015 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,015 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,015 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,015 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,015 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,015 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,015 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,015 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,015 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,015 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,015 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,015 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,016 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,016 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,016 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,016 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,017 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,017 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,017 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,017 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,017 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,017 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,020 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,022 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,022 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,022 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,022 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,023 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,023 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,023 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,024 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,026 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,026 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,026 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,026 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,026 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,026 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,026 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,026 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,027 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,027 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,027 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,027 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,027 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,027 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,027 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,027 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,027 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,028 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,028 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,028 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,029 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,029 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,029 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,029 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,029 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,029 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,029 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,029 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,029 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,029 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,029 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,029 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,029 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,030 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,030 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,031 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,031 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,031 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,032 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,032 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   learning_rate: 0.037348440879763224
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   n_estimators: 705
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   subsample: 0.8275682686623269
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9801238964661396
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   reg_alpha: 2.0076751494057687e-08
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO -   reg_lambda: 0.050437107744728454
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,032 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,033 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,035 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,035 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,035 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,035 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,035 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,035 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,035 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,036 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,036 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,036 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,036 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,036 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,036 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,037 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,037 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,037 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,037 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,037 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,037 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,037 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,037 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,037 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,037 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,037 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,037 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,037 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,037 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,037 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,038 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,038 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,038 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,038 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,039 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,039 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,039 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,039 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,039 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,039 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,039 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,039 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,039 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,039 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,039 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,039 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,039 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,039 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,039 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,039 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,039 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,039 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,039 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,039 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,041 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,041 - src.hyperparameter_tuning - ERROR - Trial 11 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,053 - src.hyperparameter_tuning - INFO - Trial 12: 모델 타입 = lightgbm
2025-06-24 09:42:48,056 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,057 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,057 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,057 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,057 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,057 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,057 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,057 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,057 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,058 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,058 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,058 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,058 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,058 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,058 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,058 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,058 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,058 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,059 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,059 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,059 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,059 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,059 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,059 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,059 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,059 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,059 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,059 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,063 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,065 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,065 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,065 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,065 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,065 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,065 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,065 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,067 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,068 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,068 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,069 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,069 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,069 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,069 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,069 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,069 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,069 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,069 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,069 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,069 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,069 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,069 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,069 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,069 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,069 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,070 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,070 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,070 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,071 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,071 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,071 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,071 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,071 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,071 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,071 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,071 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,071 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,071 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,071 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,071 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,071 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,072 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,072 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,073 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,073 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,073 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,073 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,073 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,073 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,073 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,073 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,073 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,074 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,074 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   learning_rate: 0.11614923191803554
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   n_estimators: 706
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   subsample: 0.9831484441888799
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.902800604671404
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   reg_alpha: 5.997698489764049e-07
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO -   reg_lambda: 0.012341345845574371
2025-06-24 09:42:48,074 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,075 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,075 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,077 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,077 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,077 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,077 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,077 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,078 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,078 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,078 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,079 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,079 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,079 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,079 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,079 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,079 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,079 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,079 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,079 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,079 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,079 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,079 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,080 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,080 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,080 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,080 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,080 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,080 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,080 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,081 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,081 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,081 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,081 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,081 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,081 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,081 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,081 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,081 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,081 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,081 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,081 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,081 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,081 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,081 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,081 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,081 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,083 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,083 - src.hyperparameter_tuning - ERROR - Trial 12 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,095 - src.hyperparameter_tuning - INFO - Trial 13: 모델 타입 = lightgbm
2025-06-24 09:42:48,099 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,099 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,099 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,099 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,099 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,099 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,099 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,099 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,099 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,100 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,100 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,100 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,100 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,100 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,100 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,100 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,100 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,100 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,101 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,101 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,101 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,101 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,101 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,101 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,101 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,101 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,101 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,101 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,105 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,107 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,107 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,107 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,107 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,107 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,107 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,107 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,109 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,111 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,111 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,111 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,111 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,111 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,111 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,111 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,111 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,111 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,111 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,111 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,111 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,111 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,112 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,112 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,112 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,113 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,113 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,113 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,113 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,113 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,113 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,113 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,113 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,113 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,113 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,113 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,113 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,113 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,113 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,113 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,113 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,114 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,114 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,115 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,116 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,116 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,116 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,116 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO -   learning_rate: 0.07369477793265464
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,116 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   n_estimators: 493
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   subsample: 0.8579178144028043
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6684815593910434
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   reg_alpha: 9.86874546485378
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO -   reg_lambda: 1.1101875524587999e-08
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,117 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,120 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,120 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,120 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,120 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,120 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,120 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,120 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,120 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,120 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,121 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,121 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,124 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,124 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,124 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,124 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,124 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,124 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,124 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,124 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,124 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,125 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,125 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,125 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,125 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,125 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,125 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,126 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,126 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,126 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,126 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,126 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,126 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,126 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,126 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,126 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,126 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,126 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,126 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,126 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,126 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,126 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,126 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,126 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,126 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,126 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,126 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,126 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,128 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,129 - src.hyperparameter_tuning - ERROR - Trial 13 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,140 - src.hyperparameter_tuning - INFO - Trial 14: 모델 타입 = lightgbm
2025-06-24 09:42:48,144 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,144 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,145 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,145 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,145 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,145 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,145 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,145 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,145 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,145 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,145 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,145 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,145 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,145 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,145 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,145 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,145 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,145 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,146 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,146 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,146 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,146 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,146 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,146 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,146 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,146 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,146 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,146 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,150 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,152 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,152 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,152 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,152 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,152 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,152 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,152 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,154 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,156 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,156 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,156 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,156 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,156 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,156 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,156 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,156 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,156 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,156 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,157 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,157 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,157 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,157 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,157 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,157 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,157 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,157 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,157 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,157 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,158 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,158 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,158 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,158 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,158 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,158 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,158 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,158 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,158 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,158 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,158 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,158 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,158 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,158 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,159 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,159 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,160 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,160 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,160 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,160 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,160 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,160 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,160 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,160 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,160 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,161 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,161 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,161 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,161 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,161 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,161 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,161 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,161 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,161 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,161 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,161 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,161 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   learning_rate: 0.17646596150449262
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   n_estimators: 702
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   subsample: 0.7376022736475862
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8046295483602256
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   reg_alpha: 2.3549110805943098e-07
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO -   reg_lambda: 0.06760969294969883
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,162 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,165 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,165 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,165 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,165 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,165 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,166 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,166 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,166 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,166 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,172 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,172 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,172 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,172 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,172 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,172 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,172 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,172 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,172 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,172 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,173 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,173 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,173 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,173 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,173 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,174 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,174 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,174 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,174 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,174 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,174 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,174 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,174 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,174 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,174 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,174 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,174 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,174 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,174 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,174 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,174 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,174 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,174 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,174 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,174 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,174 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,176 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,177 - src.hyperparameter_tuning - ERROR - Trial 14 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,189 - src.hyperparameter_tuning - INFO - Trial 15: 모델 타입 = lightgbm
2025-06-24 09:42:48,192 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,193 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,193 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,193 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,193 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,193 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,193 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,193 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,193 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,194 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,194 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,194 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,194 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,194 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,194 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,194 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,194 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,194 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,195 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,195 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,195 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,195 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,195 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,195 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,195 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,195 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,195 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,195 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,199 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,201 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,201 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,201 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,201 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,201 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,201 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,201 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,203 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,205 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,205 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,205 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,205 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,205 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,205 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,205 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,205 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,205 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,205 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,205 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,205 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,205 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,205 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,205 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,205 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,205 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,206 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,206 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,206 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,207 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,207 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,207 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,207 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,207 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,207 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,207 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,207 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,207 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,207 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,207 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,207 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,207 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,207 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,207 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,208 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,208 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,208 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,208 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,208 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,208 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,208 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,208 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,209 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,209 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,209 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,209 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,209 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,210 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,210 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,210 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,210 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,210 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,210 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,210 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,210 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,210 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,210 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,210 - src.models.lightgbm_model - INFO -   learning_rate: 0.026752568195150317
2025-06-24 09:42:48,210 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,210 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   n_estimators: 997
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   subsample: 0.9967544619046032
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.896461276471979
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   reg_alpha: 8.925905274192813e-05
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0009166238280651257
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,211 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,215 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,215 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,215 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,215 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,215 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,215 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,215 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,215 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,215 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,216 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,216 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,216 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,216 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,216 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,216 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,216 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,216 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,222 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,222 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,222 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,222 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,222 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,222 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,222 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,222 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,222 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,223 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,223 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,223 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,223 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,223 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,223 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,224 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,224 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,224 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,224 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,224 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,224 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,224 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,224 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,224 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,224 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,224 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,224 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,224 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,224 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,224 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,224 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,224 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,224 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,224 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,224 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,224 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,227 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,227 - src.hyperparameter_tuning - ERROR - Trial 15 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,239 - src.hyperparameter_tuning - INFO - Trial 16: 모델 타입 = lightgbm
2025-06-24 09:42:48,243 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,243 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,243 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,243 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,243 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,243 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,243 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,243 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,243 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,244 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,244 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,244 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,244 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,244 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,244 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,244 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,244 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,244 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,245 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,245 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,245 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,245 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,245 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,245 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,245 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,245 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,245 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,245 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,249 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,251 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,251 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,251 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,251 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,251 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,251 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,251 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,253 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,255 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,255 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,255 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,255 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,255 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,255 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,255 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,255 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,255 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,255 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,255 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,255 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,255 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,255 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,255 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,255 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,255 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,256 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,256 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,256 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,257 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,257 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,257 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,257 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,257 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,257 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,257 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,257 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,257 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,257 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,257 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,257 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,258 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,258 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,258 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,258 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,258 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,258 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,258 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,258 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,259 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,260 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,260 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,260 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,260 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,260 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,260 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,260 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,260 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,260 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,260 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,260 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,260 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,260 - src.models.lightgbm_model - INFO -   learning_rate: 0.06988639938760517
2025-06-24 09:42:48,260 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,260 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,260 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,260 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,260 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,260 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   n_estimators: 347
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   subsample: 0.769221734655711
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7657244060744415
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   reg_alpha: 2.9167530407966635e-07
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO -   reg_lambda: 0.4030789571311193
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,261 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,271 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,271 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,271 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,271 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,271 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,271 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,271 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,272 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,272 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,273 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,273 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,273 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,273 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,273 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,273 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,273 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,273 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,273 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,273 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,273 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,273 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,274 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,274 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,274 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,274 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,274 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,274 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,274 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,275 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,275 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,275 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,275 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,275 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,275 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,275 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,275 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,275 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,275 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,275 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,275 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,275 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,275 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,275 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,275 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,275 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,275 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,275 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,275 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,275 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,278 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,278 - src.hyperparameter_tuning - ERROR - Trial 16 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,290 - src.hyperparameter_tuning - INFO - Trial 17: 모델 타입 = lightgbm
2025-06-24 09:42:48,294 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,295 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,295 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,295 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,295 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,295 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,295 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,295 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,295 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,295 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,295 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,295 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,295 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,295 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,295 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,295 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,295 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,295 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,296 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,296 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,296 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,296 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,297 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,297 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,297 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,297 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,297 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,297 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,300 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,302 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,302 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,302 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,302 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,302 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,302 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,302 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,304 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,306 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,306 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,306 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,306 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,306 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,306 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,306 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,306 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,306 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,306 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,307 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,307 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,307 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,307 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,307 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,307 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,307 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,308 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,308 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,308 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,309 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,309 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,309 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,309 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,309 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,309 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,309 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,309 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,309 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,309 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,309 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,309 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,309 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,309 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,309 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,309 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,309 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,309 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,310 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,310 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,311 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,311 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,311 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   learning_rate: 0.15526074257939743
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   n_estimators: 600
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   subsample: 0.6732132011401761
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6721524828008189
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   reg_alpha: 9.14459959766754e-08
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO -   reg_lambda: 0.004840492100137957
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,312 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,315 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,315 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,315 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,315 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,315 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,316 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,316 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,317 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,317 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,317 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,326 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,326 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,326 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,326 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,326 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,326 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,326 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,326 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,326 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,327 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,327 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,327 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,327 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,327 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,327 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,328 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,328 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,328 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,328 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,328 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,328 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,328 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,328 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,328 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,328 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,328 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,328 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,328 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,328 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,328 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,328 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,328 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,328 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,328 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,328 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,328 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,330 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,331 - src.hyperparameter_tuning - ERROR - Trial 17 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,343 - src.hyperparameter_tuning - INFO - Trial 18: 모델 타입 = lightgbm
2025-06-24 09:42:48,347 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,348 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,348 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,348 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,348 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,348 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,348 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,348 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,348 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,349 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,349 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,349 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,349 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,349 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,349 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,349 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,349 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,349 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,350 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,350 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,350 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,350 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,350 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,350 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,350 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,350 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,350 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,350 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,354 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,356 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,356 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,356 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,356 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,356 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,356 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,356 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,358 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,359 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,359 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,360 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,360 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,360 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,360 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,360 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,360 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,360 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,360 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,360 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,360 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,360 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,360 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,360 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,360 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,360 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,361 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,361 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,361 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,362 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,362 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,362 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,362 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,362 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,362 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,362 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,362 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,362 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,362 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,362 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,362 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,362 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,362 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,362 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,362 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,363 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,363 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,363 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,363 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,364 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,364 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,364 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,364 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,364 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,364 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,365 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,365 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,365 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,365 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO -   learning_rate: 0.05533525328002605
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,365 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   n_estimators: 416
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   subsample: 0.8551318001092548
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9338003283396146
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00011115273434769104
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO -   reg_lambda: 2.6037259691414086e-06
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,366 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,369 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,369 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,369 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,369 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,369 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,369 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,370 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,370 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,375 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,376 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,376 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,376 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,376 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,376 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,376 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,376 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,376 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,376 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,376 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,376 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,376 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,377 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,377 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,377 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,377 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,377 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,377 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,377 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,377 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,377 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,377 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,377 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,377 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,377 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,377 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,377 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,377 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,377 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,377 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,377 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,377 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,377 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,377 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,377 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,380 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,380 - src.hyperparameter_tuning - ERROR - Trial 18 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,393 - src.hyperparameter_tuning - INFO - Trial 19: 모델 타입 = lightgbm
2025-06-24 09:42:48,397 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,398 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,398 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,398 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,398 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,398 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,398 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,398 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,398 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,398 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,398 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,398 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,398 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,398 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,398 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,398 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,398 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,398 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,400 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,400 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,400 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,400 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,400 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,400 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,400 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,400 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,400 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,400 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,404 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,406 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,406 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,406 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,406 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,406 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,406 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,406 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,408 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,410 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,410 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,410 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,410 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,410 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,410 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,410 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,410 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,410 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,410 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,410 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,410 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,410 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,410 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,410 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,410 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,411 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,411 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,411 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,411 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,412 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,412 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,412 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,412 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,412 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,412 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,412 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,412 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,412 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,412 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,412 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,412 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,412 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,412 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,412 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,413 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,413 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,413 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,414 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,415 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,415 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,415 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,415 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,415 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,415 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,415 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,415 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   learning_rate: 0.02877361180532123
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   n_estimators: 835
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   subsample: 0.9423652436238517
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8416634198004798
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   reg_alpha: 2.4662900352851794e-06
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO -   reg_lambda: 4.7203867760430046e-08
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,416 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,419 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,419 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,419 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,419 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,419 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,420 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,420 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,420 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,421 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,426 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,426 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,426 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,426 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,426 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,426 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,426 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,426 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,426 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,427 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,427 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,427 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,427 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,427 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,427 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,428 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,428 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,428 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,428 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,428 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,428 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,428 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,428 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,428 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,428 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,428 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,428 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,428 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,428 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,428 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,428 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,428 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,428 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,428 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,428 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,428 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,431 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,431 - src.hyperparameter_tuning - ERROR - Trial 19 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,443 - src.hyperparameter_tuning - INFO - Trial 20: 모델 타입 = lightgbm
2025-06-24 09:42:48,447 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,448 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,448 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,448 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,448 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,448 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,448 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,448 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,448 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,448 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,449 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,449 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,449 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,449 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,449 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,449 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,449 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,449 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,450 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,450 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,450 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,450 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,450 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,450 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,450 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,450 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,450 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,450 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,454 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,456 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,456 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,456 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,456 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,456 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,456 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,456 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,458 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,460 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,460 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,460 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,460 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,460 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,460 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,460 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,460 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,460 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,460 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,461 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,461 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,461 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,461 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,461 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,461 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,461 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,461 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,461 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,461 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,462 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,462 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,462 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,462 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,462 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,462 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,462 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,462 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,462 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,462 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,462 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,462 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,462 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,462 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,463 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,463 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,463 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,463 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,463 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,463 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,464 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,464 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,464 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,464 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,465 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,465 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   learning_rate: 0.16522729299476813
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   n_estimators: 224
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   subsample: 0.87408467479411
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7727431143998708
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   reg_alpha: 1.1069451775532163e-08
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO -   reg_lambda: 5.845016122261629e-06
2025-06-24 09:42:48,466 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,467 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,467 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,483 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,483 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,483 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,483 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,483 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,483 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,483 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,483 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,483 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,484 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,484 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,484 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,484 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,484 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,484 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,484 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,484 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,485 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,485 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,485 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,485 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,485 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,485 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,485 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,485 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,485 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,485 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,485 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,485 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,486 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,486 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,486 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,486 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,486 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,486 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,486 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,486 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,486 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,486 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,486 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,486 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,486 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,486 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,486 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,486 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,486 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,486 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,486 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,486 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,486 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,486 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,486 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,489 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,489 - src.hyperparameter_tuning - ERROR - Trial 20 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,503 - src.hyperparameter_tuning - INFO - Trial 21: 모델 타입 = lightgbm
2025-06-24 09:42:48,507 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,507 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,507 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,507 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,507 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,508 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,508 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,508 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,508 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,508 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,508 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,508 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,508 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,508 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,508 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,508 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,508 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,508 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,509 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,509 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,509 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,509 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,510 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,510 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,510 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,510 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,510 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,510 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,514 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,516 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,516 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,516 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,516 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,516 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,516 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,516 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,518 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,520 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,520 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,520 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,520 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,520 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,520 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,520 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,520 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,520 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,520 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,521 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,521 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,521 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,521 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,521 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,521 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,521 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,522 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,522 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,522 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,523 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,523 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,523 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,523 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,523 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,523 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,523 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,523 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,523 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,523 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,523 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,523 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,524 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,525 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,525 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,525 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,526 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,526 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,526 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,526 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,526 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,526 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,526 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,527 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,527 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   learning_rate: 0.04529483298639887
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,527 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO -   n_estimators: 316
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO -   subsample: 0.6975620050707811
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8503251588841235
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO -   reg_alpha: 9.844852091987153e-07
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO -   reg_lambda: 4.797440969544924e-05
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,528 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,531 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,531 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,531 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,531 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,531 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,531 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,531 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,531 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,531 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,531 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,532 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,532 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,538 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,538 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,538 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,538 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,538 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,538 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,538 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,538 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,539 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,539 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,539 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,539 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,539 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,539 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,539 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,540 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,540 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,540 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,540 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,540 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,540 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,540 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,540 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,540 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,540 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,540 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,540 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,540 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,540 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,540 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,540 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,540 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,540 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,540 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,540 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,540 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,543 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,543 - src.hyperparameter_tuning - ERROR - Trial 21 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,556 - src.hyperparameter_tuning - INFO - Trial 22: 모델 타입 = lightgbm
2025-06-24 09:42:48,560 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,561 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,561 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,561 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,561 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,561 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,561 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,561 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,561 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,562 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,562 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,562 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,562 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,562 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,562 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,562 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,562 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,562 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,563 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,563 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,563 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,563 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,563 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,563 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,563 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,563 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,563 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,563 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,567 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,569 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,569 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,569 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,569 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,569 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,569 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,569 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,571 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,573 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,573 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,573 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,573 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,573 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,573 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,573 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,573 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,573 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,573 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,574 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,574 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,574 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,574 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,574 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,574 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,574 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,574 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,574 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,574 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,575 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,575 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,575 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,575 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,575 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,575 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,575 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,575 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,575 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,575 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,575 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,575 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,575 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,575 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,576 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,576 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,576 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,576 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,576 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,576 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,576 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,577 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,577 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,577 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,577 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,577 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,577 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,577 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,577 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,578 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,578 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,578 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,578 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,578 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,578 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,579 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,579 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,579 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   learning_rate: 0.015410150189628657
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,579 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,580 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,580 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,580 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,580 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,580 - src.models.lightgbm_model - INFO -   n_estimators: 411
2025-06-24 09:42:48,580 - src.models.lightgbm_model - INFO -   subsample: 0.6452606057786048
2025-06-24 09:42:48,580 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8738445964974808
2025-06-24 09:42:48,580 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:48,580 - src.models.lightgbm_model - INFO -   reg_alpha: 1.1485400190421731e-05
2025-06-24 09:42:48,580 - src.models.lightgbm_model - INFO -   reg_lambda: 1.5162743738503278e-06
2025-06-24 09:42:48,580 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,580 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,580 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,582 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,582 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,582 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,582 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,583 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,583 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,583 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,583 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,583 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,583 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,584 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,584 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,584 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,584 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,587 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,587 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,587 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,587 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,587 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,587 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,587 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,587 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,587 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,587 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,588 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,588 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,588 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,588 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,588 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,589 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,589 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,589 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,589 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,589 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,589 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,589 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,589 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,589 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,589 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,589 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,589 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,589 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,589 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,589 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,589 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,589 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,589 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,589 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,589 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,589 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,592 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,592 - src.hyperparameter_tuning - ERROR - Trial 22 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,605 - src.hyperparameter_tuning - INFO - Trial 23: 모델 타입 = lightgbm
2025-06-24 09:42:48,609 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,609 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,609 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,609 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,609 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,609 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,609 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,609 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,609 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,610 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,610 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,610 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,610 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,610 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,610 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,610 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,610 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,610 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,611 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,611 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,612 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,612 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,612 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,612 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,612 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,612 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,612 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,612 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,616 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,618 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,618 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,618 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,618 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,618 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,618 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,618 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,620 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,622 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,622 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,622 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,622 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,622 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,622 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,622 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,622 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,622 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,622 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,623 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,623 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,623 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,623 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,623 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,623 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,623 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,623 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,623 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,623 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,624 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,624 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,624 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,624 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,624 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,624 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,624 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,624 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,624 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,624 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,624 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,624 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,624 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,624 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,625 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,625 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,625 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,625 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,625 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,625 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,625 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,626 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,626 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,626 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,626 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,626 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,626 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,626 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,626 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,627 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,627 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,627 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,627 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,627 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,627 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   learning_rate: 0.02960427890913426
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   n_estimators: 240
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   subsample: 0.7742544913880576
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9449923596722283
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   reg_alpha: 6.189776343666531e-08
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO -   reg_lambda: 2.0050009913357152e-05
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,628 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,631 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,631 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,631 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,631 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,631 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,631 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,631 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,631 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,631 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,631 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,632 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,632 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,632 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,632 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,632 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,632 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,632 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,637 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,637 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,637 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,637 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,637 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,637 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,637 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,637 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,637 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,638 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,638 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,638 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,638 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,638 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,638 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,639 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,639 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,639 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,639 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,639 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,639 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,639 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,639 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,639 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,639 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,639 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,639 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,639 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,639 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,639 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,639 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,639 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,639 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,639 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,639 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,639 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,642 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,642 - src.hyperparameter_tuning - ERROR - Trial 23 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,655 - src.hyperparameter_tuning - INFO - Trial 24: 모델 타입 = lightgbm
2025-06-24 09:42:48,659 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,660 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,660 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,660 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,660 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,660 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,660 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,660 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,660 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,660 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,660 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,660 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,660 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,660 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,660 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,660 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,660 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,660 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,661 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,661 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,661 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,661 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,661 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,661 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,661 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,661 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,661 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,662 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,666 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,668 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,668 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,668 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,668 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,668 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,668 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,668 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,670 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,672 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,672 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,672 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,672 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,672 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,672 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,672 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,672 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,672 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,672 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,673 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,673 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,673 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,673 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,673 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,673 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,673 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,673 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,674 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,674 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,674 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,674 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,674 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,674 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,674 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,674 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,674 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,674 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,674 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,675 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,675 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,675 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,675 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,675 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,675 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,675 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,676 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,676 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,676 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,677 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,677 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,677 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,677 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,677 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   learning_rate: 0.052772641594485394
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   n_estimators: 585
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   subsample: 0.709790030543809
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7956578586822305
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   reg_alpha: 2.8089508266239516e-05
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00016743745517347003
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,678 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,681 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,681 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,681 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,681 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,681 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,682 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,683 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,683 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,683 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,688 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,688 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,688 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,688 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,688 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,688 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,688 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,688 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,688 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,688 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,688 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,689 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,689 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,689 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,689 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,690 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,690 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,690 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,690 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,690 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,690 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,690 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,690 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,690 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,690 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,690 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,690 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,690 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,690 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,690 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,690 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,690 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,690 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,690 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,690 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,690 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,693 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,693 - src.hyperparameter_tuning - ERROR - Trial 24 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,706 - src.hyperparameter_tuning - INFO - Trial 25: 모델 타입 = lightgbm
2025-06-24 09:42:48,710 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,711 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,711 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,711 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,711 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,711 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,711 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,711 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,711 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,712 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,712 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,712 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,712 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,712 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,712 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,712 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,712 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,712 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,713 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,713 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,713 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,713 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,713 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,713 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,713 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,713 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,713 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,713 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,717 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,719 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,719 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,719 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,719 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,719 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,719 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,719 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,721 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,723 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,723 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,723 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,723 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,723 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,723 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,723 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,723 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,723 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,723 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,724 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,724 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,724 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,724 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,724 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,724 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,724 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,724 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,724 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,724 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,725 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,725 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,725 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,725 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,725 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,725 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,725 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,725 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,725 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,725 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,725 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,725 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,726 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,726 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,727 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,727 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,727 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,728 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,728 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,728 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,728 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,728 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   learning_rate: 0.02043311211274545
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   n_estimators: 410
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   subsample: 0.765836702637975
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9367310980059825
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   reg_alpha: 2.467723761283515e-06
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0025526354515177084
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,729 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,732 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,732 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,732 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,732 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,732 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,732 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,733 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,733 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,733 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,739 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,739 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,739 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,739 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,739 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,739 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,739 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,739 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,739 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,740 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,740 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,740 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,740 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,740 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,740 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,741 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,741 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,741 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,741 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,741 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,741 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,741 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,741 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,741 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,741 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,741 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,741 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,741 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,741 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,741 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,741 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,741 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,741 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,741 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,741 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,741 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,744 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,744 - src.hyperparameter_tuning - ERROR - Trial 25 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,756 - src.hyperparameter_tuning - INFO - Trial 26: 모델 타입 = lightgbm
2025-06-24 09:42:48,760 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,761 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,761 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,761 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,761 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,761 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,761 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,761 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,761 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,762 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,762 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,762 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,762 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,762 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,762 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,762 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,762 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,762 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,763 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,763 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,763 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,763 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,763 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,763 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,763 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,763 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,763 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,763 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,767 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,769 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,769 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,769 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,769 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,769 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,769 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,769 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,771 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,773 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,773 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,773 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,773 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,773 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,773 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,773 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,773 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,773 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,773 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,773 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,773 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,773 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,773 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,773 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,773 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,773 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,774 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,774 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,774 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,775 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,775 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,775 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,775 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,775 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,775 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,775 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,775 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,775 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,775 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,775 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,775 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,775 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,775 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,775 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,775 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,776 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,776 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,777 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,778 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,778 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,778 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,778 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,778 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO -   learning_rate: 0.21063894305336445
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,778 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   n_estimators: 656
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   subsample: 0.822656444358238
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8094408985463093
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0005539202839193388
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO -   reg_lambda: 6.440889140440102e-06
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,779 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,782 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,782 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,782 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,782 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,782 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,782 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,782 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,783 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,783 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,789 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,789 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,789 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,789 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,789 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,789 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,789 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,789 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,789 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,790 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,790 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,790 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,790 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,790 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,790 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,791 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,791 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,791 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,791 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,791 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,791 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,791 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,791 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,791 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,791 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,791 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,791 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,791 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,791 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,791 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,791 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,791 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,791 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,791 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,791 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,791 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,794 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,794 - src.hyperparameter_tuning - ERROR - Trial 26 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,807 - src.hyperparameter_tuning - INFO - Trial 27: 모델 타입 = lightgbm
2025-06-24 09:42:48,811 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,811 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,811 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,811 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,811 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,811 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,811 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,811 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,811 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,812 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,812 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,812 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,812 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,812 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,812 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,812 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,812 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,812 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,813 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,813 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,813 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,813 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,813 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,813 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,813 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,813 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,813 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,813 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,817 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,819 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,819 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,819 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,819 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,819 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,819 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,819 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,821 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,823 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,823 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,823 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,823 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,823 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,823 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,823 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,823 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,823 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,823 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,824 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,824 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,824 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,824 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,824 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,824 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,824 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,824 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,824 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,824 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,825 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,825 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,825 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,825 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,825 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,825 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,825 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,825 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,825 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,825 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,825 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,825 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,826 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,826 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,827 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,827 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,828 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,828 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,828 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,828 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,828 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,828 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,828 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,828 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   learning_rate: 0.0804852149570703
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   n_estimators: 483
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   subsample: 0.6346522194487378
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9964125388085947
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   reg_alpha: 8.253969505781612e-08
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO -   reg_lambda: 1.119023035815797e-07
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,829 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,832 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,832 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,832 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,832 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,832 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,832 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,833 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,833 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,833 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,839 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,839 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,839 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,839 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,839 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,839 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,839 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,839 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,839 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,840 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,840 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,840 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,841 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,841 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,841 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,841 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,841 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,841 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,841 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,841 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,841 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,841 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,841 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,841 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,841 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,841 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,841 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,841 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,841 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,841 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,841 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,841 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,841 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,844 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,844 - src.hyperparameter_tuning - ERROR - Trial 27 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,857 - src.hyperparameter_tuning - INFO - Trial 28: 모델 타입 = lightgbm
2025-06-24 09:42:48,861 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,862 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,862 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,862 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,862 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,862 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,862 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,862 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,862 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,863 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,863 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,863 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,863 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,863 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,863 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,863 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,863 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,863 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,864 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,864 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,864 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,864 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,864 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,864 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,864 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,864 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,864 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,864 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,868 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,870 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,870 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,870 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,870 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,870 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,870 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,870 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,872 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,874 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,874 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,874 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,874 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,874 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,874 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,874 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,874 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,874 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,874 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,874 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,874 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,874 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,874 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,874 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,875 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,875 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,875 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,875 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,875 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,876 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,876 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,876 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,876 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,876 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,876 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,876 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,876 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,876 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,876 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,876 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,876 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,876 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,876 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,876 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,877 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,877 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,877 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,877 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,877 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,877 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,878 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,878 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,878 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,878 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,878 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,878 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,878 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,878 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,878 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,878 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,879 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,879 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,879 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,879 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,879 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,879 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,879 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,879 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,879 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   learning_rate: 0.12404094717085312
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   n_estimators: 782
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   subsample: 0.6724055367984789
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8740038680959015
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   reg_alpha: 1.0343558782044228e-06
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO -   reg_lambda: 0.33132712190213737
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,880 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,883 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,883 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,883 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,883 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,883 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,884 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,884 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,884 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,890 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,890 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,890 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,890 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,890 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,890 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,890 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,890 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,890 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,891 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,891 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,891 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,891 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,891 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,891 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,892 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,892 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,892 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,892 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,892 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,892 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,892 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,892 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,892 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,892 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,892 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,892 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,892 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,892 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,892 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,892 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,892 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,892 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,892 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,892 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,892 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,895 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,895 - src.hyperparameter_tuning - ERROR - Trial 28 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,908 - src.hyperparameter_tuning - INFO - Trial 29: 모델 타입 = lightgbm
2025-06-24 09:42:48,913 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,913 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,913 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,913 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,913 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,913 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,913 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,913 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,913 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,914 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,914 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,914 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,914 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,914 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,914 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,914 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,914 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,914 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,915 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,915 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,915 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,915 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,915 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,915 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,915 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,915 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,915 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,915 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,919 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,921 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,921 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,921 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,921 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,921 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,921 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,921 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,923 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,925 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,925 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,925 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,925 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,925 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,925 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,925 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,925 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,925 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,925 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,926 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,926 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,926 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,926 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,926 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,926 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,926 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,926 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,926 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,926 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,927 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,927 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,927 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,927 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,927 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,927 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,927 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,927 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,927 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,927 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,927 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,927 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,928 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,928 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,929 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,929 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,929 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,929 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,930 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,930 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,930 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,930 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,930 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   learning_rate: 0.021604981364913005
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   n_estimators: 515
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   subsample: 0.7969902083314745
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7309448291222742
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   reg_alpha: 4.867051057937844e-08
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO -   reg_lambda: 3.374072614356822e-07
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,931 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,934 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,934 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,934 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,934 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,934 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,934 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,934 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,934 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,935 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,935 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,935 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,936 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,941 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,941 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,941 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,941 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,941 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,941 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,941 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,941 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,941 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,942 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,942 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,942 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,942 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,942 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,942 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,943 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,943 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,943 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,943 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,943 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,943 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,943 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,943 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,943 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,943 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,943 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,943 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,943 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,943 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,943 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,943 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,943 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,943 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,943 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,943 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,943 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,946 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,946 - src.hyperparameter_tuning - ERROR - Trial 29 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:48,959 - src.hyperparameter_tuning - INFO - Trial 30: 모델 타입 = lightgbm
2025-06-24 09:42:48,963 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:48,963 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:48,963 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:48,963 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:48,963 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:48,963 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:48,963 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:48,963 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:48,963 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:48,964 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:48,964 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:48,964 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:48,964 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:48,964 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:48,964 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:48,964 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:48,964 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:48,964 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:48,965 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,965 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,965 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:48,965 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:48,965 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,965 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:48,965 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:48,965 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:48,965 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:48,965 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:48,969 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:48,971 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,971 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:48,971 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:48,971 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:48,971 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:48,971 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:48,971 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:48,973 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:48,975 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:48,975 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,975 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,975 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:48,975 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:48,975 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,975 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:48,975 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:48,975 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,975 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,975 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:48,975 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:48,975 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,975 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,975 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:48,975 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:48,975 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,976 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,976 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:48,976 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:48,977 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:48,977 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:48,977 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:48,977 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:48,977 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:48,977 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:48,977 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:48,977 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:48,977 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,977 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:48,977 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:48,977 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:48,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:48,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,978 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,978 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:48,978 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:48,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,979 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,980 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,980 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,980 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:48,980 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,980 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:48,980 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,980 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:48,980 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:48,980 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:48,980 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:48,980 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   learning_rate: 0.04035286091031472
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   n_estimators: 457
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   subsample: 0.8044792631641183
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8696839799381978
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   reg_alpha: 2.938419320810259e-06
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO -   reg_lambda: 1.474108753561657e-08
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:48,981 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:48,984 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:48,984 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:48,984 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:48,984 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:48,984 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:48,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:48,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:48,984 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:48,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:48,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:48,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:48,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:48,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:48,985 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:48,985 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:48,991 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:48,991 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:48,991 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:48,991 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:48,991 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,991 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,991 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:48,991 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:48,992 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:48,992 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:48,992 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:48,992 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:48,992 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,992 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,992 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,993 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:48,993 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:48,993 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:48,993 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:48,993 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:48,993 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:48,993 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:48,993 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:48,993 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:48,993 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:48,993 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:48,993 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:48,993 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:48,993 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:48,993 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:48,993 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:48,993 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:48,993 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,993 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,993 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:48,993 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:48,996 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:48,996 - src.hyperparameter_tuning - ERROR - Trial 30 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,009 - src.hyperparameter_tuning - INFO - Trial 31: 모델 타입 = lightgbm
2025-06-24 09:42:49,013 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,014 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,014 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,014 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,014 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,014 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,014 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,014 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,014 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,015 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,015 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,015 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,015 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,015 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,015 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,015 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,015 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,015 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,016 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,016 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,016 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,016 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,016 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,016 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,016 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,016 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,016 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,016 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,020 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,022 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,022 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,022 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,022 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,022 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,022 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,022 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,024 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,026 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,026 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,026 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,026 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,026 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,026 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,026 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,026 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,026 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,026 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,026 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,026 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,026 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,026 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,026 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,026 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,026 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,027 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,027 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,027 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,028 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,028 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,028 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,028 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,028 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,028 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,028 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,028 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,028 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,028 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,028 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,028 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,028 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,029 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,029 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,030 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,031 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,031 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   learning_rate: 0.013637410036364993
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,031 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   n_estimators: 358
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   subsample: 0.8349337395484048
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.831861212497879
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   reg_alpha: 0.001834620070516215
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO -   reg_lambda: 6.362585398085402e-07
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,032 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,038 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,038 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,038 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,039 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,039 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,039 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,039 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,039 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,039 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,039 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,039 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,039 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,040 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,040 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,040 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,040 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,040 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,040 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,040 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,040 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,040 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,040 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,040 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,040 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,041 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,041 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,041 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,041 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,041 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,041 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,041 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,042 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,042 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,042 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,042 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,042 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,042 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,042 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,042 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,042 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,042 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,042 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,042 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,042 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,042 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,042 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,042 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,042 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,042 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,042 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,042 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,042 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,045 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,045 - src.hyperparameter_tuning - ERROR - Trial 31 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,058 - src.hyperparameter_tuning - INFO - Trial 32: 모델 타입 = lightgbm
2025-06-24 09:42:49,062 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,063 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,063 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,063 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,063 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,063 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,063 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,063 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,063 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,063 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,063 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,063 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,063 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,063 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,063 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,063 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,064 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,064 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,064 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,064 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,065 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,065 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,065 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,065 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,065 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,065 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,065 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,065 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,068 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,070 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,070 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,070 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,070 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,070 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,071 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,071 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,072 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,074 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,074 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,074 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,074 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,074 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,074 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,074 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,074 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,074 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,074 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,075 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,075 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,075 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,075 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,075 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,075 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,075 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,076 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,076 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,076 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,076 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,077 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,077 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,077 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,077 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,077 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,077 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,077 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,077 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,077 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,077 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,077 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,077 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,077 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,077 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,078 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,078 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,079 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,079 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,079 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,080 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   learning_rate: 0.010358238324974577
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   n_estimators: 269
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   subsample: 0.9392065580983905
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7242608165537173
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   reg_alpha: 0.07671535159777253
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO -   reg_lambda: 9.281031668514603e-05
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,080 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,083 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,083 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,083 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,083 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,083 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,084 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,084 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,084 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,084 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,084 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,084 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,084 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,084 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,085 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,085 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,085 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,085 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,085 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,085 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,085 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,085 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,085 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,085 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,085 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,085 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,085 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,086 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,086 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,086 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,086 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,086 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,087 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,087 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,087 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,087 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,087 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,087 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,087 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,087 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,087 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,087 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,087 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,087 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,087 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,087 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,087 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,087 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,087 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,087 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,087 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,089 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,089 - src.hyperparameter_tuning - ERROR - Trial 32 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,103 - src.hyperparameter_tuning - INFO - Trial 33: 모델 타입 = lightgbm
2025-06-24 09:42:49,106 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,107 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,107 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,107 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,107 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,107 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,107 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,107 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,107 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,108 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,108 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,108 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,108 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,108 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,108 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,108 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,108 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,108 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,109 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,109 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,109 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,109 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,109 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,109 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,109 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,109 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,109 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,109 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,112 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,114 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,114 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,114 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,115 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,115 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,115 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,115 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,116 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,118 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,118 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,118 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,118 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,118 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,118 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,118 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,118 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,118 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,119 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,119 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,119 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,119 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,119 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,119 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,119 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,119 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,120 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,120 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,120 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,121 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,121 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,121 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,121 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,121 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,121 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,121 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,121 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,121 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,121 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,121 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,121 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,121 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,122 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,122 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,123 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,123 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,123 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   learning_rate: 0.018528024944816653
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   n_estimators: 585
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   subsample: 0.7403423161145642
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.694494095260054
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   reg_alpha: 0.009311170494905974
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO -   reg_lambda: 1.439483740775924e-07
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,124 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,127 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,127 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,127 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,127 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,127 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,127 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,127 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,127 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,128 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,128 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,128 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,128 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,128 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,128 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,128 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,128 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,129 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,134 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,134 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,134 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,134 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,134 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,134 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,134 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,134 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,134 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,135 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,135 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,135 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,135 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,135 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,135 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,136 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,136 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,136 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,136 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,136 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,136 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,136 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,136 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,136 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,136 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,136 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,136 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,136 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,136 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,136 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,136 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,136 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,136 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,136 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,136 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,136 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,139 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,139 - src.hyperparameter_tuning - ERROR - Trial 33 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,152 - src.hyperparameter_tuning - INFO - Trial 34: 모델 타입 = lightgbm
2025-06-24 09:42:49,156 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,157 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,157 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,157 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,157 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,157 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,157 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,157 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,157 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,157 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,158 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,158 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,158 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,158 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,158 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,158 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,158 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,158 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,159 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,159 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,159 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,159 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,159 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,159 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,159 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,159 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,159 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,159 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,162 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,164 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,164 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,164 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,164 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,164 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,164 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,164 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,166 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,168 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,168 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,168 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,168 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,168 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,168 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,168 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,168 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,168 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,168 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,169 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,169 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,169 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,169 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,169 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,169 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,169 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,170 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,170 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,170 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,170 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,170 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,170 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,170 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,170 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,170 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,170 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,171 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,171 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,171 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,171 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,171 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,171 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,171 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,171 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,171 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,172 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,172 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,172 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,172 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,172 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,173 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,173 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,173 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,173 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,173 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,173 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,173 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   learning_rate: 0.012603140096888722
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   n_estimators: 537
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   subsample: 0.887059385340847
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.814690263795279
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0007257356330429975
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0006511272157627004
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,174 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,177 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,177 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,177 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,177 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,177 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,177 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,177 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,177 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,178 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,178 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,178 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,178 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,184 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,184 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,184 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,184 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,184 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,184 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,184 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,184 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,184 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,185 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,185 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,185 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,185 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,185 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,185 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,186 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,186 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,186 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,186 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,186 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,186 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,186 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,186 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,186 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,186 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,186 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,186 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,186 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,186 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,186 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,186 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,186 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,186 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,186 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,186 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,186 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,189 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,189 - src.hyperparameter_tuning - ERROR - Trial 34 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,203 - src.hyperparameter_tuning - INFO - Trial 35: 모델 타입 = lightgbm
2025-06-24 09:42:49,206 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,207 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,207 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,207 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,207 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,207 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,207 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,207 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,207 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,208 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,208 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,208 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,208 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,208 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,208 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,208 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,208 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,208 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,209 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,209 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,209 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,209 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,209 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,209 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,209 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,209 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,209 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,209 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,213 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,215 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,215 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,215 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,215 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,215 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,215 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,215 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,217 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,219 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,219 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,219 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,219 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,219 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,219 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,219 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,219 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,219 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,219 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,219 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,219 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,219 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,219 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,219 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,219 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,219 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,220 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,220 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,220 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,221 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,221 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,221 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,221 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,221 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,221 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,221 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,221 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,221 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,221 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,221 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,221 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,221 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,221 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,221 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,221 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,222 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,222 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,222 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,222 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,222 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,222 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,222 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,222 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,223 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,224 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,224 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   learning_rate: 0.010078636987766579
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,224 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   n_estimators: 207
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   subsample: 0.9593052727074797
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9586658642491094
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   reg_alpha: 4.2693203841762886e-05
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO -   reg_lambda: 2.556230835595068e-05
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,225 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,228 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,228 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,228 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,228 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,228 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,228 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,228 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,229 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,229 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,230 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,230 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,230 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,236 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,236 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,236 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,236 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,236 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,236 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,236 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,236 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,236 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,236 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,237 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,237 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,237 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,237 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,237 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,238 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,238 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,238 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,238 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,238 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,238 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,238 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,238 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,238 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,238 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,238 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,238 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,238 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,238 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,238 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,238 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,238 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,238 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,238 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,238 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,238 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,241 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,241 - src.hyperparameter_tuning - ERROR - Trial 35 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,255 - src.hyperparameter_tuning - INFO - Trial 36: 모델 타입 = lightgbm
2025-06-24 09:42:49,258 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,259 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,259 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,259 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,259 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,259 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,259 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,259 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,259 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,260 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,260 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,260 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,260 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,260 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,260 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,260 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,260 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,260 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,261 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,261 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,261 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,261 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,261 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,261 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,261 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,261 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,261 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,261 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,265 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,267 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,267 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,267 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,267 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,267 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,267 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,267 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,269 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,271 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,271 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,271 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,271 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,271 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,271 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,271 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,271 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,271 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,271 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,272 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,272 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,272 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,272 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,272 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,272 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,272 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,272 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,272 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,272 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,273 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,273 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,273 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,273 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,273 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,273 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,273 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,273 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,273 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,273 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,273 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,273 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,273 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,273 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,273 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,274 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,275 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,275 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,275 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,275 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,275 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,275 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,275 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,275 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,275 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,275 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,276 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,276 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,276 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,276 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,276 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,276 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,276 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,276 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,276 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,276 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,276 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   learning_rate: 0.02487519724197392
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   n_estimators: 638
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   subsample: 0.7985560215507382
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7512759811523114
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   reg_alpha: 0.024900590270190155
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO -   reg_lambda: 1.8961556446893008e-06
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,277 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,280 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,280 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,280 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,280 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,280 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,280 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,281 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,281 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,281 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,281 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,281 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,282 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,282 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,282 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,284 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,284 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,284 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,284 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,284 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,284 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,284 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,284 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,284 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,284 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,284 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,284 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,284 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,285 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,285 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,285 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,285 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,285 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,285 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,285 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,285 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,285 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,285 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,285 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,285 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,285 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,286 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,286 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,286 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,286 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,286 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,286 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,286 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,286 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,286 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,286 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,288 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,288 - src.hyperparameter_tuning - ERROR - Trial 36 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,302 - src.hyperparameter_tuning - INFO - Trial 37: 모델 타입 = lightgbm
2025-06-24 09:42:49,306 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,306 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,306 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,306 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,306 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,306 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,306 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,306 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,307 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,307 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,307 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,307 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,307 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,307 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,307 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,307 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,307 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,307 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,308 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,308 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,308 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,308 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,308 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,308 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,308 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,308 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,308 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,308 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,312 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,314 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,314 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,314 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,314 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,314 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,314 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,314 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,316 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,318 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,318 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,318 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,318 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,318 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,318 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,318 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,318 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,318 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,318 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,319 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,319 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,319 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,319 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,319 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,319 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,319 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,319 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,319 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,319 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,320 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,320 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,320 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,320 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,320 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,320 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,320 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,320 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,320 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,320 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,320 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,320 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,320 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,320 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,320 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,321 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,321 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,321 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,321 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,321 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,321 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,321 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,321 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,322 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,322 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,322 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,322 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,323 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,323 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,323 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,323 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,323 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,323 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,323 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,323 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,323 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,323 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,323 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   learning_rate: 0.01569833488957703
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   n_estimators: 283
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   subsample: 0.7125680491414248
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.784145332591274
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   reg_alpha: 0.766447656094571
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO -   reg_lambda: 6.133310095468243e-06
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,324 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,327 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,327 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,327 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,327 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,327 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,327 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,327 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,327 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,327 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,327 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,328 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,328 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,328 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,331 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,331 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,331 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,331 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,331 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,331 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,331 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,331 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,331 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,332 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,332 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,332 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,332 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,332 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,332 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,333 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,333 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,333 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,333 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,333 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,333 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,333 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,333 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,333 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,333 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,333 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,333 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,333 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,333 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,333 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,333 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,333 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,333 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,333 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,333 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,333 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,336 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,336 - src.hyperparameter_tuning - ERROR - Trial 37 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,349 - src.hyperparameter_tuning - INFO - Trial 38: 모델 타입 = lightgbm
2025-06-24 09:42:49,353 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,354 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,354 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,354 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,354 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,354 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,354 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,354 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,354 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,355 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,355 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,355 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,355 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,355 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,355 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,355 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,355 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,355 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,356 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,356 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,356 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,356 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,356 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,356 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,356 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,356 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,356 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,356 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,360 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,362 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,362 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,362 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,362 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,362 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,362 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,362 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,364 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,366 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,366 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,366 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,366 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,366 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,366 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,366 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,366 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,366 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,366 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,366 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,366 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,366 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,366 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,366 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,366 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,366 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,367 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,367 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,367 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,368 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,368 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,368 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,368 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,368 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,368 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,368 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,368 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,368 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,368 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,368 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,368 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,369 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,369 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,369 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,370 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,371 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,371 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,371 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,371 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,371 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,371 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   learning_rate: 0.032767807118294565
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   n_estimators: 150
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   subsample: 0.9178842372107386
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8277442294773829
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0037264473202334634
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO -   reg_lambda: 4.218833317145971e-08
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,372 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,375 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,375 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,375 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,375 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,375 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,375 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,375 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,376 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,376 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,377 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,377 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,377 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,377 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,377 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,377 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,377 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,377 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,377 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,378 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,378 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,378 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,378 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,378 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,378 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,379 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,379 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,379 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,379 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,379 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,379 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,379 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,379 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,379 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,379 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,379 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,379 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,379 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,379 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,379 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,379 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,379 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,379 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,379 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,379 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,379 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,382 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,382 - src.hyperparameter_tuning - ERROR - Trial 38 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,395 - src.hyperparameter_tuning - INFO - Trial 39: 모델 타입 = lightgbm
2025-06-24 09:42:49,399 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,400 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,400 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,400 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,400 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,400 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,400 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,400 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,400 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,401 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,401 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,401 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,401 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,401 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,401 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,401 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,401 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,401 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,402 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,402 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,402 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,402 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,402 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,402 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,402 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,402 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,402 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,402 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,405 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,407 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,407 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,407 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,407 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,407 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,407 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,407 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,409 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,411 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,411 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,412 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,412 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,412 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,412 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,412 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,412 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,412 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,412 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,412 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,412 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,412 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,412 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,412 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,412 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,412 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,413 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,413 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,413 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,414 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,414 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,414 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,414 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,414 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,414 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,414 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,414 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,414 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,414 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,414 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,414 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,414 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,415 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,415 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,416 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,416 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,416 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,416 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,416 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,416 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,417 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,417 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   learning_rate: 0.246113868759451
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:42:49,417 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,418 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,418 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,418 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,418 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,418 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,418 - src.models.lightgbm_model - INFO -   n_estimators: 376
2025-06-24 09:42:49,418 - src.models.lightgbm_model - INFO -   subsample: 0.7569340813632006
2025-06-24 09:42:49,418 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9165276790317524
2025-06-24 09:42:49,418 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:49,418 - src.models.lightgbm_model - INFO -   reg_alpha: 3.2547826967952095e-07
2025-06-24 09:42:49,418 - src.models.lightgbm_model - INFO -   reg_lambda: 9.914717715029425
2025-06-24 09:42:49,418 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,418 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,418 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,424 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,425 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,425 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,425 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,425 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,425 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,426 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,426 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,426 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,426 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,426 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,426 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,426 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,426 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,426 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,426 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,426 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,426 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,427 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,427 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,427 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,427 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,427 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,427 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,427 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,428 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,428 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,428 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,428 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,428 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,428 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,428 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,428 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,428 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,428 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,428 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,428 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,428 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,428 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,428 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,428 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,428 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,428 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,428 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,428 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,428 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,431 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,431 - src.hyperparameter_tuning - ERROR - Trial 39 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,445 - src.hyperparameter_tuning - INFO - Trial 40: 모델 타입 = lightgbm
2025-06-24 09:42:49,449 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,450 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,450 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,450 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,450 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,450 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,450 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,450 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,450 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,451 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,451 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,451 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,451 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,451 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,451 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,451 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,451 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,451 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,452 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,452 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,452 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,452 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,452 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,452 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,452 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,452 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,452 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,452 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,456 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,458 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,458 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,458 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,458 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,458 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,458 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,458 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,460 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,462 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,462 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,462 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,462 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,462 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,462 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,462 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,462 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,462 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,462 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,463 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,463 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,463 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,463 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,463 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,463 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,463 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,464 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,464 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,464 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,464 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,465 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,465 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,465 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,465 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,465 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,465 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,465 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,465 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,465 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,465 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,465 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,465 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,466 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,466 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,467 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,467 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,467 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,468 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,468 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,468 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,468 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,468 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,468 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   learning_rate: 0.2986164631467998
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   n_estimators: 446
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   subsample: 0.8551720469993793
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6327085885569078
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   reg_alpha: 7.703681668328675e-06
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO -   reg_lambda: 6.634521545517012e-07
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,469 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,473 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,473 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,473 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,473 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,473 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,474 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,474 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,474 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,475 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,475 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,475 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,475 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,475 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,475 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,475 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,475 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,475 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,476 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,476 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,476 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,476 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,476 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,476 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,477 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,477 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,477 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,477 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,477 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,477 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,477 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,477 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,477 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,477 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,477 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,477 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,477 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,477 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,477 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,477 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,477 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,477 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,477 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,477 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,477 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,477 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,480 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,480 - src.hyperparameter_tuning - ERROR - Trial 40 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,497 - src.hyperparameter_tuning - INFO - Trial 41: 모델 타입 = lightgbm
2025-06-24 09:42:49,501 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,502 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,502 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,502 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,502 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,502 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,502 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,502 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,502 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,503 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,503 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,503 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,503 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,503 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,503 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,503 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,503 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,503 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,504 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,504 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,504 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,504 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,504 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,504 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,504 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,504 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,504 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,504 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,508 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,510 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,510 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,510 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,510 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,510 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,510 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,510 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,512 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,514 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,514 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,514 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,514 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,514 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,514 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,514 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,515 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,515 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,515 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,515 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,515 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,515 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,515 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,515 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,515 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,515 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,516 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,516 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,516 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,517 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,517 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,517 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,517 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,517 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,517 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,517 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,517 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,517 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,517 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,517 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,517 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,517 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,518 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,518 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,519 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,519 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,519 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,519 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,519 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,519 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,519 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,519 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,520 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,520 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,520 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,520 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,520 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,520 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,520 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,520 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,520 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,520 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   learning_rate: 0.09793882584456802
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   n_estimators: 123
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   subsample: 0.9640586492533287
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6435146090531931
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   reg_alpha: 0.012306593994534086
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0003273769666730943
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,521 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,524 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,524 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,524 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,524 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,524 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,524 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,524 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,524 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,524 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,525 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,525 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,529 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,529 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,529 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,529 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,529 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,529 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,529 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,529 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,529 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,529 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,529 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,529 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,529 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,530 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,530 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,530 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,530 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,530 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,530 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,530 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,530 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,530 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,530 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,530 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,530 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,530 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,530 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,530 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,530 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,530 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,530 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,530 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,531 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,531 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,531 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,531 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,533 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,533 - src.hyperparameter_tuning - ERROR - Trial 41 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,548 - src.hyperparameter_tuning - INFO - Trial 42: 모델 타입 = lightgbm
2025-06-24 09:42:49,552 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,553 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,553 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,553 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,553 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,553 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,553 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,553 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,553 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,553 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,553 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,553 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,553 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,553 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,553 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,553 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,553 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,553 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,554 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,554 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,554 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,554 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,554 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,555 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,555 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,555 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,555 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,555 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,558 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,560 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,560 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,560 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,560 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,560 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,560 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,560 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,562 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,564 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,564 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,564 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,564 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,565 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,565 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,565 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,565 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,565 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,565 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,565 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,565 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,565 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,565 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,565 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,565 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,565 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,566 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,566 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,566 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,567 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,567 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,567 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,567 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,567 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,567 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,567 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,567 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,567 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,567 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,567 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,567 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,567 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,567 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,567 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,567 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,568 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,568 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,568 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,568 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,568 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,568 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,568 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,569 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,570 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,570 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,570 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,570 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,570 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,570 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,570 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,570 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   learning_rate: 0.13733093633534701
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   n_estimators: 87
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   subsample: 0.8965101815345152
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6091730541587009
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   reg_alpha: 0.4907237459022601
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO -   reg_lambda: 6.576001803087445e-05
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,571 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,574 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,574 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,574 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,574 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,574 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,574 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,575 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,575 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,575 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,581 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,581 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,581 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,581 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,581 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,581 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,581 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,581 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,581 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,581 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,582 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,582 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,582 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,582 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,582 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,583 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,583 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,583 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,583 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,583 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,583 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,583 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,583 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,583 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,583 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,583 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,583 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,583 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,583 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,583 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,583 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,583 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,583 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,583 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,583 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,583 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,585 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,585 - src.hyperparameter_tuning - ERROR - Trial 42 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,600 - src.hyperparameter_tuning - INFO - Trial 43: 모델 타입 = lightgbm
2025-06-24 09:42:49,604 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,604 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,604 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,605 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,605 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,605 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,605 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,605 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,605 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,605 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,605 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,605 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,605 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,605 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,605 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,605 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,605 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,605 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,606 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,606 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,606 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,606 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,606 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,606 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,606 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,606 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,606 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,606 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,610 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,612 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,612 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,612 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,612 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,612 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,612 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,612 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,614 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,616 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,616 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,616 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,616 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,616 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,616 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,616 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,616 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,616 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,616 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,617 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,617 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,617 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,617 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,617 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,617 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,617 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,618 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,618 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,618 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,619 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,619 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,619 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,619 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,619 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,619 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,619 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,619 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,619 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,619 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,619 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,619 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,619 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,620 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,620 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,620 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,620 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,620 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,620 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,621 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,621 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,622 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,622 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO -   learning_rate: 0.21326734344408033
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,622 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   n_estimators: 539
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   subsample: 0.9673242456454179
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7044942853722713
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   reg_alpha: 0.059174749853088904
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO -   reg_lambda: 0.02588182777279751
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,623 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,633 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,633 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,633 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,633 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,633 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,633 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,633 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,633 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,634 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,634 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,634 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,635 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,638 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,638 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,638 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,638 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,638 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,638 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,638 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,638 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,638 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,638 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,639 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,639 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,639 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,639 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,639 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,640 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,640 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,640 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,640 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,640 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,640 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,640 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,640 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,640 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,640 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,640 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,640 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,640 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,640 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,640 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,640 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,640 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,640 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,640 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,640 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,640 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,642 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,642 - src.hyperparameter_tuning - ERROR - Trial 43 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,657 - src.hyperparameter_tuning - INFO - Trial 44: 모델 타입 = lightgbm
2025-06-24 09:42:49,661 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,662 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,662 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,662 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,662 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,662 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,662 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,662 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,662 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,662 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,662 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,662 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,662 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,663 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,663 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,663 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,663 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,663 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,664 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,664 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,664 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,664 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,664 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,664 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,664 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,664 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,664 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,664 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,667 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,669 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,669 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,669 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,669 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,669 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,669 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,669 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,672 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,673 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,673 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,673 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,673 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,674 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,674 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,674 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,674 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,674 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,674 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,674 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,674 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,674 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,674 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,674 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,674 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,674 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,675 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,675 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,675 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,676 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,676 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,676 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,676 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,676 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,676 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,676 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,676 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,676 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,676 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,676 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,676 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,676 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,678 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,678 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,678 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,678 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,678 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,678 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,679 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,679 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,679 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,679 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,679 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,679 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,679 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,679 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,679 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,679 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   learning_rate: 0.05625048885017797
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   n_estimators: 651
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   subsample: 0.9936644823981703
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6776465721915215
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00018101280841052082
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO -   reg_lambda: 2.2021620859017483
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,680 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,682 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,682 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,682 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,682 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,682 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,683 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,683 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,684 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,684 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,684 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,684 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,684 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,684 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,684 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,684 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,684 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,684 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,684 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,684 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,685 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,685 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,685 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,685 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,685 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,685 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,686 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,686 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,686 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,686 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,686 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,686 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,686 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,686 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,686 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,686 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,686 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,686 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,686 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,686 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,686 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,686 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,686 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,686 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,686 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,686 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,686 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,689 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,689 - src.hyperparameter_tuning - ERROR - Trial 44 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,704 - src.hyperparameter_tuning - INFO - Trial 45: 모델 타입 = lightgbm
2025-06-24 09:42:49,708 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,708 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,708 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,708 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,708 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,708 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,708 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,708 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,709 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,709 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,709 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,709 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,709 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,709 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,709 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,709 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,709 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,709 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,710 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,710 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,710 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,710 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,710 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,710 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,710 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,710 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,710 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,710 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,714 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,716 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,716 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,716 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,716 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,716 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,716 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,716 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,719 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,721 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,721 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,721 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,721 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,721 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,721 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,721 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,721 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,721 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,721 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,721 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,721 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,721 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,721 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,722 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,722 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,722 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,722 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,722 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,722 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,723 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,723 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,723 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,723 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,723 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,723 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,723 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,723 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,723 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,723 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,723 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,723 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,724 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,725 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,725 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,725 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,726 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,726 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,726 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,726 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,726 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,726 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,726 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   learning_rate: 0.08474924091905767
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   n_estimators: 179
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   subsample: 0.9332399755244474
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6557272282328251
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0012292771784949972
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0023872846722201887
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,727 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,729 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,729 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,729 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,729 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,729 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,730 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,731 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,731 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,731 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,737 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,737 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,737 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,737 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,737 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,737 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,737 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,737 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,737 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,738 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,738 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,738 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,738 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,738 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,738 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,739 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,739 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,739 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,739 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,739 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,739 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,739 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,739 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,739 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,739 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,739 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,739 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,739 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,739 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,739 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,739 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,739 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,739 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,739 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,739 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,739 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,742 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,742 - src.hyperparameter_tuning - ERROR - Trial 45 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,757 - src.hyperparameter_tuning - INFO - Trial 46: 모델 타입 = lightgbm
2025-06-24 09:42:49,760 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,761 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,761 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,761 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,761 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,761 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,761 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,761 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,761 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,762 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,762 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,762 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,762 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,762 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,762 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,762 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,762 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,762 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,763 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,763 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,763 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,763 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,763 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,763 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,763 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,763 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,763 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,763 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,767 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,769 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,769 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,769 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,769 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,769 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,769 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,769 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,771 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,773 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,773 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,773 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,773 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,773 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,773 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,773 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,773 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,773 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,773 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,774 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,774 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,774 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,774 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,774 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,774 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,774 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,774 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,774 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,774 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,775 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,775 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,775 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,775 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,775 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,775 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,775 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,775 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,775 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,775 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,775 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,775 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,775 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,775 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,776 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,776 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,777 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,777 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,777 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,778 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,778 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,778 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,778 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,778 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,778 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,778 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   learning_rate: 0.012214781803232549
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:42:49,779 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,780 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,780 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,780 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,780 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,780 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,780 - src.models.lightgbm_model - INFO -   n_estimators: 319
2025-06-24 09:42:49,780 - src.models.lightgbm_model - INFO -   subsample: 0.9011353546076427
2025-06-24 09:42:49,780 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8923112812273108
2025-06-24 09:42:49,780 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:49,780 - src.models.lightgbm_model - INFO -   reg_alpha: 1.819220639207179e-07
2025-06-24 09:42:49,780 - src.models.lightgbm_model - INFO -   reg_lambda: 1.5563198677214068e-05
2025-06-24 09:42:49,780 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,780 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,780 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,782 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,782 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,782 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,782 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,782 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,782 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,783 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,783 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,789 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,789 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,789 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,789 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,789 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,789 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,789 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,789 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,789 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,790 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,790 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,790 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,790 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,790 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,790 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,791 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,791 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,791 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,791 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,791 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,791 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,791 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,791 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,791 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,791 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,791 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,791 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,791 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,791 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,791 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,791 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,791 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,791 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,791 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,791 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,791 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,793 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,794 - src.hyperparameter_tuning - ERROR - Trial 46 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,809 - src.hyperparameter_tuning - INFO - Trial 47: 모델 타입 = lightgbm
2025-06-24 09:42:49,813 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,813 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,813 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,813 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,813 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,813 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,814 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,814 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,814 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,814 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,814 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,814 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,814 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,814 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,814 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,814 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,814 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,814 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,815 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,815 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,815 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,815 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,815 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,815 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,815 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,815 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,815 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,815 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,819 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,821 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,821 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,821 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,821 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,821 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,821 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,821 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,823 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,825 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,825 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,825 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,825 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,825 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,825 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,825 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,825 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,825 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,826 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,826 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,826 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,826 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,826 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,826 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,826 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,826 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,827 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,827 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,827 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,828 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,828 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,828 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,828 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,828 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,828 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,828 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,828 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,828 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,828 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,828 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,828 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,828 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,828 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,828 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,828 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,829 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,829 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,830 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,830 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,830 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,831 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,831 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,831 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,831 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,831 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,831 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,831 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,831 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   learning_rate: 0.03507645979363265
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   n_estimators: 761
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   subsample: 0.9824694942087706
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7417033228523667
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   reg_alpha: 0.004366446105347352
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO -   reg_lambda: 2.675638978946855e-07
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,832 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,834 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,834 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,834 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,834 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,834 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,834 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,834 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,835 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,835 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,836 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,836 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,836 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,836 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,840 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,840 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,840 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,840 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,840 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,840 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,840 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,841 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,841 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,841 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,841 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,841 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,842 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,842 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,842 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,842 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,842 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,842 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,842 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,842 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,842 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,842 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,842 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,842 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,842 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,842 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,842 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,842 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,842 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,842 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,842 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,842 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,845 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,845 - src.hyperparameter_tuning - ERROR - Trial 47 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,860 - src.hyperparameter_tuning - INFO - Trial 48: 모델 타입 = lightgbm
2025-06-24 09:42:49,863 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,864 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,864 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,864 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,864 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,864 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,864 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,864 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,864 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,865 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,865 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,865 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,865 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,865 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,865 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,865 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,865 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,865 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,866 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,866 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,866 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,866 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,866 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,866 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,866 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,866 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,866 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,866 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,870 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,872 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,872 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,872 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,872 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,872 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,872 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,872 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,874 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,876 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,876 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,876 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,876 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,876 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,876 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,876 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,876 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,876 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,876 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,877 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,877 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,877 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,877 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,877 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,877 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,877 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,877 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,877 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,877 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,878 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,878 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,878 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,878 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,878 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,878 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,878 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,878 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,878 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,878 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,878 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,878 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,878 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,878 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,879 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,879 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,879 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,879 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,880 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,880 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,881 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,881 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,881 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   learning_rate: 0.06459184368410763
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,882 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,883 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,883 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,883 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,883 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,883 - src.models.lightgbm_model - INFO -   n_estimators: 384
2025-06-24 09:42:49,883 - src.models.lightgbm_model - INFO -   subsample: 0.8774992037260307
2025-06-24 09:42:49,883 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.702163125786101
2025-06-24 09:42:49,883 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:42:49,883 - src.models.lightgbm_model - INFO -   reg_alpha: 2.160303535766916e-08
2025-06-24 09:42:49,883 - src.models.lightgbm_model - INFO -   reg_lambda: 1.1500879799835756e-06
2025-06-24 09:42:49,883 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,883 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,883 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,885 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,885 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,885 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,885 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,885 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,886 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,886 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,886 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,886 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,886 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,886 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,886 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,886 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,887 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,892 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,892 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,892 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,892 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,892 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,892 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,892 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,892 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,892 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,893 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,893 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,893 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,893 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,893 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,893 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,894 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,894 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,894 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,894 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,894 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,894 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,894 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,894 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,894 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,894 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,894 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,894 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,894 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,894 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,894 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,894 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,894 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,894 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,894 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,894 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,894 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,897 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,897 - src.hyperparameter_tuning - ERROR - Trial 48 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,913 - src.hyperparameter_tuning - INFO - Trial 49: 모델 타입 = lightgbm
2025-06-24 09:42:49,916 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,917 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,917 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,917 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,917 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,917 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,917 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,917 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,917 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,917 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,917 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,917 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,918 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,918 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,918 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,918 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,918 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,918 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,919 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,919 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,919 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,919 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,919 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,919 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,919 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,919 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,919 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,919 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,922 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,924 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,924 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,924 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,924 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,924 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,924 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,925 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,927 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,928 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,928 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,929 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,929 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,929 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,929 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,929 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,929 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,929 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,929 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,929 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,929 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,929 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,929 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,929 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,929 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,929 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,930 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,930 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,930 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,931 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,931 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,931 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,931 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,931 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,931 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,931 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,931 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,931 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,931 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,931 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,931 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,931 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,931 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,931 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,932 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,933 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,933 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,933 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,933 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,933 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,933 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,933 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,933 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,934 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,934 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,934 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,934 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,934 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,934 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,934 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,935 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,935 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,935 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,935 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,935 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,935 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,935 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,935 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,935 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,935 - src.models.lightgbm_model - INFO -   learning_rate: 0.10017283165371263
2025-06-24 09:42:49,935 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,935 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,935 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   n_estimators: 73
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   subsample: 0.8373072645672719
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8564848185348581
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   reg_alpha: 6.266565809920671
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO -   reg_lambda: 0.2714317924622672
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,936 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,938 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,938 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,938 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,938 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,938 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,939 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,940 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,940 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,940 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,940 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,943 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,943 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,943 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,943 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,943 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,943 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,943 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,943 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,943 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,943 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,943 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,943 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,943 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,944 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,944 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,944 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,944 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,944 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,944 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,944 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,944 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,944 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,944 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,944 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,944 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,945 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,945 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,945 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,945 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,945 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,945 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,945 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,945 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,945 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,945 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,945 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,947 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:49,947 - src.hyperparameter_tuning - ERROR - Trial 49 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:49,963 - src.hyperparameter_tuning - INFO - Trial 50: 모델 타입 = lightgbm
2025-06-24 09:42:49,966 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:49,967 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:49,967 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:49,967 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:49,967 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:49,967 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:49,967 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:49,967 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:49,967 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:49,968 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:49,968 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:49,968 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:49,968 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:49,968 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:49,968 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:49,968 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:49,968 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:49,968 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:49,969 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,969 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,969 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:49,969 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:49,969 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,969 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:49,969 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:49,969 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:49,969 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:49,969 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:49,972 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:49,974 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,974 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:49,974 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:49,975 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:49,975 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:49,975 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:49,975 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:49,977 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:49,978 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:49,979 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,979 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,979 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:49,979 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:49,979 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,979 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:49,979 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:49,979 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,979 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,979 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:49,979 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:49,979 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,979 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,979 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:49,979 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:49,979 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,980 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,980 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:49,980 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:49,981 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:49,981 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:49,981 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:49,981 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:49,981 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:49,981 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:49,981 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:49,981 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:49,981 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,981 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:49,981 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:49,981 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:49,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:49,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,982 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,982 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,982 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,982 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,982 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,982 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,982 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:49,983 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:49,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,983 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,984 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,984 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:49,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,984 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:49,984 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,984 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   learning_rate: 0.19354396033060667
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   n_estimators: 461
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   subsample: 0.8193951276727495
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7785557445809279
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00027869312762492945
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00013688798527848386
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:49,985 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:49,995 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:49,995 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:49,995 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:49,995 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:49,996 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:49,996 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:49,996 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,996 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:49,996 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:49,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:49,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:49,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:49,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:49,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:49,997 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:49,997 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:49,997 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:49,997 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:49,997 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:49,997 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:49,997 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,997 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,997 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:49,998 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:49,998 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:49,998 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:49,998 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:49,998 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:49,998 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,998 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,999 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,999 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:49,999 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:49,999 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:49,999 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:49,999 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:49,999 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:49,999 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:49,999 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:49,999 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:49,999 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:49,999 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:49,999 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:49,999 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:49,999 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:49,999 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:49,999 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:49,999 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:49,999 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,999 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:49,999 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:49,999 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,002 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,002 - src.hyperparameter_tuning - ERROR - Trial 50 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,018 - src.hyperparameter_tuning - INFO - Trial 51: 모델 타입 = lightgbm
2025-06-24 09:42:50,021 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,022 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,022 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,022 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,022 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,022 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,022 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,022 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,022 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,023 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,023 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,023 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,023 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,023 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,023 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,023 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,023 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,023 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,024 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,024 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,024 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,024 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,024 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,024 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,024 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,024 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,024 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,024 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,028 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,030 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,030 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,030 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,030 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,030 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,030 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,030 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,032 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,034 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,034 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,034 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,034 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,034 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,034 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,034 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,034 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,034 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,034 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,035 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,035 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,035 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,035 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,035 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,035 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,035 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,035 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,036 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,036 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,036 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,036 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,036 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,036 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,036 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,036 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,037 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,037 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,037 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,037 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,037 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,037 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,037 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,037 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,037 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,037 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,037 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,037 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,038 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,038 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,038 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,038 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,038 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,038 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,038 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,038 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,038 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,038 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,039 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,039 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,039 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,039 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,039 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,039 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,040 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,040 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO -   learning_rate: 0.0142443614712617
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,040 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   n_estimators: 129
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   subsample: 0.9746128038451177
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.718946577832295
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   reg_alpha: 4.407538220944994e-06
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO -   reg_lambda: 0.13079007377001461
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,041 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,043 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,043 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,043 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,043 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,043 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,043 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,043 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,044 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,044 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,044 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,044 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,044 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,044 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,044 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,045 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,045 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,045 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,045 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,045 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,045 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,045 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,045 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,045 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,045 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,045 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,045 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,045 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,046 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,046 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,046 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,046 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,046 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,047 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,047 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,047 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,047 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,047 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,047 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,047 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,047 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,047 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,047 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,047 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,047 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,047 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,047 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,047 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,047 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,047 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,047 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,047 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,047 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,049 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,049 - src.hyperparameter_tuning - ERROR - Trial 51 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,065 - src.hyperparameter_tuning - INFO - Trial 52: 모델 타입 = lightgbm
2025-06-24 09:42:50,069 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,069 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,069 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,069 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,069 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,069 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,070 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,070 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,070 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,070 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,070 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,070 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,070 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,070 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,070 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,070 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,070 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,070 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,071 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,071 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,071 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,071 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,071 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,071 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,071 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,071 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,071 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,072 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,075 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,077 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,077 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,077 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,077 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,077 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,077 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,077 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,079 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,081 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,081 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,081 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,081 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,082 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,082 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,082 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,082 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,082 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,082 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,082 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,082 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,082 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,082 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,082 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,082 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,082 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,083 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,083 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,083 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,084 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,084 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,084 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,084 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,084 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,084 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,084 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,084 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,084 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,084 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,084 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,084 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,084 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,085 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,085 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,085 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,085 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,085 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,085 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,085 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,086 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,086 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,086 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,086 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,086 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,086 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,086 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,086 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,086 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,086 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,087 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,087 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,087 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,087 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,087 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,087 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,087 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,087 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,087 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,087 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   learning_rate: 0.018456661428192748
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   n_estimators: 181
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   subsample: 0.9509603298852387
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6911039091967015
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   reg_alpha: 7.612892550570312e-07
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO -   reg_lambda: 4.173453381060882e-06
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,088 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,090 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,090 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,090 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,090 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,090 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,090 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,090 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,091 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,092 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,092 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,092 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,092 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,092 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,092 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,092 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,092 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,092 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,092 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,092 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,092 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,093 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,093 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,093 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,093 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,093 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,093 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,093 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,094 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,094 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,094 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,094 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,094 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,094 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,094 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,094 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,094 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,094 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,094 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,094 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,094 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,094 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,094 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,094 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,094 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,094 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,094 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,094 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,094 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,097 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,097 - src.hyperparameter_tuning - ERROR - Trial 52 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,112 - src.hyperparameter_tuning - INFO - Trial 53: 모델 타입 = lightgbm
2025-06-24 09:42:50,116 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,116 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,116 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,116 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,116 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,117 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,117 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,117 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,117 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,117 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,117 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,117 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,117 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,117 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,117 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,117 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,117 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,117 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,118 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,118 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,118 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,118 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,118 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,118 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,118 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,118 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,118 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,118 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,122 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,124 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,124 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,124 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,124 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,124 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,124 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,124 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,126 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,128 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,128 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,128 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,128 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,128 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,129 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,129 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,129 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,129 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,129 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,129 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,129 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,129 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,129 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,129 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,129 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,129 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,130 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,130 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,130 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,131 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,131 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,131 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,131 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,131 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,131 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,131 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,131 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,131 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,131 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,131 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,131 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,131 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,131 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,131 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,131 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,132 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,132 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,132 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,132 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,132 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,132 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,132 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,133 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,133 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,133 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,134 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,134 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,134 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,134 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,134 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,134 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,134 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   learning_rate: 0.023387567111245493
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   n_estimators: 253
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   subsample: 0.9226975130375475
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6611933706717418
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   reg_alpha: 2.5680490521396752e-08
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO -   reg_lambda: 0.008010451217063149
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,135 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,138 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,138 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,138 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,138 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,138 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,138 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,138 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,138 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,138 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,138 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,138 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,139 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,139 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,139 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,139 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,139 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,139 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,143 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,143 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,143 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,143 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,143 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,143 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,143 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,143 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,144 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,144 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,144 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,144 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,144 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,144 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,144 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,145 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,145 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,145 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,145 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,145 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,145 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,145 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,145 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,145 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,145 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,145 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,145 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,145 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,145 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,145 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,145 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,145 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,145 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,145 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,145 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,145 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,148 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,148 - src.hyperparameter_tuning - ERROR - Trial 53 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,163 - src.hyperparameter_tuning - INFO - Trial 54: 모델 타입 = lightgbm
2025-06-24 09:42:50,167 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,167 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,167 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,167 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,167 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,167 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,167 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,167 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,167 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,168 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,168 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,168 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,168 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,168 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,168 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,168 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,168 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,168 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,169 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,169 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,169 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,169 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,169 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,169 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,169 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,169 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,169 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,169 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,173 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,175 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,175 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,175 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,175 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,175 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,175 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,175 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,177 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,179 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,179 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,179 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,179 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,179 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,179 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,179 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,179 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,179 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,179 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,180 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,180 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,180 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,180 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,180 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,180 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,180 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,180 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,180 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,180 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,181 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,181 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,181 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,181 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,181 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,181 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,181 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,181 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,181 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,181 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,182 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,182 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,182 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,182 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,182 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,182 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,182 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,182 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,182 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,183 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,183 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,183 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,183 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,183 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,183 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,183 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,183 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,183 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,184 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,184 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,184 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,184 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,184 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,184 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,184 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,184 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   learning_rate: 0.017930539769372034
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,185 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,186 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,186 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,186 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,186 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,186 - src.models.lightgbm_model - INFO -   n_estimators: 292
2025-06-24 09:42:50,186 - src.models.lightgbm_model - INFO -   subsample: 0.7831255552496368
2025-06-24 09:42:50,186 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7589517267440986
2025-06-24 09:42:50,186 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:42:50,186 - src.models.lightgbm_model - INFO -   reg_alpha: 3.771141225353274e-05
2025-06-24 09:42:50,186 - src.models.lightgbm_model - INFO -   reg_lambda: 0.000530203372836347
2025-06-24 09:42:50,186 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,186 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,186 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,188 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,188 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,188 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,188 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,188 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,189 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,190 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,190 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,195 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,195 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,195 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,195 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,195 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,195 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,195 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,195 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,195 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,196 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,196 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,196 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,196 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,196 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,196 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,197 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,197 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,197 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,197 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,197 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,197 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,197 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,197 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,197 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,197 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,197 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,197 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,197 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,197 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,197 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,197 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,197 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,197 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,197 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,197 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,197 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,199 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,200 - src.hyperparameter_tuning - ERROR - Trial 54 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,215 - src.hyperparameter_tuning - INFO - Trial 55: 모델 타입 = lightgbm
2025-06-24 09:42:50,218 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,219 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,219 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,219 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,219 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,219 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,219 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,219 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,219 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,220 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,220 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,220 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,220 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,220 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,220 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,220 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,220 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,220 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,221 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,221 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,221 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,221 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,221 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,221 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,221 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,221 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,221 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,221 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,225 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,227 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,227 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,227 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,227 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,227 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,227 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,227 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,229 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,231 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,231 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,231 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,231 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,231 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,231 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,231 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,231 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,231 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,231 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,232 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,232 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,232 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,232 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,232 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,232 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,232 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,232 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,232 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,232 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,233 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,233 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,233 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,233 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,233 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,233 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,233 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,233 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,233 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,233 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,233 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,233 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,233 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,233 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,234 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,234 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,234 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,234 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,234 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,234 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,235 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,235 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,235 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,235 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,236 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,236 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   learning_rate: 0.011437207024077016
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   n_estimators: 51
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   subsample: 0.9988910626470648
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7955253543847626
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   reg_alpha: 3.9245291180279974e-07
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO -   reg_lambda: 0.001413477088598793
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,237 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,240 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,240 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,240 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,240 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,240 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,240 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,240 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,240 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,240 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,240 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,241 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,241 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,241 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,241 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,241 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,241 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,241 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,247 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,247 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,247 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,247 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,247 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,247 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,247 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,247 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,247 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,248 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,248 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,248 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,248 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,248 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,248 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,249 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,249 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,249 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,249 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,249 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,249 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,249 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,249 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,249 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,249 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,249 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,249 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,249 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,249 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,249 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,249 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,249 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,249 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,249 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,249 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,249 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,251 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,252 - src.hyperparameter_tuning - ERROR - Trial 55 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,267 - src.hyperparameter_tuning - INFO - Trial 56: 모델 타입 = lightgbm
2025-06-24 09:42:50,271 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,271 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,271 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,271 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,271 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,271 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,271 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,271 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,271 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,272 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,272 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,272 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,272 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,272 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,272 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,272 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,272 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,272 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,273 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,273 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,273 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,273 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,273 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,273 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,273 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,273 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,273 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,273 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,277 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,279 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,279 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,279 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,279 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,279 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,279 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,279 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,281 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,283 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,284 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,284 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,284 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,284 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,284 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,284 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,284 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,284 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,284 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,284 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,284 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,284 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,284 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,284 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,284 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,284 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,285 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,285 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,285 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,286 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,286 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,286 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,286 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,286 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,286 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,286 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,286 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,286 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,286 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,286 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,286 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,287 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,288 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,288 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,288 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,289 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,289 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,289 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,289 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,289 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   learning_rate: 0.153186769078403
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   n_estimators: 620
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   subsample: 0.7475015634023295
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9150280338924608
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   reg_alpha: 1.1809416753112032e-07
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO -   reg_lambda: 1.3713683152159453e-05
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,290 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,300 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,300 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,300 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,300 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,300 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,300 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,300 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,300 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,301 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,302 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,302 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,302 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,304 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,304 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,304 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,304 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,304 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,304 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,304 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,304 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,304 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,304 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,305 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,305 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,305 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,305 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,305 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,306 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,306 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,306 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,306 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,306 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,306 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,306 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,306 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,306 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,306 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,306 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,306 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,306 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,306 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,306 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,306 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,306 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,307 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,307 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,307 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,307 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,309 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,309 - src.hyperparameter_tuning - ERROR - Trial 56 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,325 - src.hyperparameter_tuning - INFO - Trial 57: 모델 타입 = lightgbm
2025-06-24 09:42:50,328 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,329 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,329 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,329 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,329 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,329 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,329 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,329 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,329 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,330 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,330 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,330 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,330 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,330 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,330 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,330 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,330 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,330 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,331 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,331 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,331 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,331 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,331 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,331 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,331 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,331 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,331 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,331 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,334 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,337 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,337 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,337 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,337 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,337 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,337 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,337 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,339 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,341 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,341 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,341 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,341 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,341 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,341 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,341 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,341 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,341 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,341 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,342 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,342 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,342 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,342 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,342 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,342 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,342 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,342 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,342 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,342 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,343 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,343 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,343 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,343 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,343 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,343 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,343 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,343 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,343 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,343 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,343 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,343 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,344 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,344 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,344 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,344 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,344 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,344 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,345 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,346 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,346 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,346 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,346 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,346 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   learning_rate: 0.04252092888793017
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   n_estimators: 555
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   subsample: 0.9111812059161246
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6841855639649754
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   reg_alpha: 1.469469291873918e-06
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO -   reg_lambda: 1.362640689879042
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,347 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,350 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,350 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,350 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,350 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,350 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,350 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,350 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,350 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,350 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,350 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,351 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,351 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,352 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,357 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,357 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,357 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,357 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,357 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,357 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,357 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,357 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,357 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,357 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,358 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,358 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,358 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,358 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,358 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,359 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,359 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,359 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,359 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,359 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,359 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,359 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,359 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,359 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,359 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,359 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,359 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,359 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,359 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,359 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,359 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,359 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,359 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,359 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,359 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,359 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,361 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,362 - src.hyperparameter_tuning - ERROR - Trial 57 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,377 - src.hyperparameter_tuning - INFO - Trial 58: 모델 타입 = lightgbm
2025-06-24 09:42:50,381 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,381 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,382 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,382 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,382 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,382 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,382 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,382 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,382 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,382 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,382 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,382 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,382 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,382 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,382 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,382 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,382 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,382 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,383 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,383 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,383 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,383 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,383 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,383 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,383 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,383 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,383 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,384 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,387 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,389 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,389 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,389 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,389 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,389 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,389 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,389 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,392 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,394 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,394 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,394 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,394 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,394 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,394 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,394 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,394 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,394 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,394 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,394 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,394 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,394 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,394 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,394 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,394 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,394 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,395 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,395 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,395 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,396 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,396 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,396 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,396 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,396 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,396 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,396 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,396 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,396 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,396 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,396 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,396 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,396 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,396 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,396 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,397 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,398 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,398 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,398 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,399 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,399 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,399 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,399 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,399 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,399 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,399 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   learning_rate: 0.01121632525249422
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   n_estimators: 506
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   subsample: 0.7239428053703661
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7096617144525774
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   reg_alpha: 1.2539835065528851e-05
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO -   reg_lambda: 3.479924777807695e-08
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,400 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,403 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,403 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,403 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,403 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,403 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,403 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,404 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,404 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,410 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,410 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,410 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,410 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,410 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,410 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,410 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,410 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,410 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,411 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,411 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,411 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,411 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,411 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,411 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,412 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,412 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,412 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,412 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,412 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,412 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,412 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,412 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,412 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,412 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,412 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,412 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,412 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,412 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,412 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,412 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,412 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,412 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,412 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,412 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,412 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,415 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,415 - src.hyperparameter_tuning - ERROR - Trial 58 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,430 - src.hyperparameter_tuning - INFO - Trial 59: 모델 타입 = lightgbm
2025-06-24 09:42:50,434 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,435 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,435 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,435 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,435 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,435 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,435 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,435 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,435 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,435 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,435 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,435 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,436 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,436 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,436 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,436 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,436 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,436 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,436 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,437 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,437 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,437 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,437 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,437 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,437 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,437 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,437 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,437 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,440 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,442 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,442 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,442 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,442 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,442 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,442 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,442 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,445 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,447 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,447 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,447 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,447 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,447 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,447 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,447 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,447 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,447 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,447 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,447 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,447 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,447 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,447 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,447 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,447 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,447 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,448 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,448 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,448 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,449 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,449 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,449 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,449 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,449 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,449 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,449 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,449 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,449 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,449 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,449 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,449 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,449 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,449 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,449 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,449 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,450 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,450 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,451 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,452 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,452 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,452 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,452 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,452 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,452 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,452 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,452 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,452 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   learning_rate: 0.24384133830368773
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   n_estimators: 335
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   subsample: 0.8683523300707465
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8857996984773274
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   reg_alpha: 4.439663032964412e-08
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO -   reg_lambda: 0.02341800942228853
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,453 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,456 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,456 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,456 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,457 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,457 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,457 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,458 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,458 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,458 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,458 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,458 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,461 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,461 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,461 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,461 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,461 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,461 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,461 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,461 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,461 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,461 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,461 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,461 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,462 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,462 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,462 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,462 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,462 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,462 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,462 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,463 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,463 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,463 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,463 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,463 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,463 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,463 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,463 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,463 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,463 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,463 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,463 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,463 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,463 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,463 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,463 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,463 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,466 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,466 - src.hyperparameter_tuning - ERROR - Trial 59 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,482 - src.hyperparameter_tuning - INFO - Trial 60: 모델 타입 = lightgbm
2025-06-24 09:42:50,485 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,486 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,486 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,486 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,486 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,486 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,486 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,486 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,486 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,487 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,487 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,487 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,487 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,487 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,487 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,487 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,487 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,487 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,488 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,488 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,488 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,488 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,488 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,488 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,488 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,488 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,488 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,488 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,491 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,493 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,494 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,494 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,494 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,494 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,494 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,494 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,496 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,498 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,498 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,498 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,498 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,498 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,498 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,498 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,498 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,498 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,498 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,499 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,499 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,499 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,499 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,499 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,499 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,499 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,499 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,499 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,499 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,500 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,500 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,500 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,500 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,500 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,500 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,500 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,500 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,500 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,500 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,500 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,500 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,500 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,500 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,501 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,502 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,502 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,502 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,503 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,503 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,503 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,503 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,503 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   learning_rate: 0.013791386929805163
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   n_estimators: 693
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   subsample: 0.6055182468435556
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7421066057531389
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   reg_alpha: 0.028410855500270112
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00020704799608554415
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,504 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,507 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,507 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,507 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,507 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,507 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,507 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,508 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,508 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,513 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,513 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,513 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,513 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,513 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,513 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,513 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,513 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,513 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,514 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,514 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,514 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,514 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,514 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,514 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,515 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,515 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,515 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,515 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,515 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,515 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,515 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,515 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,515 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,515 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,515 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,515 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,515 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,515 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,515 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,515 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,515 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,515 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,515 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,515 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,515 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,518 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,518 - src.hyperparameter_tuning - ERROR - Trial 60 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,534 - src.hyperparameter_tuning - INFO - Trial 61: 모델 타입 = lightgbm
2025-06-24 09:42:50,537 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,538 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,538 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,538 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,538 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,538 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,538 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,538 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,538 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,538 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,539 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,539 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,539 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,539 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,539 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,539 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,539 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,539 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,540 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,540 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,540 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,540 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,540 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,540 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,540 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,540 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,540 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,540 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,543 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,545 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,545 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,545 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,545 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,545 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,545 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,545 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,547 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,549 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,549 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,549 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,549 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,549 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,549 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,549 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,550 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,550 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,550 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,550 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,550 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,550 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,550 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,550 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,550 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,550 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,551 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,551 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,551 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,552 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,552 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,552 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,552 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,552 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,552 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,552 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,552 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,552 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,552 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,552 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,552 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,552 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,553 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,553 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,554 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,554 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,555 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,555 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   learning_rate: 0.29607121667659375
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,555 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   n_estimators: 571
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   subsample: 0.9492180121271596
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9835831542773467
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   reg_alpha: 0.1889918707742379
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO -   reg_lambda: 0.6510572184077662
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,556 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,559 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,559 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,559 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,559 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,559 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,559 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,559 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,560 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,560 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,560 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,560 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,560 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,560 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,560 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,561 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,561 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,567 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,567 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,567 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,567 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,567 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,567 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,567 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,567 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,567 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,568 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,568 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,568 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,568 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,568 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,568 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,569 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,569 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,569 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,569 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,569 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,569 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,569 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,569 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,569 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,569 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,569 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,569 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,569 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,569 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,569 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,569 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,569 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,569 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,569 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,569 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,569 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,572 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,572 - src.hyperparameter_tuning - ERROR - Trial 61 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,588 - src.hyperparameter_tuning - INFO - Trial 62: 모델 타입 = lightgbm
2025-06-24 09:42:50,591 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,592 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,592 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,592 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,592 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,592 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,592 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,592 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,592 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,593 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,593 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,593 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,593 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,593 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,593 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,593 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,593 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,593 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,594 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,594 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,594 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,594 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,594 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,594 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,594 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,594 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,594 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,594 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,597 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,599 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,599 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,599 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,600 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,600 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,600 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,600 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,602 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,604 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,604 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,604 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,604 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,604 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,604 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,604 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,604 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,604 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,604 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,605 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,605 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,605 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,605 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,605 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,605 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,605 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,605 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,605 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,605 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,606 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,606 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,606 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,606 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,606 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,606 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,606 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,606 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,606 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,606 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,606 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,606 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,606 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,606 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,607 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,608 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,608 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,609 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,609 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,609 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   learning_rate: 0.27145131192063576
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,610 - src.models.lightgbm_model - INFO -   n_estimators: 441
2025-06-24 09:42:50,611 - src.models.lightgbm_model - INFO -   subsample: 0.8388888202790384
2025-06-24 09:42:50,611 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9679527386504253
2025-06-24 09:42:50,611 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:42:50,611 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0032641441634054954
2025-06-24 09:42:50,611 - src.models.lightgbm_model - INFO -   reg_lambda: 3.55409111214763e-05
2025-06-24 09:42:50,611 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,611 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,611 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,613 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,613 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,613 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,613 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,613 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,614 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,614 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,614 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,614 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,614 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,615 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,615 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,615 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,615 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,621 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,621 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,621 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,621 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,621 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,621 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,621 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,621 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,621 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,622 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,622 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,622 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,622 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,622 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,622 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,623 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,623 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,623 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,623 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,623 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,623 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,623 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,623 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,623 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,623 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,623 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,623 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,623 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,623 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,623 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,623 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,623 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,623 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,623 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,623 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,623 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,626 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,626 - src.hyperparameter_tuning - ERROR - Trial 62 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,642 - src.hyperparameter_tuning - INFO - Trial 63: 모델 타입 = lightgbm
2025-06-24 09:42:50,645 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,646 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,646 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,646 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,646 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,646 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,646 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,646 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,646 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,647 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,647 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,647 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,647 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,647 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,647 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,647 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,647 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,647 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,648 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,648 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,648 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,648 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,648 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,648 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,648 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,648 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,648 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,648 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,651 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,653 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,653 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,653 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,653 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,653 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,653 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,654 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,656 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,658 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,658 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,658 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,658 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,658 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,658 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,658 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,658 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,658 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,658 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,658 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,658 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,658 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,658 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,658 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,658 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,658 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,659 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,659 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,659 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,660 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,660 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,660 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,660 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,660 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,660 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,660 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,660 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,660 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,660 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,660 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,660 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,661 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,662 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,662 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,662 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,663 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,663 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,663 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,663 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,663 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,663 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,663 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,663 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   learning_rate: 0.18507739953392208
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   n_estimators: 501
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   subsample: 0.9255363949136147
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9478516979033457
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0016453016635939743
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO -   reg_lambda: 3.889292533372911
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,664 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,666 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,666 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,666 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,666 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,667 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,667 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,667 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,667 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,667 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,668 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,668 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,668 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,668 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,668 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,668 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,668 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,668 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,668 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,668 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,668 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,668 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,668 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,669 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,669 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,669 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,669 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,669 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,669 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,669 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,670 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,670 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,670 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,670 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,670 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,670 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,670 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,670 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,670 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,670 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,670 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,670 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,670 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,670 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,670 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,670 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,670 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,670 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,670 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,670 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,670 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,673 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,673 - src.hyperparameter_tuning - ERROR - Trial 63 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,689 - src.hyperparameter_tuning - INFO - Trial 64: 모델 타입 = lightgbm
2025-06-24 09:42:50,693 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,694 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,694 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,694 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,694 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,694 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,694 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,694 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,694 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,694 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,694 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,694 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,694 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,694 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,694 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,694 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,694 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,694 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,695 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,695 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,695 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,695 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,696 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,696 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,696 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,696 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,696 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,696 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,699 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,701 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,701 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,701 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,701 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,701 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,701 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,701 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,703 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,705 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,705 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,705 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,705 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,706 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,706 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,706 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,706 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,706 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,706 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,706 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,706 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,706 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,706 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,706 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,706 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,706 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,707 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,707 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,707 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,708 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,708 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,708 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,708 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,708 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,708 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,708 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,708 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,708 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,708 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,708 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,708 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,708 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,709 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,709 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,710 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,711 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,711 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,711 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,711 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,711 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,711 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   learning_rate: 0.12954824612423743
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   n_estimators: 98
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   subsample: 0.8112141622588307
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9260449527056052
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   reg_alpha: 0.009995808450449633
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO -   reg_lambda: 0.10706547190904596
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,712 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,715 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,715 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,715 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,715 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,715 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,715 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,716 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,716 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,722 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,722 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,722 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,722 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,722 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,722 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,722 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,722 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,722 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,723 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,723 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,723 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,723 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,723 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,723 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,724 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,724 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,724 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,724 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,724 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,724 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,724 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,724 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,724 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,724 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,724 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,724 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,724 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,724 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,724 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,724 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,724 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,724 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,724 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,724 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,724 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,726 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,726 - src.hyperparameter_tuning - ERROR - Trial 64 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,743 - src.hyperparameter_tuning - INFO - Trial 65: 모델 타입 = lightgbm
2025-06-24 09:42:50,747 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,747 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,747 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,747 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,747 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,747 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,747 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,748 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,748 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,748 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,748 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,748 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,748 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,748 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,748 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,748 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,748 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,748 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,749 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,749 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,749 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,749 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,749 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,749 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,749 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,749 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,749 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,749 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,753 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,755 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,755 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,755 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,755 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,755 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,755 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,755 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,757 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,759 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,759 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,759 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,759 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,759 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,759 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,759 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,759 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,759 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,760 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,760 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,760 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,760 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,760 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,760 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,760 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,760 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,761 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,761 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,761 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,762 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,762 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,762 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,762 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,762 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,762 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,762 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,762 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,762 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,762 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,762 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,762 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,762 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,763 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,763 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,764 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,765 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,765 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,765 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,765 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,765 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,765 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   learning_rate: 0.015953931804349637
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   n_estimators: 415
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   subsample: 0.9789455694045592
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9991613164008715
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   reg_alpha: 6.456208343096671e-05
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO -   reg_lambda: 2.1200870633038303e-07
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,766 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,769 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,769 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,769 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,769 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,769 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,769 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,769 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,769 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,769 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,770 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,770 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,770 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,774 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,774 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,774 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,774 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,774 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,774 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,774 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,774 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,774 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,775 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,775 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,775 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,775 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,775 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,775 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,776 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,776 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,776 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,776 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,776 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,776 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,776 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,776 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,776 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,776 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,776 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,776 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,776 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,776 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,776 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,776 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,776 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,776 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,776 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,776 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,776 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,779 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,779 - src.hyperparameter_tuning - ERROR - Trial 65 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,795 - src.hyperparameter_tuning - INFO - Trial 66: 모델 타입 = lightgbm
2025-06-24 09:42:50,799 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,800 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,800 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,800 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,800 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,800 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,800 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,800 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,800 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,800 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,800 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,800 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,800 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,800 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,800 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,800 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,800 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,800 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,801 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,801 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,801 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,801 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,801 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,801 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,801 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,801 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,801 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,801 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,805 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,807 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,807 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,807 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,807 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,807 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,807 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,807 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,809 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,811 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,811 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,811 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,811 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,811 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,811 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,811 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,811 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,811 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,811 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,812 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,812 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,812 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,812 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,812 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,812 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,812 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,812 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,812 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,813 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,813 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,813 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,813 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,813 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,813 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,813 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,813 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,813 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,813 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,813 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,813 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,813 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,814 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,814 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,814 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,814 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,814 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,814 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,814 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,815 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,815 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,815 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,815 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,815 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,815 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,815 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,815 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,815 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,815 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,816 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,816 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,816 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,817 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   learning_rate: 0.11087159867996219
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   n_estimators: 679
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   subsample: 0.9403050846328712
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9758227150453681
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   reg_alpha: 1.0131157393738157e-08
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO -   reg_lambda: 0.8523746549601214
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,817 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,820 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,820 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,820 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,820 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,820 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,820 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,820 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,820 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,820 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,821 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,821 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,821 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,827 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,827 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,827 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,827 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,827 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,827 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,827 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,827 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,827 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,827 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,828 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,828 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,828 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,829 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,829 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,829 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,829 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,829 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,829 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,829 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,829 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,829 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,829 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,829 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,829 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,829 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,829 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,829 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,829 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,829 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,829 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,829 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,829 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,829 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,832 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,832 - src.hyperparameter_tuning - ERROR - Trial 66 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,848 - src.hyperparameter_tuning - INFO - Trial 67: 모델 타입 = lightgbm
2025-06-24 09:42:50,852 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,852 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,852 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,852 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,852 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,852 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,852 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,852 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,852 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,853 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,853 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,853 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,853 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,853 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,853 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,853 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,853 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,853 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,854 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,854 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,854 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,854 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,854 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,854 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,854 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,854 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,854 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,854 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,858 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,860 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,860 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,860 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,860 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,860 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,860 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,860 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,862 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,864 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,864 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,864 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,864 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,864 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,864 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,864 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,864 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,864 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,864 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,865 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,865 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,865 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,865 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,865 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,865 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,865 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,865 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,865 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,865 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,866 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,866 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,866 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,866 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,866 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,866 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,866 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,866 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,866 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,866 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,866 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,866 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,867 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,868 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,868 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,869 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,869 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,869 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,870 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,870 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   learning_rate: 0.22703332024128894
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,870 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,871 - src.models.lightgbm_model - INFO -   n_estimators: 738
2025-06-24 09:42:50,871 - src.models.lightgbm_model - INFO -   subsample: 0.682593228121369
2025-06-24 09:42:50,871 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8224029138278149
2025-06-24 09:42:50,871 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:50,871 - src.models.lightgbm_model - INFO -   reg_alpha: 6.007326216970683e-06
2025-06-24 09:42:50,871 - src.models.lightgbm_model - INFO -   reg_lambda: 7.268356621597371e-08
2025-06-24 09:42:50,871 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,871 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,871 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,873 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,873 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,873 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,873 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,873 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,874 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,874 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,874 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,875 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,878 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,878 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,878 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,878 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,878 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,878 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,878 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,878 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,879 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,879 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,879 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,879 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,879 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,879 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,879 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,880 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,880 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,880 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,880 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,880 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,880 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,880 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,880 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,880 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,880 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,880 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,880 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,880 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,880 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,880 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,880 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,880 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,880 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,880 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,880 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,880 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,883 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,883 - src.hyperparameter_tuning - ERROR - Trial 67 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,899 - src.hyperparameter_tuning - INFO - Trial 68: 모델 타입 = lightgbm
2025-06-24 09:42:50,903 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,904 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,904 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,904 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,904 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,904 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,904 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,904 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,904 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,904 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,904 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,904 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,904 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,905 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,905 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,905 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,905 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,905 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,905 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,906 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,906 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,906 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,906 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,906 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,906 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,906 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,906 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,906 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,909 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,911 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,911 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,911 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,911 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,911 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,911 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,911 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,913 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,915 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,915 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,915 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,915 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,915 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,915 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,916 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,916 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,916 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,916 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,916 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,916 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,916 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,916 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,916 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,916 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,916 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,917 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,917 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,917 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,918 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,918 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,918 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,918 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,918 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,918 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,918 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,918 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,918 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,918 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,918 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,918 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,918 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,918 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,919 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,919 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,919 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,920 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,920 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,920 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,920 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,920 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,921 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,921 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,921 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,921 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,921 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,921 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,921 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,921 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   learning_rate: 0.04990710888816552
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   n_estimators: 609
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   subsample: 0.848270830948627
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.850598430172833
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0004951275409578349
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO -   reg_lambda: 3.47820930095863e-06
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,922 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,925 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,926 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,926 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,926 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,926 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,926 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,926 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,926 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,927 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,927 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,927 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,927 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,927 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,933 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,933 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,933 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,933 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,933 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,933 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,933 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,933 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,933 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,934 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,934 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,934 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,935 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,935 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,935 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,935 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,935 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,935 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,935 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,935 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,935 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,935 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,935 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,935 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,935 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,935 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,935 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,935 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,935 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,935 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,935 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,935 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,935 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,938 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,938 - src.hyperparameter_tuning - ERROR - Trial 68 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:50,955 - src.hyperparameter_tuning - INFO - Trial 69: 모델 타입 = lightgbm
2025-06-24 09:42:50,958 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:50,959 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:50,959 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:50,959 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:50,959 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:50,959 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:50,959 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:50,959 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:50,959 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:50,960 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:50,960 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:50,960 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:50,960 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:50,960 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:50,960 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:50,960 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:50,960 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:50,960 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:50,961 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,961 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,961 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:50,961 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:50,961 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,961 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:50,961 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:50,961 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:50,961 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:50,961 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:50,964 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:50,966 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,966 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:50,966 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:50,966 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:50,966 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:50,967 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:50,967 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:50,969 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:50,971 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:50,971 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,971 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,971 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:50,971 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:50,971 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,971 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:50,971 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:50,971 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,971 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,971 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:50,971 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:50,971 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,971 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,971 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:50,971 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:50,971 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,972 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,972 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:50,972 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:50,973 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:50,973 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:50,973 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:50,973 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:50,973 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:50,973 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:50,973 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:50,973 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:50,973 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,973 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:50,973 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:50,973 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:50,973 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:50,973 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,973 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,973 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,974 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:50,974 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:50,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,975 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,976 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,976 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,976 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:50,976 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,976 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:50,976 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,976 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:50,976 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   learning_rate: 0.15916881726677745
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   n_estimators: 998
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   subsample: 0.9530544650204105
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8647144776940237
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   reg_alpha: 1.6010135879554323e-06
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO -   reg_lambda: 1.0999472666734155e-05
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:50,977 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:50,979 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:50,979 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:50,979 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:50,979 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:50,979 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:50,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:50,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,980 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:50,980 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:50,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:50,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:50,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:50,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:50,981 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:50,981 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:50,981 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:50,985 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:50,985 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:50,985 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:50,985 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:50,985 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,985 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,985 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:50,985 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:50,985 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:50,985 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:50,985 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:50,985 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:50,986 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,986 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,986 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,986 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:50,987 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:50,987 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:50,987 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:50,987 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:50,987 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:50,987 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:50,987 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:50,987 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:50,987 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:50,987 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:50,987 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:50,987 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:50,987 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:50,987 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:50,987 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:50,987 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:50,987 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,987 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,987 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:50,987 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:50,989 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:50,989 - src.hyperparameter_tuning - ERROR - Trial 69 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,008 - src.hyperparameter_tuning - INFO - Trial 70: 모델 타입 = lightgbm
2025-06-24 09:42:51,011 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,012 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,012 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,012 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,012 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,012 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,012 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,012 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,012 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,013 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,013 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,013 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,013 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,013 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,013 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,013 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,013 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,013 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,014 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,014 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,014 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,014 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,014 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,014 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,014 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,014 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,014 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,014 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,018 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,020 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,020 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,020 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,020 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,020 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,020 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,020 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,022 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,024 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,025 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,025 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,025 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,025 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,025 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,025 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,025 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,025 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,025 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,025 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,025 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,025 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,025 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,025 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,025 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,025 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,026 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,026 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,026 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,027 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,027 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,027 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,027 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,027 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,027 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,027 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,027 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,027 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,027 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,027 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,027 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,028 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,029 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,029 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,029 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,030 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,030 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,030 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,030 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,030 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   learning_rate: 0.020914360188651566
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   n_estimators: 220
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   subsample: 0.7847861042114909
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6157716992226357
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   reg_alpha: 2.2119025375971438e-05
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO -   reg_lambda: 2.5581389759662644e-08
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,031 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,128 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,128 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,128 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,128 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,128 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,128 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,128 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,129 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,129 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,129 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,129 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,130 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,130 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,130 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,130 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,130 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,130 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,135 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,135 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,135 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,135 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,135 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,135 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,135 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,135 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,136 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,136 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,136 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,136 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,136 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,136 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,136 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,137 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,137 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,137 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,137 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,137 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,137 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,137 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,137 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,137 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,137 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,137 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,137 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,137 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,137 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,137 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,137 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,137 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,137 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,137 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,137 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,137 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,140 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,140 - src.hyperparameter_tuning - ERROR - Trial 70 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,158 - src.hyperparameter_tuning - INFO - Trial 71: 모델 타입 = lightgbm
2025-06-24 09:42:51,162 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,162 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,162 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,162 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,162 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,162 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,162 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,162 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,163 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,163 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,163 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,163 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,163 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,163 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,163 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,163 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,163 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,163 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,164 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,164 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,164 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,164 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,164 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,164 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,164 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,164 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,164 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,164 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,168 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,170 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,170 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,170 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,170 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,170 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,170 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,170 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,172 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,174 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,175 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,175 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,175 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,175 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,175 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,175 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,175 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,175 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,175 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,175 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,175 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,175 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,175 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,175 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,175 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,175 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,176 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,176 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,176 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,177 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,177 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,177 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,177 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,177 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,177 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,177 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,177 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,177 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,177 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,177 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,177 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,177 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,177 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,177 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,178 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,178 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,178 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,179 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,179 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,179 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,180 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,180 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,180 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,180 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,180 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,180 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,180 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,180 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   learning_rate: 0.010957129865736666
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   n_estimators: 153
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   subsample: 0.6564142001008275
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8397815212987682
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   reg_alpha: 3.0126779680525884
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO -   reg_lambda: 6.874100189958323e-05
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,181 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,192 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,192 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,192 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,192 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,192 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,193 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,194 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,194 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,200 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,200 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,200 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,200 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,200 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,200 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,200 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,200 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,200 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,200 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,201 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,201 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,201 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,201 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,201 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,202 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,202 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,202 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,202 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,202 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,202 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,202 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,202 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,202 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,202 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,202 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,202 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,202 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,202 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,202 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,202 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,202 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,202 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,202 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,202 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,202 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,205 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,205 - src.hyperparameter_tuning - ERROR - Trial 71 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,222 - src.hyperparameter_tuning - INFO - Trial 72: 모델 타입 = lightgbm
2025-06-24 09:42:51,226 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,227 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,227 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,227 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,227 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,227 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,227 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,227 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,227 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,228 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,228 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,228 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,228 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,228 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,228 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,228 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,228 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,228 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,229 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,229 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,229 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,229 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,229 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,229 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,229 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,229 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,229 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,229 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,232 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,235 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,235 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,235 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,235 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,235 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,235 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,235 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,237 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,239 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,239 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,239 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,239 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,239 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,239 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,239 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,239 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,239 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,239 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,240 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,240 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,240 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,240 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,240 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,240 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,240 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,240 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,240 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,240 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,241 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,241 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,241 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,241 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,241 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,241 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,241 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,241 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,241 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,241 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,241 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,241 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,241 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,241 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,242 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,242 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,243 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,243 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,243 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,243 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,243 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,243 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,243 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,243 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,243 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,244 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,244 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,244 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,244 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,244 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,244 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,244 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   learning_rate: 0.012872128435596708
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   n_estimators: 108
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   subsample: 0.701870451203659
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7329492683995666
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   reg_alpha: 0.2817736475166566
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO -   reg_lambda: 6.653037142606319e-07
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,245 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,248 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,248 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,248 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,248 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,248 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,248 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,249 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,249 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,255 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,255 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,255 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,255 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,255 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,255 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,255 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,255 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,255 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,256 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,256 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,256 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,256 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,256 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,256 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,257 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,257 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,257 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,257 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,257 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,257 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,257 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,257 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,257 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,257 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,257 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,257 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,257 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,257 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,257 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,257 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,257 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,257 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,257 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,257 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,257 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,260 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,260 - src.hyperparameter_tuning - ERROR - Trial 72 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,276 - src.hyperparameter_tuning - INFO - Trial 73: 모델 타입 = lightgbm
2025-06-24 09:42:51,280 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,281 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,281 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,281 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,281 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,281 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,281 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,281 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,281 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,281 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,281 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,281 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,281 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,281 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,281 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,281 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,282 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,282 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,282 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,282 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,283 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,283 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,283 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,283 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,283 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,283 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,283 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,283 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,286 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,288 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,288 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,288 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,288 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,288 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,288 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,288 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,290 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,292 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,292 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,292 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,292 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,292 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,292 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,292 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,292 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,293 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,293 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,293 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,293 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,293 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,293 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,293 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,293 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,293 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,294 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,294 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,294 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,295 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,295 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,295 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,295 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,295 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,295 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,295 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,295 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,295 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,295 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,295 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,295 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,295 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,297 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,297 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,297 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   learning_rate: 0.014541973687489567
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,298 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,299 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,299 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,299 - src.models.lightgbm_model - INFO -   n_estimators: 188
2025-06-24 09:42:51,299 - src.models.lightgbm_model - INFO -   subsample: 0.759421050732034
2025-06-24 09:42:51,299 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7654101279240798
2025-06-24 09:42:51,299 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:42:51,299 - src.models.lightgbm_model - INFO -   reg_alpha: 0.01722905276111146
2025-06-24 09:42:51,299 - src.models.lightgbm_model - INFO -   reg_lambda: 1.263937240496527e-06
2025-06-24 09:42:51,299 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,299 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,299 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,301 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,301 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,301 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,301 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,301 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,302 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,302 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,303 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,303 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,303 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,303 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,303 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,303 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,303 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,303 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,303 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,303 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,303 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,303 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,303 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,304 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,304 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,304 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,304 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,304 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,304 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,305 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,305 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,305 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,305 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,305 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,305 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,305 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,305 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,305 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,305 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,305 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,305 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,305 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,305 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,305 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,305 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,305 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,305 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,305 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,305 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,307 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,307 - src.hyperparameter_tuning - ERROR - Trial 73 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,325 - src.hyperparameter_tuning - INFO - Trial 74: 모델 타입 = lightgbm
2025-06-24 09:42:51,328 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,329 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,329 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,329 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,329 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,329 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,329 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,329 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,329 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,329 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,330 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,330 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,330 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,330 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,330 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,330 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,330 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,330 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,331 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,331 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,331 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,331 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,331 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,331 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,331 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,331 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,331 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,331 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,334 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,336 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,336 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,336 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,336 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,336 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,336 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,336 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,339 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,340 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,341 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,341 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,341 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,341 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,341 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,341 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,341 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,341 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,341 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,341 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,341 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,341 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,341 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,341 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,341 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,341 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,342 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,342 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,342 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,343 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,343 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,343 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,343 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,343 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,343 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,343 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,343 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,343 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,343 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,343 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,343 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,344 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,344 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,344 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,344 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,344 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,344 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,345 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,346 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,346 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,346 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,346 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,346 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   learning_rate: 0.010049681564965829
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   n_estimators: 472
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   subsample: 0.7277245828295967
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7166438037926771
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   reg_alpha: 0.006492067438794327
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO -   reg_lambda: 3.47045623771009e-05
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,347 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,350 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,350 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,350 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,350 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,350 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,350 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,350 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,350 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,351 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,351 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,351 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,351 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,357 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,357 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,357 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,357 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,357 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,357 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,357 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,357 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,357 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,358 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,358 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,358 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,358 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,358 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,358 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,359 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,359 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,359 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,359 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,359 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,359 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,359 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,359 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,359 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,359 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,359 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,359 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,359 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,359 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,359 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,359 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,359 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,359 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,359 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,359 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,359 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,362 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,362 - src.hyperparameter_tuning - ERROR - Trial 74 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,379 - src.hyperparameter_tuning - INFO - Trial 75: 모델 타입 = lightgbm
2025-06-24 09:42:51,382 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,383 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,383 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,383 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,383 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,383 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,383 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,383 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,383 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,383 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,383 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,383 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,383 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,383 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,383 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,384 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,384 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,384 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,384 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,385 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,385 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,385 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,385 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,385 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,385 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,385 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,385 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,385 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,388 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,390 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,390 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,390 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,390 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,390 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,390 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,390 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,392 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,394 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,394 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,394 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,394 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,394 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,394 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,395 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,395 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,395 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,395 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,395 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,395 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,395 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,395 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,395 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,395 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,395 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,396 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,396 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,396 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,397 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,397 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,397 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,397 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,397 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,397 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,397 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,397 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,397 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,397 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,397 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,397 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,397 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,398 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,398 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,399 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,399 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,399 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,399 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,400 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,400 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,400 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,400 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,400 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,400 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,400 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,400 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,400 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   learning_rate: 0.028490465891437326
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   n_estimators: 365
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   subsample: 0.6254706923605511
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7925475288364967
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   reg_alpha: 0.05495560517360351
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO -   reg_lambda: 3.551282729015529
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,401 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,406 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,406 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,406 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,406 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,406 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,406 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,406 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,406 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,406 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,407 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,407 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,407 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,407 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,407 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,407 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,411 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,411 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,411 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,411 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,411 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,411 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,411 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,411 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,411 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,411 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,412 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,412 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,412 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,412 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,412 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,413 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,413 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,413 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,413 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,413 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,413 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,413 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,413 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,413 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,413 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,413 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,413 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,413 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,413 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,413 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,413 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,413 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,413 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,413 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,413 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,413 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,416 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,416 - src.hyperparameter_tuning - ERROR - Trial 75 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,433 - src.hyperparameter_tuning - INFO - Trial 76: 모델 타입 = lightgbm
2025-06-24 09:42:51,437 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,437 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,437 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,437 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,437 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,437 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,437 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,437 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,437 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,438 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,438 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,438 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,438 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,438 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,438 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,438 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,438 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,438 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,439 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,439 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,439 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,439 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,439 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,439 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,439 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,439 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,439 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,439 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,443 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,445 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,445 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,445 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,445 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,445 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,445 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,445 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,447 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,449 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,449 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,449 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,449 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,449 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,449 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,449 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,449 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,449 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,449 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,450 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,450 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,450 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,450 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,450 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,450 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,450 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,450 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,451 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,451 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,451 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,451 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,451 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,451 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,451 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,451 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,452 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,452 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,452 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,452 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,452 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,452 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,452 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,452 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,452 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,452 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,453 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,453 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,453 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,453 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,453 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,454 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,454 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,454 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,455 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,455 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,455 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,455 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,455 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,455 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,455 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,455 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   learning_rate: 0.012115236479030286
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   n_estimators: 153
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   subsample: 0.9118267599058681
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6687523762556236
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   reg_alpha: 1.6345515759655802
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO -   reg_lambda: 7.166551603900752e-06
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,456 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,459 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,459 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,459 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,459 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,459 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,459 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,459 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,459 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,459 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,460 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,460 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,460 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,466 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,466 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,466 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,466 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,466 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,466 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,466 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,466 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,466 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,467 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,467 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,467 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,467 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,467 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,467 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,468 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,468 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,468 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,468 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,468 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,468 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,468 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,468 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,468 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,468 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,468 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,468 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,468 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,468 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,468 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,468 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,468 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,468 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,468 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,468 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,468 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,471 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,471 - src.hyperparameter_tuning - ERROR - Trial 76 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,488 - src.hyperparameter_tuning - INFO - Trial 77: 모델 타입 = lightgbm
2025-06-24 09:42:51,491 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,492 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,492 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,492 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,492 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,492 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,492 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,492 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,492 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,493 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,493 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,493 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,493 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,493 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,493 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,493 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,493 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,493 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,494 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,494 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,494 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,494 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,494 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,494 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,494 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,494 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,494 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,494 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,497 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,499 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,500 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,500 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,500 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,500 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,500 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,500 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,502 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,504 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,504 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,504 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,504 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,504 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,504 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,504 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,504 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,504 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,504 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,505 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,505 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,505 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,505 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,505 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,505 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,505 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,505 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,505 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,505 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,506 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,506 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,506 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,506 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,506 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,506 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,506 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,506 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,506 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,506 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,506 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,506 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,507 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,508 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,508 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,508 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,509 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,509 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,509 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,509 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,509 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,509 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,509 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   learning_rate: 0.063637820225863
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   n_estimators: 881
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   subsample: 0.9660419365576216
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9529111978290701
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   reg_alpha: 5.114020852306642e-07
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0003097731129743343
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,510 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,516 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,516 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,516 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,516 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,516 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,516 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,516 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,517 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,517 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,523 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,523 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,523 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,523 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,523 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,523 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,523 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,523 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,524 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,524 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,524 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,524 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,524 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,524 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,524 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,525 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,525 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,525 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,525 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,525 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,525 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,525 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,525 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,525 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,525 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,525 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,525 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,525 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,525 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,525 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,525 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,525 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,525 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,525 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,525 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,525 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,528 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,528 - src.hyperparameter_tuning - ERROR - Trial 77 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,545 - src.hyperparameter_tuning - INFO - Trial 78: 모델 타입 = lightgbm
2025-06-24 09:42:51,549 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,549 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,549 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,549 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,549 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,549 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,550 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,550 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,550 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,550 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,550 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,550 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,550 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,550 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,550 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,550 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,550 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,550 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,551 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,551 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,551 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,551 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,551 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,551 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,551 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,551 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,551 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,551 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,555 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,557 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,557 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,557 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,557 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,557 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,557 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,557 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,559 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,561 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,561 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,562 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,562 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,562 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,562 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,562 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,562 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,562 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,562 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,562 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,562 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,562 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,562 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,562 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,562 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,562 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,563 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,563 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,563 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,564 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,564 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,564 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,564 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,564 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,564 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,564 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,564 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,564 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,564 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,564 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,564 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,564 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,565 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,565 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,566 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,566 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,566 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,566 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,567 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,567 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,567 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,567 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,567 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,567 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,567 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,567 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   learning_rate: 0.016976948057482684
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   n_estimators: 393
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   subsample: 0.7883441898007725
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9375725893666309
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   reg_alpha: 1.6432227257309933e-07
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0009728369901229373
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,568 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,573 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,574 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,574 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,574 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,574 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,574 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,574 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,574 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,574 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,575 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,575 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,575 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,577 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,577 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,577 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,577 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,577 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,577 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,577 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,577 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,578 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,578 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,578 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,578 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,578 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,578 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,579 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,579 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,579 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,579 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,579 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,579 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,579 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,579 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,579 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,579 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,579 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,579 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,579 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,579 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,579 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,579 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,579 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,579 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,579 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,579 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,579 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,579 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,582 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,582 - src.hyperparameter_tuning - ERROR - Trial 78 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,600 - src.hyperparameter_tuning - INFO - Trial 79: 모델 타입 = lightgbm
2025-06-24 09:42:51,603 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,604 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,604 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,604 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,604 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,604 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,604 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,604 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,604 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,605 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,605 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,605 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,605 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,605 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,605 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,605 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,605 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,605 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,606 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,606 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,606 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,606 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,606 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,606 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,606 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,606 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,606 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,606 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,610 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,612 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,612 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,612 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,612 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,612 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,612 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,612 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,614 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,617 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,617 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,617 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,617 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,617 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,617 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,617 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,617 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,617 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,617 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,618 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,618 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,618 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,618 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,618 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,618 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,618 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,618 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,618 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,618 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,619 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,619 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,619 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,619 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,619 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,619 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,619 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,619 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,619 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,619 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,619 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,619 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,620 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,620 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,621 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,621 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,621 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,621 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,621 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,621 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,622 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,623 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,623 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,623 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,623 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,623 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,623 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,623 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,623 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   learning_rate: 0.2593451809950288
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   n_estimators: 524
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   subsample: 0.9892833490980313
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8114549676244355
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0024320305460977846
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00011587610553415014
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,624 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,627 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,627 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,627 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,627 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,627 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,627 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,628 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,628 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,629 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,630 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,630 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,630 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,630 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,630 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,630 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,630 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,630 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,630 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,631 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,631 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,631 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,631 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,631 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,631 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,632 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,632 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,632 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,632 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,632 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,632 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,632 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,632 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,632 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,632 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,632 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,632 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,632 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,632 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,632 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,632 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,632 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,632 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,632 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,632 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,632 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,635 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,635 - src.hyperparameter_tuning - ERROR - Trial 79 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,652 - src.hyperparameter_tuning - INFO - Trial 80: 모델 타입 = lightgbm
2025-06-24 09:42:51,655 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,656 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,656 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,656 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,656 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,656 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,656 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,656 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,656 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,657 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,657 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,657 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,657 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,657 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,657 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,657 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,657 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,657 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,658 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,658 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,658 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,658 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,658 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,658 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,658 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,658 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,658 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,658 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,662 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,664 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,664 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,664 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,664 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,664 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,664 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,664 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,666 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,668 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,668 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,668 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,668 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,668 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,668 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,668 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,668 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,668 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,668 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,669 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,669 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,669 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,669 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,669 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,669 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,669 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,670 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,670 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,670 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,671 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,671 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,671 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,671 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,671 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,671 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,671 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,671 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,671 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,671 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,671 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,671 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,671 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,672 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,672 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,672 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,672 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,672 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,672 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,673 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,673 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,673 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,673 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,673 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,673 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,674 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,674 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,674 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,674 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,674 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,674 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,674 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,674 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,674 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,674 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,674 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,674 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,674 - src.models.lightgbm_model - INFO -   learning_rate: 0.07813911661457104
2025-06-24 09:42:51,674 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,674 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   n_estimators: 302
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   subsample: 0.8875096072240903
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6433794276239841
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0011379545210007589
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO -   reg_lambda: 4.306976213595928e-07
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,675 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,677 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,677 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,677 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,677 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,677 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,677 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,677 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,678 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,678 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,679 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,679 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,679 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,679 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,685 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,685 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,685 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,685 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,685 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,685 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,685 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,685 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,685 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,686 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,686 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,686 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,686 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,686 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,686 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,687 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,687 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,687 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,687 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,687 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,687 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,687 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,687 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,687 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,687 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,687 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,687 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,687 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,687 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,687 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,687 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,687 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,687 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,687 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,687 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,687 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,690 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,690 - src.hyperparameter_tuning - ERROR - Trial 80 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,707 - src.hyperparameter_tuning - INFO - Trial 81: 모델 타입 = lightgbm
2025-06-24 09:42:51,710 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,711 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,711 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,711 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,711 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,711 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,711 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,711 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,711 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,712 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,712 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,712 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,712 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,712 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,712 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,712 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,712 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,712 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,713 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,713 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,713 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,713 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,713 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,713 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,713 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,713 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,713 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,713 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,716 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,718 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,718 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,718 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,718 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,719 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,719 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,719 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,721 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,723 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,723 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,723 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,723 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,723 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,723 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,723 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,723 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,723 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,723 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,723 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,723 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,724 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,724 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,724 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,724 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,724 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,724 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,724 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,724 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,725 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,725 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,725 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,725 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,725 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,725 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,725 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,725 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,725 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,725 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,725 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,725 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,726 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,726 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,727 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,727 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,727 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,728 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,728 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,728 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,728 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,728 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   learning_rate: 0.013390824935990937
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   n_estimators: 225
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   subsample: 0.8655718258437664
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6268140816663329
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   reg_alpha: 0.13849867415852568
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO -   reg_lambda: 2.1834271927039548e-06
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,729 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,732 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,732 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,732 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,732 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,732 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,733 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,733 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,733 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,733 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,739 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,739 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,739 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,739 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,739 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,739 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,739 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,739 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,739 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,739 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,740 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,740 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,740 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,740 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,740 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,741 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,741 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,741 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,741 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,741 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,741 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,741 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,741 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,741 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,741 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,741 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,741 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,741 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,741 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,741 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,741 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,741 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,741 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,741 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,741 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,741 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,744 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,744 - src.hyperparameter_tuning - ERROR - Trial 81 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,761 - src.hyperparameter_tuning - INFO - Trial 82: 모델 타입 = lightgbm
2025-06-24 09:42:51,764 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,765 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,765 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,765 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,765 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,765 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,765 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,765 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,765 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,765 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,765 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,765 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,765 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,765 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,765 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,765 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,765 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,765 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,766 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,766 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,766 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,766 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,766 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,766 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,766 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,767 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,767 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,767 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,770 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,772 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,772 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,772 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,772 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,772 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,772 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,772 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,774 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,776 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,776 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,776 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,776 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,776 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,776 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,776 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,777 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,777 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,777 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,777 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,777 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,777 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,777 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,777 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,777 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,777 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,778 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,778 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,778 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,779 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,779 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,779 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,779 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,779 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,779 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,779 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,779 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,779 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,779 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,779 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,779 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,779 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,780 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,780 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,781 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,781 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,782 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,782 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO -   learning_rate: 0.015254010311290964
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,782 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   n_estimators: 270
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   subsample: 0.9338363605752303
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6435775161794274
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   reg_alpha: 0.10966313007085868
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO -   reg_lambda: 1.8570005277345276e-07
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,783 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,788 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,788 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,788 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,788 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,788 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,788 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,788 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,788 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,788 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,789 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,789 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,789 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,789 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,789 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,789 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,789 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,789 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,794 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,794 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,794 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,794 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,794 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,794 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,794 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,794 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,794 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,795 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,795 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,795 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,795 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,795 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,795 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,796 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,796 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,796 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,796 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,796 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,796 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,796 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,796 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,796 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,796 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,796 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,796 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,796 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,796 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,796 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,796 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,796 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,796 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,796 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,796 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,796 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,799 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,799 - src.hyperparameter_tuning - ERROR - Trial 82 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,816 - src.hyperparameter_tuning - INFO - Trial 83: 모델 타입 = lightgbm
2025-06-24 09:42:51,819 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,820 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,820 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,820 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,820 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,820 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,820 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,820 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,820 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,821 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,821 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,821 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,821 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,821 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,821 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,821 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,821 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,821 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,822 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,822 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,822 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,822 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,822 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,822 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,822 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,822 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,822 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,822 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,825 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,828 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,828 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,828 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,828 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,828 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,828 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,828 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,830 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,832 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,832 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,832 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,832 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,832 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,832 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,832 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,832 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,832 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,832 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,833 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,833 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,833 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,833 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,833 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,833 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,833 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,833 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,833 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,833 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,834 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,834 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,834 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,834 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,834 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,834 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,834 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,834 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,834 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,834 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,834 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,834 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,834 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,834 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,835 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,835 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,836 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,836 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,836 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,836 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,836 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,836 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,836 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,836 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,836 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,837 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,837 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,837 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,837 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,837 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,837 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,837 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,837 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,837 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,837 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,837 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   learning_rate: 0.019506751038527934
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   n_estimators: 72
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   subsample: 0.9016055807922
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6786527742452434
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   reg_alpha: 0.5179817334010663
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO -   reg_lambda: 2.585526747106335e-05
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,838 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,845 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,845 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,845 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,845 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,845 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,846 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,847 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,847 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,852 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,852 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,852 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,852 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,852 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,852 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,852 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,852 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,852 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,853 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,853 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,853 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,853 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,853 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,853 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,854 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,854 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,854 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,854 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,854 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,854 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,854 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,854 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,854 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,854 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,854 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,854 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,854 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,854 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,854 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,854 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,854 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,854 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,854 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,854 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,854 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,857 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,857 - src.hyperparameter_tuning - ERROR - Trial 83 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,874 - src.hyperparameter_tuning - INFO - Trial 84: 모델 타입 = lightgbm
2025-06-24 09:42:51,877 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,878 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,878 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,878 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,878 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,878 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,878 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,878 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,878 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,879 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,879 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,879 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,879 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,879 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,879 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,879 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,879 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,879 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,880 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,880 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,880 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,880 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,880 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,880 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,880 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,880 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,880 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,880 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,884 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,886 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,886 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,886 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,886 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,886 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,886 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,886 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,888 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,890 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,890 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,890 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,890 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,890 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,890 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,890 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,890 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,890 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,890 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,891 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,891 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,891 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,891 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,891 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,891 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,891 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,892 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,892 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,892 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,893 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,893 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,893 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,893 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,893 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,893 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,893 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,893 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,893 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,893 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,893 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,893 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,893 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,894 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,894 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,894 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,894 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,894 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,894 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,895 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,895 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,895 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,896 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,896 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   learning_rate: 0.011761518315917473
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,896 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:42:51,897 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,897 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,897 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,897 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,897 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,897 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,897 - src.models.lightgbm_model - INFO -   n_estimators: 336
2025-06-24 09:42:51,897 - src.models.lightgbm_model - INFO -   subsample: 0.8814774332424677
2025-06-24 09:42:51,897 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6589836190226069
2025-06-24 09:42:51,897 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:42:51,897 - src.models.lightgbm_model - INFO -   reg_alpha: 0.03740462540171629
2025-06-24 09:42:51,897 - src.models.lightgbm_model - INFO -   reg_lambda: 9.421800508700533e-07
2025-06-24 09:42:51,897 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,897 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,897 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,899 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,899 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,899 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,899 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,899 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,900 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,901 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,901 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,906 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,906 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,906 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,906 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,906 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,906 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,906 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,906 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,906 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,907 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,907 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,907 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,907 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,907 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,907 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,908 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,908 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,908 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,908 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,908 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,908 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,908 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,908 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,908 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,908 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,908 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,908 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,908 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,908 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,908 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,908 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,908 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,908 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,908 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,908 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,908 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,911 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,911 - src.hyperparameter_tuning - ERROR - Trial 84 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,928 - src.hyperparameter_tuning - INFO - Trial 85: 모델 타입 = lightgbm
2025-06-24 09:42:51,932 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,932 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,932 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,932 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,932 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,932 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,932 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,932 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,932 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,933 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,933 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,933 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,933 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,933 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,933 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,933 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,933 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,933 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,934 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,934 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,934 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,934 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,934 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,934 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,934 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,934 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,934 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,934 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,938 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,940 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,940 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,940 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,940 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,940 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,940 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,940 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,942 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,944 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:51,944 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,944 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,944 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:51,944 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:51,944 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,944 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:51,944 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:51,944 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,944 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,945 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:51,945 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:51,945 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,945 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,945 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:51,945 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:51,945 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,945 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,945 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:51,946 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:51,946 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:51,946 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:51,946 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:51,946 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:51,946 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:51,946 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:51,946 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:51,946 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:51,946 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,946 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:51,947 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:51,947 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:51,947 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:51,947 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,947 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,947 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,947 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,947 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,947 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,948 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,948 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,948 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:51,948 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:51,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,949 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,949 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,949 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,949 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,949 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,949 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,949 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,949 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,950 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:51,950 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   learning_rate: 0.023369091605691176
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   n_estimators: 416
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   subsample: 0.9285006889587568
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6911826263958073
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   reg_alpha: 0.005586000009250545
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO -   reg_lambda: 1.0365316887043513e-07
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:51,950 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:51,954 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:51,954 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:51,954 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:51,954 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:51,954 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:51,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:51,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:51,955 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:51,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:51,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:51,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:51,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:51,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:51,956 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:51,956 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,956 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:51,962 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:51,962 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:51,962 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:51,962 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:51,962 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,962 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,962 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:51,962 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:51,962 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:51,963 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:51,963 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:51,963 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:51,963 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,963 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,963 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,964 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:51,964 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:51,964 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:51,964 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:51,964 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:51,964 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:51,964 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:51,964 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:51,964 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:51,964 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:51,964 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:51,964 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:51,964 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:51,964 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:51,964 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:51,964 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:51,964 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:51,964 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,964 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,964 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:51,964 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:51,967 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:51,967 - src.hyperparameter_tuning - ERROR - Trial 85 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:51,984 - src.hyperparameter_tuning - INFO - Trial 86: 모델 타입 = lightgbm
2025-06-24 09:42:51,987 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:51,988 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:51,988 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:51,988 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:51,988 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:51,988 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:51,988 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:51,988 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:51,988 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:51,989 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:51,989 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:51,989 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:51,989 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:51,989 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:51,989 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:51,989 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:51,989 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:51,989 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:51,990 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,990 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,990 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:51,990 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:51,990 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,990 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:51,990 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:51,990 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:51,990 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:51,990 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:51,994 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:51,996 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:51,996 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:51,996 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:51,996 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:51,996 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:51,996 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:51,996 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:51,998 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,000 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:52,000 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,000 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,000 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,000 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,000 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,000 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,000 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:52,000 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,000 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,001 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:52,001 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:52,001 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,001 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,001 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:52,001 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:52,001 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,001 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,001 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,001 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:52,002 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:52,002 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:52,002 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:52,002 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:52,002 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:52,002 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:52,002 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:52,002 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:52,002 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,002 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:52,002 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:52,002 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:52,003 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:52,003 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,003 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,003 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,004 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,004 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,004 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:52,004 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,004 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:52,004 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,004 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,004 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,004 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,005 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,005 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,005 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,005 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,005 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,005 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,005 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,005 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,006 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:52,006 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   learning_rate: 0.0167210164277769
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   n_estimators: 126
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   subsample: 0.8121859411209759
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.600980416597681
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   reg_alpha: 0.015484276919204112
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO -   reg_lambda: 3.60403122472424e-07
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:52,006 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:52,010 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:52,010 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:52,010 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:52,010 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:52,010 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:52,010 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,010 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,011 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,011 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,011 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,011 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,011 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,011 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,012 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,012 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,012 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,012 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:52,017 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:52,017 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:52,017 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:52,017 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:52,017 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,017 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,017 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:52,017 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:52,017 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:52,017 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:52,018 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:52,018 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:52,018 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,018 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,018 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,019 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,019 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:52,019 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:52,019 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:52,019 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:52,019 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:52,019 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:52,019 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:52,019 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:52,019 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:52,019 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:52,019 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:52,019 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:52,019 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:52,019 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:52,019 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:52,019 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:52,019 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,019 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,019 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,019 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,022 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:52,022 - src.hyperparameter_tuning - ERROR - Trial 86 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:52,039 - src.hyperparameter_tuning - INFO - Trial 87: 모델 타입 = lightgbm
2025-06-24 09:42:52,043 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:52,044 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:52,044 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:52,044 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:52,044 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:52,044 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:52,044 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:52,044 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:52,044 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:52,045 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:52,045 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:52,045 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:52,045 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:52,045 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:52,045 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:52,045 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:52,045 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:52,045 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:52,046 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,046 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,046 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,046 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,046 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,046 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:52,046 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:52,046 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:52,046 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:52,046 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:52,049 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:52,052 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,052 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:52,052 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:52,052 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:52,052 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:52,052 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:52,052 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,054 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,056 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:52,056 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,056 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,056 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,056 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,056 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,056 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,056 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:52,056 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,056 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,057 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:52,057 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:52,057 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,057 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,057 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:52,057 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:52,057 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,058 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,058 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,058 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:52,059 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:52,059 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:52,059 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:52,059 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:52,059 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:52,059 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:52,059 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:52,059 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:52,059 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,059 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:52,059 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:52,059 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:52,059 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:52,059 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,059 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,059 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,060 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,060 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,060 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,060 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,060 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:52,060 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:52,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,061 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,061 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,061 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,062 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,062 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,062 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,062 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,062 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,062 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:52,062 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,062 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,062 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,062 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:52,062 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   learning_rate: 0.08737941929340731
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   n_estimators: 485
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   subsample: 0.7725397087037676
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9032259116266748
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   reg_alpha: 3.4172998319315425e-06
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO -   reg_lambda: 8.925646395185016e-06
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:52,063 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:52,066 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:52,066 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:52,066 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:52,066 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:52,066 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:52,066 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,066 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,066 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,066 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,067 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,067 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,067 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,067 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,067 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:52,073 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:52,073 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:52,073 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:52,073 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:52,073 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,073 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,073 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:52,073 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:52,073 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:52,074 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:52,074 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:52,074 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:52,074 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,074 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,074 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,075 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,075 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:52,075 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:52,075 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:52,075 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:52,075 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:52,075 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:52,075 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:52,075 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:52,075 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:52,075 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:52,075 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:52,075 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:52,075 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:52,075 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:52,075 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:52,075 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:52,075 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,075 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,075 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,075 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,078 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:52,078 - src.hyperparameter_tuning - ERROR - Trial 87 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:52,095 - src.hyperparameter_tuning - INFO - Trial 88: 모델 타입 = lightgbm
2025-06-24 09:42:52,098 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:52,099 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:52,099 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:52,099 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:52,099 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:52,099 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:52,099 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:52,099 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:52,099 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:52,100 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:52,100 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:52,100 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:52,100 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:52,100 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:52,100 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:52,100 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:52,100 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:52,100 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:52,101 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,101 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,101 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,101 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,101 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,101 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:52,101 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:52,101 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:52,101 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:52,101 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:52,104 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:52,107 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,107 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:52,107 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:52,107 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:52,107 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:52,107 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:52,107 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,109 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,111 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:52,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,111 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,111 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,111 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:52,111 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,111 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,112 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:52,112 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:52,112 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,112 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,112 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:52,112 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:52,112 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,112 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,112 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,112 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:52,113 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:52,113 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:52,113 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:52,113 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:52,113 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:52,113 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:52,113 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:52,113 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:52,113 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,113 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:52,113 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:52,113 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:52,113 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:52,113 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,114 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,115 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:52,115 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:52,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,115 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,116 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,116 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,116 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:52,116 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   learning_rate: 0.20084862043853582
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   n_estimators: 436
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   subsample: 0.6836681494518045
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7513030717936812
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0001317813499998491
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO -   reg_lambda: 2.3433791053557896e-06
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:52,117 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:52,135 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:52,135 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:52,135 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:52,135 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:52,135 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:52,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,136 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,136 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,137 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,137 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:52,137 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:52,137 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:52,137 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:52,137 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:52,137 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,137 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,137 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:52,137 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:52,137 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:52,137 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:52,138 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:52,138 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:52,138 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,138 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,138 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,138 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,139 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:52,139 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:52,139 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:52,139 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:52,139 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:52,139 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:52,139 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:52,139 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:52,139 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:52,139 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:52,139 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:52,139 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:52,139 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:52,139 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:52,139 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:52,139 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:52,139 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,139 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,139 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,139 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,141 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:52,142 - src.hyperparameter_tuning - ERROR - Trial 88 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:52,159 - src.hyperparameter_tuning - INFO - Trial 89: 모델 타입 = lightgbm
2025-06-24 09:42:52,163 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:52,164 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:52,164 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:52,164 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:52,164 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:52,164 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:52,164 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:52,164 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:52,164 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:52,164 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:52,164 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:52,164 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:52,164 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:52,164 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:52,164 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:52,164 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:52,164 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:52,164 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:52,165 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,165 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,165 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,165 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,165 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,165 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:52,165 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:52,165 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:52,165 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:52,165 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:52,169 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:52,171 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,171 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:52,171 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:52,171 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:52,171 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:52,171 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:52,171 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,173 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,175 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:52,175 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,175 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,175 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,175 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,175 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,176 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,176 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:52,176 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,176 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,176 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:52,176 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:52,176 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,176 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,176 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:52,176 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:52,176 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,177 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,177 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,177 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:52,178 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:52,178 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:52,178 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:52,178 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:52,178 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:52,178 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:52,178 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:52,178 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:52,178 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,178 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:52,178 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:52,178 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:52,178 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:52,178 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,178 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,178 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,179 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,179 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,179 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,179 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,179 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:52,179 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:52,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,180 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,180 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,181 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,181 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,181 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:52,181 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO -   learning_rate: 0.010712348865860803
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:52,181 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   n_estimators: 569
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   subsample: 0.9715163381303065
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8835099955381397
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   reg_alpha: 3.181288168420014e-08
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO -   reg_lambda: 0.003706339122281663
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:52,182 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:52,184 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:52,184 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:52,184 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:52,184 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:52,184 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:52,184 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,184 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,184 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,185 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,186 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,186 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:52,186 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:52,186 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:52,186 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:52,186 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:52,186 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,186 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,186 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:52,186 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:52,186 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:52,186 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:52,186 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:52,187 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:52,187 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,187 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,187 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,187 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,188 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:52,188 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:52,188 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:52,188 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:52,188 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:52,188 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:52,188 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:52,188 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:52,188 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:52,188 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:52,188 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:52,188 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:52,188 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:52,188 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:52,188 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:52,188 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:52,188 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,188 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,188 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,188 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,190 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:52,190 - src.hyperparameter_tuning - ERROR - Trial 89 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:52,208 - src.hyperparameter_tuning - INFO - Trial 90: 모델 타입 = lightgbm
2025-06-24 09:42:52,211 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:52,212 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:52,212 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:52,212 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:52,212 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:52,212 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:52,212 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:52,212 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:52,212 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:52,213 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:52,213 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:52,213 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:52,213 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:52,213 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:52,213 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:52,213 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:52,213 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:52,213 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:52,214 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,214 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,214 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,214 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,214 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,214 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:52,214 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:52,214 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:52,214 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:52,214 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:52,218 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:52,220 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,220 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:52,220 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:52,220 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:52,220 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:52,220 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:52,220 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,222 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,224 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:52,224 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,224 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,224 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,224 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,224 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,224 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,224 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:52,224 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,224 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,225 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:52,225 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:52,225 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,225 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,225 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:52,225 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:52,225 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,226 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,226 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,226 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:52,227 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:52,227 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:52,227 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:52,227 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:52,227 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:52,227 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:52,227 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:52,227 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:52,227 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,227 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:52,227 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:52,227 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:52,227 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:52,227 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,227 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,227 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,227 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,228 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,228 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,228 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,228 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,228 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:52,228 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,228 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:52,228 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,228 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,228 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,229 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,229 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,230 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,230 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,230 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:52,230 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,230 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,230 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,230 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:52,230 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:52,230 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:52,230 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:52,230 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:52,230 - src.models.lightgbm_model - INFO -   learning_rate: 0.17292774562587593
2025-06-24 09:42:52,230 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:52,230 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   n_estimators: 249
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   subsample: 0.9100639628414496
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7319861545848053
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   reg_alpha: 6.841319298994953e-08
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO -   reg_lambda: 7.294516932532824e-08
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:52,231 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:52,234 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:52,234 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:52,234 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:52,234 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:52,234 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:52,234 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,234 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,234 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,234 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,235 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,235 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,235 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,235 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,235 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,235 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,235 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:52,241 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:52,241 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:52,241 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:52,241 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:52,241 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,241 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,241 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:52,241 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:52,241 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:52,242 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:52,242 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:52,242 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:52,242 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,242 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,242 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,243 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,243 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:52,243 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:52,243 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:52,243 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:52,243 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:52,243 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:52,243 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:52,243 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:52,243 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:52,243 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:52,243 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:52,243 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:52,243 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:52,243 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:52,243 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:52,243 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:52,243 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,243 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,243 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,243 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,246 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:52,246 - src.hyperparameter_tuning - ERROR - Trial 90 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:52,263 - src.hyperparameter_tuning - INFO - Trial 91: 모델 타입 = lightgbm
2025-06-24 09:42:52,267 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:52,267 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:52,268 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:52,268 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:52,268 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:52,268 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:52,268 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:52,268 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:52,268 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:52,268 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:52,268 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:52,268 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:52,268 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:52,268 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:52,268 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:52,268 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:52,268 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:52,268 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:52,269 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,269 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,269 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,269 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,269 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,269 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:52,269 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:52,269 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:52,269 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:52,270 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:52,273 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:52,275 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,275 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:52,275 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:52,275 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:52,275 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:52,275 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:52,275 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,277 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,279 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:52,279 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,279 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,279 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,280 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,280 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,280 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,280 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:52,280 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,280 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,280 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:52,280 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:52,280 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,280 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,280 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:52,280 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:52,280 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,281 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,281 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,281 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:52,282 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:52,282 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:52,282 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:52,282 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:52,282 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:52,282 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:52,282 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:52,282 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:52,282 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,282 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:52,282 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:52,282 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:52,282 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:52,282 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,282 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,282 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,283 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,283 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,283 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,283 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,283 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:52,283 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,283 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:52,283 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,284 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,284 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,284 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,284 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,284 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,284 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,284 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,284 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,285 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,285 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,285 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:52,285 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,285 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,285 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,285 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:52,285 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:52,285 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:52,285 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:52,285 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:52,285 - src.models.lightgbm_model - INFO -   learning_rate: 0.11013898979209548
2025-06-24 09:42:52,285 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   n_estimators: 86
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   subsample: 0.9578849478844019
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9636601537167676
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   reg_alpha: 1.4565994044938084e-05
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO -   reg_lambda: 4.107640210812544e-06
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:52,286 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:52,296 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:52,296 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:52,296 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:52,296 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:52,296 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:52,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,297 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:52,298 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:52,298 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:52,298 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:52,298 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:52,298 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,298 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,298 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:52,298 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:52,299 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:52,299 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:52,299 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:52,299 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:52,299 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,299 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,299 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,300 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,300 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:52,300 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:52,300 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:52,300 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:52,300 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:52,300 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:52,300 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:52,300 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:52,300 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:52,300 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:52,300 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:52,300 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:52,300 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:52,300 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:52,300 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:52,300 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:52,300 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,300 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,300 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,300 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,303 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:52,303 - src.hyperparameter_tuning - ERROR - Trial 91 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:52,321 - src.hyperparameter_tuning - INFO - Trial 92: 모델 타입 = lightgbm
2025-06-24 09:42:52,324 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:52,325 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:52,325 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:52,325 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:52,325 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:52,325 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:52,325 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:52,325 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:52,325 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:52,326 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:52,326 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:52,326 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:52,326 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:52,326 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:52,326 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:52,326 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:52,326 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:52,326 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:52,327 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,327 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,327 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,327 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,327 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,327 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:52,327 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:52,327 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:52,327 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:52,327 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:52,331 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:52,333 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,333 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:52,333 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:52,333 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:52,333 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:52,333 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:52,333 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,335 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,337 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:52,337 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,337 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,337 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,337 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,337 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,337 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,337 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:52,338 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,338 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,338 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:52,338 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:52,338 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,338 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,338 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:52,338 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:52,338 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,339 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,339 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,339 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:52,340 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:52,340 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:52,340 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:52,340 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:52,340 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:52,340 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:52,340 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:52,340 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:52,340 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,340 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:52,340 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:52,340 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:52,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:52,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,340 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,341 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:52,341 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:52,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,342 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:52,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   learning_rate: 0.06512620613719415
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:52,343 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   n_estimators: 62
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   subsample: 0.9440049750817702
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9069793609426638
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   reg_alpha: 1.3433121325142226e-06
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO -   reg_lambda: 2.1808112052856218e-08
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:52,344 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:52,346 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:52,346 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:52,346 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:52,346 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:52,346 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:52,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,347 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,348 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,348 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,348 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:52,354 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:52,354 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:52,354 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:52,354 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:52,354 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,354 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,354 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:52,354 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:52,354 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:52,355 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:52,355 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:52,355 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:52,355 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,355 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,355 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,356 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,356 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:52,356 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:52,356 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:52,356 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:52,356 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:52,356 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:52,356 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:52,356 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:52,356 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:52,356 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:52,356 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:52,356 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:52,356 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:52,356 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:52,356 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:52,356 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:52,356 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,356 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,356 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,356 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,359 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:52,359 - src.hyperparameter_tuning - ERROR - Trial 92 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:52,377 - src.hyperparameter_tuning - INFO - Trial 93: 모델 타입 = lightgbm
2025-06-24 09:42:52,380 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:52,381 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:52,381 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:52,381 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:52,381 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:52,381 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:52,381 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:52,381 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:52,381 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:52,381 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:52,381 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:52,381 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:52,381 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:52,381 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:52,382 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:52,382 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:52,382 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:52,382 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:52,383 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,383 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,383 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,383 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,383 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,383 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:52,383 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:52,383 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:52,383 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:52,383 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:52,386 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:52,388 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,388 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:52,388 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:52,388 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:52,388 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:52,388 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:52,388 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,391 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,393 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:52,393 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,393 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,393 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,393 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,393 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,393 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,393 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:52,393 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,393 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,393 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:52,393 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:52,393 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,393 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,393 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:52,393 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:52,394 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,394 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,394 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,394 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:52,395 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:52,395 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:52,395 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:52,395 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:52,395 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:52,395 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:52,395 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:52,395 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:52,395 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,395 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:52,395 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:52,395 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:52,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:52,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,396 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,397 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:52,397 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:52,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,397 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,398 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,398 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:52,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,398 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,398 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,398 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   learning_rate: 0.144034078327933
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   n_estimators: 161
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   subsample: 0.891280205171518
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9241422630860318
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   reg_alpha: 7.365332985642187e-05
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO -   reg_lambda: 5.580919445808581e-05
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:52,399 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:52,402 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:52,402 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:52,402 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:52,402 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:52,402 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:52,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,403 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,404 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,404 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:52,409 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:52,409 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:52,409 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:52,409 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:52,409 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,409 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,409 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:52,409 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:52,409 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:52,409 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:52,410 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:52,410 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:52,410 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,410 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,410 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,411 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,411 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:52,411 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:52,411 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:52,411 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:52,411 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:52,411 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:52,411 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:52,411 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:52,411 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:52,411 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:52,411 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:52,411 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:52,411 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:52,411 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:52,411 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:52,411 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:52,411 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,411 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,411 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,411 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,414 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:52,414 - src.hyperparameter_tuning - ERROR - Trial 93 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:52,431 - src.hyperparameter_tuning - INFO - Trial 94: 모델 타입 = lightgbm
2025-06-24 09:42:52,435 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:52,436 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:52,436 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:52,436 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:52,436 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:52,436 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:52,436 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:52,436 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:52,436 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:52,436 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:52,436 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:52,436 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:52,436 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:52,436 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:52,436 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:52,436 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:52,436 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:52,436 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:52,437 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,437 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,437 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,437 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,437 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,437 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:52,437 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:52,437 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:52,437 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:52,437 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:52,441 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:52,443 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,443 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:52,443 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:52,443 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:52,443 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:52,443 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:52,443 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,445 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,447 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:52,447 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,447 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,447 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,447 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,447 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,448 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,448 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:52,448 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,448 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,448 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:52,448 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:52,448 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,448 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,448 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:52,448 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:52,448 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,449 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,449 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,449 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:52,450 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:52,450 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:52,450 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:52,450 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:52,450 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:52,450 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:52,450 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:52,450 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:52,450 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,450 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:52,450 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:52,450 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:52,450 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:52,450 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,450 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,450 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,451 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:52,451 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:52,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,452 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,452 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,453 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,453 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,453 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:52,453 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO -   learning_rate: 0.03226966411568605
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:52,453 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   n_estimators: 111
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   subsample: 0.8275247108212429
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6198230292372529
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00034040068930289746
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO -   reg_lambda: 4.96586351698221e-07
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:52,454 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:52,456 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:52,456 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:52,456 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:52,456 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:52,456 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:52,456 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,456 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,457 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,458 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,458 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,458 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:52,458 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:52,458 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:52,458 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:52,458 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:52,458 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,458 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,458 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:52,458 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:52,458 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:52,458 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:52,459 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:52,459 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:52,459 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,459 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,459 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,459 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,460 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:52,460 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:52,460 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:52,460 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:52,460 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:52,460 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:52,460 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:52,460 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:52,460 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:52,460 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:52,460 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:52,460 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:52,460 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:52,460 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:52,460 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:52,460 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:52,460 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,460 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,460 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,460 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,462 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:52,463 - src.hyperparameter_tuning - ERROR - Trial 94 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:52,481 - src.hyperparameter_tuning - INFO - Trial 95: 모델 타입 = lightgbm
2025-06-24 09:42:52,484 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:52,485 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:52,485 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:52,485 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:52,485 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:52,485 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:52,485 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:52,485 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:52,485 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:52,486 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:52,486 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:52,486 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:52,486 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:52,486 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:52,486 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:52,486 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:52,486 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:52,486 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:52,487 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,487 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,487 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,487 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,487 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,487 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:52,487 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:52,487 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:52,487 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:52,487 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:52,490 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:52,492 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,492 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:52,492 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:52,492 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:52,492 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:52,492 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:52,493 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,495 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,497 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:52,497 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,497 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,497 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,497 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,497 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,497 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,497 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:52,497 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,497 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,497 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:52,497 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:52,497 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,498 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,498 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:52,498 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:52,498 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,498 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,498 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,498 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:52,499 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:52,499 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:52,499 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:52,499 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:52,499 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:52,499 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:52,499 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:52,499 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:52,499 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,499 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:52,499 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:52,499 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:52,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:52,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,500 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,500 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,500 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,500 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,500 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,500 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,501 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:52,501 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:52,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,501 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,502 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,502 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:52,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,502 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,502 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,502 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   learning_rate: 0.23289446247753645
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   n_estimators: 199
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   subsample: 0.9182339907634957
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8414284434329359
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   reg_alpha: 0.30891866315595923
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO -   reg_lambda: 7.06945184557314
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:52,503 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:52,506 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:52,506 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:52,506 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:52,506 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:52,506 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:52,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,507 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,508 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,508 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:52,514 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:52,514 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:52,514 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:52,514 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:52,514 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,514 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,514 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:52,514 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:52,514 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:52,515 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:52,515 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:52,515 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:52,515 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,515 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,515 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,516 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,516 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:52,516 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:52,516 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:52,516 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:52,516 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:52,516 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:52,516 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:52,516 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:52,516 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:52,516 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:52,516 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:52,516 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:52,516 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:52,516 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:52,516 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:52,516 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:52,516 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,516 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,516 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,516 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,519 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:52,519 - src.hyperparameter_tuning - ERROR - Trial 95 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:52,537 - src.hyperparameter_tuning - INFO - Trial 96: 모델 타입 = lightgbm
2025-06-24 09:42:52,540 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:52,541 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:52,541 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:52,541 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:52,541 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:52,541 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:52,541 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:52,541 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:52,541 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:52,541 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:52,541 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:52,541 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:52,541 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:52,541 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:52,541 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:52,541 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:52,541 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:52,542 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:52,542 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,542 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,542 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,542 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,543 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,543 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:52,543 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:52,543 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:52,543 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:52,543 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:52,546 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:52,548 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,548 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:52,548 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:52,548 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:52,548 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:52,548 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:52,548 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,550 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,552 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:52,552 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,553 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,553 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,553 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,553 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,553 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,553 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:52,553 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,553 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,553 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:52,553 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:52,553 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,553 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,553 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:52,553 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:52,553 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,554 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,554 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,554 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:52,555 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:52,555 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:52,555 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:52,555 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:52,555 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:52,555 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:52,555 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:52,555 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:52,555 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,555 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:52,555 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:52,555 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:52,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:52,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,555 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,556 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:52,556 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:52,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,557 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:52,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,558 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,558 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,558 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:52,558 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:52,558 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:52,558 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   learning_rate: 0.0128858323826597
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   n_estimators: 392
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   subsample: 0.9883471561917563
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9800264200829185
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0008163736186869123
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO -   reg_lambda: 7.146987388366111e-08
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:52,559 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:52,561 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:52,561 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:52,561 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:52,561 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:52,561 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:52,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,562 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,563 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,563 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,563 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:52,563 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:52,563 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:52,563 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:52,563 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:52,563 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,563 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,563 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:52,563 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:52,563 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:52,563 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:52,564 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:52,564 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:52,564 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,564 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,564 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,565 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,565 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:52,565 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:52,565 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:52,565 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:52,565 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:52,565 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:52,565 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:52,565 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:52,565 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:52,565 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:52,565 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:52,565 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:52,565 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:52,565 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:52,565 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:52,565 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:52,565 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,565 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,565 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,565 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,568 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:52,568 - src.hyperparameter_tuning - ERROR - Trial 96 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:52,586 - src.hyperparameter_tuning - INFO - Trial 97: 모델 타입 = lightgbm
2025-06-24 09:42:52,589 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:52,590 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:52,590 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:52,590 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:52,590 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:52,590 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:52,590 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:52,590 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:52,590 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:52,591 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:52,591 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:52,591 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:52,591 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:52,591 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:52,591 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:52,591 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:52,591 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:52,591 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:52,592 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,592 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,592 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,592 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,592 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,592 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:52,592 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:52,592 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:52,592 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:52,592 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:52,595 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:52,598 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,598 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:52,598 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:52,598 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:52,598 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:52,598 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:52,598 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,600 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,602 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:52,602 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,602 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,602 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,602 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,602 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,602 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,602 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:52,602 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,602 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,603 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:52,603 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:52,603 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,603 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,603 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:52,603 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:52,603 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,603 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,603 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,603 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:52,604 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:52,604 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:52,604 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:52,604 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:52,604 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:52,604 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:52,604 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:52,604 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:52,604 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,604 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:52,604 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:52,604 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:52,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:52,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,605 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,605 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,606 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,606 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:52,606 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,606 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:52,606 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,606 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,606 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,606 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,606 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,607 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,607 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:52,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,607 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,607 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,607 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   learning_rate: 0.04708035431951437
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   n_estimators: 545
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   subsample: 0.8481306135407106
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8777043418153438
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   reg_alpha: 5.301017506056371e-06
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO -   reg_lambda: 1.4157321646404635e-07
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:52,608 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:52,611 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:52,611 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:52,611 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:52,611 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:52,611 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:52,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,611 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,612 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,612 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:52,616 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:52,616 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:52,616 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:52,616 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:52,616 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,616 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,616 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:52,616 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:52,616 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:52,616 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:52,617 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:52,617 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:52,617 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,617 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,617 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,618 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,618 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:52,618 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:52,618 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:52,618 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:52,618 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:52,618 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:52,618 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:52,618 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:52,618 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:52,618 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:52,618 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:52,618 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:52,618 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:52,618 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:52,618 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:52,618 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:52,618 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,618 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,618 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,618 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,621 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:52,621 - src.hyperparameter_tuning - ERROR - Trial 97 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:52,639 - src.hyperparameter_tuning - INFO - Trial 98: 모델 타입 = lightgbm
2025-06-24 09:42:52,642 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:52,643 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:52,643 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:52,643 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:52,643 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:52,643 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:52,643 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:52,643 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:52,643 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:52,643 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:52,643 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:52,643 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:52,643 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:52,643 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:52,643 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:52,643 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:52,643 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:52,643 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:52,644 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,644 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,644 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,644 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,644 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,645 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:52,645 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:52,645 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:52,645 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:52,645 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:52,648 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:52,650 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,650 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:52,650 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:52,650 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:52,650 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:52,650 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:52,650 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,652 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,654 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:52,654 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,655 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,655 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,655 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,655 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,655 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,655 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:52,655 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,655 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,655 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:52,655 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:52,655 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,655 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,655 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:52,655 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:52,655 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,656 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,656 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,656 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:52,657 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:52,657 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:52,657 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:52,657 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:52,657 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:52,657 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:52,657 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:52,657 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:52,657 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,657 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:52,657 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:52,657 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:52,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:52,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,657 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,658 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:52,658 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:52,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,659 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,659 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,659 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,660 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,660 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:52,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,660 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,660 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,660 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:52,660 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   learning_rate: 0.014754168878137339
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   n_estimators: 354
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   subsample: 0.7178025885121065
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8037627937927796
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   reg_alpha: 2.5408310634329025e-06
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO -   reg_lambda: 1.658568588495107e-05
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:52,661 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:52,664 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:52,664 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:52,664 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:52,664 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:52,664 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:52,664 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,664 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,664 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,664 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,665 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,665 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:52,670 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:52,670 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:52,670 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:52,670 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:52,670 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,670 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,670 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:52,670 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:52,670 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:52,671 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:52,671 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:52,671 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:52,671 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,671 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,671 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,672 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,672 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:52,672 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:52,672 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:52,672 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:52,672 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:52,672 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:52,672 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:52,672 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:52,672 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:52,672 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:52,672 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:52,672 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:52,672 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:52,672 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:52,672 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:52,672 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:52,672 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,672 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,672 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,672 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,675 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:52,675 - src.hyperparameter_tuning - ERROR - Trial 98 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:52,693 - src.hyperparameter_tuning - INFO - Trial 99: 모델 타입 = lightgbm
2025-06-24 09:42:52,696 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:42:52,697 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:42:52,697 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:42:52,697 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:42:52,697 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:42:52,697 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:42:52,697 - src.training - INFO - 교차 검증 시작
2025-06-24 09:42:52,697 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:42:52,697 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:42:52,697 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:42:52,697 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:42:52,698 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:42:52,698 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:42:52,698 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:42:52,698 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:42:52,698 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:42:52,698 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:42:52,698 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:42:52,699 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,699 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,699 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:42:52,699 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:42:52,699 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,699 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:42:52,699 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:42:52,699 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:42:52,699 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:42:52,699 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:42:52,702 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:42:52,704 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,704 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:42:52,704 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:42:52,704 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:42:52,704 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:42:52,704 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:42:52,704 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:42:52,706 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:42:52,708 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:42:52,708 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,709 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,709 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:42:52,709 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:42:52,709 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,709 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:42:52,709 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:42:52,709 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,709 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,709 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:42:52,709 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:42:52,709 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,709 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,709 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:42:52,709 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:42:52,709 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,710 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,710 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:42:52,710 - src.training - INFO - 모델 학습 시작
2025-06-24 09:42:52,711 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:42:52,711 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:42:52,711 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:42:52,711 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:42:52,711 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:42:52,711 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:42:52,711 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:42:52,711 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:42:52,711 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,711 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:42:52,711 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:42:52,711 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:42:52,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:42:52,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,711 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,712 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:42:52,712 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:42:52,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,713 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,714 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,714 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:42:52,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,714 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:42:52,714 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,714 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:42:52,714 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   learning_rate: 0.03847826310814636
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   n_estimators: 139
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   subsample: 0.9029634435810079
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8644492537002094
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   reg_alpha: 1.8669869859858968e-05
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO -   reg_lambda: 1.3473548198935023e-08
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:42:52,715 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:42:52,717 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:42:52,717 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:42:52,717 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:42:52,717 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:42:52,718 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:42:52,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:42:52,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:42:52,718 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:42:52,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:42:52,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:42:52,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:42:52,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:42:52,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:42:52,719 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:42:52,719 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:42:52,719 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:42:52,719 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:42:52,719 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:42:52,719 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:42:52,719 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,719 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,719 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:42:52,719 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:42:52,720 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:42:52,720 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:42:52,720 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:42:52,720 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:42:52,720 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,720 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,720 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,721 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:42:52,721 - src.training - INFO -   precision: 0.0
2025-06-24 09:42:52,721 - src.training - INFO -   recall: 0.0
2025-06-24 09:42:52,721 - src.training - INFO -   f1: 0.0
2025-06-24 09:42:52,721 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:42:52,721 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:42:52,721 - src.training - INFO -   positive_samples: 0
2025-06-24 09:42:52,721 - src.training - INFO -   negative_samples: 250
2025-06-24 09:42:52,721 - src.training - INFO -   total_samples: 250
2025-06-24 09:42:52,721 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:42:52,721 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:42:52,721 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:42:52,721 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:42:52,721 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:42:52,721 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:42:52,721 - src.training - INFO - 모델 학습 완료
2025-06-24 09:42:52,721 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:42:52,721 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,721 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,721 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:42:52,721 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:42:52,724 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:42:52,724 - src.hyperparameter_tuning - ERROR - Trial 99 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:42:52,724 - src.hyperparameter_tuning - INFO - 튜닝 완료 - 최고 성능: -inf
2025-06-24 09:42:52,724 - src.hyperparameter_tuning - INFO - 튜닝 시간: 5.14초
2025-06-24 09:42:52,729 - __main__ - INFO - 튜닝 결과 저장 중...
2025-06-24 09:42:52,729 - __main__ - ERROR - 결과 저장 실패: 'NoneType' object has no attribute 'copy'
2025-06-24 09:42:52,729 - __main__ - INFO - 최고 성능: -inf
2025-06-24 09:42:52,729 - __main__ - INFO - 최적 파라미터:
2025-06-24 09:42:52,729 - __main__ - INFO -   n_estimators: 406
2025-06-24 09:42:52,729 - __main__ - INFO -   max_depth: 12
2025-06-24 09:42:52,729 - __main__ - INFO -   learning_rate: 0.1205712628744377
2025-06-24 09:42:52,729 - __main__ - INFO -   subsample: 0.8394633936788146
2025-06-24 09:42:52,729 - __main__ - INFO -   colsample_bytree: 0.6624074561769746
2025-06-24 09:42:52,729 - __main__ - INFO -   min_child_weight: 2
2025-06-24 09:42:52,729 - __main__ - INFO -   reg_alpha: 3.3323645788192616e-08
2025-06-24 09:42:52,729 - __main__ - INFO -   reg_lambda: 0.6245760287469893

==================================================
튜닝 결과 요약
==================================================
모델 타입: lightgbm
실험 타입: hyperparameter_tuning
사용 데이터 행 수: 1,000
MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/50893be0e85f4bcdae5b0f6ee8c14582
최고 성능: -inf
최적 파라미터: {'n_estimators': 406, 'max_depth': 12, 'learning_rate': 0.1205712628744377, 'subsample': 0.8394633936788146, 'colsample_bytree': 0.6624074561769746, 'min_child_weight': 2, 'reg_alpha': 3.3323645788192616e-08, 'reg_lambda': 0.6245760287469893}
튜닝 시간: 5.1431496143341064
==================================================
2025-06-24 09:42:52,730 - __main__ - INFO - 실험 결과가 /home/junhyung/Documents/simcare/kbsmc_suicide/results/experiment_results_20250624_094252.txt에 저장되었습니다.
2025-06-24 09:42:52,730 - __main__ - INFO - MLflow Experiment ID: 765186397364671153
2025-06-24 09:42:52,730 - __main__ - INFO - MLflow Run ID: 50893be0e85f4bcdae5b0f6ee8c14582
2025-06-24 09:42:52,730 - __main__ - INFO - MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/50893be0e85f4bcdae5b0f6ee8c14582
