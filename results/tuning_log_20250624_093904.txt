2025-06-24 09:39:04,200 - src.hyperparameter_tuning - INFO - MLflow 실험 설정: hyperparameter_tuning (ID: 765186397364671153)
2025-06-24 09:39:04,200 - src.hyperparameter_tuning - INFO - 데이터 로드 중: data/processed/processed_data_with_features.csv
2025-06-24 09:39:04,205 - src.hyperparameter_tuning - INFO - 테스트용 데이터 로드: 1,000 행
2025-06-24 09:39:04,205 - src.hyperparameter_tuning - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,205 - src.hyperparameter_tuning - INFO - 튜닝 설정 - 시도 횟수: 100, 타임아웃: 3600초
2025-06-24 09:39:04,205 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 튜너 초기화 완료
2025-06-24 09:39:04,205 - src.hyperparameter_tuning - INFO -   - 튜닝 설정: {'data': {'file_path': 'data/processed_data.csv', 'encoding': 'utf-8', 'na_values': ['', 'nan', 'NaN', 'NULL', 'null']}, 'features': {'target_columns': ['suicide_a_next_year'], 'exclude_columns': ['id', 'patient_id', 'visit_date', 'visit_year'], 'categorical_columns': ['gender', 'marital_status', 'education_level', 'income_level', 'residence_type', 'insurance_type', 'primary_diagnosis', 'comorbidity', 'medication_type', 'treatment_type', 'follow_up_status'], 'selected_features': ['age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score'], 'validation': {'scope': 'sample', 'sample_size': 10}, 'enable_feature_engineering': False, 'enable_lagged_features': False, 'lag_periods': [1, 2, 3], 'lagged_features': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}, 'enable_rolling_stats': False, 'rolling_stats': {'window_sizes': [2, 3], 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}}, 'preprocessing': {'time_series_imputation': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp'], 'fallback_strategy': 'mean'}, 'numerical_imputation': {'strategy': 'mean', 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']}, 'categorical_imputation': {'strategy': 'most_frequent', 'columns': ['sex']}, 'categorical_encoding': {'method': 'ordinal'}, 'missing_value_strategy': 'median', 'outlier_detection': {'method': 'iqr', 'threshold': 1.5}, 'scaling': {'method': 'robust', 'with_mean': True, 'with_std': True}, 'feature_selection': {'method': 'variance_threshold', 'threshold': 0.01}}, 'data_split': {'test_ids_ratio': 0.15, 'random_state': 42, 'method': 'stratified_kfold', 'n_splits': 5, 'test_size': 0.2, 'val_size': 0.2}, 'validation': {'strategy': 'group_kfold', 'num_cv_folds': 3, 'test_size': 0.15, 'random_state': 42, 'val_ids_ratio': 0.15, 'validation_start_year': 2021, 'min_train_years': 3, 'max_train_years': 8}, 'time_series': {'date_column': 'dov', 'year_column': 'yov', 'id_column': 'id'}, 'evaluation': {'regression_metrics': ['mae', 'rmse', 'r2'], 'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2'], 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True, 'primary_metric': 'f1_score', 'secondary_metrics': ['recall', 'precision', 'balanced_accuracy', 'roc_auc'], 'cv': {'strategy': 'group_kfold', 'n_folds': 5, 'shuffle': False}}, 'training': {'early_stopping': True, 'patience': 10, 'handle_imbalance': True, 'save_best_model': True, 'model_save_path': 'models/'}, 'logging': {'log_splits_info': True, 'log_fold_details': True, 'level': 'INFO', 'format': '%(asctime)s - %(name)s - %(levelname)s - %(message)s', 'file': 'logs/experiment.log'}, 'output': {'directory': 'results', 'save_model': True, 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True}, 'mlflow': {'experiment_name': 'hyperparameter_tuning', 'experiment_description': '자살 위험 예측 모델 실험', 'tags': ['suicide_prediction', 'healthcare', 'classification', 'regression'], 'nested_runs': True, 'save_artifacts': True, 'log_params': True, 'log_metrics': True, 'log_model': True, 'tracking': {'tracking_uri': 'file:./mlruns', 'experiment_name': 'suicide_prediction', 'nested_runs': True, 'artifact_location': './mlruns'}, 'logging': {'param_logging_level': 'INFO', 'metric_logging_level': 'INFO', 'artifact_logging_level': 'INFO', 'log_experiment_info': True, 'log_fold_results': True, 'log_model_info': True}, 'log_optimization': True}, 'model': {'model_type': 'lightgbm', 'lightgbm': {'num_leaves': 31, 'learning_rate': 0.1, 'feature_fraction': 0.9, 'bagging_fraction': 0.8, 'bagging_freq': 5, 'min_data_in_leaf': 20, 'min_sum_hessian_in_leaf': '1e-3', 'lambda_l1': 0.1, 'lambda_l2': 0.1, 'num_threads': 28, 'verbose': -1, 'early_stopping_rounds': 10, 'max_cat_threshold': 32, 'cat_smooth': 10.0, 'cat_l2': 10.0, 'is_unbalance': True, 'scale_pos_weight': 1.0, 'class_weight': 'balanced', 'boosting_type': 'gbdt', 'objective': 'binary', 'metric': 'binary_logloss', 'max_depth': 6, 'min_gain_to_split': 0.0, 'min_child_samples': 20, 'bagging_seed': 42, 'feature_fraction_seed': 42, 'drop_seed': 42, 'data_random_seed': 42, 'use_focal_loss': False, 'focal_loss': {'alpha': 0.25, 'gamma': 2.0}}}, 'imbalanced_data': {'resampling': {'enabled': False, 'method': 'smote', 'smote': {'k_neighbors': 5, 'sampling_strategy': 'auto'}, 'borderline_smote': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'm_neighbors': 10}, 'adasyn': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'n_neighbors': 5}, 'under_sampling': {'strategy': 'random', 'sampling_strategy': 'auto'}}, 'class_weight': 'balanced', 'scale_pos_weight': 1.0, 'is_unbalance': True}, 'experiment': {'name': 'hyperparameter_tuning_experiment', 'description': 'Optuna 기반 하이퍼파라미터 최적화 실험', 'tags': ['hyperparameter_tuning', 'optuna', 'optimization']}, 'tuning': {'direction': 'maximize', 'n_trials': 50, 'n_jobs': 1, 'early_stopping': {'enabled': True, 'patience': 20, 'min_trials': 30}}, 'sampler': {'type': 'tpe', 'tpe': {'n_startup_trials': 10, 'n_ei_candidates': 24, 'multivariate': True, 'group': False}, 'cmaes': {'x0': {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'min_child_weight': 1, 'reg_alpha': 0.1, 'reg_lambda': 1.0}, 'sigma0': 0.1}}, 'xgboost_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 15, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'scale_pos_weight': {'type': 'float', 'low': 0.5, 'high': 10.0, 'log': True}}, 'lightgbm_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 12, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}}, 'catboost_params': {'iterations': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'depth': {'type': 'int', 'low': 3, 'high': 10, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'l2_leaf_reg': {'type': 'float', 'low': 1, 'high': 10, 'log': True}, 'border_count': {'type': 'int', 'low': 32, 'high': 255, 'log': False}, 'bagging_temperature': {'type': 'float', 'low': 0.1, 'high': 1.0, 'log': False}, 'random_strength': {'type': 'float', 'low': 0.1, 'high': 10.0, 'log': True}}, 'random_forest_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 20, 'log': False}, 'min_samples_split': {'type': 'int', 'low': 2, 'high': 20, 'log': False}, 'min_samples_leaf': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'max_features': {'type': 'categorical', 'choices': ['sqrt', 'log2', 'auto']}}, 'results': {'save_best_model': True, 'model_save_path': 'models/best_tuned_model.joblib', 'save_study': True, 'study_save_path': 'models/optuna_study.pkl', 'create_plots': True, 'plots_save_path': 'data/tuning_results/'}}
2025-06-24 09:39:04,205 - src.hyperparameter_tuning - INFO -   - 튜닝 횟수: 100
2025-06-24 09:39:04,205 - src.hyperparameter_tuning - INFO -   - 타임아웃: 3600초
2025-06-24 09:39:04,205 - __main__ - INFO - 하이퍼파라미터 최적화 실행 중...
2025-06-24 09:39:04,205 - src.hyperparameter_tuning - INFO - === 하이퍼파라미터 튜닝 시작 ===
2025-06-24 09:39:04,206 - src.hyperparameter_tuning - INFO - Trial 0: 모델 타입 = lightgbm
2025-06-24 09:39:04,210 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,211 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,211 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,211 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,211 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,211 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,211 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,211 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,211 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,212 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,212 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,212 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,212 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,212 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,212 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,212 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,213 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,213 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,214 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,214 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,214 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,214 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,214 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,214 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,214 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,214 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,214 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,214 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,219 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,221 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,221 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,221 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,221 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,221 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,221 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,221 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,223 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,225 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,225 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,225 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,225 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,225 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,225 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,225 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,225 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,225 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,225 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,226 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,226 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,226 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,226 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,226 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,226 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,226 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,226 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,227 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,227 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,227 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,227 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,228 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,228 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,228 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,228 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,228 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,228 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,228 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,228 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,228 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,228 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,228 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,228 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,228 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,228 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,228 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,228 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,229 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,229 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,229 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,229 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,229 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,229 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,230 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,230 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,231 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,231 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,231 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,231 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,231 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,231 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,231 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,231 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,231 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,231 - src.models.lightgbm_model - INFO -   learning_rate: 0.1205712628744377
2025-06-24 09:39:04,231 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   n_estimators: 406
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   subsample: 0.8394633936788146
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6624074561769746
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   reg_alpha: 3.3323645788192616e-08
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO -   reg_lambda: 0.6245760287469893
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,232 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,236 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,236 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,236 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,236 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,236 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,237 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,238 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,238 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,238 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,238 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,238 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,238 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,238 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,238 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,238 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,238 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,238 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,239 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,239 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,239 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,239 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,239 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,239 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,240 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,240 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,240 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,240 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,240 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,240 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,240 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,240 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,240 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,240 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,240 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,240 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,240 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,240 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,240 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,240 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,240 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,240 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,240 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,240 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,240 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,240 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,243 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,243 - src.hyperparameter_tuning - ERROR - Trial 0 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,244 - src.hyperparameter_tuning - INFO - Trial 1: 모델 타입 = lightgbm
2025-06-24 09:39:04,248 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,249 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,249 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,249 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,249 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,249 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,249 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,249 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,249 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,249 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,250 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,250 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,250 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,250 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,250 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,250 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,250 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,250 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,251 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,251 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,251 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,251 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,251 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,251 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,251 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,251 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,251 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,251 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,255 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,257 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,257 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,257 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,257 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,257 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,257 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,257 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,259 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,261 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,261 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,261 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,261 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,261 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,261 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,261 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,261 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,261 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,261 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,262 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,262 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,262 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,262 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,262 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,262 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,262 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,262 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,262 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,262 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,263 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,263 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,263 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,263 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,263 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,263 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,263 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,263 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,263 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,263 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,263 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,263 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,263 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,263 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,263 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,264 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,264 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,264 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,264 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,264 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,264 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,265 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,265 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,265 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,265 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,265 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,265 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,265 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,265 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,265 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,266 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,266 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,266 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,266 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,266 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,266 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,266 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   learning_rate: 0.010725209743171997
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   n_estimators: 621
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   subsample: 0.9879639408647978
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9329770563201687
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   reg_alpha: 4.329370014459266e-07
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO -   reg_lambda: 4.4734294104626844e-07
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,267 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,270 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,270 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,270 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,270 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,270 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,270 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,270 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,270 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,270 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,270 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,271 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,271 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,271 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,271 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,271 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,271 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,271 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,273 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,274 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,274 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,274 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,274 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,274 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,274 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,274 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,274 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,274 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,274 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,274 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,274 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,274 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,275 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,275 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,275 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,275 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,275 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,275 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,275 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,275 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,275 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,275 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,275 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,275 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,275 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,275 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,275 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,275 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,275 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,275 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,275 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,275 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,276 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,276 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,278 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,278 - src.hyperparameter_tuning - ERROR - Trial 1 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,279 - src.hyperparameter_tuning - INFO - Trial 2: 모델 타입 = lightgbm
2025-06-24 09:39:04,282 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,283 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,283 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,283 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,283 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,283 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,283 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,283 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,283 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,284 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,284 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,284 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,284 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,284 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,284 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,284 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,284 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,284 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,285 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,285 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,285 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,285 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,285 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,285 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,285 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,285 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,285 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,285 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,288 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,290 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,290 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,290 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,290 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,290 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,290 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,290 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,292 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,294 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,294 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,294 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,294 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,294 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,294 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,295 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,295 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,295 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,295 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,295 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,295 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,295 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,295 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,295 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,295 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,295 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,296 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,296 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,296 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,297 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,297 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,297 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,297 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,297 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,297 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,297 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,297 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,297 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,297 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,297 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,297 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,297 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,299 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,299 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,300 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,300 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,300 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,300 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO -   learning_rate: 0.04345454109729477
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,300 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   n_estimators: 339
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   subsample: 0.7164916560792167
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8447411578889518
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   reg_alpha: 4.258943089524393e-06
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO -   reg_lambda: 1.9826980964985924e-05
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,301 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,303 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,303 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,303 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,303 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,303 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,303 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,303 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,304 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,304 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,305 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,305 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,305 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,308 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,308 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,308 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,308 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,308 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,308 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,308 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,308 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,308 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,308 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,309 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,309 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,309 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,309 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,309 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,310 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,310 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,310 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,310 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,310 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,310 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,310 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,310 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,310 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,310 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,310 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,310 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,310 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,310 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,310 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,310 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,310 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,310 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,310 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,310 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,310 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,312 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,312 - src.hyperparameter_tuning - ERROR - Trial 2 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,313 - src.hyperparameter_tuning - INFO - Trial 3: 모델 타입 = lightgbm
2025-06-24 09:39:04,317 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,317 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,317 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,317 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,317 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,317 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,317 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,317 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,317 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,318 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,318 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,318 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,318 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,318 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,318 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,318 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,318 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,318 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,319 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,319 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,319 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,319 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,319 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,319 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,319 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,319 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,319 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,319 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,323 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,325 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,325 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,325 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,325 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,325 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,325 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,326 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,328 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,329 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,329 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,330 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,330 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,330 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,330 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,330 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,330 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,330 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,330 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,330 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,330 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,330 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,330 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,330 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,330 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,330 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,331 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,331 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,331 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,332 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,332 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,332 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,332 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,332 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,332 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,332 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,332 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,332 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,332 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,332 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,332 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,332 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,332 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,332 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,333 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,333 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,333 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,334 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,334 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,334 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,335 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,335 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,335 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,335 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,335 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   learning_rate: 0.019721610970574007
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   n_estimators: 483
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   subsample: 0.8056937753654446
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.836965827544817
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0029369981104377003
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO -   reg_lambda: 3.425445902633376e-07
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,336 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,339 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,339 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,339 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,339 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,339 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,339 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,339 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,339 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,339 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,339 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,340 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,340 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,342 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,342 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,342 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,342 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,342 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,342 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,342 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,342 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,342 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,342 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,342 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,342 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,343 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,343 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,343 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,343 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,344 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,344 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,344 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,344 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,344 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,344 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,344 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,344 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,344 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,344 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,344 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,344 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,344 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,344 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,344 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,344 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,344 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,344 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,344 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,344 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,346 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,346 - src.hyperparameter_tuning - ERROR - Trial 3 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,347 - src.hyperparameter_tuning - INFO - Trial 4: 모델 타입 = lightgbm
2025-06-24 09:39:04,351 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,351 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,351 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,351 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,351 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,351 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,351 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,351 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,351 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,352 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,352 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,352 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,352 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,352 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,352 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,352 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,352 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,352 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,353 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,353 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,353 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,353 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,353 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,353 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,353 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,353 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,353 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,353 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,357 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,359 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,359 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,359 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,359 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,359 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,359 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,359 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,361 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,363 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,363 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,363 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,363 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,363 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,363 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,363 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,363 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,363 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,363 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,364 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,364 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,364 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,364 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,364 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,364 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,364 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,364 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,364 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,365 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,365 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,365 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,365 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,365 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,365 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,365 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,365 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,365 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,365 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,366 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,366 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,366 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,366 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,366 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,366 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,366 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,366 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,366 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,366 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,367 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,367 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,367 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,367 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,367 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,367 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,367 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,367 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,367 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,368 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,368 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,368 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,368 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,368 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,368 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,368 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,368 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   learning_rate: 0.26690431824362526
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,369 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO -   n_estimators: 111
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO -   subsample: 0.9233589392465844
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7218455076693483
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO -   reg_alpha: 0.014391207615728067
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO -   reg_lambda: 9.148975058772307e-05
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,370 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,372 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,372 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,372 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,372 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,373 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,373 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,373 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,373 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,373 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,374 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,374 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,376 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,376 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,376 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,376 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,376 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,376 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,376 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,376 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,376 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,377 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,377 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,377 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,377 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,377 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,377 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,378 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,378 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,378 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,378 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,378 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,378 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,378 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,378 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,378 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,378 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,378 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,378 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,378 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,378 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,378 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,378 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,378 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,378 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,378 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,378 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,378 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,380 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,380 - src.hyperparameter_tuning - ERROR - Trial 4 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,381 - src.hyperparameter_tuning - INFO - Trial 5: 모델 타입 = lightgbm
2025-06-24 09:39:04,385 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,385 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,385 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,385 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,385 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,385 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,385 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,385 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,385 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,386 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,386 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,386 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,386 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,386 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,386 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,386 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,386 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,386 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,387 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,387 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,387 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,387 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,387 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,387 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,387 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,387 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,387 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,387 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,391 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,393 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,393 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,393 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,393 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,393 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,393 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,393 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,395 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,397 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,397 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,397 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,397 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,397 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,397 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,397 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,397 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,397 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,397 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,398 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,398 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,398 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,398 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,398 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,398 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,398 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,399 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,399 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,399 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,400 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,400 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,400 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,400 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,400 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,400 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,400 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,400 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,400 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,400 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,400 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,400 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,400 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,400 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,401 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,401 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,402 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,403 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,403 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,403 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,403 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,403 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,403 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   learning_rate: 0.011240768803005551
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   n_estimators: 166
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   subsample: 0.9637281608315128
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7035119926400067
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   reg_alpha: 6.388511557344611e-06
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0004793052550782129
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,404 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,407 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,407 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,408 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,408 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,408 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,408 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,408 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,408 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,408 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,408 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,408 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,409 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,409 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,409 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,409 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,409 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,409 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,414 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,414 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,414 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,414 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,414 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,414 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,414 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,414 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,414 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,415 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,415 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,415 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,415 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,415 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,415 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,416 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,416 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,416 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,416 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,416 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,416 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,416 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,416 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,416 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,416 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,416 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,416 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,416 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,416 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,416 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,416 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,416 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,416 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,416 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,416 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,416 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,418 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,418 - src.hyperparameter_tuning - ERROR - Trial 5 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,419 - src.hyperparameter_tuning - INFO - Trial 6: 모델 타입 = lightgbm
2025-06-24 09:39:04,423 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,423 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,423 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,423 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,423 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,423 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,423 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,423 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,423 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,424 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,424 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,424 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,424 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,424 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,424 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,424 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,424 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,424 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,425 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,425 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,425 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,425 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,425 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,425 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,425 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,425 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,425 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,425 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,429 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,431 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,431 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,431 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,431 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,431 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,431 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,431 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,433 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,435 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,435 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,435 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,435 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,435 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,435 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,435 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,435 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,435 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,435 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,435 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,435 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,435 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,435 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,435 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,435 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,436 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,436 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,436 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,436 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,437 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,437 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,437 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,437 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,437 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,437 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,437 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,437 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,437 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,437 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,437 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,437 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,438 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,438 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,438 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,439 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,439 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,439 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,440 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,440 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,440 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,440 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,440 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,440 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,440 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,440 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   learning_rate: 0.27051668818999286
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   n_estimators: 569
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   subsample: 0.9100531293444458
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9757995766256756
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   reg_alpha: 0.002404915432737351
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO -   reg_lambda: 1.9809253750493907
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,441 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,444 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,444 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,444 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,444 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,444 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,444 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,444 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,445 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,445 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,451 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,451 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,451 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,451 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,451 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,451 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,451 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,451 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,451 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,452 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,452 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,452 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,452 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,452 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,452 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,453 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,453 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,453 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,453 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,453 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,453 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,453 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,453 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,453 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,453 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,453 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,453 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,453 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,453 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,453 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,453 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,453 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,453 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,453 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,453 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,453 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,455 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,455 - src.hyperparameter_tuning - ERROR - Trial 6 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,456 - src.hyperparameter_tuning - INFO - Trial 7: 모델 타입 = lightgbm
2025-06-24 09:39:04,460 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,460 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,460 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,460 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,460 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,460 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,460 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,460 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,460 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,461 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,461 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,461 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,461 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,461 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,461 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,461 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,461 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,461 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,462 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,462 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,462 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,462 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,462 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,462 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,462 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,462 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,462 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,462 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,466 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,468 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,468 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,468 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,468 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,468 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,468 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,468 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,470 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,472 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,472 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,472 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,472 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,472 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,472 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,472 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,472 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,472 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,472 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,473 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,473 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,473 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,473 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,473 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,473 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,473 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,473 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,473 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,473 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,474 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,474 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,474 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,474 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,474 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,474 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,474 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,474 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,474 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,474 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,475 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,475 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,475 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,475 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,475 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,475 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,476 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,476 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,476 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,476 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,476 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,476 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,476 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,476 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,476 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,477 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,477 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,477 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,478 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,478 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   learning_rate: 0.011662890273931383
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,478 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   n_estimators: 134
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   subsample: 0.7301321323053057
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7554709158757928
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   reg_alpha: 0.28749982347407854
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO -   reg_lambda: 1.6247252885719427e-05
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,479 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,482 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,482 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,482 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,482 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,482 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,482 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,482 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,483 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,483 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,483 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,485 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,485 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,485 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,485 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,485 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,485 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,485 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,485 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,485 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,486 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,486 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,486 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,486 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,486 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,486 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,487 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,487 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,487 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,487 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,487 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,487 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,487 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,487 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,487 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,487 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,487 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,487 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,487 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,487 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,487 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,487 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,487 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,487 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,487 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,487 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,487 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,489 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,489 - src.hyperparameter_tuning - ERROR - Trial 7 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,490 - src.hyperparameter_tuning - INFO - Trial 8: 모델 타입 = lightgbm
2025-06-24 09:39:04,494 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,494 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,494 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,494 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,494 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,494 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,494 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,494 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,494 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,495 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,495 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,495 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,495 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,495 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,495 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,495 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,495 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,495 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,497 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,497 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,497 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,497 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,497 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,497 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,497 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,497 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,497 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,497 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,501 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,503 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,503 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,503 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,503 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,503 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,503 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,503 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,505 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,507 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,507 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,507 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,507 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,507 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,507 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,508 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,508 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,508 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,508 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,508 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,508 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,508 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,508 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,508 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,508 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,508 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,509 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,509 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,509 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,510 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,510 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,510 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,510 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,510 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,510 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,510 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,510 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,510 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,510 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,510 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,510 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,510 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,510 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,510 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,510 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,510 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,511 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,511 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,511 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,511 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,511 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,511 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,512 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,513 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,513 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,513 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,513 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,513 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,513 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,513 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,513 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,513 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,513 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,513 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,513 - src.models.lightgbm_model - INFO -   learning_rate: 0.016149614799999188
2025-06-24 09:39:04,513 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,513 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,513 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,513 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,513 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   n_estimators: 317
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   subsample: 0.9208787923016158
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6298202574719083
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   reg_alpha: 0.08916674715636537
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO -   reg_lambda: 6.143857495033091e-07
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,514 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,516 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,516 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,516 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,516 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,517 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,517 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,518 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,518 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,518 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,524 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,524 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,524 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,524 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,524 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,524 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,524 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,524 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,524 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,524 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,525 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,525 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,525 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,525 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,525 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,526 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,526 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,526 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,526 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,526 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,526 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,526 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,526 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,526 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,526 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,526 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,526 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,526 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,526 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,526 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,526 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,526 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,526 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,526 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,526 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,526 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,528 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,528 - src.hyperparameter_tuning - ERROR - Trial 8 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,529 - src.hyperparameter_tuning - INFO - Trial 9: 모델 타입 = lightgbm
2025-06-24 09:39:04,533 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,533 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,533 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,533 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,533 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,533 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,533 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,533 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,533 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,534 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,534 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,534 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,534 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,534 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,534 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,534 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,534 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,534 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,535 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,535 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,535 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,535 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,535 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,535 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,535 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,535 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,535 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,535 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,539 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,541 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,541 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,541 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,541 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,541 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,541 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,541 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,543 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,545 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,545 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,545 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,545 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,545 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,545 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,545 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,545 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,545 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,545 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,546 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,546 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,546 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,546 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,546 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,546 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,546 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,546 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,546 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,546 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,547 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,547 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,547 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,547 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,547 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,547 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,547 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,547 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,547 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,547 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,547 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,547 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,547 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,547 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,548 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,548 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,548 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,548 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,548 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,549 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,549 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,549 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,549 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,550 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,550 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,550 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   learning_rate: 0.11069143219393454
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,551 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO -   n_estimators: 55
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO -   subsample: 0.8916028672163949
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9085081386743783
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO -   reg_alpha: 1.683416412018213e-05
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO -   reg_lambda: 1.1036250149900698e-07
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,552 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,554 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,554 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,554 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,554 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,554 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,554 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,554 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,555 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,555 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,555 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,555 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,555 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,555 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,555 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,555 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,557 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,557 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,558 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,558 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,558 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,558 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,558 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,558 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,558 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,558 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,558 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,558 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,558 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,558 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,559 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,559 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,559 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,559 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,559 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,559 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,559 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,559 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,559 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,559 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,559 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,559 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,559 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,559 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,559 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,559 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,559 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,559 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,559 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,559 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,559 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,559 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,562 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,562 - src.hyperparameter_tuning - ERROR - Trial 9 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,574 - src.hyperparameter_tuning - INFO - Trial 10: 모델 타입 = lightgbm
2025-06-24 09:39:04,578 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,579 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,579 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,579 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,579 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,579 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,579 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,579 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,579 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,579 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,579 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,579 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,579 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,579 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,579 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,579 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,579 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,579 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,580 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,580 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,580 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,580 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,580 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,581 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,581 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,581 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,581 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,581 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,584 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,587 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,587 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,587 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,587 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,587 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,587 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,587 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,589 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,591 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,591 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,591 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,591 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,591 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,591 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,591 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,591 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,591 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,591 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,591 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,591 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,591 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,591 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,591 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,591 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,592 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,592 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,592 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,592 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,593 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,593 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,593 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,593 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,593 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,593 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,593 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,593 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,593 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,593 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,593 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,593 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,593 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,593 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,593 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,594 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,594 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,594 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,595 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,595 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,595 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,595 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,595 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,595 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,595 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,596 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,596 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,597 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,597 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   learning_rate: 0.09315744902122479
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   n_estimators: 901
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   subsample: 0.6071847502459278
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6061470949312417
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   reg_alpha: 1.3686680646913267e-08
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO -   reg_lambda: 6.099006535330825
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,597 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,598 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,600 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,600 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,600 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,600 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,600 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,600 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,600 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,601 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,601 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,602 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,602 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,608 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,608 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,608 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,608 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,608 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,608 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,608 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,608 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,608 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,608 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,609 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,609 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,609 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,609 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,609 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,609 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,610 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,610 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,610 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,610 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,610 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,610 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,610 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,610 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,610 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,610 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,610 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,610 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,610 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,610 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,610 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,610 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,610 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,610 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,610 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,610 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,612 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,612 - src.hyperparameter_tuning - ERROR - Trial 10 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,626 - src.hyperparameter_tuning - INFO - Trial 11: 모델 타입 = lightgbm
2025-06-24 09:39:04,630 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,631 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,631 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,631 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,631 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,631 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,631 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,631 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,631 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,631 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,631 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,631 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,631 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,631 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,632 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,632 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,632 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,632 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,633 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,633 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,633 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,633 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,633 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,633 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,633 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,633 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,633 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,633 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,637 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,639 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,639 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,639 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,639 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,639 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,639 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,639 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,641 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,643 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,643 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,643 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,643 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,643 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,643 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,643 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,643 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,643 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,643 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,644 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,644 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,644 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,644 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,644 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,644 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,644 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,644 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,644 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,644 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,645 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,645 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,645 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,645 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,645 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,645 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,645 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,645 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,645 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,645 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,645 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,645 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,646 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,646 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,647 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,647 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,647 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,647 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,648 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,648 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,648 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,648 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,648 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,648 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,648 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   learning_rate: 0.037348440879763224
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   n_estimators: 705
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   subsample: 0.8275682686623269
2025-06-24 09:39:04,649 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9801238964661396
2025-06-24 09:39:04,650 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:39:04,650 - src.models.lightgbm_model - INFO -   reg_alpha: 2.0076751494057687e-08
2025-06-24 09:39:04,650 - src.models.lightgbm_model - INFO -   reg_lambda: 0.050437107744728454
2025-06-24 09:39:04,650 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,650 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,650 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,730 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,730 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,730 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,730 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,730 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,731 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,732 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,732 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,737 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,737 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,737 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,737 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,737 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,737 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,737 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,737 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,737 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,738 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,738 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,738 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,738 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,738 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,738 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,739 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,739 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,739 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,739 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,739 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,739 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,739 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,739 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,739 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,739 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,739 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,739 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,739 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,739 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,739 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,739 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,739 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,739 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,739 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,739 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,739 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,742 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,742 - src.hyperparameter_tuning - ERROR - Trial 11 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,754 - src.hyperparameter_tuning - INFO - Trial 12: 모델 타입 = lightgbm
2025-06-24 09:39:04,758 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,759 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,759 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,759 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,759 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,759 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,759 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,759 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,759 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,760 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,760 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,760 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,760 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,760 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,760 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,760 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,760 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,760 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,761 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,761 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,761 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,761 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,761 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,761 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,761 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,761 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,761 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,761 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,765 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,767 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,767 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,767 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,767 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,767 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,767 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,767 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,769 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,771 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,771 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,771 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,771 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,771 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,771 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,771 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,771 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,771 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,771 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,772 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,772 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,772 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,772 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,772 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,772 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,772 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,773 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,773 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,773 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,773 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,773 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,773 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,773 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,773 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,773 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,774 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,774 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,774 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,774 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,774 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,774 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,774 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,774 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,774 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,774 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,775 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,775 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,775 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,775 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,775 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,775 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,775 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,775 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,775 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,776 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,776 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,776 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   learning_rate: 0.11614923191803554
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   n_estimators: 706
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   subsample: 0.9831484441888799
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.902800604671404
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   reg_alpha: 5.997698489764049e-07
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO -   reg_lambda: 0.012341345845574371
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,777 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,780 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,780 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,780 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,780 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,780 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,781 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,781 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,782 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,787 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,787 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,787 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,787 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,787 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,787 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,787 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,787 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,787 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,787 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,788 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,788 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,788 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,788 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,788 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,789 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,789 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,789 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,789 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,789 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,789 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,789 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,789 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,789 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,789 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,789 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,789 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,789 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,789 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,789 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,789 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,789 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,789 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,789 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,789 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,789 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,791 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,791 - src.hyperparameter_tuning - ERROR - Trial 12 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,803 - src.hyperparameter_tuning - INFO - Trial 13: 모델 타입 = lightgbm
2025-06-24 09:39:04,807 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,808 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,808 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,808 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,808 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,808 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,808 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,808 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,808 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,808 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,808 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,808 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,808 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,808 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,808 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,808 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,808 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,808 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,809 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,809 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,809 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,809 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,809 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,809 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,809 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,809 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,809 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,809 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,813 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,815 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,815 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,815 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,815 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,815 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,815 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,815 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,817 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,819 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,819 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,819 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,819 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,819 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,819 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,819 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,819 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,819 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,819 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,820 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,820 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,820 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,820 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,820 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,820 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,820 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,820 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,821 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,821 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,821 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,821 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,821 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,821 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,821 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,821 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,821 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,821 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,821 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,821 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,822 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,822 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,822 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,823 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,823 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,824 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,824 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,824 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   learning_rate: 0.07369477793265464
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   n_estimators: 493
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   subsample: 0.8579178144028043
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6684815593910434
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   reg_alpha: 9.86874546485378
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO -   reg_lambda: 1.1101875524587999e-08
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,825 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,828 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,828 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,828 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,828 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,828 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,828 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,828 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,828 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,828 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,829 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,829 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,829 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,830 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,830 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,830 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,830 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,830 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,830 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,830 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,830 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,830 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,830 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,830 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,830 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,830 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,831 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,831 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,831 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,831 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,831 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,831 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,831 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,831 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,831 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,831 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,831 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,831 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,831 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,831 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,831 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,831 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,831 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,832 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,832 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,832 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,832 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,832 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,832 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,834 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,834 - src.hyperparameter_tuning - ERROR - Trial 13 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,847 - src.hyperparameter_tuning - INFO - Trial 14: 모델 타입 = lightgbm
2025-06-24 09:39:04,851 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,851 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,851 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,851 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,851 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,851 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,851 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,851 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,851 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,852 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,852 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,852 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,852 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,852 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,852 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,852 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,852 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,852 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,853 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,853 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,853 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,853 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,853 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,853 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,853 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,853 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,853 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,853 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,857 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,859 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,859 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,859 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,859 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,859 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,859 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,859 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,861 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,863 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,863 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,863 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,863 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,863 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,863 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,864 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,864 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,864 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,864 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,864 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,864 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,864 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,864 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,864 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,864 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,864 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,865 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,865 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,865 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,866 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,866 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,866 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,866 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,866 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,866 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,866 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,866 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,866 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,866 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,866 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,866 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,866 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,866 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,867 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,867 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,868 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,869 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,869 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   learning_rate: 0.17646596150449262
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,869 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   n_estimators: 702
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   subsample: 0.7376022736475862
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8046295483602256
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   reg_alpha: 2.3549110805943098e-07
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO -   reg_lambda: 0.06760969294969883
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,870 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,872 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,872 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,872 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,872 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,872 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,873 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,874 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,874 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,874 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,874 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,874 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,874 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,874 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,874 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,874 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,874 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,874 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,874 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,874 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,875 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,875 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,875 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,875 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,875 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,876 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,876 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,876 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,876 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,876 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,876 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,876 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,876 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,876 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,876 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,876 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,876 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,876 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,876 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,876 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,876 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,876 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,876 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,876 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,876 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,878 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,878 - src.hyperparameter_tuning - ERROR - Trial 14 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,890 - src.hyperparameter_tuning - INFO - Trial 15: 모델 타입 = lightgbm
2025-06-24 09:39:04,894 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,894 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,894 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,894 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,894 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,894 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,894 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,894 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,894 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,895 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,895 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,895 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,895 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,895 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,895 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,895 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,895 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,895 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,896 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,896 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,896 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,896 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,896 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,896 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,896 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,896 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,896 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,896 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,900 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,902 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,902 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,902 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,902 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,902 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,902 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,902 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,904 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,906 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,906 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,906 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,906 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,906 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,906 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,906 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,906 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,906 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,906 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,907 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,907 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,907 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,907 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,907 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,907 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,907 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,907 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,907 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,907 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,908 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,908 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,908 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,908 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,908 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,908 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,908 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,908 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,908 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,908 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,908 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,908 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,909 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,910 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,910 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,910 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,910 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,910 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,910 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,910 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,910 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,911 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,911 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,911 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,911 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,911 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,911 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,911 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,911 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,911 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   learning_rate: 0.026752568195150317
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   n_estimators: 997
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   subsample: 0.9967544619046032
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.896461276471979
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   reg_alpha: 8.925905274192813e-05
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0009166238280651257
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,912 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,914 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,915 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,915 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,915 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,915 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,915 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,915 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,915 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,915 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,916 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,916 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,916 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,916 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,916 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,916 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,916 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,916 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,916 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,916 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,916 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,916 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,916 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,917 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,917 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,917 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,917 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,917 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,917 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,917 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,918 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,918 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,918 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,918 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,918 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,918 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,918 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,918 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,918 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,918 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,918 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,918 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,918 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,918 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,918 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,918 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,918 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,918 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,918 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,918 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,918 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,920 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,920 - src.hyperparameter_tuning - ERROR - Trial 15 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,933 - src.hyperparameter_tuning - INFO - Trial 16: 모델 타입 = lightgbm
2025-06-24 09:39:04,937 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,937 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,937 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,937 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,937 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,937 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,937 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,937 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,938 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,938 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,938 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,938 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,938 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,938 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,938 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,938 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,938 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,938 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,939 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,939 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,939 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,939 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,939 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,939 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,939 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,939 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,939 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,939 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,943 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,945 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,945 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,945 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,945 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,945 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,945 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,945 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,947 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,949 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,949 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,949 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,949 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,949 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,949 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,949 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,949 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,949 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,949 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,950 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,950 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,950 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,950 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,950 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,950 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,950 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,951 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,951 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,951 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,951 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,951 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,952 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,952 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,952 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,952 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,952 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,952 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,952 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,952 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,952 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,952 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,952 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,952 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,952 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,952 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,952 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,952 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,953 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,953 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,953 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,953 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,953 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,953 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,953 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,953 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,953 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,954 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,955 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,955 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO -   learning_rate: 0.06988639938760517
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,955 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   n_estimators: 347
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   subsample: 0.769221734655711
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7657244060744415
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   reg_alpha: 2.9167530407966635e-07
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO -   reg_lambda: 0.4030789571311193
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,956 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:04,958 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:04,958 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:04,958 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:04,958 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:04,958 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:04,958 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,958 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,959 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,959 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,960 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,960 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,960 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,960 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:04,960 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:04,960 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:04,960 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:04,960 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:04,960 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,960 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,960 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:04,960 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:04,960 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:04,960 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:04,961 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:04,961 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:04,961 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,961 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,961 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,962 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:04,962 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:04,962 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:04,962 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:04,962 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:04,962 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:04,962 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:04,962 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:04,962 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:04,962 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:04,962 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:04,962 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:04,962 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:04,962 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:04,962 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:04,962 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:04,962 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:04,962 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,962 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,962 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,962 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,964 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:04,964 - src.hyperparameter_tuning - ERROR - Trial 16 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:04,977 - src.hyperparameter_tuning - INFO - Trial 17: 모델 타입 = lightgbm
2025-06-24 09:39:04,980 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:04,981 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:04,981 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:04,981 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:04,981 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:04,981 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:04,981 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:04,981 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:04,981 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:04,981 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:04,981 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:04,981 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:04,981 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:04,981 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:04,981 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:04,981 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:04,981 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:04,981 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:04,982 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,982 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,982 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:04,982 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:04,983 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,983 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:04,983 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:04,983 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:04,983 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:04,983 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:04,986 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:04,988 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,988 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:04,988 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:04,988 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:04,988 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:04,988 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:04,988 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:04,990 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:04,992 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:04,992 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,992 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,992 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:04,992 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:04,992 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,993 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:04,993 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:04,993 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,993 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,993 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:04,993 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:04,993 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,993 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,993 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:04,993 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:04,993 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,994 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,994 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:04,994 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:04,995 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:04,995 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:04,995 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:04,995 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:04,995 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:04,995 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:04,995 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:04,995 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:04,995 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,995 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:04,995 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:04,995 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:04,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:04,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,995 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,996 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:04,996 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:04,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:04,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:04,997 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:04,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:04,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:04,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:04,998 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:04,998 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:04,998 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:04,998 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:04,998 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:04,998 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,998 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:04,998 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:04,998 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:04,998 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   learning_rate: 0.15526074257939743
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   n_estimators: 600
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   subsample: 0.6732132011401761
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6721524828008189
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   reg_alpha: 9.14459959766754e-08
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO -   reg_lambda: 0.004840492100137957
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:04,999 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,002 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,002 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,002 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,002 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,002 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,002 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,002 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,002 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,003 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,003 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,003 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,009 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,009 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,009 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,009 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,009 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,009 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,009 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,009 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,009 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,010 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,010 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,010 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,010 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,010 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,010 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,011 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,011 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,011 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,011 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,011 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,011 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,011 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,011 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,011 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,011 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,011 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,011 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,011 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,011 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,011 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,011 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,011 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,011 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,011 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,011 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,011 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,013 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,013 - src.hyperparameter_tuning - ERROR - Trial 17 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,026 - src.hyperparameter_tuning - INFO - Trial 18: 모델 타입 = lightgbm
2025-06-24 09:39:05,029 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,030 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,030 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,030 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,030 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,030 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,030 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,030 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,030 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,030 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,030 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,030 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,030 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,030 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,030 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,030 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,030 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,030 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,031 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,031 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,031 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,031 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,031 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,031 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,031 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,031 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,031 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,031 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,035 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,037 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,037 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,037 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,037 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,037 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,037 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,037 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,039 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,041 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,041 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,041 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,041 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,041 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,041 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,041 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,041 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,041 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,041 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,042 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,042 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,042 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,042 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,042 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,042 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,042 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,042 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,042 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,042 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,043 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,043 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,043 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,043 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,043 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,043 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,043 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,043 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,043 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,043 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,043 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,043 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,043 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,043 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,044 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,044 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,044 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,044 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,044 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,044 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,045 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,045 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,045 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,045 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,046 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,046 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   learning_rate: 0.05533525328002605
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   n_estimators: 416
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   subsample: 0.8551318001092548
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9338003283396146
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00011115273434769104
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO -   reg_lambda: 2.6037259691414086e-06
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,047 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,067 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,067 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,067 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,067 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,067 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,067 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,067 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,067 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,068 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,068 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,068 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,068 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,068 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,068 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,068 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,068 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,068 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,068 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,068 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,069 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,069 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,069 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,069 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,069 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,069 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,070 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,070 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,070 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,070 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,070 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,070 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,070 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,070 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,070 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,070 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,070 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,070 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,070 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,070 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,070 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,070 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,070 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,070 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,070 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,070 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,070 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,070 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,073 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,073 - src.hyperparameter_tuning - ERROR - Trial 18 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,085 - src.hyperparameter_tuning - INFO - Trial 19: 모델 타입 = lightgbm
2025-06-24 09:39:05,089 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,089 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,089 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,089 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,089 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,089 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,089 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,089 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,089 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,090 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,090 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,090 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,090 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,090 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,090 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,090 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,090 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,090 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,091 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,091 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,091 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,091 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,091 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,091 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,091 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,091 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,091 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,091 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,095 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,097 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,097 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,097 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,097 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,097 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,097 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,097 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,099 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,101 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,101 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,101 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,101 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,101 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,101 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,101 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,101 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,101 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,101 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,102 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,102 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,102 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,102 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,102 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,102 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,102 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,102 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,102 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,102 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,103 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,103 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,103 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,103 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,103 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,103 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,103 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,103 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,103 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,103 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,103 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,103 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,103 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,103 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,104 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,104 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,105 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,105 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,105 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,105 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,105 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,105 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,105 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,105 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,105 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,106 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,106 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,106 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,106 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,106 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,106 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,106 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   learning_rate: 0.02877361180532123
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   n_estimators: 835
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   subsample: 0.9423652436238517
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8416634198004798
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   reg_alpha: 2.4662900352851794e-06
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO -   reg_lambda: 4.7203867760430046e-08
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,107 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,110 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,110 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,110 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,110 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,110 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,110 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,111 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,111 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,117 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,117 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,117 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,117 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,117 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,117 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,117 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,117 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,117 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,118 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,118 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,118 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,118 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,118 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,118 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,119 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,119 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,119 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,119 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,119 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,119 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,119 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,119 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,119 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,119 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,119 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,119 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,119 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,119 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,119 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,119 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,119 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,119 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,119 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,119 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,119 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,121 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,121 - src.hyperparameter_tuning - ERROR - Trial 19 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,134 - src.hyperparameter_tuning - INFO - Trial 20: 모델 타입 = lightgbm
2025-06-24 09:39:05,137 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,138 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,138 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,138 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,138 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,138 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,138 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,138 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,138 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,139 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,139 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,139 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,139 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,139 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,139 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,139 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,139 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,139 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,140 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,140 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,140 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,140 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,140 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,140 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,140 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,140 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,140 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,140 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,144 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,146 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,146 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,146 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,146 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,146 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,146 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,146 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,148 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,150 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,150 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,150 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,150 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,150 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,150 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,150 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,150 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,150 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,150 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,150 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,150 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,150 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,150 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,150 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,150 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,150 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,151 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,151 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,151 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,152 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,152 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,152 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,152 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,152 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,152 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,152 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,152 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,152 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,152 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,152 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,152 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,152 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,152 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,152 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,153 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,153 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,153 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,153 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,153 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,153 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,154 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,154 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,154 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,155 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,155 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,155 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,155 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,155 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,155 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,155 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   learning_rate: 0.16522729299476813
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   n_estimators: 224
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   subsample: 0.87408467479411
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7727431143998708
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   reg_alpha: 1.1069451775532163e-08
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO -   reg_lambda: 5.845016122261629e-06
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,156 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,159 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,159 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,159 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,159 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,159 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,159 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,159 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,159 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,159 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,160 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,160 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,160 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,160 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,160 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,160 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,160 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,160 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,162 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,162 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,162 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,162 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,162 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,162 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,162 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,162 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,162 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,162 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,162 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,162 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,163 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,163 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,163 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,164 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,164 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,164 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,164 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,164 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,164 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,164 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,164 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,164 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,164 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,164 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,164 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,164 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,164 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,164 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,164 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,164 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,164 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,164 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,164 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,164 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,166 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,166 - src.hyperparameter_tuning - ERROR - Trial 20 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,179 - src.hyperparameter_tuning - INFO - Trial 21: 모델 타입 = lightgbm
2025-06-24 09:39:05,183 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,184 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,184 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,184 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,184 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,184 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,184 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,184 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,184 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,184 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,184 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,184 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,184 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,184 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,184 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,184 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,184 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,184 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,185 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,185 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,185 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,185 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,185 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,185 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,185 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,186 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,186 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,186 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,189 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,191 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,191 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,191 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,191 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,191 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,191 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,191 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,193 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,195 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,195 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,195 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,195 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,195 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,195 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,195 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,195 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,195 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,195 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,196 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,196 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,196 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,196 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,196 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,196 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,196 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,197 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,197 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,197 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,197 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,198 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,198 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,198 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,198 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,198 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,198 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,198 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,198 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,198 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,198 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,198 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,198 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,198 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,198 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,199 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,199 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,199 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,199 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,199 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,199 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,200 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,200 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,201 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,201 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO -   learning_rate: 0.04529483298639887
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,201 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   n_estimators: 316
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   subsample: 0.6975620050707811
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8503251588841235
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   reg_alpha: 9.844852091987153e-07
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO -   reg_lambda: 4.797440969544924e-05
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,202 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,205 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,205 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,205 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,205 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,206 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,206 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,206 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,206 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,206 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,207 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,207 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,207 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,212 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,212 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,212 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,212 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,212 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,212 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,212 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,212 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,212 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,212 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,212 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,212 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,213 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,213 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,213 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,213 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,213 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,213 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,214 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,214 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,214 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,214 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,214 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,214 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,214 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,214 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,214 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,214 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,214 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,214 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,214 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,214 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,214 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,214 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,214 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,214 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,216 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,216 - src.hyperparameter_tuning - ERROR - Trial 21 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,229 - src.hyperparameter_tuning - INFO - Trial 22: 모델 타입 = lightgbm
2025-06-24 09:39:05,233 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,233 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,233 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,233 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,233 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,233 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,233 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,233 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,233 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,234 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,234 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,234 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,234 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,234 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,234 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,234 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,234 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,234 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,235 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,235 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,235 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,235 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,235 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,235 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,235 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,235 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,235 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,235 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,239 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,241 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,241 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,241 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,241 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,241 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,241 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,241 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,243 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,245 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,245 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,245 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,245 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,245 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,245 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,245 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,245 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,245 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,245 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,246 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,246 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,246 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,246 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,246 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,246 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,246 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,246 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,246 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,246 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,247 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,247 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,247 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,247 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,247 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,247 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,247 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,247 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,247 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,247 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,247 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,247 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,247 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,248 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,249 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,249 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,250 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,250 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,250 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,250 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,250 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,250 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,250 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,250 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   learning_rate: 0.015410150189628657
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,251 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:39:05,252 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,252 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,252 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,252 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,252 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,252 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,252 - src.models.lightgbm_model - INFO -   n_estimators: 411
2025-06-24 09:39:05,252 - src.models.lightgbm_model - INFO -   subsample: 0.6452606057786048
2025-06-24 09:39:05,252 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8738445964974808
2025-06-24 09:39:05,252 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:05,252 - src.models.lightgbm_model - INFO -   reg_alpha: 1.1485400190421731e-05
2025-06-24 09:39:05,252 - src.models.lightgbm_model - INFO -   reg_lambda: 1.5162743738503278e-06
2025-06-24 09:39:05,252 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,252 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,252 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,254 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,254 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,254 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,254 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,254 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,255 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,255 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,255 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,256 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,261 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,261 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,261 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,261 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,261 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,261 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,261 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,261 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,261 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,261 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,262 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,262 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,262 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,262 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,262 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,263 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,263 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,263 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,263 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,263 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,263 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,263 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,263 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,263 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,263 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,263 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,263 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,263 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,263 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,263 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,263 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,263 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,263 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,263 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,263 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,263 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,265 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,265 - src.hyperparameter_tuning - ERROR - Trial 22 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,278 - src.hyperparameter_tuning - INFO - Trial 23: 모델 타입 = lightgbm
2025-06-24 09:39:05,282 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,282 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,283 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,283 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,283 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,283 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,283 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,283 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,283 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,283 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,283 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,283 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,283 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,283 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,283 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,283 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,283 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,283 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,284 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,284 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,284 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,284 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,284 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,284 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,284 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,284 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,285 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,285 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,288 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,290 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,290 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,290 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,290 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,290 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,290 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,290 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,292 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,294 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,294 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,294 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,294 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,294 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,294 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,294 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,294 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,294 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,294 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,295 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,295 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,295 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,295 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,295 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,295 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,295 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,296 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,296 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,296 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,296 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,296 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,296 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,296 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,297 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,297 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,297 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,297 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,297 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,297 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,297 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,297 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,297 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,299 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,299 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,299 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,300 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,300 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,300 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO -   learning_rate: 0.02960427890913426
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,300 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   n_estimators: 240
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   subsample: 0.7742544913880576
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9449923596722283
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   reg_alpha: 6.189776343666531e-08
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO -   reg_lambda: 2.0050009913357152e-05
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,301 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,303 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,303 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,303 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,303 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,303 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,303 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,303 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,303 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,304 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,304 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,304 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,305 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,305 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,305 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,305 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,305 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,305 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,305 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,305 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,305 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,305 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,305 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,305 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,305 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,306 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,306 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,306 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,306 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,307 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,307 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,307 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,307 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,307 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,307 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,307 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,307 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,307 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,307 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,307 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,307 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,307 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,307 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,307 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,307 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,307 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,307 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,307 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,307 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,309 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,309 - src.hyperparameter_tuning - ERROR - Trial 23 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,322 - src.hyperparameter_tuning - INFO - Trial 24: 모델 타입 = lightgbm
2025-06-24 09:39:05,326 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,327 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,327 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,327 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,327 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,327 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,327 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,327 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,327 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,327 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,327 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,327 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,327 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,327 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,327 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,327 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,327 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,327 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,328 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,328 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,328 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,328 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,329 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,329 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,329 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,329 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,329 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,329 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,332 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,334 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,334 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,334 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,334 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,334 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,334 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,334 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,336 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,338 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,338 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,338 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,338 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,338 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,338 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,338 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,338 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,338 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,338 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,339 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,339 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,339 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,339 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,339 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,339 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,339 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,340 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,340 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,340 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,341 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,341 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,341 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,341 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,341 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,341 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,341 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,341 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,341 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,341 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,341 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,341 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,341 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,342 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,342 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,343 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,344 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,344 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,344 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,344 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,344 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,344 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,344 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,344 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,344 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,344 - src.models.lightgbm_model - INFO -   learning_rate: 0.052772641594485394
2025-06-24 09:39:05,344 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,344 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,344 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,344 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,344 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,344 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   n_estimators: 585
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   subsample: 0.709790030543809
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7956578586822305
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   reg_alpha: 2.8089508266239516e-05
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00016743745517347003
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,345 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,347 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,347 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,347 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,347 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,347 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,348 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,348 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,349 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,349 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,349 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,349 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,349 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,349 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,349 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,349 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,349 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,349 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,349 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,349 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,350 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,350 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,350 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,350 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,350 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,350 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,351 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,351 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,351 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,351 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,351 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,351 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,351 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,351 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,351 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,351 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,351 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,351 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,351 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,351 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,351 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,351 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,351 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,351 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,351 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,351 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,351 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,353 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,353 - src.hyperparameter_tuning - ERROR - Trial 24 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,367 - src.hyperparameter_tuning - INFO - Trial 25: 모델 타입 = lightgbm
2025-06-24 09:39:05,370 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,371 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,371 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,371 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,371 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,371 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,371 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,371 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,371 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,371 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,371 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,371 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,371 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,371 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,371 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,371 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,371 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,371 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,372 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,372 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,372 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,372 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,372 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,372 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,372 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,373 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,373 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,373 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,376 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,378 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,378 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,378 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,378 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,378 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,378 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,378 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,380 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,382 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,382 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,382 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,382 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,382 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,382 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,382 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,382 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,382 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,382 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,383 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,383 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,383 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,383 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,383 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,383 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,383 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,384 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,384 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,384 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,385 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,385 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,385 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,385 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,385 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,385 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,385 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,385 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,385 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,385 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,385 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,385 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,385 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,385 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,385 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,385 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,385 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,385 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,386 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,386 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,386 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,386 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,386 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,386 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,386 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,386 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,386 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,387 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,387 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,387 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,387 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,387 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,387 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,387 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,388 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,388 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,388 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,388 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,388 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,388 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,388 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,388 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,388 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,388 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,388 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,388 - src.models.lightgbm_model - INFO -   learning_rate: 0.02043311211274545
2025-06-24 09:39:05,388 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,388 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,388 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,388 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,388 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,388 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   n_estimators: 410
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   subsample: 0.765836702637975
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9367310980059825
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   reg_alpha: 2.467723761283515e-06
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0025526354515177084
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,389 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,391 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,391 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,391 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,391 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,391 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,392 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,392 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,392 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,393 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,393 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,393 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,393 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,393 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,393 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,393 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,394 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,394 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,394 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,394 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,395 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,395 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,395 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,395 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,395 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,395 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,395 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,395 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,395 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,395 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,395 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,395 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,395 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,395 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,395 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,395 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,395 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,395 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,395 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,395 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,397 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,397 - src.hyperparameter_tuning - ERROR - Trial 25 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,411 - src.hyperparameter_tuning - INFO - Trial 26: 모델 타입 = lightgbm
2025-06-24 09:39:05,414 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,414 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,414 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,414 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,414 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,414 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,414 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,414 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,415 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,415 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,415 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,415 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,415 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,415 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,415 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,415 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,415 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,415 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,416 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,416 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,416 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,416 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,416 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,416 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,416 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,416 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,416 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,416 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,420 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,422 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,422 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,422 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,422 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,422 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,422 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,422 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,424 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,426 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,426 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,426 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,426 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,426 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,426 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,427 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,427 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,427 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,427 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,427 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,427 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,427 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,427 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,428 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,428 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,428 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,428 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,428 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,428 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,428 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,428 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,428 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,429 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,429 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,429 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,429 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,429 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,429 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,430 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,430 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,430 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,430 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,431 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,431 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,432 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,432 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,432 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   learning_rate: 0.21063894305336445
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,432 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   n_estimators: 656
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   subsample: 0.822656444358238
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8094408985463093
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0005539202839193388
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO -   reg_lambda: 6.440889140440102e-06
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,433 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,435 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,435 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,435 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,435 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,435 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,436 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,436 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,437 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,437 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,437 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,437 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,437 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,437 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,437 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,437 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,437 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,437 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,437 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,437 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,437 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,437 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,438 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,438 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,438 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,438 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,439 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,439 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,439 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,439 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,439 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,439 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,439 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,439 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,439 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,439 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,439 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,439 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,439 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,439 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,439 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,439 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,439 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,439 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,439 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,439 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,441 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,441 - src.hyperparameter_tuning - ERROR - Trial 26 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,455 - src.hyperparameter_tuning - INFO - Trial 27: 모델 타입 = lightgbm
2025-06-24 09:39:05,458 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,459 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,459 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,459 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,459 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,459 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,459 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,459 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,459 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,459 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,459 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,459 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,459 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,459 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,459 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,459 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,459 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,459 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,460 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,460 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,460 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,460 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,460 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,461 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,461 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,461 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,461 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,461 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,464 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,466 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,466 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,466 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,466 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,466 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,466 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,466 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,468 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,470 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,470 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,470 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,470 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,470 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,470 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,470 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,471 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,471 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,471 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,471 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,471 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,471 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,471 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,471 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,471 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,471 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,472 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,472 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,472 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,473 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,473 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,473 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,473 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,473 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,473 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,473 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,473 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,473 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,473 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,473 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,473 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,473 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,473 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,474 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,474 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,475 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,475 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,475 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,475 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,476 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,476 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,476 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,476 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,476 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,476 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,476 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,476 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,476 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,476 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,476 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   learning_rate: 0.0804852149570703
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   n_estimators: 483
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   subsample: 0.6346522194487378
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9964125388085947
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   reg_alpha: 8.253969505781612e-08
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO -   reg_lambda: 1.119023035815797e-07
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,477 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,479 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,479 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,479 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,479 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,479 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,479 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,479 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,480 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,480 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,481 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,481 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,481 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,481 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,481 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,481 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,481 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,481 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,481 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,481 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,481 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,481 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,481 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,482 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,482 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,482 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,482 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,482 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,482 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,483 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,483 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,483 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,483 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,483 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,483 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,483 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,483 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,483 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,483 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,483 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,483 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,483 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,483 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,483 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,483 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,483 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,483 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,483 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,483 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,485 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,485 - src.hyperparameter_tuning - ERROR - Trial 27 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,499 - src.hyperparameter_tuning - INFO - Trial 28: 모델 타입 = lightgbm
2025-06-24 09:39:05,502 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,503 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,503 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,503 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,503 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,503 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,503 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,503 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,503 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,503 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,504 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,504 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,504 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,504 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,504 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,504 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,504 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,504 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,505 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,505 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,505 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,505 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,505 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,505 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,505 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,505 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,505 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,505 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,508 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,510 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,510 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,510 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,510 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,510 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,510 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,510 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,513 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,514 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,514 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,515 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,515 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,515 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,515 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,515 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,515 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,515 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,515 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,515 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,515 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,515 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,515 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,515 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,515 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,515 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,516 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,516 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,516 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,517 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,517 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,517 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,517 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,517 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,517 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,517 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,517 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,517 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,517 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,517 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,517 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,517 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,518 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,518 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,518 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,519 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,519 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,519 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,519 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,519 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,519 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,519 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,519 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,519 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,520 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,520 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,520 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,520 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,520 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,520 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,520 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,520 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,520 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,520 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,520 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,520 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   learning_rate: 0.12404094717085312
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   n_estimators: 782
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   subsample: 0.6724055367984789
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8740038680959015
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   reg_alpha: 1.0343558782044228e-06
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO -   reg_lambda: 0.33132712190213737
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,521 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,523 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,523 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,523 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,523 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,523 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,524 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,524 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,525 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,525 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,525 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,525 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,525 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,525 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,525 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,525 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,525 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,525 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,525 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,525 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,526 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,526 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,526 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,526 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,526 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,526 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,527 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,527 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,527 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,527 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,527 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,527 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,527 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,527 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,527 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,527 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,527 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,527 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,527 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,527 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,527 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,527 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,527 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,527 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,527 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,527 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,529 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,529 - src.hyperparameter_tuning - ERROR - Trial 28 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,543 - src.hyperparameter_tuning - INFO - Trial 29: 모델 타입 = lightgbm
2025-06-24 09:39:05,546 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,547 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,547 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,547 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,547 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,547 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,547 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,547 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,547 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,548 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,548 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,548 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,548 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,548 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,548 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,548 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,548 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,548 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,549 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,549 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,549 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,549 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,549 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,549 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,549 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,549 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,549 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,549 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,552 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,555 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,555 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,555 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,555 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,555 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,555 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,555 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,557 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,559 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,559 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,559 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,559 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,559 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,559 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,559 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,559 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,559 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,559 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,559 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,559 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,560 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,560 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,560 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,560 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,560 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,560 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,560 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,560 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,561 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,561 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,561 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,561 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,561 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,561 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,561 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,561 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,561 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,561 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,561 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,561 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,562 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,563 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,563 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,563 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,563 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,563 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,563 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,563 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,564 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,564 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,564 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,564 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,564 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,564 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,564 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,564 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,565 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,565 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   learning_rate: 0.021604981364913005
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,565 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:39:05,566 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,566 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,566 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,566 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,566 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,566 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,566 - src.models.lightgbm_model - INFO -   n_estimators: 515
2025-06-24 09:39:05,566 - src.models.lightgbm_model - INFO -   subsample: 0.7969902083314745
2025-06-24 09:39:05,566 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7309448291222742
2025-06-24 09:39:05,566 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:05,566 - src.models.lightgbm_model - INFO -   reg_alpha: 4.867051057937844e-08
2025-06-24 09:39:05,566 - src.models.lightgbm_model - INFO -   reg_lambda: 3.374072614356822e-07
2025-06-24 09:39:05,566 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,566 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,566 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,568 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,568 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,568 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,568 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,568 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,569 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,569 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,569 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,570 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,571 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,571 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,571 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,571 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,571 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,571 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,571 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,571 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,571 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,571 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,571 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,571 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,571 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,572 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,572 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,572 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,572 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,572 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,572 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,572 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,572 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,572 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,572 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,572 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,572 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,572 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,572 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,572 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,572 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,572 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,572 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,572 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,572 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,572 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,572 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,572 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,575 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,575 - src.hyperparameter_tuning - ERROR - Trial 29 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,588 - src.hyperparameter_tuning - INFO - Trial 30: 모델 타입 = lightgbm
2025-06-24 09:39:05,591 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,592 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,592 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,592 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,592 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,592 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,592 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,592 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,592 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,593 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,593 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,593 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,593 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,593 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,593 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,593 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,593 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,593 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,594 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,594 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,594 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,594 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,594 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,594 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,594 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,594 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,594 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,594 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,598 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,600 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,600 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,600 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,600 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,600 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,600 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,600 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,602 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,604 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,604 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,604 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,604 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,604 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,604 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,604 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,604 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,604 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,604 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,605 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,605 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,605 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,605 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,605 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,605 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,605 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,605 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,605 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,605 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,606 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,606 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,606 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,606 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,606 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,606 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,606 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,606 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,606 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,606 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,606 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,606 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,606 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,606 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,607 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,608 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,608 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,609 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,610 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,610 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,610 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,610 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,610 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,610 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   learning_rate: 0.04035286091031472
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   n_estimators: 457
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   subsample: 0.8044792631641183
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8696839799381978
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   reg_alpha: 2.938419320810259e-06
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO -   reg_lambda: 1.474108753561657e-08
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,611 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,613 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,613 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,613 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,613 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,613 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,614 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,614 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,614 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,614 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,614 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,615 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,615 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,615 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,615 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,621 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,621 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,621 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,621 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,621 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,621 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,621 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,621 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,621 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,621 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,621 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,621 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,622 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,622 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,622 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,622 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,622 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,622 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,622 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,622 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,623 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,623 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,623 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,623 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,623 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,623 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,623 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,623 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,623 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,623 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,623 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,623 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,623 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,623 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,623 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,623 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,625 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,625 - src.hyperparameter_tuning - ERROR - Trial 30 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,639 - src.hyperparameter_tuning - INFO - Trial 31: 모델 타입 = lightgbm
2025-06-24 09:39:05,642 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,643 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,643 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,643 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,643 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,643 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,643 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,643 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,643 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,644 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,644 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,644 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,644 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,644 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,644 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,644 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,644 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,644 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,645 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,645 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,645 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,645 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,645 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,645 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,645 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,645 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,645 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,645 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,649 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,651 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,651 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,651 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,651 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,651 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,651 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,651 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,653 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,655 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,655 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,655 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,655 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,655 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,655 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,655 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,655 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,655 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,655 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,656 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,656 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,656 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,656 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,656 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,656 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,656 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,656 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,656 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,656 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,657 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,657 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,657 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,657 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,657 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,657 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,657 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,657 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,657 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,657 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,657 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,657 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,658 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,658 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,658 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,659 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,659 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,659 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,659 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,660 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,660 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,660 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,661 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,661 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   learning_rate: 0.013637410036364993
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,661 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,662 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,662 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,662 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,662 - src.models.lightgbm_model - INFO -   n_estimators: 358
2025-06-24 09:39:05,662 - src.models.lightgbm_model - INFO -   subsample: 0.8349337395484048
2025-06-24 09:39:05,662 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.831861212497879
2025-06-24 09:39:05,662 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:05,662 - src.models.lightgbm_model - INFO -   reg_alpha: 0.001834620070516215
2025-06-24 09:39:05,662 - src.models.lightgbm_model - INFO -   reg_lambda: 6.362585398085402e-07
2025-06-24 09:39:05,662 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,662 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,662 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,664 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,664 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,664 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,664 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,664 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,664 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,664 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,664 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,664 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,665 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,665 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,671 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,671 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,671 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,671 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,671 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,671 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,671 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,671 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,671 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,672 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,672 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,672 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,672 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,672 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,672 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,673 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,673 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,673 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,673 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,673 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,673 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,673 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,673 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,673 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,673 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,673 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,673 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,673 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,673 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,673 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,673 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,673 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,673 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,673 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,673 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,673 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,675 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,675 - src.hyperparameter_tuning - ERROR - Trial 31 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,689 - src.hyperparameter_tuning - INFO - Trial 32: 모델 타입 = lightgbm
2025-06-24 09:39:05,692 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,693 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,693 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,693 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,693 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,693 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,693 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,693 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,693 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,694 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,694 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,694 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,694 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,694 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,694 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,694 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,694 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,694 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,695 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,695 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,695 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,695 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,695 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,695 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,695 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,695 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,695 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,695 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,698 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,700 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,700 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,700 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,700 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,700 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,700 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,700 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,703 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,704 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,705 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,705 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,705 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,705 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,705 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,705 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,705 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,705 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,705 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,705 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,705 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,705 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,705 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,705 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,705 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,705 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,706 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,706 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,706 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,707 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,707 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,707 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,707 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,707 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,707 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,707 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,707 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,707 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,707 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,707 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,707 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,707 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,707 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,707 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,707 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,708 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,708 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,709 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,710 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,710 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,710 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,710 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,710 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,710 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,710 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,710 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,710 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,710 - src.models.lightgbm_model - INFO -   learning_rate: 0.010358238324974577
2025-06-24 09:39:05,710 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   n_estimators: 269
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   subsample: 0.9392065580983905
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7242608165537173
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   reg_alpha: 0.07671535159777253
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO -   reg_lambda: 9.281031668514603e-05
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,711 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,713 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,713 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,713 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,713 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,713 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,714 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,714 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,715 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,715 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,715 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,715 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,715 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,715 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,715 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,715 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,715 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,715 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,715 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,715 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,715 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,716 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,716 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,716 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,716 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,717 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,717 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,717 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,717 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,717 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,717 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,717 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,717 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,717 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,717 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,717 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,717 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,717 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,717 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,717 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,717 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,717 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,717 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,717 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,717 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,719 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,719 - src.hyperparameter_tuning - ERROR - Trial 32 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,733 - src.hyperparameter_tuning - INFO - Trial 33: 모델 타입 = lightgbm
2025-06-24 09:39:05,736 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,737 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,737 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,737 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,737 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,737 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,737 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,737 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,737 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,737 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,737 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,737 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,737 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,737 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,738 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,738 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,738 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,738 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,738 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,738 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,739 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,739 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,739 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,739 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,739 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,739 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,739 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,739 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,742 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,744 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,744 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,744 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,744 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,744 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,744 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,744 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,746 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,748 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,748 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,748 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,748 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,748 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,748 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,749 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,749 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,749 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,749 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,749 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,749 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,749 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,749 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,749 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,749 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,749 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,750 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,750 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,750 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,751 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,751 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,751 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,751 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,751 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,751 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,751 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,751 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,751 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,751 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,751 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,751 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,751 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,751 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,751 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,751 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,751 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,752 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,752 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,752 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,752 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,752 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,752 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,753 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,753 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,753 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,753 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,753 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,753 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,754 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,754 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,754 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,754 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,754 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,754 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,754 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,754 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   learning_rate: 0.018528024944816653
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   n_estimators: 585
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   subsample: 0.7403423161145642
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.694494095260054
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   reg_alpha: 0.009311170494905974
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO -   reg_lambda: 1.439483740775924e-07
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,755 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,758 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,758 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,758 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,758 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,758 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,758 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,758 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,759 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,759 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,760 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,760 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,760 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,763 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,763 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,763 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,763 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,763 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,763 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,763 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,763 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,764 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,764 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,764 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,764 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,764 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,764 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,764 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,765 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,765 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,765 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,765 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,765 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,765 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,765 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,765 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,765 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,765 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,765 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,765 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,765 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,765 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,765 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,765 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,765 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,765 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,765 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,765 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,765 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,767 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,768 - src.hyperparameter_tuning - ERROR - Trial 33 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,781 - src.hyperparameter_tuning - INFO - Trial 34: 모델 타입 = lightgbm
2025-06-24 09:39:05,784 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,785 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,785 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,785 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,785 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,785 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,785 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,785 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,785 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,786 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,786 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,786 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,786 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,786 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,786 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,786 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,786 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,786 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,787 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,787 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,787 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,787 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,787 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,787 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,787 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,787 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,787 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,787 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,791 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,793 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,793 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,793 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,793 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,793 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,793 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,793 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,795 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,797 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,797 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,797 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,797 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,797 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,797 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,797 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,797 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,797 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,797 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,798 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,798 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,798 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,798 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,798 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,798 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,798 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,798 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,798 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,798 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,799 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,799 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,799 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,799 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,799 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,799 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,799 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,799 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,799 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,799 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,799 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,799 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,799 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,800 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,800 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,800 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,800 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,800 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,800 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,801 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,801 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,801 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,801 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,802 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,802 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,802 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,803 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,803 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   learning_rate: 0.012603140096888722
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,803 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO -   n_estimators: 537
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO -   subsample: 0.887059385340847
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.814690263795279
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0007257356330429975
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0006511272157627004
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,804 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,806 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,806 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,806 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,806 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,806 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,807 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,808 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,808 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,811 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,811 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,811 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,811 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,811 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,811 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,811 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,811 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,811 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,811 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,811 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,811 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,811 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,812 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,812 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,812 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,812 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,812 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,812 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,812 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,812 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,812 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,812 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,812 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,812 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,812 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,812 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,812 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,813 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,813 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,813 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,813 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,813 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,813 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,813 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,813 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,815 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,815 - src.hyperparameter_tuning - ERROR - Trial 34 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,829 - src.hyperparameter_tuning - INFO - Trial 35: 모델 타입 = lightgbm
2025-06-24 09:39:05,832 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,833 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,833 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,833 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,833 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,833 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,833 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,833 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,833 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,833 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,833 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,833 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,833 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,833 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,834 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,834 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,834 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,834 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,834 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,835 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,835 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,835 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,835 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,835 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,835 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,835 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,835 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,835 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,838 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,840 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,840 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,840 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,840 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,840 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,840 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,840 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,843 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,844 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,844 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,844 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,845 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,845 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,845 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,845 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,845 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,845 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,845 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,845 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,845 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,845 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,845 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,845 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,845 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,845 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,846 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,846 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,846 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,847 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,847 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,847 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,847 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,847 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,847 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,847 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,847 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,847 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,847 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,847 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,847 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,847 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,848 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,848 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,849 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,849 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,849 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,849 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,850 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,850 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,850 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,850 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,850 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,850 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,850 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,850 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,850 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,850 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   learning_rate: 0.010078636987766579
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   n_estimators: 207
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   subsample: 0.9593052727074797
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9586658642491094
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   reg_alpha: 4.2693203841762886e-05
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO -   reg_lambda: 2.556230835595068e-05
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,851 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,853 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,853 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,853 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,853 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,853 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,854 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,854 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,855 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,855 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,855 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,855 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,855 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,855 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,855 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,855 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,855 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,855 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,855 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,855 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,856 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,856 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,856 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,856 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,856 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,856 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,857 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,857 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,857 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,857 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,857 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,857 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,857 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,857 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,857 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,857 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,857 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,857 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,857 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,857 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,857 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,857 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,857 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,857 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,857 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,857 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,857 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,859 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,859 - src.hyperparameter_tuning - ERROR - Trial 35 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,874 - src.hyperparameter_tuning - INFO - Trial 36: 모델 타입 = lightgbm
2025-06-24 09:39:05,877 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,877 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,878 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,878 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,878 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,878 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,878 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,878 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,878 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,878 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,878 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,878 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,878 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,878 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,878 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,878 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,878 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,878 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,879 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,879 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,879 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,879 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,879 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,879 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,879 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,880 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,880 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,880 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,883 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,885 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,885 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,885 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,885 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,885 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,885 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,885 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,887 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,889 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,889 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,889 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,889 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,889 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,889 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,889 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,889 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,889 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,889 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,890 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,890 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,890 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,890 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,890 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,890 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,890 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,891 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,891 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,891 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,892 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,892 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,892 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,892 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,892 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,892 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,892 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,892 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,892 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,892 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,892 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,892 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,892 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,892 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,892 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,892 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,892 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,893 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,893 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,894 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,894 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,895 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,895 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,895 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,895 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,895 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,895 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,895 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,895 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,895 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,895 - src.models.lightgbm_model - INFO -   learning_rate: 0.02487519724197392
2025-06-24 09:39:05,895 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,895 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,895 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,895 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,895 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   n_estimators: 638
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   subsample: 0.7985560215507382
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7512759811523114
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   reg_alpha: 0.024900590270190155
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO -   reg_lambda: 1.8961556446893008e-06
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,896 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,899 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,899 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,899 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,899 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,899 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,900 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,900 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,900 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,903 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,903 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,903 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,903 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,903 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,903 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,903 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,903 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,903 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,903 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,904 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,904 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,904 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,904 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,904 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,904 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,905 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,905 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,905 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,905 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,905 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,905 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,905 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,905 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,905 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,905 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,905 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,905 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,905 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,905 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,905 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,905 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,905 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,905 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,905 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,905 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,907 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,907 - src.hyperparameter_tuning - ERROR - Trial 36 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,921 - src.hyperparameter_tuning - INFO - Trial 37: 모델 타입 = lightgbm
2025-06-24 09:39:05,924 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,925 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,925 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,925 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,925 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,925 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,925 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,925 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,925 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,926 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,926 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,926 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,926 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,926 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,926 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,926 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,926 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,926 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,927 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,927 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,927 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,927 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,927 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,927 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,927 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,927 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,927 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,927 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,930 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,933 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,933 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,933 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,933 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,933 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,933 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,933 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,935 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,937 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,937 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,937 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,937 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,937 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,937 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,937 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,937 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,937 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,937 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,937 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,937 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,937 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,938 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,938 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,938 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,938 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,938 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,938 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,938 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,939 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,939 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,939 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,939 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,939 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,939 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,939 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,939 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,939 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,939 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,939 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,939 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,940 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,940 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,940 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,940 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,940 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,941 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,941 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,941 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,941 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,942 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,942 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,942 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,942 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,942 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,942 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,942 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,942 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,943 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,943 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   learning_rate: 0.01569833488957703
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   n_estimators: 283
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   subsample: 0.7125680491414248
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.784145332591274
2025-06-24 09:39:05,943 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:05,944 - src.models.lightgbm_model - INFO -   reg_alpha: 0.766447656094571
2025-06-24 09:39:05,944 - src.models.lightgbm_model - INFO -   reg_lambda: 6.133310095468243e-06
2025-06-24 09:39:05,944 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,944 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,944 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,946 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,946 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,946 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,946 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,946 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,946 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,946 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,946 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,946 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,946 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,947 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,947 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,947 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,947 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,947 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,947 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,947 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:05,953 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:05,953 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:05,953 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:05,953 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:05,953 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,953 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,953 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:05,953 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:05,953 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:05,954 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:05,954 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:05,954 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:05,954 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,954 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,954 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,955 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:05,955 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:05,955 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:05,955 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:05,955 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:05,955 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:05,955 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:05,955 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:05,955 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:05,955 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:05,955 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:05,955 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:05,955 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:05,955 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:05,955 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:05,955 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:05,955 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:05,955 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,955 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,955 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,955 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,957 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:05,957 - src.hyperparameter_tuning - ERROR - Trial 37 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:05,971 - src.hyperparameter_tuning - INFO - Trial 38: 모델 타입 = lightgbm
2025-06-24 09:39:05,974 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:05,975 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:05,975 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:05,975 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:05,975 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:05,975 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:05,975 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:05,975 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:05,975 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:05,976 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:05,976 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:05,976 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:05,976 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:05,976 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:05,976 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:05,976 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:05,976 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:05,976 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:05,977 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,977 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,977 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:05,977 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:05,977 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,977 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:05,977 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:05,977 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:05,977 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:05,977 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:05,980 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:05,983 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,983 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:05,983 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:05,983 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:05,983 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:05,983 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:05,983 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:05,985 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:05,987 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:05,987 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,987 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,987 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:05,987 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:05,987 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,987 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:05,987 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:05,987 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,987 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,987 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:05,988 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:05,988 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,988 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,988 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:05,988 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:05,988 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,988 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,988 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:05,988 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:05,989 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:05,989 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:05,989 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:05,989 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:05,989 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:05,989 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:05,989 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:05,989 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:05,989 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,989 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:05,989 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:05,989 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:05,989 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:05,989 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,990 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,990 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,990 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,990 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,990 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,990 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,991 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,991 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:05,991 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,991 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:05,991 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,991 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,991 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,991 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,991 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,992 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,992 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,992 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:05,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   learning_rate: 0.032767807118294565
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   n_estimators: 150
2025-06-24 09:39:05,993 - src.models.lightgbm_model - INFO -   subsample: 0.9178842372107386
2025-06-24 09:39:05,994 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8277442294773829
2025-06-24 09:39:05,994 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:39:05,994 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0037264473202334634
2025-06-24 09:39:05,994 - src.models.lightgbm_model - INFO -   reg_lambda: 4.218833317145971e-08
2025-06-24 09:39:05,994 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:05,994 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:05,994 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:05,998 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:05,998 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:05,998 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:05,998 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:05,998 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:05,998 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:05,998 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,998 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:05,998 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:05,998 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:05,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:05,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:05,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:05,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:05,999 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:05,999 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:05,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,004 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,004 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,004 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,004 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,004 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,004 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,004 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,004 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,004 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,005 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,005 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,005 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,005 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,005 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,005 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,006 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,006 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,006 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,006 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,006 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,006 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,006 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,006 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,006 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,006 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,006 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,006 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,006 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,006 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,006 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,006 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,006 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,006 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,006 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,006 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,006 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,008 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,008 - src.hyperparameter_tuning - ERROR - Trial 38 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,022 - src.hyperparameter_tuning - INFO - Trial 39: 모델 타입 = lightgbm
2025-06-24 09:39:06,025 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,026 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,026 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,026 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,026 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,026 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,026 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,026 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,026 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,027 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,027 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,027 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,027 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,027 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,027 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,027 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,027 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,027 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,028 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,028 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,028 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,028 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,028 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,028 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,028 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,028 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,028 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,028 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,032 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,034 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,034 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,034 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,034 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,034 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,034 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,034 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,036 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,038 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,038 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,038 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,038 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,038 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,038 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,038 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,038 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,038 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,038 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,039 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,039 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,039 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,039 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,039 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,039 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,039 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,040 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,040 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,040 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,041 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,041 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,041 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,041 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,041 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,041 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,041 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,041 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,041 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,041 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,041 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,041 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,041 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,041 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,041 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,041 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,041 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,041 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,042 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,042 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,042 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,042 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,042 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,042 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,042 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,042 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,042 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,043 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,043 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,043 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,043 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,043 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,043 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,043 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,044 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,044 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,044 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,044 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,044 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,044 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,044 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,044 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,044 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,044 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,044 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,044 - src.models.lightgbm_model - INFO -   learning_rate: 0.246113868759451
2025-06-24 09:39:06,044 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,044 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,044 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,044 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   n_estimators: 376
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   subsample: 0.7569340813632006
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9165276790317524
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   reg_alpha: 3.2547826967952095e-07
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO -   reg_lambda: 9.914717715029425
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,045 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,048 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,048 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,048 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,048 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,048 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,048 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,049 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,049 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,049 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,052 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,052 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,052 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,052 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,052 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,052 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,052 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,052 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,052 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,052 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,053 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,053 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,053 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,053 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,053 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,054 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,054 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,054 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,054 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,054 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,054 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,054 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,054 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,054 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,054 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,054 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,054 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,054 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,054 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,054 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,054 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,054 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,054 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,054 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,054 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,054 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,056 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,056 - src.hyperparameter_tuning - ERROR - Trial 39 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,071 - src.hyperparameter_tuning - INFO - Trial 40: 모델 타입 = lightgbm
2025-06-24 09:39:06,074 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,074 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,075 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,075 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,075 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,075 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,075 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,075 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,075 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,075 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,075 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,075 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,075 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,075 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,075 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,075 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,075 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,075 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,076 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,076 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,076 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,076 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,076 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,076 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,076 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,077 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,077 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,077 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,080 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,082 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,082 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,082 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,082 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,082 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,082 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,082 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,084 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,086 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,086 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,086 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,086 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,086 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,086 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,086 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,087 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,087 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,087 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,087 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,087 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,087 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,087 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,087 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,087 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,087 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,088 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,088 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,088 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,089 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,089 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,089 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,089 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,089 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,089 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,089 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,089 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,089 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,089 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,089 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,089 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,089 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,089 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,089 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,089 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,089 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,090 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,090 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,090 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,090 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,090 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,090 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,091 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,092 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,092 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,092 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,092 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,092 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,092 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,092 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,092 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,092 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,092 - src.models.lightgbm_model - INFO -   learning_rate: 0.2986164631467998
2025-06-24 09:39:06,092 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,092 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,092 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,092 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   n_estimators: 446
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   subsample: 0.8551720469993793
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6327085885569078
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   reg_alpha: 7.703681668328675e-06
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO -   reg_lambda: 6.634521545517012e-07
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,093 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,095 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,095 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,095 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,095 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,096 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,096 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,096 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,096 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,096 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,096 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,096 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,096 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,096 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,097 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,097 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,097 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,097 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,097 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,097 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,097 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,097 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,097 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,097 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,097 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,097 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,098 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,098 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,098 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,098 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,098 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,098 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,098 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,099 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,099 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,099 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,099 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,099 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,099 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,099 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,099 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,099 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,099 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,099 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,099 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,099 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,099 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,099 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,099 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,099 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,099 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,099 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,099 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,099 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,101 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,102 - src.hyperparameter_tuning - ERROR - Trial 40 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,116 - src.hyperparameter_tuning - INFO - Trial 41: 모델 타입 = lightgbm
2025-06-24 09:39:06,119 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,120 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,120 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,120 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,120 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,120 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,120 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,120 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,120 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,121 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,121 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,121 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,121 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,121 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,121 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,121 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,121 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,121 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,122 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,122 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,122 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,122 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,122 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,122 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,122 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,122 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,122 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,122 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,126 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,128 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,128 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,128 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,128 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,128 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,128 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,128 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,130 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,132 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,132 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,132 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,132 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,132 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,132 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,132 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,132 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,132 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,132 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,132 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,133 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,133 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,133 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,133 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,133 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,133 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,133 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,133 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,133 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,134 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,134 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,134 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,134 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,134 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,134 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,134 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,134 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,134 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,134 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,134 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,134 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,134 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,134 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,134 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,135 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,136 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,136 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,136 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,136 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,136 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,136 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,136 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,136 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,137 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,137 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,137 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,137 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,137 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,137 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,137 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,137 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   learning_rate: 0.09793882584456802
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   n_estimators: 123
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   subsample: 0.9640586492533287
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6435146090531931
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   reg_alpha: 0.012306593994534086
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0003273769666730943
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,138 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,140 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,141 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,141 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,141 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,141 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,141 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,141 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,141 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,141 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,141 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,141 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,141 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,142 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,142 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,142 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,142 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,148 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,148 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,148 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,148 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,148 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,148 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,148 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,148 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,148 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,148 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,149 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,149 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,149 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,149 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,149 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,150 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,150 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,150 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,150 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,150 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,150 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,150 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,150 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,150 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,150 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,150 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,150 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,150 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,150 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,150 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,150 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,150 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,150 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,150 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,150 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,150 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,152 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,152 - src.hyperparameter_tuning - ERROR - Trial 41 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,167 - src.hyperparameter_tuning - INFO - Trial 42: 모델 타입 = lightgbm
2025-06-24 09:39:06,170 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,171 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,171 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,171 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,171 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,171 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,171 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,171 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,171 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,171 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,171 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,171 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,171 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,171 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,171 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,171 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,171 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,171 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,172 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,172 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,172 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,172 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,173 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,173 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,173 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,173 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,173 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,173 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,176 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,178 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,178 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,178 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,178 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,178 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,178 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,178 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,180 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,182 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,182 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,182 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,182 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,182 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,182 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,182 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,183 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,183 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,183 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,183 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,183 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,183 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,183 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,183 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,183 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,183 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,184 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,184 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,184 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,185 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,185 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,185 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,185 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,185 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,185 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,185 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,185 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,185 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,185 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,185 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,185 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,185 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,186 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,186 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,187 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,188 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,188 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,188 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,188 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,188 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,188 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,188 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,188 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   learning_rate: 0.13733093633534701
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   n_estimators: 87
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   subsample: 0.8965101815345152
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6091730541587009
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   reg_alpha: 0.4907237459022601
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO -   reg_lambda: 6.576001803087445e-05
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,189 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,191 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,191 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,191 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,191 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,192 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,192 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,192 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,192 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,192 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,193 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,193 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,193 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,193 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,193 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,193 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,193 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,193 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,193 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,193 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,194 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,194 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,194 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,194 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,194 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,194 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,194 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,195 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,195 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,195 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,195 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,195 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,195 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,195 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,195 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,195 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,195 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,195 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,195 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,195 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,195 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,195 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,195 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,195 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,195 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,195 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,195 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,195 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,197 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,197 - src.hyperparameter_tuning - ERROR - Trial 42 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,212 - src.hyperparameter_tuning - INFO - Trial 43: 모델 타입 = lightgbm
2025-06-24 09:39:06,215 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,216 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,216 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,216 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,216 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,216 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,216 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,216 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,216 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,217 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,217 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,217 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,217 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,217 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,217 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,217 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,217 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,217 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,218 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,218 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,218 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,218 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,218 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,218 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,218 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,218 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,218 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,218 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,221 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,224 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,224 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,224 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,224 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,224 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,224 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,224 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,226 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,228 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,228 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,228 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,228 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,228 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,228 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,228 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,228 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,228 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,228 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,228 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,228 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,228 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,228 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,228 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,228 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,228 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,229 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,229 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,229 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,230 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,230 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,230 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,230 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,230 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,230 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,230 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,230 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,230 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,230 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,230 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,230 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,230 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,230 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,230 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,231 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,231 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,231 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,232 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,232 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,232 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,232 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,232 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,232 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,233 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,233 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,233 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,233 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,233 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,233 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,233 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,233 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,233 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,233 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,233 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   learning_rate: 0.21326734344408033
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   n_estimators: 539
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   subsample: 0.9673242456454179
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7044942853722713
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   reg_alpha: 0.059174749853088904
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO -   reg_lambda: 0.02588182777279751
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,234 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,236 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,236 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,236 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,236 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,237 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,237 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,238 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,238 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,238 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,238 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,238 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,238 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,238 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,238 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,238 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,238 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,238 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,238 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,238 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,239 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,239 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,239 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,239 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,239 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,239 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,239 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,240 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,240 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,240 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,240 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,240 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,240 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,240 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,240 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,240 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,240 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,240 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,240 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,240 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,240 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,240 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,240 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,240 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,240 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,240 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,240 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,240 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,242 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,242 - src.hyperparameter_tuning - ERROR - Trial 43 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,257 - src.hyperparameter_tuning - INFO - Trial 44: 모델 타입 = lightgbm
2025-06-24 09:39:06,260 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,261 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,261 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,261 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,261 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,261 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,261 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,261 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,261 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,262 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,262 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,262 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,262 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,262 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,262 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,262 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,262 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,262 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,263 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,263 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,263 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,263 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,263 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,263 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,263 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,263 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,263 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,263 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,266 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,269 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,269 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,269 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,269 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,269 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,269 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,269 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,271 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,273 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,273 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,273 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,273 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,273 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,273 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,273 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,273 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,273 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,273 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,274 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,274 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,274 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,274 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,274 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,274 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,274 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,274 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,274 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,274 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,275 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,275 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,275 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,275 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,275 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,275 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,275 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,275 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,275 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,275 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,275 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,275 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,275 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,275 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,276 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,276 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,276 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,276 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,276 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,276 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,277 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,277 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,277 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,277 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,278 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,278 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   learning_rate: 0.05625048885017797
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,279 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,280 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,280 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,280 - src.models.lightgbm_model - INFO -   n_estimators: 651
2025-06-24 09:39:06,280 - src.models.lightgbm_model - INFO -   subsample: 0.9936644823981703
2025-06-24 09:39:06,280 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6776465721915215
2025-06-24 09:39:06,280 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:06,280 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00018101280841052082
2025-06-24 09:39:06,280 - src.models.lightgbm_model - INFO -   reg_lambda: 2.2021620859017483
2025-06-24 09:39:06,280 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,280 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,280 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,286 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,286 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,286 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,286 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,286 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,287 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,287 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,288 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,288 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,288 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,288 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,288 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,288 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,288 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,288 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,288 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,288 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,288 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,288 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,288 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,289 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,289 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,289 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,289 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,290 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,290 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,290 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,290 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,290 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,290 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,290 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,290 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,290 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,290 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,290 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,290 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,290 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,290 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,290 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,290 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,290 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,290 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,290 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,290 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,292 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,292 - src.hyperparameter_tuning - ERROR - Trial 44 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,307 - src.hyperparameter_tuning - INFO - Trial 45: 모델 타입 = lightgbm
2025-06-24 09:39:06,310 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,311 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,311 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,311 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,311 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,311 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,311 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,311 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,311 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,312 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,312 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,312 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,312 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,312 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,312 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,312 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,312 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,312 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,313 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,313 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,313 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,313 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,313 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,313 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,313 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,313 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,313 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,313 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,317 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,319 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,319 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,319 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,319 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,319 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,319 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,319 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,321 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,323 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,323 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,323 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,323 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,323 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,323 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,323 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,323 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,323 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,323 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,324 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,324 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,324 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,324 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,324 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,324 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,324 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,324 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,325 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,325 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,325 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,325 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,325 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,325 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,325 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,325 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,325 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,325 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,325 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,325 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,326 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,326 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,326 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,326 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,326 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,326 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,326 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,326 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,326 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,327 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,327 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,327 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,327 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,327 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,327 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,327 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,327 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,327 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,328 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,328 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,328 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,329 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,329 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   learning_rate: 0.08474924091905767
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   n_estimators: 179
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   subsample: 0.9332399755244474
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6557272282328251
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0012292771784949972
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0023872846722201887
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,329 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,332 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,332 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,332 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,332 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,332 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,332 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,332 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,332 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,332 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,333 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,333 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,333 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,334 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,334 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,334 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,334 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,334 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,334 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,334 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,334 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,334 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,334 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,334 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,334 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,334 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,335 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,335 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,335 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,335 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,335 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,335 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,335 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,335 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,335 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,335 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,335 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,335 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,335 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,335 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,335 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,335 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,335 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,335 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,335 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,335 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,336 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,336 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,336 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,338 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,338 - src.hyperparameter_tuning - ERROR - Trial 45 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,353 - src.hyperparameter_tuning - INFO - Trial 46: 모델 타입 = lightgbm
2025-06-24 09:39:06,356 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,356 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,356 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,356 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,356 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,356 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,356 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,356 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,356 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,357 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,357 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,357 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,357 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,357 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,357 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,357 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,357 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,357 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,358 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,358 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,358 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,358 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,358 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,358 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,358 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,358 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,358 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,358 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,362 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,364 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,364 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,364 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,364 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,364 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,364 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,364 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,366 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,368 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,368 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,368 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,368 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,368 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,368 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,368 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,368 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,368 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,368 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,369 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,369 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,369 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,369 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,369 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,369 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,369 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,369 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,370 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,370 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,370 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,370 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,370 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,370 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,370 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,370 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,370 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,371 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,371 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,371 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,371 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,371 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,371 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,372 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,372 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,372 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,372 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,373 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,374 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,374 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,374 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,374 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,374 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,374 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   learning_rate: 0.012214781803232549
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   n_estimators: 319
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   subsample: 0.9011353546076427
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8923112812273108
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   reg_alpha: 1.819220639207179e-07
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO -   reg_lambda: 1.5563198677214068e-05
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,375 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,380 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,380 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,380 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,380 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,380 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,380 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,380 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,380 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,380 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,381 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,381 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,381 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,381 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,381 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,381 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,381 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,381 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,381 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,381 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,381 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,381 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,381 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,382 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,382 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,382 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,382 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,382 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,382 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,383 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,383 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,383 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,383 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,383 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,383 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,383 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,383 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,383 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,383 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,383 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,383 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,383 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,383 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,383 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,383 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,383 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,383 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,383 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,383 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,383 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,383 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,386 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,386 - src.hyperparameter_tuning - ERROR - Trial 46 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,400 - src.hyperparameter_tuning - INFO - Trial 47: 모델 타입 = lightgbm
2025-06-24 09:39:06,404 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,404 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,404 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,404 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,404 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,404 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,404 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,404 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,404 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,405 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,405 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,405 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,405 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,405 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,405 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,405 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,405 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,405 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,406 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,406 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,406 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,406 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,406 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,406 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,406 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,406 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,406 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,406 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,410 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,412 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,412 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,412 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,412 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,412 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,413 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,413 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,415 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,416 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,416 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,416 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,416 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,417 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,417 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,417 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,417 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,417 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,417 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,417 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,417 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,417 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,417 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,417 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,417 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,417 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,418 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,418 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,418 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,419 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,419 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,419 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,419 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,419 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,419 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,419 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,419 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,419 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,419 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,419 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,419 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,419 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,419 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,420 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,420 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,420 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,420 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,420 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,420 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,421 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,421 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,421 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,421 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,421 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,421 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,421 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,421 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,422 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   learning_rate: 0.03507645979363265
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,422 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO -   n_estimators: 761
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO -   subsample: 0.9824694942087706
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7417033228523667
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO -   reg_alpha: 0.004366446105347352
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO -   reg_lambda: 2.675638978946855e-07
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,423 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,425 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,425 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,425 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,425 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,425 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,425 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,426 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,426 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,426 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,426 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,426 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,426 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,426 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,427 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,427 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,427 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,427 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,427 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,427 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,427 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,427 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,427 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,427 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,427 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,427 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,427 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,428 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,428 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,428 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,428 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,428 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,428 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,428 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,428 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,428 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,428 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,428 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,428 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,428 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,428 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,428 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,428 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,428 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,428 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,428 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,428 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,429 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,429 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,429 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,431 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,431 - src.hyperparameter_tuning - ERROR - Trial 47 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,446 - src.hyperparameter_tuning - INFO - Trial 48: 모델 타입 = lightgbm
2025-06-24 09:39:06,449 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,449 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,449 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,449 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,449 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,449 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,449 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,449 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,450 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,450 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,450 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,450 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,450 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,450 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,450 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,450 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,450 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,450 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,451 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,451 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,451 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,451 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,451 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,451 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,451 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,451 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,451 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,451 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,455 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,457 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,457 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,457 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,457 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,457 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,457 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,457 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,459 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,461 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,461 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,461 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,461 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,461 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,461 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,461 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,461 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,461 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,461 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,462 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,462 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,462 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,462 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,462 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,462 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,462 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,463 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,463 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,463 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,463 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,464 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,464 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,464 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,464 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,464 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,464 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,464 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,464 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,464 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,464 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,464 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,464 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,464 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,464 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,465 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,465 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,466 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,467 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,467 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,467 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,467 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,467 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,467 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,467 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,467 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,467 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,467 - src.models.lightgbm_model - INFO -   learning_rate: 0.06459184368410763
2025-06-24 09:39:06,467 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,467 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,467 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,467 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   n_estimators: 384
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   subsample: 0.8774992037260307
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.702163125786101
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   reg_alpha: 2.160303535766916e-08
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO -   reg_lambda: 1.1500879799835756e-06
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,468 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,470 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,470 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,470 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,470 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,470 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,470 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,470 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,471 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,472 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,472 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,472 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,472 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,472 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,472 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,472 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,472 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,472 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,472 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,472 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,472 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,472 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,472 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,472 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,473 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,473 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,473 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,473 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,474 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,474 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,474 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,474 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,474 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,474 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,474 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,474 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,474 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,474 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,474 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,474 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,474 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,474 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,474 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,474 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,474 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,474 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,474 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,474 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,476 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,476 - src.hyperparameter_tuning - ERROR - Trial 48 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,491 - src.hyperparameter_tuning - INFO - Trial 49: 모델 타입 = lightgbm
2025-06-24 09:39:06,494 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,495 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,495 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,495 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,495 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,495 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,495 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,495 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,495 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,496 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,496 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,496 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,496 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,496 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,496 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,496 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,496 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,496 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,497 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,497 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,497 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,497 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,497 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,497 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,497 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,497 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,497 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,497 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,501 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,503 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,503 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,503 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,503 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,503 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,503 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,503 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,505 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,507 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,507 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,507 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,507 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,507 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,507 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,507 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,507 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,507 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,507 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,508 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,508 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,508 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,508 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,508 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,508 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,508 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,508 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,508 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,508 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,509 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,509 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,509 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,509 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,509 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,509 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,509 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,509 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,509 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,509 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,509 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,509 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,509 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,509 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,510 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,510 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,510 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,510 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,510 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,510 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,511 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,511 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,511 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,511 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,512 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,512 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,512 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,512 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,512 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   learning_rate: 0.10017283165371263
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   n_estimators: 73
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   subsample: 0.8373072645672719
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8564848185348581
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   reg_alpha: 6.266565809920671
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO -   reg_lambda: 0.2714317924622672
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,513 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,516 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,516 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,516 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,516 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,516 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,516 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,516 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,516 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,517 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,517 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,523 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,523 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,523 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,523 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,523 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,523 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,523 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,523 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,523 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,524 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,524 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,524 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,524 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,524 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,524 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,525 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,525 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,525 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,525 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,525 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,525 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,525 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,525 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,525 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,525 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,525 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,525 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,525 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,525 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,525 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,525 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,525 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,525 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,525 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,525 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,525 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,527 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,527 - src.hyperparameter_tuning - ERROR - Trial 49 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,542 - src.hyperparameter_tuning - INFO - Trial 50: 모델 타입 = lightgbm
2025-06-24 09:39:06,545 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,546 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,546 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,546 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,546 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,546 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,546 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,546 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,546 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,547 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,547 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,547 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,547 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,547 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,547 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,547 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,547 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,547 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,548 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,548 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,548 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,548 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,548 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,548 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,548 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,548 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,548 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,548 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,552 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,554 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,554 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,554 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,554 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,554 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,554 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,554 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,556 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,558 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,558 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,558 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,558 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,558 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,558 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,558 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,558 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,558 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,558 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,559 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,559 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,559 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,559 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,559 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,559 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,559 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,559 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,559 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,559 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,560 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,560 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,560 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,560 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,560 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,560 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,560 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,560 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,560 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,561 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,561 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,561 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,561 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,562 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,562 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,563 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,563 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,564 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,564 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,564 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,564 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,564 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,564 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,564 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,564 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,564 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,564 - src.models.lightgbm_model - INFO -   learning_rate: 0.19354396033060667
2025-06-24 09:39:06,564 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,564 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   n_estimators: 461
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   subsample: 0.8193951276727495
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7785557445809279
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00027869312762492945
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00013688798527848386
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,565 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,569 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,569 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,569 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,569 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,569 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,570 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,570 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,570 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,576 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,576 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,576 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,576 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,576 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,576 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,576 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,576 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,576 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,576 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,577 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,577 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,577 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,577 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,577 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,578 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,578 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,578 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,578 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,578 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,578 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,578 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,578 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,578 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,578 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,578 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,578 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,578 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,578 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,578 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,578 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,578 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,578 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,578 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,578 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,578 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,580 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,580 - src.hyperparameter_tuning - ERROR - Trial 50 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,596 - src.hyperparameter_tuning - INFO - Trial 51: 모델 타입 = lightgbm
2025-06-24 09:39:06,599 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,599 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,599 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,599 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,599 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,599 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,599 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,599 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,600 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,600 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,600 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,600 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,600 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,600 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,600 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,600 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,600 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,600 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,601 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,601 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,601 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,601 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,601 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,601 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,601 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,601 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,601 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,601 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,605 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,607 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,607 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,607 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,607 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,607 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,607 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,607 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,609 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,611 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,611 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,611 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,611 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,611 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,611 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,611 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,611 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,611 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,611 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,612 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,612 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,612 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,612 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,612 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,612 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,612 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,613 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,613 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,613 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,613 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,613 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,614 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,614 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,614 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,614 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,614 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,614 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,614 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,614 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,614 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,614 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,614 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,614 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,614 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,615 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,615 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,615 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,615 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,615 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,615 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,615 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,615 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,615 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,616 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,616 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,617 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,617 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO -   learning_rate: 0.0142443614712617
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,617 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   n_estimators: 129
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   subsample: 0.9746128038451177
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.718946577832295
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   reg_alpha: 4.407538220944994e-06
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO -   reg_lambda: 0.13079007377001461
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,618 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,620 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,620 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,620 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,620 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,620 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,620 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,620 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,620 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,621 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,621 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,621 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,622 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,622 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,622 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,622 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,622 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,622 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,622 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,622 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,622 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,622 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,622 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,622 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,623 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,623 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,623 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,623 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,623 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,623 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,623 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,624 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,624 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,624 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,624 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,624 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,624 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,624 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,624 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,624 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,624 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,624 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,624 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,624 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,624 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,624 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,624 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,624 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,626 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,626 - src.hyperparameter_tuning - ERROR - Trial 51 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,642 - src.hyperparameter_tuning - INFO - Trial 52: 모델 타입 = lightgbm
2025-06-24 09:39:06,645 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,645 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,645 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,645 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,645 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,645 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,646 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,646 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,646 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,646 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,646 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,646 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,646 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,646 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,646 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,646 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,646 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,646 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,647 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,647 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,647 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,647 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,647 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,647 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,647 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,647 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,647 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,647 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,651 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,653 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,653 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,653 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,653 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,653 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,653 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,653 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,655 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,657 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,657 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,657 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,657 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,657 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,657 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,657 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,657 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,657 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,657 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,658 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,658 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,658 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,658 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,658 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,658 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,658 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,659 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,659 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,659 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,659 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,659 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,659 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,660 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,660 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,660 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,660 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,660 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,660 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,660 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,660 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,660 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,660 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,661 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,661 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,661 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,661 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,661 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,661 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,662 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,663 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,663 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO -   learning_rate: 0.018456661428192748
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,663 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   n_estimators: 181
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   subsample: 0.9509603298852387
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6911039091967015
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   reg_alpha: 7.612892550570312e-07
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO -   reg_lambda: 4.173453381060882e-06
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,664 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,666 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,666 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,666 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,666 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,666 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,667 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,667 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,667 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,667 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,671 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,671 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,671 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,671 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,671 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,671 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,671 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,671 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,671 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,671 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,671 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,671 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,671 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,672 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,672 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,672 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,672 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,672 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,672 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,672 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,672 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,672 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,672 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,672 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,672 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,672 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,672 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,672 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,672 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,672 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,672 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,672 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,672 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,672 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,672 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,672 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,675 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,675 - src.hyperparameter_tuning - ERROR - Trial 52 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,691 - src.hyperparameter_tuning - INFO - Trial 53: 모델 타입 = lightgbm
2025-06-24 09:39:06,694 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,694 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,694 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,694 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,694 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,694 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,694 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,694 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,694 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,695 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,695 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,695 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,695 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,695 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,695 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,695 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,695 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,695 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,696 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,696 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,696 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,696 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,696 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,696 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,696 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,696 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,696 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,696 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,700 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,702 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,702 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,702 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,702 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,702 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,702 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,702 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,704 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,706 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,706 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,706 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,706 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,706 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,706 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,706 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,706 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,706 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,706 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,706 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,707 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,707 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,707 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,707 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,707 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,707 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,707 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,707 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,707 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,708 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,708 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,708 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,708 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,708 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,708 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,708 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,708 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,708 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,708 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,708 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,708 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,709 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,710 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,710 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,710 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,711 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,711 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,711 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,711 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,711 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   learning_rate: 0.023387567111245493
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   n_estimators: 253
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   subsample: 0.9226975130375475
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6611933706717418
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   reg_alpha: 2.5680490521396752e-08
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO -   reg_lambda: 0.008010451217063149
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,712 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,715 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,715 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,715 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,715 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,715 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,715 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,716 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,716 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,722 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,722 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,722 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,722 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,722 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,722 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,722 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,722 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,722 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,722 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,723 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,723 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,723 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,723 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,723 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,724 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,724 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,724 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,724 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,724 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,724 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,724 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,724 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,724 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,724 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,724 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,724 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,724 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,724 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,724 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,724 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,724 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,724 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,724 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,724 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,724 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,726 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,726 - src.hyperparameter_tuning - ERROR - Trial 53 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,742 - src.hyperparameter_tuning - INFO - Trial 54: 모델 타입 = lightgbm
2025-06-24 09:39:06,745 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,745 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,745 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,745 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,745 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,745 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,745 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,745 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,746 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,746 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,746 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,746 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,746 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,746 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,746 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,746 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,746 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,746 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,747 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,747 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,747 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,747 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,747 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,747 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,747 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,747 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,747 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,747 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,751 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,753 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,753 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,753 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,753 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,753 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,753 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,753 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,755 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,757 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,757 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,757 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,757 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,757 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,757 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,757 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,757 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,757 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,757 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,758 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,758 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,758 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,758 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,758 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,758 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,758 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,759 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,759 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,759 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,760 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,760 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,760 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,760 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,760 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,760 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,760 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,760 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,760 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,760 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,760 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,760 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,760 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,760 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,760 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,760 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,760 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,760 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,761 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,761 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,761 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,761 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,761 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,761 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,761 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,761 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,761 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,762 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,763 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,763 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,763 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,763 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,763 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,763 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,763 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,763 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   learning_rate: 0.017930539769372034
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   n_estimators: 292
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   subsample: 0.7831255552496368
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7589517267440986
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   reg_alpha: 3.771141225353274e-05
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO -   reg_lambda: 0.000530203372836347
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,764 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,766 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,766 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,766 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,766 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,767 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,767 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,768 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,768 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,774 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,774 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,774 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,774 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,774 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,774 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,774 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,774 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,774 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,774 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,775 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,775 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,775 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,775 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,775 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,776 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,776 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,776 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,776 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,776 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,776 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,776 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,776 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,776 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,776 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,776 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,776 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,776 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,776 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,776 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,776 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,776 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,776 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,776 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,776 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,776 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,778 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,778 - src.hyperparameter_tuning - ERROR - Trial 54 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,794 - src.hyperparameter_tuning - INFO - Trial 55: 모델 타입 = lightgbm
2025-06-24 09:39:06,797 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,797 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,797 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,797 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,797 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,797 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,797 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,798 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,798 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,798 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,798 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,798 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,798 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,798 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,798 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,798 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,798 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,798 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,799 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,799 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,799 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,799 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,799 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,799 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,799 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,799 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,799 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,799 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,803 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,805 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,805 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,805 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,805 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,805 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,805 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,805 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,807 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,809 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,809 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,809 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,809 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,809 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,809 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,809 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,809 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,809 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,809 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,810 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,810 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,810 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,810 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,810 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,810 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,810 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,811 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,811 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,811 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,811 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,811 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,811 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,811 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,811 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,812 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,812 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,812 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,812 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,812 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,812 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,812 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,812 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,813 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,813 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,814 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,814 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,814 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,814 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,814 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,814 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,814 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,814 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,815 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,815 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   learning_rate: 0.011437207024077016
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,815 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,816 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,816 - src.models.lightgbm_model - INFO -   n_estimators: 51
2025-06-24 09:39:06,816 - src.models.lightgbm_model - INFO -   subsample: 0.9988910626470648
2025-06-24 09:39:06,816 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7955253543847626
2025-06-24 09:39:06,816 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:06,816 - src.models.lightgbm_model - INFO -   reg_alpha: 3.9245291180279974e-07
2025-06-24 09:39:06,816 - src.models.lightgbm_model - INFO -   reg_lambda: 0.001413477088598793
2025-06-24 09:39:06,816 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,816 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,816 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,818 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,818 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,818 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,818 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,818 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,818 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,818 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,818 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,818 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,819 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,819 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,819 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,819 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,819 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,819 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,819 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,819 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,824 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,824 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,824 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,824 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,824 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,824 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,824 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,824 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,824 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,825 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,825 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,825 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,825 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,825 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,825 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,826 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,826 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,826 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,826 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,826 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,826 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,826 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,826 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,826 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,826 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,826 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,826 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,826 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,826 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,826 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,826 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,826 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,826 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,826 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,826 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,826 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,828 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,828 - src.hyperparameter_tuning - ERROR - Trial 55 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,844 - src.hyperparameter_tuning - INFO - Trial 56: 모델 타입 = lightgbm
2025-06-24 09:39:06,847 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,848 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,848 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,848 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,848 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,848 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,848 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,848 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,848 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,848 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,848 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,848 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,848 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,848 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,848 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,849 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,849 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,849 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,849 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,849 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,850 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,850 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,850 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,850 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,850 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,850 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,850 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,850 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,853 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,855 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,855 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,855 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,855 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,855 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,855 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,855 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,857 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,859 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,859 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,859 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,859 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,860 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,860 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,860 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,860 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,860 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,860 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,860 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,860 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,860 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,860 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,860 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,860 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,860 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,861 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,861 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,861 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,862 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,862 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,862 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,862 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,862 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,862 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,862 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,862 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,862 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,862 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,862 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,862 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,862 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,862 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,862 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,863 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,864 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,864 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,864 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,864 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,864 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,864 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,864 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,864 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,865 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,865 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,865 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,865 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,865 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,865 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,865 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,865 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,865 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,865 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   learning_rate: 0.153186769078403
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   n_estimators: 620
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   subsample: 0.7475015634023295
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9150280338924608
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   reg_alpha: 1.1809416753112032e-07
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO -   reg_lambda: 1.3713683152159453e-05
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,866 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,882 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,882 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,882 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,882 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,882 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,883 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,883 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,883 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,883 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,884 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,884 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,884 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,889 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,889 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,889 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,889 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,889 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,889 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,889 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,889 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,889 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,889 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,890 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,890 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,890 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,890 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,890 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,891 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,891 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,891 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,891 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,891 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,891 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,891 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,891 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,891 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,891 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,891 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,891 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,891 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,891 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,891 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,891 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,891 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,891 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,891 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,891 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,891 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,893 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,893 - src.hyperparameter_tuning - ERROR - Trial 56 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,909 - src.hyperparameter_tuning - INFO - Trial 57: 모델 타입 = lightgbm
2025-06-24 09:39:06,912 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,913 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,913 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,913 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,913 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,913 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,913 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,913 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,913 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,914 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,914 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,914 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,914 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,914 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,914 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,914 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,914 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,914 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,915 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,915 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,915 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,915 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,915 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,915 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,915 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,915 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,915 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,915 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,918 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,920 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,920 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,920 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,921 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,921 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,921 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,921 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,923 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,925 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,925 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,925 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,925 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,925 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,925 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,925 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,925 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,925 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,925 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,925 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,926 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,926 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,926 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,926 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,926 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,926 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,926 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,926 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,926 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,927 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,927 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,927 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,927 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,927 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,927 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,927 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,927 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,927 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,927 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,927 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,927 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,928 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,928 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,929 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,929 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,929 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,929 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,930 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,930 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   learning_rate: 0.04252092888793017
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   n_estimators: 555
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   subsample: 0.9111812059161246
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6841855639649754
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:39:06,931 - src.models.lightgbm_model - INFO -   reg_alpha: 1.469469291873918e-06
2025-06-24 09:39:06,932 - src.models.lightgbm_model - INFO -   reg_lambda: 1.362640689879042
2025-06-24 09:39:06,932 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,932 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,932 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,934 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,934 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,934 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,934 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,934 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,934 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,934 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,934 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,934 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,935 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,935 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,935 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,941 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,941 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,941 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,941 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,941 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,941 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,941 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,941 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,941 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,942 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,942 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,942 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,942 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,942 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,942 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,943 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,943 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,943 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,943 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,943 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,943 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,943 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,943 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,943 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,943 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,943 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,943 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,943 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,943 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,943 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,943 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,943 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,943 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,943 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,943 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,943 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,945 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,945 - src.hyperparameter_tuning - ERROR - Trial 57 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:06,961 - src.hyperparameter_tuning - INFO - Trial 58: 모델 타입 = lightgbm
2025-06-24 09:39:06,964 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:06,965 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:06,965 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:06,965 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:06,965 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:06,965 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:06,965 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:06,965 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:06,965 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:06,966 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:06,966 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:06,966 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:06,966 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:06,966 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:06,966 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:06,966 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:06,966 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:06,966 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:06,967 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,967 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,967 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:06,967 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:06,967 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,967 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:06,967 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:06,967 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:06,967 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:06,967 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:06,970 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:06,972 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,972 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:06,972 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:06,972 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:06,972 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:06,972 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:06,972 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:06,974 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:06,976 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:06,976 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,977 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,977 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:06,977 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:06,977 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,977 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:06,977 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:06,977 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,977 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,977 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:06,977 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:06,977 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,977 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,977 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:06,977 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:06,977 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,978 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,978 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:06,978 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:06,979 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:06,979 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:06,979 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:06,979 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:06,979 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:06,979 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:06,979 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:06,979 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:06,979 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,979 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:06,979 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:06,979 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:06,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:06,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,979 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,980 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:06,980 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:06,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,981 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,981 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,981 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,981 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,982 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,982 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,982 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,982 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,982 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:06,982 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,982 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:06,982 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,982 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:06,982 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   learning_rate: 0.01121632525249422
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   n_estimators: 506
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   subsample: 0.7239428053703661
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7096617144525774
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   reg_alpha: 1.2539835065528851e-05
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO -   reg_lambda: 3.479924777807695e-08
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:06,983 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:06,985 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:06,985 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:06,985 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:06,985 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:06,985 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:06,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:06,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:06,986 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:06,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:06,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:06,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:06,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:06,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:06,987 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:06,987 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,987 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:06,987 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:06,987 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:06,987 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:06,987 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:06,987 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,987 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,987 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:06,987 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:06,987 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:06,987 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:06,988 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:06,988 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:06,988 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,988 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,988 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,988 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:06,989 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:06,989 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:06,989 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:06,989 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:06,989 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:06,989 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:06,989 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:06,989 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:06,989 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:06,989 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:06,989 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:06,989 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:06,989 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:06,989 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:06,989 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:06,989 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:06,989 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,989 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,989 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:06,989 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:06,991 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:06,991 - src.hyperparameter_tuning - ERROR - Trial 58 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,007 - src.hyperparameter_tuning - INFO - Trial 59: 모델 타입 = lightgbm
2025-06-24 09:39:07,010 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,011 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,011 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,011 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,011 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,011 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,011 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,011 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,011 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,012 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,012 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,012 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,012 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,012 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,012 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,012 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,012 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,012 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,013 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,013 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,013 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,013 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,013 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,013 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,013 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,013 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,013 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,013 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,016 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,018 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,018 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,018 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,018 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,018 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,018 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,018 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,021 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,023 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,023 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,023 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,023 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,023 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,023 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,023 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,023 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,023 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,023 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,023 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,023 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,023 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,023 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,023 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,023 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,024 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,024 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,024 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,024 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,025 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,025 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,025 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,025 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,025 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,025 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,025 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,025 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,025 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,025 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,025 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,025 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,026 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,027 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,027 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,027 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,028 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,028 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,028 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,028 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,028 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   learning_rate: 0.24384133830368773
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   n_estimators: 335
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   subsample: 0.8683523300707465
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8857996984773274
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   reg_alpha: 4.439663032964412e-08
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO -   reg_lambda: 0.02341800942228853
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,029 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,030 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,032 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,032 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,032 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,032 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,032 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,032 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,032 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,033 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,033 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,034 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,034 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,034 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,040 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,040 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,040 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,040 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,040 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,040 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,040 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,040 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,040 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,040 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,041 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,041 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,041 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,041 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,041 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,041 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,042 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,042 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,042 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,042 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,042 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,042 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,042 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,042 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,042 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,042 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,042 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,042 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,042 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,042 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,042 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,042 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,042 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,042 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,042 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,042 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,044 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,044 - src.hyperparameter_tuning - ERROR - Trial 59 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,060 - src.hyperparameter_tuning - INFO - Trial 60: 모델 타입 = lightgbm
2025-06-24 09:39:07,063 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,064 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,064 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,064 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,064 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,064 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,064 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,064 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,064 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,065 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,065 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,065 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,065 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,065 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,065 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,065 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,065 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,065 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,066 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,066 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,066 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,066 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,066 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,066 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,066 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,066 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,066 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,066 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,069 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,071 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,071 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,071 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,071 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,071 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,071 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,071 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,074 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,076 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,076 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,076 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,076 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,076 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,076 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,076 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,076 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,076 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,076 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,076 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,076 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,076 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,076 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,076 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,076 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,076 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,077 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,077 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,077 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,078 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,078 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,078 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,078 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,078 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,078 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,078 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,078 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,078 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,078 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,078 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,078 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,079 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,080 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,080 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,080 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,080 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,080 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,080 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,080 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,080 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,080 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,081 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,081 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,081 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,081 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,081 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   learning_rate: 0.013791386929805163
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   n_estimators: 693
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   subsample: 0.6055182468435556
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7421066057531389
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   reg_alpha: 0.028410855500270112
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00020704799608554415
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,082 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,092 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,092 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,092 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,092 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,092 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,092 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,092 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,092 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,093 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,093 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,093 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,093 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,094 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,094 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,094 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,094 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,094 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,094 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,094 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,094 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,094 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,094 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,094 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,094 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,094 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,095 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,095 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,095 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,095 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,095 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,095 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,095 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,095 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,095 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,095 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,095 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,095 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,095 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,095 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,095 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,095 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,095 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,095 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,095 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,095 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,095 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,095 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,098 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,098 - src.hyperparameter_tuning - ERROR - Trial 60 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,114 - src.hyperparameter_tuning - INFO - Trial 61: 모델 타입 = lightgbm
2025-06-24 09:39:07,117 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,117 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,117 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,117 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,118 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,118 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,118 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,118 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,118 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,118 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,118 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,118 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,118 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,118 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,118 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,118 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,118 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,118 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,119 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,119 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,119 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,119 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,119 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,119 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,119 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,119 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,119 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,119 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,123 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,125 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,125 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,125 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,125 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,125 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,125 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,125 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,127 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,129 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,129 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,129 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,129 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,129 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,129 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,129 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,129 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,129 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,129 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,130 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,130 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,130 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,130 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,130 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,130 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,130 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,131 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,131 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,131 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,131 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,131 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,131 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,132 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,132 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,132 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,132 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,132 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,132 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,132 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,132 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,132 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,132 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,132 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,132 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,132 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,132 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,132 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,133 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,133 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,133 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,133 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,133 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,134 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,134 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,135 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,135 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,135 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,135 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,135 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,135 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,135 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,135 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,135 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,135 - src.models.lightgbm_model - INFO -   learning_rate: 0.29607121667659375
2025-06-24 09:39:07,135 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,135 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,135 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,135 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,135 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,135 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,135 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   n_estimators: 571
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   subsample: 0.9492180121271596
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9835831542773467
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   reg_alpha: 0.1889918707742379
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO -   reg_lambda: 0.6510572184077662
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,136 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,146 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,146 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,146 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,146 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,146 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,147 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,147 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,147 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,147 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,147 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,147 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,147 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,147 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,148 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,148 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,148 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,148 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,148 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,148 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,148 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,148 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,148 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,148 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,148 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,148 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,148 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,149 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,149 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,149 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,149 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,149 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,149 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,149 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,149 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,149 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,150 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,150 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,150 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,150 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,150 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,150 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,150 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,150 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,150 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,150 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,150 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,150 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,150 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,150 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,150 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,152 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,152 - src.hyperparameter_tuning - ERROR - Trial 61 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,169 - src.hyperparameter_tuning - INFO - Trial 62: 모델 타입 = lightgbm
2025-06-24 09:39:07,172 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,172 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,172 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,172 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,172 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,172 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,172 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,172 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,173 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,173 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,173 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,173 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,173 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,173 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,173 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,173 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,173 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,173 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,174 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,174 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,174 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,174 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,174 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,174 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,174 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,174 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,175 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,175 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,178 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,180 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,180 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,180 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,180 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,180 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,180 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,180 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,182 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,184 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,184 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,185 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,185 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,185 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,185 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,185 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,185 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,185 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,185 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,185 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,185 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,185 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,185 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,185 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,185 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,186 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,186 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,186 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,186 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,187 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,187 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,187 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,187 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,187 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,187 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,187 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,187 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,187 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,187 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,187 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,187 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,188 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,189 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,189 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,190 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,191 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,191 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,191 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,191 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,191 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,191 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,191 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   learning_rate: 0.27145131192063576
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   n_estimators: 441
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   subsample: 0.8388888202790384
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9679527386504253
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0032641441634054954
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO -   reg_lambda: 3.55409111214763e-05
2025-06-24 09:39:07,192 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,193 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,193 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,195 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,195 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,195 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,195 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,195 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,195 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,195 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,196 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,196 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,196 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,196 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,196 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,196 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,196 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,197 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,197 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,197 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,197 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,198 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,198 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,198 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,198 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,198 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,198 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,198 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,198 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,198 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,198 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,198 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,198 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,198 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,199 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,199 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,199 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,199 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,199 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,199 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,199 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,199 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,199 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,199 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,199 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,199 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,199 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,199 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,199 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,199 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,199 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,199 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,199 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,199 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,199 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,199 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,202 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,202 - src.hyperparameter_tuning - ERROR - Trial 62 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,218 - src.hyperparameter_tuning - INFO - Trial 63: 모델 타입 = lightgbm
2025-06-24 09:39:07,221 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,221 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,221 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,221 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,221 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,221 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,221 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,221 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,221 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,222 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,222 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,222 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,222 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,222 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,222 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,222 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,222 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,222 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,223 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,223 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,223 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,223 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,223 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,223 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,223 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,223 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,223 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,223 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,227 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,229 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,229 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,229 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,229 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,229 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,229 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,229 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,231 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,233 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,233 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,233 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,233 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,233 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,233 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,233 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,233 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,233 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,233 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,234 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,234 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,234 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,234 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,234 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,234 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,234 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,234 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,234 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,234 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,235 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,235 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,235 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,235 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,235 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,235 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,235 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,235 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,235 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,235 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,235 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,235 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,236 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,237 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,237 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,237 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,238 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,238 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,238 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,238 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,238 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,238 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,238 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,238 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,238 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,238 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,238 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   learning_rate: 0.18507739953392208
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   n_estimators: 501
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   subsample: 0.9255363949136147
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9478516979033457
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0016453016635939743
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO -   reg_lambda: 3.889292533372911
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,239 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,242 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,242 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,242 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,242 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,242 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,242 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,242 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,242 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,242 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,243 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,243 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,243 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,243 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,243 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,243 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,249 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,249 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,249 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,249 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,249 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,249 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,249 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,249 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,249 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,249 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,250 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,250 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,250 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,250 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,250 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,251 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,251 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,251 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,251 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,251 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,251 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,251 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,251 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,251 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,251 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,251 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,251 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,251 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,251 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,251 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,251 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,251 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,251 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,251 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,251 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,251 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,253 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,253 - src.hyperparameter_tuning - ERROR - Trial 63 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,269 - src.hyperparameter_tuning - INFO - Trial 64: 모델 타입 = lightgbm
2025-06-24 09:39:07,273 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,273 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,273 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,273 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,273 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,273 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,273 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,273 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,273 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,274 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,274 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,274 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,274 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,274 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,274 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,274 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,274 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,274 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,275 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,275 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,275 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,275 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,275 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,275 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,275 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,275 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,275 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,275 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,278 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,281 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,281 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,281 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,281 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,281 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,281 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,281 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,283 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,285 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,285 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,285 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,285 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,285 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,285 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,285 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,285 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,285 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,285 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,286 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,286 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,286 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,286 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,286 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,286 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,286 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,286 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,286 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,286 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,287 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,287 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,287 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,287 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,287 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,287 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,287 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,287 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,287 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,287 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,287 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,287 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,287 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,287 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,288 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,289 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,289 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,289 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,290 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,290 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,290 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,290 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,290 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,290 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,290 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,290 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,290 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,290 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,290 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   learning_rate: 0.12954824612423743
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   n_estimators: 98
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   subsample: 0.8112141622588307
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9260449527056052
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   reg_alpha: 0.009995808450449633
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO -   reg_lambda: 0.10706547190904596
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,291 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,294 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,294 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,294 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,294 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,294 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,294 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,294 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,294 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,294 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,294 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,294 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,295 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,295 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,301 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,301 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,301 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,301 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,301 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,301 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,301 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,301 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,301 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,301 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,302 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,302 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,302 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,302 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,302 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,303 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,303 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,303 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,303 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,303 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,303 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,303 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,303 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,303 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,303 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,303 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,303 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,303 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,303 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,303 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,303 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,303 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,303 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,303 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,303 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,303 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,305 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,305 - src.hyperparameter_tuning - ERROR - Trial 64 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,321 - src.hyperparameter_tuning - INFO - Trial 65: 모델 타입 = lightgbm
2025-06-24 09:39:07,325 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,325 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,325 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,325 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,325 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,325 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,325 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,325 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,325 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,326 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,326 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,326 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,326 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,326 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,326 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,326 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,326 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,326 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,327 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,327 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,327 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,327 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,327 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,327 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,327 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,327 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,327 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,327 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,331 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,333 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,333 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,333 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,333 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,333 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,333 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,333 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,335 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,337 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,337 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,337 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,337 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,337 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,337 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,337 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,337 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,337 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,337 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,338 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,338 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,338 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,338 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,338 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,338 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,338 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,338 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,339 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,339 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,339 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,339 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,339 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,339 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,339 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,339 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,339 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,340 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,340 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,340 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,340 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,340 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,340 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,341 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,341 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,342 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO -   learning_rate: 0.015953931804349637
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,343 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   n_estimators: 415
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   subsample: 0.9789455694045592
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9991613164008715
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   reg_alpha: 6.456208343096671e-05
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO -   reg_lambda: 2.1200870633038303e-07
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,344 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,346 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,346 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,346 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,346 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,346 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,347 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,347 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,347 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,348 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,351 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,351 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,351 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,351 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,351 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,351 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,351 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,351 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,351 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,351 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,352 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,352 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,352 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,352 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,352 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,353 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,353 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,353 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,353 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,353 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,353 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,353 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,353 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,353 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,353 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,353 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,353 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,353 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,353 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,353 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,353 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,353 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,353 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,353 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,353 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,353 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,355 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,355 - src.hyperparameter_tuning - ERROR - Trial 65 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,372 - src.hyperparameter_tuning - INFO - Trial 66: 모델 타입 = lightgbm
2025-06-24 09:39:07,375 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,375 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,375 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,375 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,375 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,375 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,375 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,375 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,376 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,376 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,376 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,376 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,376 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,376 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,376 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,376 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,376 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,376 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,377 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,377 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,377 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,377 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,377 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,377 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,377 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,377 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,377 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,377 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,381 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,383 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,383 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,383 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,383 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,383 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,383 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,383 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,385 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,387 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,387 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,387 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,387 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,387 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,387 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,387 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,387 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,387 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,387 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,388 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,388 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,388 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,388 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,388 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,388 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,388 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,389 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,389 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,389 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,389 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,390 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,390 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,390 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,390 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,390 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,390 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,390 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,390 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,390 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,390 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,390 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,390 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,390 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,390 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,391 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,391 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,392 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,392 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,393 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,393 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,393 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,393 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,393 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,393 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,393 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,393 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,393 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   learning_rate: 0.11087159867996219
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   n_estimators: 679
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   subsample: 0.9403050846328712
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9758227150453681
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   reg_alpha: 1.0131157393738157e-08
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO -   reg_lambda: 0.8523746549601214
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,394 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,396 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,396 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,396 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,396 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,396 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,396 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,396 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,397 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,398 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,398 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,404 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,404 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,404 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,404 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,404 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,404 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,404 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,404 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,404 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,404 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,405 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,405 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,405 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,405 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,405 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,406 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,406 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,406 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,406 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,406 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,406 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,406 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,406 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,406 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,406 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,406 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,406 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,406 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,406 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,406 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,406 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,406 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,406 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,406 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,406 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,406 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,408 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,408 - src.hyperparameter_tuning - ERROR - Trial 66 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,425 - src.hyperparameter_tuning - INFO - Trial 67: 모델 타입 = lightgbm
2025-06-24 09:39:07,428 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,429 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,429 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,429 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,429 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,429 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,429 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,429 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,429 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,430 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,430 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,430 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,430 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,430 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,430 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,430 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,430 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,430 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,431 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,431 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,431 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,431 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,431 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,431 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,431 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,431 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,431 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,431 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,434 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,436 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,436 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,436 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,436 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,436 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,437 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,437 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,439 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,441 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,441 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,441 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,441 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,441 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,441 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,441 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,441 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,441 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,441 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,441 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,441 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,441 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,441 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,441 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,441 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,441 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,442 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,442 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,442 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,443 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,443 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,443 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,443 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,443 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,443 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,443 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,443 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,443 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,443 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,443 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,443 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,443 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,443 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,443 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,444 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,444 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,444 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,444 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,444 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,444 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,444 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,444 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,445 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,446 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,446 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,446 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,446 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,446 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,446 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   learning_rate: 0.22703332024128894
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   n_estimators: 738
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   subsample: 0.682593228121369
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8224029138278149
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   reg_alpha: 6.007326216970683e-06
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO -   reg_lambda: 7.268356621597371e-08
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,447 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,450 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,450 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,450 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,450 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,450 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,450 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,450 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,451 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,452 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,452 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,452 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,455 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,455 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,455 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,455 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,455 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,455 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,455 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,455 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,456 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,456 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,456 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,456 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,456 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,456 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,456 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,457 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,457 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,457 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,457 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,457 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,457 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,457 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,457 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,457 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,457 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,457 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,457 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,457 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,457 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,457 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,457 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,457 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,457 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,457 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,457 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,457 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,459 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,459 - src.hyperparameter_tuning - ERROR - Trial 67 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,476 - src.hyperparameter_tuning - INFO - Trial 68: 모델 타입 = lightgbm
2025-06-24 09:39:07,479 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,480 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,480 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,480 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,480 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,480 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,480 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,480 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,480 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,481 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,481 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,481 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,481 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,481 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,481 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,481 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,481 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,481 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,482 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,482 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,482 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,482 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,482 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,482 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,482 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,482 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,482 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,482 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,485 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,488 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,488 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,488 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,488 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,488 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,488 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,488 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,490 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,492 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,492 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,492 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,492 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,492 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,492 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,492 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,492 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,492 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,492 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,493 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,493 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,493 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,493 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,493 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,493 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,493 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,493 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,493 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,493 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,494 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,494 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,494 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,494 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,494 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,494 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,494 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,494 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,494 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,494 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,494 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,494 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,494 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,494 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,495 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,495 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,495 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,495 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,495 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,495 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,496 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,496 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,496 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,496 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,496 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,496 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,496 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,496 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,496 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,497 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,497 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,497 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,497 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,497 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,497 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,497 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,498 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,498 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,498 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,498 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,498 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,498 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,498 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,498 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,498 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,498 - src.models.lightgbm_model - INFO -   learning_rate: 0.04990710888816552
2025-06-24 09:39:07,498 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   n_estimators: 609
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   subsample: 0.848270830948627
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.850598430172833
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0004951275409578349
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO -   reg_lambda: 3.47820930095863e-06
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,499 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,502 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,502 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,502 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,502 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,502 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,503 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,504 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,504 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,504 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,504 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,504 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,504 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,509 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,509 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,509 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,509 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,509 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,509 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,509 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,509 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,510 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,510 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,510 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,510 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,510 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,511 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,511 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,512 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,512 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,512 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,512 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,512 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,512 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,512 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,512 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,512 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,512 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,512 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,512 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,512 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,512 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,512 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,512 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,512 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,512 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,512 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,512 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,512 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,516 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,516 - src.hyperparameter_tuning - ERROR - Trial 68 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,532 - src.hyperparameter_tuning - INFO - Trial 69: 모델 타입 = lightgbm
2025-06-24 09:39:07,536 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,536 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,536 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,536 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,536 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,536 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,536 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,536 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,536 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,537 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,537 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,537 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,537 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,537 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,537 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,537 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,537 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,537 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,538 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,538 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,538 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,538 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,538 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,538 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,538 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,538 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,538 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,538 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,541 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,544 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,544 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,544 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,544 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,544 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,544 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,544 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,546 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,548 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,548 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,548 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,548 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,548 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,548 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,548 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,548 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,548 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,548 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,548 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,549 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,549 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,549 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,549 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,549 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,549 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,549 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,549 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,549 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,550 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,550 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,550 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,550 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,550 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,550 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,550 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,550 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,550 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,550 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,550 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,550 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,550 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,550 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,551 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,551 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,551 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,551 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,551 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,551 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,552 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,552 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,552 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,553 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,553 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,553 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,553 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,553 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   learning_rate: 0.15916881726677745
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   n_estimators: 998
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   subsample: 0.9530544650204105
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8647144776940237
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   reg_alpha: 1.6010135879554323e-06
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO -   reg_lambda: 1.0999472666734155e-05
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,554 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,556 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,556 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,556 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,556 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,556 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,557 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,563 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,563 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,563 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,563 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,563 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,563 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,563 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,563 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,563 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,563 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,563 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,563 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,564 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,564 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,564 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,564 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,564 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,564 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,564 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,564 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,565 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,565 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,565 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,565 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,565 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,565 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,565 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,565 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,565 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,565 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,565 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,565 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,565 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,565 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,565 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,565 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,567 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,567 - src.hyperparameter_tuning - ERROR - Trial 69 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,585 - src.hyperparameter_tuning - INFO - Trial 70: 모델 타입 = lightgbm
2025-06-24 09:39:07,588 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,588 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,588 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,588 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,588 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,588 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,588 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,588 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,588 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,589 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,589 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,589 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,589 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,589 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,589 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,589 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,589 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,589 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,590 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,590 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,590 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,590 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,590 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,590 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,590 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,590 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,590 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,590 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,594 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,596 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,596 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,596 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,596 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,596 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,596 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,596 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,598 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,600 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,600 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,600 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,600 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,600 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,600 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,600 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,600 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,600 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,600 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,601 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,601 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,601 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,601 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,601 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,601 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,601 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,601 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,602 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,602 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,602 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,602 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,602 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,602 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,602 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,602 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,602 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,602 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,602 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,603 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,603 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,603 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,603 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,603 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,603 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,603 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,604 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,604 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,604 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,604 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,605 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,605 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,605 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,606 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,606 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   learning_rate: 0.020914360188651566
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   n_estimators: 220
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   subsample: 0.7847861042114909
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6157716992226357
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   reg_alpha: 2.2119025375971438e-05
2025-06-24 09:39:07,606 - src.models.lightgbm_model - INFO -   reg_lambda: 2.5581389759662644e-08
2025-06-24 09:39:07,607 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,607 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,607 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,609 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,609 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,609 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,609 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,609 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,609 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,610 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,610 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,616 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,616 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,616 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,616 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,616 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,616 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,616 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,616 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,616 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,617 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,617 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,617 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,617 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,617 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,617 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,618 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,618 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,618 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,618 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,618 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,618 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,618 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,618 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,618 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,618 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,618 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,618 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,618 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,618 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,618 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,618 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,618 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,618 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,618 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,618 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,618 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,620 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,620 - src.hyperparameter_tuning - ERROR - Trial 70 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,637 - src.hyperparameter_tuning - INFO - Trial 71: 모델 타입 = lightgbm
2025-06-24 09:39:07,640 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,641 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,641 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,641 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,641 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,641 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,641 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,641 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,641 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,642 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,642 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,642 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,642 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,642 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,642 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,642 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,642 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,642 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,643 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,643 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,643 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,643 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,643 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,643 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,643 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,643 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,643 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,643 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,646 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,648 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,648 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,649 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,649 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,649 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,649 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,649 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,651 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,653 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,653 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,653 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,653 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,653 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,653 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,653 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,653 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,653 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,653 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,653 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,653 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,653 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,653 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,653 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,653 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,653 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,654 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,654 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,654 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,655 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,655 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,655 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,655 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,655 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,655 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,655 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,655 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,655 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,655 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,655 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,655 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,655 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,655 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,655 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,656 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,656 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,656 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,656 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,656 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,656 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,656 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,656 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,657 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,657 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,657 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,658 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,658 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,658 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,658 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,658 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,658 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,658 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,658 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   learning_rate: 0.010957129865736666
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   n_estimators: 153
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   subsample: 0.6564142001008275
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8397815212987682
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   reg_alpha: 3.0126779680525884
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO -   reg_lambda: 6.874100189958323e-05
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,659 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,661 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,661 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,661 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,661 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,661 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,661 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,661 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,662 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,663 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,663 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,663 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,663 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,663 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,663 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,663 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,663 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,663 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,663 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,663 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,664 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,664 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,664 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,664 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,664 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,664 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,665 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,665 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,665 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,665 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,665 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,665 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,665 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,665 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,665 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,665 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,665 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,665 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,665 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,665 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,665 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,665 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,665 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,665 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,665 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,665 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,665 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,667 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,667 - src.hyperparameter_tuning - ERROR - Trial 71 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,684 - src.hyperparameter_tuning - INFO - Trial 72: 모델 타입 = lightgbm
2025-06-24 09:39:07,687 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,688 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,688 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,688 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,688 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,688 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,688 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,688 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,688 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,689 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,689 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,689 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,689 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,689 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,689 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,689 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,689 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,689 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,690 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,690 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,690 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,690 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,690 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,690 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,690 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,690 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,690 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,690 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,693 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,696 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,696 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,696 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,696 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,696 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,696 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,696 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,698 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,700 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,700 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,700 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,700 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,700 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,700 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,700 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,700 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,700 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,700 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,701 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,701 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,701 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,701 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,701 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,701 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,701 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,701 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,701 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,701 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,702 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,702 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,702 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,702 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,702 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,702 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,702 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,702 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,702 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,702 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,702 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,702 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,702 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,702 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,703 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,703 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,704 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,704 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,704 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,704 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,705 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,705 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,705 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,705 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,705 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,705 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,705 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,705 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,705 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   learning_rate: 0.012872128435596708
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   n_estimators: 108
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   subsample: 0.701870451203659
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7329492683995666
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   reg_alpha: 0.2817736475166566
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO -   reg_lambda: 6.653037142606319e-07
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,706 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,709 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,709 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,709 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,709 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,709 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,709 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,710 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,710 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,713 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,713 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,713 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,713 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,713 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,713 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,713 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,713 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,714 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,714 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,714 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,714 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,714 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,714 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,714 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,715 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,715 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,715 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,715 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,715 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,715 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,715 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,715 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,715 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,715 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,715 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,715 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,715 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,715 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,715 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,715 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,715 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,715 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,715 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,715 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,715 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,718 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,718 - src.hyperparameter_tuning - ERROR - Trial 72 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,734 - src.hyperparameter_tuning - INFO - Trial 73: 모델 타입 = lightgbm
2025-06-24 09:39:07,737 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,738 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,738 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,738 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,738 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,738 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,738 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,738 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,738 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,739 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,739 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,739 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,739 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,739 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,739 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,739 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,739 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,739 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,740 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,740 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,740 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,740 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,740 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,740 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,740 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,740 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,740 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,740 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,743 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,745 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,745 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,745 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,745 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,745 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,745 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,745 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,747 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,749 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,750 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,750 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,750 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,750 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,750 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,750 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,750 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,750 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,750 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,750 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,750 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,750 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,750 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,750 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,750 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,750 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,751 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,751 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,751 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,752 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,752 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,752 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,752 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,752 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,752 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,752 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,752 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,752 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,752 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,752 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,752 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,752 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,752 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,752 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,752 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,753 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,753 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,754 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,754 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,754 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,754 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,754 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,755 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,755 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,755 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,755 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,755 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,755 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,755 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,755 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,755 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,755 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,755 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   learning_rate: 0.014541973687489567
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   n_estimators: 188
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   subsample: 0.759421050732034
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7654101279240798
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   reg_alpha: 0.01722905276111146
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO -   reg_lambda: 1.263937240496527e-06
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,756 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,758 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,758 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,758 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,758 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,758 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,758 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,758 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,758 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,759 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,759 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,759 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,760 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,760 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,760 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,760 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,760 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,760 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,760 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,760 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,760 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,760 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,760 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,760 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,760 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,761 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,761 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,761 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,761 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,761 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,761 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,762 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,762 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,762 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,762 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,762 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,762 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,762 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,762 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,762 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,762 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,762 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,762 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,762 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,762 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,762 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,762 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,762 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,762 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,764 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,764 - src.hyperparameter_tuning - ERROR - Trial 73 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,781 - src.hyperparameter_tuning - INFO - Trial 74: 모델 타입 = lightgbm
2025-06-24 09:39:07,784 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,785 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,785 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,785 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,785 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,785 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,785 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,785 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,785 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,786 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,786 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,786 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,786 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,786 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,786 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,786 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,786 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,786 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,787 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,787 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,787 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,787 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,787 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,787 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,787 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,787 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,787 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,787 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,790 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,792 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,792 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,792 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,792 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,792 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,792 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,792 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,795 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,797 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,797 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,797 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,797 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,797 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,797 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,797 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,797 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,797 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,797 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,797 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,797 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,797 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,797 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,797 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,797 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,797 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,798 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,798 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,798 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,799 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,799 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,799 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,799 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,799 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,799 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,799 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,799 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,799 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,799 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,799 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,799 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,799 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,799 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,799 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,800 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,800 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,800 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,800 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,800 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,800 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,801 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,801 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,801 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,801 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,802 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,802 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,802 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,802 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,802 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,802 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,802 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   learning_rate: 0.010049681564965829
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   n_estimators: 472
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   subsample: 0.7277245828295967
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7166438037926771
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   reg_alpha: 0.006492067438794327
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO -   reg_lambda: 3.47045623771009e-05
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,803 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,806 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,806 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,806 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,806 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,806 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,806 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,807 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,807 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,807 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,810 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,810 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,810 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,810 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,810 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,810 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,810 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,810 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,810 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,810 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,810 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,810 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,811 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,811 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,811 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,811 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,812 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,812 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,812 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,812 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,812 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,812 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,812 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,812 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,812 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,812 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,812 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,812 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,812 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,812 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,812 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,812 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,812 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,812 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,812 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,812 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,814 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,814 - src.hyperparameter_tuning - ERROR - Trial 74 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,831 - src.hyperparameter_tuning - INFO - Trial 75: 모델 타입 = lightgbm
2025-06-24 09:39:07,834 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,835 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,835 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,835 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,835 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,835 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,835 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,835 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,835 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,836 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,836 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,836 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,836 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,836 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,836 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,836 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,836 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,836 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,837 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,837 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,837 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,837 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,837 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,837 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,837 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,837 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,837 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,837 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,840 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,842 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,843 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,843 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,843 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,843 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,843 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,843 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,845 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,847 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,847 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,847 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,847 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,847 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,847 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,847 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,847 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,847 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,847 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,847 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,848 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,848 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,848 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,848 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,848 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,848 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,848 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,848 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,848 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,849 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,849 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,849 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,849 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,849 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,849 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,849 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,849 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,849 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,849 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,849 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,849 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,850 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,850 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,850 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,850 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,850 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,850 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,851 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,851 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,851 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,851 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,851 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,851 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,851 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,851 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,851 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,852 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,852 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,852 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,852 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,852 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,852 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,852 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,852 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   learning_rate: 0.028490465891437326
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,853 - src.models.lightgbm_model - INFO -   n_estimators: 365
2025-06-24 09:39:07,854 - src.models.lightgbm_model - INFO -   subsample: 0.6254706923605511
2025-06-24 09:39:07,854 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7925475288364967
2025-06-24 09:39:07,854 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:39:07,854 - src.models.lightgbm_model - INFO -   reg_alpha: 0.05495560517360351
2025-06-24 09:39:07,854 - src.models.lightgbm_model - INFO -   reg_lambda: 3.551282729015529
2025-06-24 09:39:07,854 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,854 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,854 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,866 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,866 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,866 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,866 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,866 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,867 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,868 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,868 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,868 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,868 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,868 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,868 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,868 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,868 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,868 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,868 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,869 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,869 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,869 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,869 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,869 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,869 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,869 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,870 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,870 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,870 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,870 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,870 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,870 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,870 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,870 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,870 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,870 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,870 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,870 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,870 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,870 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,870 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,870 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,870 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,870 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,870 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,870 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,870 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,872 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,872 - src.hyperparameter_tuning - ERROR - Trial 75 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,890 - src.hyperparameter_tuning - INFO - Trial 76: 모델 타입 = lightgbm
2025-06-24 09:39:07,893 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,902 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,902 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,902 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,902 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,902 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,902 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,902 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,902 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,902 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,902 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,902 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,902 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,902 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,902 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,902 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,903 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,903 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,903 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,903 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,903 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,903 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,904 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,904 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,904 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,904 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,904 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,904 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,907 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,909 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,909 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,909 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,909 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,909 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,909 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,909 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,911 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,913 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,913 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,913 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,913 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,913 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,913 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,913 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,913 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,913 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,913 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,914 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,914 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,914 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,914 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,914 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,914 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,914 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,915 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,915 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,915 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,916 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,916 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,916 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,916 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,916 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,916 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,916 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,916 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,916 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,916 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,916 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,916 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,916 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,916 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,916 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,916 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,916 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,916 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,917 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,917 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,917 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,917 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,917 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,917 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,918 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,918 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,918 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,918 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,918 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,918 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,918 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,918 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,919 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,919 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   learning_rate: 0.012115236479030286
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,919 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,920 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,920 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,920 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,920 - src.models.lightgbm_model - INFO -   n_estimators: 153
2025-06-24 09:39:07,920 - src.models.lightgbm_model - INFO -   subsample: 0.9118267599058681
2025-06-24 09:39:07,920 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6687523762556236
2025-06-24 09:39:07,920 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:07,920 - src.models.lightgbm_model - INFO -   reg_alpha: 1.6345515759655802
2025-06-24 09:39:07,920 - src.models.lightgbm_model - INFO -   reg_lambda: 7.166551603900752e-06
2025-06-24 09:39:07,920 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,920 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,920 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,922 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,922 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,922 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,922 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,922 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,922 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,922 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,922 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,922 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,923 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,923 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,929 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,929 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,929 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,929 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,929 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,929 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,929 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,929 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,929 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,930 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,930 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,930 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,930 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,930 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,930 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,931 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,931 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,931 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,931 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,931 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,931 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,931 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,931 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,931 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,931 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,931 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,931 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,931 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,931 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,931 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,931 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,931 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,931 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,931 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,931 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,931 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,933 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,933 - src.hyperparameter_tuning - ERROR - Trial 76 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:07,950 - src.hyperparameter_tuning - INFO - Trial 77: 모델 타입 = lightgbm
2025-06-24 09:39:07,954 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:07,954 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:07,954 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:07,954 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:07,954 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:07,954 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:07,954 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:07,954 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:07,954 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:07,955 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:07,955 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:07,955 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:07,955 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:07,955 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:07,955 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:07,955 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:07,955 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:07,955 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:07,956 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,956 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,956 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:07,956 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:07,956 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,956 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:07,956 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:07,956 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:07,956 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:07,956 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:07,960 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:07,962 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,962 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:07,962 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:07,962 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:07,962 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:07,962 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:07,962 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:07,964 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:07,966 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:07,966 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,966 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,966 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:07,966 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:07,966 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,966 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:07,966 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:07,966 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,966 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,967 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:07,967 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:07,967 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,967 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,967 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:07,967 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:07,967 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,967 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,967 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:07,967 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:07,968 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:07,968 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:07,968 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:07,968 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:07,968 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:07,968 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:07,968 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:07,968 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:07,968 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,968 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:07,968 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:07,968 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:07,968 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:07,968 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,969 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,969 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,969 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,969 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,969 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,969 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,969 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,970 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:07,970 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:07,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,970 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,971 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,971 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,971 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:07,971 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,971 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:07,971 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,971 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   learning_rate: 0.063637820225863
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   n_estimators: 881
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   subsample: 0.9660419365576216
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9529111978290701
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   reg_alpha: 5.114020852306642e-07
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0003097731129743343
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:07,972 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:07,975 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:07,975 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:07,975 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:07,975 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:07,975 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:07,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:07,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:07,975 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:07,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:07,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:07,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:07,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:07,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:07,976 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:07,976 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,976 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:07,979 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:07,979 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:07,979 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:07,979 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:07,979 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,980 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,980 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:07,980 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:07,980 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:07,980 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:07,980 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:07,980 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:07,980 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,980 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,981 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,981 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:07,981 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:07,981 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:07,981 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:07,981 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:07,981 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:07,981 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:07,981 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:07,981 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:07,981 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:07,981 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:07,981 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:07,981 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:07,981 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:07,981 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:07,981 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:07,981 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:07,981 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,981 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,981 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:07,981 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:07,984 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:07,984 - src.hyperparameter_tuning - ERROR - Trial 77 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,001 - src.hyperparameter_tuning - INFO - Trial 78: 모델 타입 = lightgbm
2025-06-24 09:39:08,004 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,004 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,004 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,005 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,005 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,005 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,005 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,005 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,005 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,005 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,005 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,005 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,005 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,005 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,005 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,005 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,005 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,005 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,006 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,006 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,006 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,006 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,006 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,006 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,006 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,006 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,006 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,006 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,010 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,012 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,012 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,012 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,012 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,012 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,012 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,012 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,014 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,016 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,016 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,016 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,016 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,016 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,016 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,016 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,016 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,016 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,016 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,017 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,017 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,017 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,017 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,017 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,017 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,017 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,018 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,018 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,018 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,018 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,018 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,018 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,019 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,019 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,019 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,019 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,019 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,019 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,019 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,019 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,019 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,019 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,019 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,019 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,019 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,019 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,019 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,020 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,020 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,020 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,020 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,020 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,020 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,020 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,020 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,020 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,021 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,021 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,021 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,021 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,021 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,021 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,021 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,022 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,022 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,022 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,022 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,022 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,022 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,022 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,022 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,022 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,022 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,022 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,022 - src.models.lightgbm_model - INFO -   learning_rate: 0.016976948057482684
2025-06-24 09:39:08,022 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,022 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,022 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,022 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,022 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,022 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,022 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   n_estimators: 393
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   subsample: 0.7883441898007725
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9375725893666309
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   reg_alpha: 1.6432227257309933e-07
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0009728369901229373
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,023 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,025 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,025 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,025 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,025 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,025 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,026 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,027 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,027 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,030 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,030 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,030 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,030 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,030 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,030 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,030 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,030 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,030 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,031 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,031 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,031 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,031 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,031 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,031 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,032 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,032 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,032 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,032 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,032 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,032 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,032 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,032 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,032 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,032 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,032 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,032 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,032 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,032 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,032 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,032 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,032 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,032 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,032 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,032 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,032 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,034 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,034 - src.hyperparameter_tuning - ERROR - Trial 78 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,052 - src.hyperparameter_tuning - INFO - Trial 79: 모델 타입 = lightgbm
2025-06-24 09:39:08,055 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,055 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,055 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,055 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,055 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,056 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,056 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,056 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,056 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,056 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,056 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,056 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,056 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,056 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,056 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,056 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,056 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,056 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,057 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,057 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,057 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,057 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,057 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,057 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,057 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,057 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,057 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,057 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,061 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,063 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,063 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,063 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,063 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,063 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,063 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,063 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,065 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,067 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,067 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,067 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,067 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,067 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,067 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,067 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,067 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,067 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,067 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,068 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,068 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,068 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,068 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,068 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,068 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,068 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,069 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,069 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,069 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,070 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,070 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,070 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,070 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,070 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,070 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,070 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,070 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,070 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,070 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,070 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,070 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,070 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,070 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,070 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,071 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,071 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,072 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,073 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,073 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,073 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,073 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,073 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,073 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,073 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,073 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,073 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,073 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,073 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,073 - src.models.lightgbm_model - INFO -   learning_rate: 0.2593451809950288
2025-06-24 09:39:08,073 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,073 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,073 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,073 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,073 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   n_estimators: 524
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   subsample: 0.9892833490980313
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8114549676244355
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0024320305460977846
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00011587610553415014
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,074 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,076 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,076 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,076 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,076 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,076 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,077 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,077 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,077 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,077 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,078 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,078 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,084 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,084 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,084 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,084 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,084 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,084 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,084 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,084 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,084 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,085 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,085 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,085 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,085 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,085 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,085 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,086 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,086 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,086 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,086 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,086 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,086 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,086 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,086 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,086 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,086 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,086 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,086 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,086 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,086 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,086 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,086 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,086 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,086 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,086 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,086 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,086 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,088 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,088 - src.hyperparameter_tuning - ERROR - Trial 79 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,105 - src.hyperparameter_tuning - INFO - Trial 80: 모델 타입 = lightgbm
2025-06-24 09:39:08,109 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,110 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,110 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,110 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,110 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,110 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,110 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,110 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,110 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,110 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,110 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,110 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,110 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,110 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,110 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,110 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,110 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,110 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,111 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,111 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,111 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,111 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,111 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,111 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,111 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,111 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,111 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,111 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,115 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,117 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,117 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,117 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,117 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,117 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,117 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,117 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,119 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,121 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,121 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,121 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,121 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,121 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,121 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,121 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,121 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,121 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,121 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,122 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,122 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,122 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,122 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,122 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,122 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,122 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,122 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,122 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,122 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,123 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,123 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,123 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,123 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,123 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,123 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,123 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,123 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,123 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,123 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,123 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,123 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,124 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,125 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,125 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,125 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,125 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,125 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,125 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,125 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,125 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,125 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,126 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,126 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,126 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,126 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,126 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   learning_rate: 0.07813911661457104
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   n_estimators: 302
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   subsample: 0.8875096072240903
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6433794276239841
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0011379545210007589
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO -   reg_lambda: 4.306976213595928e-07
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,127 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,137 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,137 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,137 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,137 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,137 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,137 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,137 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,138 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,138 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,138 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,138 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,138 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,138 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,138 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,138 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,139 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,139 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,139 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,139 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,139 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,139 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,139 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,139 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,139 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,139 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,139 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,139 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,139 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,140 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,140 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,140 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,140 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,140 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,140 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,140 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,140 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,140 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,140 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,140 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,140 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,140 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,140 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,140 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,140 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,140 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,140 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,140 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,140 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,140 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,140 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,143 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,143 - src.hyperparameter_tuning - ERROR - Trial 80 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,160 - src.hyperparameter_tuning - INFO - Trial 81: 모델 타입 = lightgbm
2025-06-24 09:39:08,163 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,164 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,164 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,164 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,164 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,164 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,164 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,164 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,164 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,165 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,165 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,165 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,165 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,165 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,165 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,165 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,165 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,165 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,166 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,166 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,166 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,166 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,166 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,166 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,166 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,166 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,166 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,166 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,169 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,171 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,171 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,171 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,171 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,171 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,171 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,171 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,174 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,176 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,176 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,176 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,176 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,176 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,176 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,176 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,176 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,176 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,176 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,176 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,176 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,176 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,176 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,176 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,176 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,176 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,177 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,177 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,177 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,178 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,178 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,178 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,178 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,178 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,178 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,178 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,178 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,178 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,178 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,178 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,178 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,178 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,178 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,179 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,179 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,179 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,179 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,180 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,180 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,180 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,180 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,180 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,180 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,180 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,181 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,181 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,181 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,181 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,181 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,181 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,182 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,182 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,182 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,182 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,182 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,182 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,182 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,182 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,182 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,182 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,182 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,182 - src.models.lightgbm_model - INFO -   learning_rate: 0.013390824935990937
2025-06-24 09:39:08,182 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,182 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,182 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,182 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,182 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   n_estimators: 225
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   subsample: 0.8655718258437664
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6268140816663329
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   reg_alpha: 0.13849867415852568
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO -   reg_lambda: 2.1834271927039548e-06
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,183 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,185 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,185 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,185 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,185 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,185 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,186 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,187 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,187 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,190 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,190 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,190 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,190 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,190 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,190 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,190 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,190 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,190 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,190 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,191 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,191 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,191 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,191 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,191 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,192 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,192 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,192 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,192 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,192 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,192 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,192 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,192 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,192 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,192 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,192 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,192 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,192 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,192 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,192 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,192 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,192 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,192 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,192 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,192 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,192 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,194 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,194 - src.hyperparameter_tuning - ERROR - Trial 81 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,211 - src.hyperparameter_tuning - INFO - Trial 82: 모델 타입 = lightgbm
2025-06-24 09:39:08,214 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,215 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,215 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,215 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,215 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,215 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,215 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,215 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,215 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,216 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,216 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,216 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,216 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,216 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,216 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,216 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,216 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,216 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,217 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,217 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,217 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,217 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,217 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,217 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,217 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,217 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,217 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,217 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,220 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,223 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,223 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,223 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,223 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,223 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,223 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,223 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,225 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,227 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,227 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,227 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,227 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,227 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,227 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,227 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,227 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,227 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,227 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,228 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,228 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,228 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,228 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,228 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,228 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,228 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,228 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,228 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,228 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,229 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,229 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,229 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,229 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,229 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,229 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,229 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,229 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,229 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,229 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,229 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,229 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,229 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,229 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,230 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,230 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,231 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,231 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,232 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,232 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,232 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,233 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,233 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   learning_rate: 0.015254010311290964
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,233 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO -   n_estimators: 270
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO -   subsample: 0.9338363605752303
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6435775161794274
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO -   reg_alpha: 0.10966313007085868
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO -   reg_lambda: 1.8570005277345276e-07
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,234 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,236 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,236 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,236 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,236 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,236 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,237 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,237 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,237 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,238 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,238 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,238 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,238 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,238 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,238 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,238 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,238 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,238 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,238 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,238 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,238 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,238 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,239 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,239 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,239 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,239 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,239 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,239 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,239 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,239 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,239 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,239 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,239 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,239 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,239 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,239 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,240 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,240 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,240 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,240 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,240 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,240 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,240 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,240 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,240 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,242 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,242 - src.hyperparameter_tuning - ERROR - Trial 82 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,259 - src.hyperparameter_tuning - INFO - Trial 83: 모델 타입 = lightgbm
2025-06-24 09:39:08,262 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,263 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,263 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,263 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,263 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,263 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,263 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,263 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,263 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,264 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,264 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,264 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,264 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,264 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,264 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,264 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,264 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,264 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,265 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,265 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,265 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,265 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,265 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,265 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,265 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,265 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,265 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,265 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,268 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,271 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,271 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,271 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,271 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,271 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,271 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,271 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,273 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,275 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,275 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,275 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,275 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,275 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,275 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,275 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,275 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,275 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,275 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,276 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,276 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,276 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,276 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,276 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,276 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,276 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,276 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,276 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,276 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,277 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,277 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,277 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,277 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,277 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,277 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,277 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,277 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,277 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,277 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,277 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,277 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,278 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,278 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,279 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,279 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,279 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,279 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,280 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,280 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,281 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,281 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   learning_rate: 0.019506751038527934
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   n_estimators: 72
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   subsample: 0.9016055807922
2025-06-24 09:39:08,281 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6786527742452434
2025-06-24 09:39:08,282 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:39:08,282 - src.models.lightgbm_model - INFO -   reg_alpha: 0.5179817334010663
2025-06-24 09:39:08,282 - src.models.lightgbm_model - INFO -   reg_lambda: 2.585526747106335e-05
2025-06-24 09:39:08,282 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,282 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,282 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,284 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,284 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,284 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,284 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,284 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,284 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,284 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,284 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,284 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,285 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,285 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,285 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,291 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,291 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,291 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,291 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,291 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,291 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,291 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,291 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,291 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,292 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,292 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,292 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,292 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,292 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,292 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,293 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,293 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,293 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,293 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,293 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,293 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,293 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,293 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,293 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,293 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,293 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,293 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,293 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,293 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,293 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,293 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,293 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,293 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,293 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,293 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,293 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,295 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,296 - src.hyperparameter_tuning - ERROR - Trial 83 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,312 - src.hyperparameter_tuning - INFO - Trial 84: 모델 타입 = lightgbm
2025-06-24 09:39:08,316 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,316 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,316 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,316 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,316 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,316 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,316 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,316 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,317 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,317 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,317 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,317 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,317 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,317 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,317 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,317 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,317 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,317 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,318 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,318 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,318 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,318 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,318 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,318 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,318 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,318 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,318 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,318 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,322 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,324 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,324 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,324 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,324 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,324 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,324 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,324 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,326 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,328 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,328 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,328 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,328 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,328 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,328 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,328 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,328 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,328 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,328 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,329 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,329 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,329 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,329 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,329 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,329 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,329 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,330 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,330 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,330 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,330 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,330 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,330 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,330 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,330 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,330 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,331 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,331 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,331 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,331 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,331 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,331 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,331 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,332 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,332 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,332 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,332 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,332 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,332 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,332 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,332 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,332 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,333 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,333 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,334 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,334 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO -   learning_rate: 0.011761518315917473
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,334 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   n_estimators: 336
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   subsample: 0.8814774332424677
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6589836190226069
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   reg_alpha: 0.03740462540171629
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO -   reg_lambda: 9.421800508700533e-07
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,335 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,337 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,337 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,337 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,337 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,337 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,338 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,339 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,339 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,339 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,339 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,341 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,341 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,341 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,341 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,341 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,341 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,341 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,341 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,341 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,341 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,341 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,341 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,342 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,342 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,342 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,342 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,342 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,342 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,342 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,342 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,342 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,342 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,343 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,343 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,343 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,343 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,343 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,343 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,343 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,343 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,343 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,343 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,343 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,343 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,343 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,343 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,345 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,345 - src.hyperparameter_tuning - ERROR - Trial 84 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,362 - src.hyperparameter_tuning - INFO - Trial 85: 모델 타입 = lightgbm
2025-06-24 09:39:08,365 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,366 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,366 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,366 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,366 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,366 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,366 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,366 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,366 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,367 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,367 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,367 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,367 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,367 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,367 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,367 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,367 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,367 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,368 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,368 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,368 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,368 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,368 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,368 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,368 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,368 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,368 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,368 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,371 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,373 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,373 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,373 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,374 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,374 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,374 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,374 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,376 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,378 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,378 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,378 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,378 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,378 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,378 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,378 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,378 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,378 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,378 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,378 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,378 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,378 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,378 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,378 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,378 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,378 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,379 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,379 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,379 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,380 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,380 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,380 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,380 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,380 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,380 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,380 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,380 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,380 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,380 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,380 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,380 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,380 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,380 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,380 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,381 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,381 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,381 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,381 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,381 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,381 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,381 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,381 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,382 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,382 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,382 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,382 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,383 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,383 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,383 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,383 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,383 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,383 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,383 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,383 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   learning_rate: 0.023369091605691176
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   n_estimators: 416
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   subsample: 0.9285006889587568
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6911826263958073
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   reg_alpha: 0.005586000009250545
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO -   reg_lambda: 1.0365316887043513e-07
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,384 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,386 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,386 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,386 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,386 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,386 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,386 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,386 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,387 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,387 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,387 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,387 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,387 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,387 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,387 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,388 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,388 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,388 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,388 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,388 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,388 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,388 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,388 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,388 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,388 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,388 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,388 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,388 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,389 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,389 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,389 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,389 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,389 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,389 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,390 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,390 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,390 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,390 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,390 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,390 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,390 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,390 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,390 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,390 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,390 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,390 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,390 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,390 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,390 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,390 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,390 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,390 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,390 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,390 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,392 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,392 - src.hyperparameter_tuning - ERROR - Trial 85 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,410 - src.hyperparameter_tuning - INFO - Trial 86: 모델 타입 = lightgbm
2025-06-24 09:39:08,413 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,414 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,414 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,414 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,414 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,414 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,414 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,414 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,414 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,414 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,415 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,415 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,415 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,415 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,415 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,415 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,415 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,415 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,416 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,416 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,416 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,416 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,416 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,416 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,416 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,416 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,416 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,416 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,419 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,421 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,421 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,421 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,421 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,421 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,421 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,421 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,424 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,426 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,426 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,426 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,426 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,426 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,426 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,426 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,426 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,426 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,426 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,426 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,426 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,426 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,427 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,427 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,427 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,428 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,428 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,428 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,428 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,428 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,428 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,428 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,428 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,428 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,428 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,428 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,428 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,428 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,428 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,428 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,429 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,430 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,430 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,430 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,430 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,431 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,431 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,431 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,431 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,431 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,431 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,431 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   learning_rate: 0.0167210164277769
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   n_estimators: 126
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   subsample: 0.8121859411209759
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.600980416597681
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   reg_alpha: 0.015484276919204112
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO -   reg_lambda: 3.60403122472424e-07
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,432 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,435 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,435 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,435 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,435 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,435 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,435 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,436 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,436 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,436 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,442 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,442 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,442 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,442 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,442 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,442 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,442 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,442 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,442 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,442 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,443 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,443 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,443 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,443 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,443 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,444 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,444 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,444 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,444 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,444 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,444 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,444 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,444 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,444 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,444 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,444 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,444 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,444 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,444 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,444 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,444 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,444 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,444 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,444 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,444 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,444 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,447 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,447 - src.hyperparameter_tuning - ERROR - Trial 86 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,464 - src.hyperparameter_tuning - INFO - Trial 87: 모델 타입 = lightgbm
2025-06-24 09:39:08,467 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,468 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,468 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,468 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,468 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,468 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,468 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,468 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,468 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,469 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,469 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,469 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,469 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,469 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,469 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,469 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,469 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,469 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,470 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,470 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,470 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,470 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,470 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,470 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,470 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,470 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,470 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,470 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,473 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,475 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,475 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,475 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,475 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,476 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,476 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,476 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,478 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,480 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,480 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,480 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,480 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,480 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,480 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,480 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,480 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,480 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,480 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,480 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,480 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,480 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,480 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,481 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,481 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,481 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,481 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,481 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,481 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,482 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,482 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,482 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,482 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,482 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,482 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,482 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,482 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,482 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,482 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,482 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,482 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,483 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,483 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,484 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,484 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,484 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,484 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,484 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,484 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,484 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,484 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,484 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,485 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,485 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,486 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,486 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   learning_rate: 0.08737941929340731
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,486 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,487 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,487 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,487 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,487 - src.models.lightgbm_model - INFO -   n_estimators: 485
2025-06-24 09:39:08,487 - src.models.lightgbm_model - INFO -   subsample: 0.7725397087037676
2025-06-24 09:39:08,487 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9032259116266748
2025-06-24 09:39:08,487 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:08,487 - src.models.lightgbm_model - INFO -   reg_alpha: 3.4172998319315425e-06
2025-06-24 09:39:08,487 - src.models.lightgbm_model - INFO -   reg_lambda: 8.925646395185016e-06
2025-06-24 09:39:08,487 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,487 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,487 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,489 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,489 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,489 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,489 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,489 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,489 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,489 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,489 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,489 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,490 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,490 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,490 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,490 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,490 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,491 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,491 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,491 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,496 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,496 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,496 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,496 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,496 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,496 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,496 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,496 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,496 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,497 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,497 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,497 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,497 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,497 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,497 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,498 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,498 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,498 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,498 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,498 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,498 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,498 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,498 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,498 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,498 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,498 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,498 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,498 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,498 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,498 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,498 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,498 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,498 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,498 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,498 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,498 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,500 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,500 - src.hyperparameter_tuning - ERROR - Trial 87 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,518 - src.hyperparameter_tuning - INFO - Trial 88: 모델 타입 = lightgbm
2025-06-24 09:39:08,521 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,522 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,522 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,522 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,522 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,522 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,522 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,522 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,522 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,522 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,522 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,522 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,522 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,522 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,523 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,523 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,523 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,523 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,524 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,524 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,524 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,524 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,524 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,524 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,524 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,524 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,524 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,524 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,527 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,529 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,529 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,529 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,529 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,529 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,529 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,529 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,531 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,533 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,534 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,534 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,534 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,534 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,534 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,534 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,534 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,534 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,534 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,534 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,534 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,534 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,534 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,534 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,534 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,534 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,535 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,535 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,535 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,536 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,536 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,536 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,536 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,536 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,536 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,536 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,536 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,536 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,536 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,536 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,536 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,536 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,536 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,536 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,537 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,538 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,538 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,538 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,538 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,539 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,539 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,539 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,539 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,539 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,539 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,539 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,539 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,539 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,539 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,539 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   learning_rate: 0.20084862043853582
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   n_estimators: 436
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   subsample: 0.6836681494518045
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7513030717936812
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0001317813499998491
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO -   reg_lambda: 2.3433791053557896e-06
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,540 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,541 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,543 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,543 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,543 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,543 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,543 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,543 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,543 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,543 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,543 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,544 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,544 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,544 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,544 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,544 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,544 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,544 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,544 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,550 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,550 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,550 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,550 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,550 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,550 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,550 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,550 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,550 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,550 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,551 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,551 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,551 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,551 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,551 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,552 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,552 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,552 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,552 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,552 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,552 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,552 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,552 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,552 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,552 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,552 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,552 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,552 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,552 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,552 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,552 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,552 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,552 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,552 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,552 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,552 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,554 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,554 - src.hyperparameter_tuning - ERROR - Trial 88 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,572 - src.hyperparameter_tuning - INFO - Trial 89: 모델 타입 = lightgbm
2025-06-24 09:39:08,575 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,576 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,576 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,576 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,576 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,576 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,576 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,576 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,576 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,577 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,577 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,577 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,577 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,577 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,577 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,577 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,577 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,577 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,578 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,578 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,578 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,578 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,578 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,578 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,578 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,578 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,578 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,578 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,581 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,583 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,583 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,583 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,583 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,583 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,583 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,583 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,585 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,587 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,587 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,587 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,587 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,587 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,587 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,588 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,588 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,588 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,588 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,588 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,588 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,588 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,588 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,588 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,588 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,588 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,589 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,589 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,589 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,590 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,590 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,590 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,590 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,590 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,590 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,590 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,590 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,590 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,590 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,590 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,590 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,590 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,590 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,590 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,590 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,590 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,590 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,591 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,591 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,591 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,591 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,591 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,591 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,591 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,591 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,591 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,592 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,592 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,592 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,592 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,592 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,592 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,592 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,592 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,593 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,593 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,593 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   learning_rate: 0.010712348865860803
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,593 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO -   n_estimators: 569
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO -   subsample: 0.9715163381303065
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8835099955381397
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO -   reg_alpha: 3.181288168420014e-08
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO -   reg_lambda: 0.003706339122281663
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,594 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,596 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,596 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,596 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,596 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,596 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,596 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,596 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,596 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,596 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,597 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,597 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,597 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,597 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,597 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,597 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,597 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,597 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,598 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,598 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,598 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,598 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,598 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,598 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,598 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,598 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,598 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,598 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,598 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,598 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,598 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,599 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,599 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,599 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,599 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,599 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,599 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,599 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,599 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,599 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,599 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,599 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,599 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,599 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,599 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,599 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,599 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,599 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,599 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,599 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,599 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,599 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,599 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,602 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,602 - src.hyperparameter_tuning - ERROR - Trial 89 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,619 - src.hyperparameter_tuning - INFO - Trial 90: 모델 타입 = lightgbm
2025-06-24 09:39:08,622 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,623 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,623 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,623 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,623 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,623 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,623 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,623 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,623 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,624 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,624 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,624 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,624 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,624 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,624 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,624 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,624 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,624 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,625 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,625 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,625 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,625 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,625 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,625 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,625 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,625 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,625 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,625 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,628 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,630 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,630 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,630 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,630 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,630 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,630 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,630 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,633 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,635 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,635 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,635 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,635 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,635 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,635 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,635 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,635 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,635 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,635 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,635 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,635 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,635 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,635 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,635 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,635 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,635 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,636 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,636 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,636 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,637 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,637 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,637 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,637 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,637 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,637 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,637 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,637 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,637 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,637 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,637 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,637 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,637 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,637 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,637 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,638 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,638 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,638 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,638 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,638 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,638 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,639 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,639 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,639 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,639 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,639 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,639 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,639 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,639 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,639 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,640 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,640 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,640 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,640 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,640 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,640 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,640 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,640 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,640 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,640 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,640 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   learning_rate: 0.17292774562587593
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   n_estimators: 249
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   subsample: 0.9100639628414496
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7319861545848053
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   reg_alpha: 6.841319298994953e-08
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO -   reg_lambda: 7.294516932532824e-08
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,641 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,644 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,644 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,644 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,644 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,644 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,644 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,645 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,645 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,648 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,648 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,648 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,648 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,648 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,648 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,648 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,648 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,648 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,648 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,648 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,648 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,649 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,649 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,649 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,649 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,650 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,650 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,650 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,650 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,650 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,650 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,650 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,650 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,650 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,650 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,650 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,650 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,650 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,650 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,650 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,650 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,650 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,650 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,650 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,650 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,652 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,652 - src.hyperparameter_tuning - ERROR - Trial 90 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,670 - src.hyperparameter_tuning - INFO - Trial 91: 모델 타입 = lightgbm
2025-06-24 09:39:08,673 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,674 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,674 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,674 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,674 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,674 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,674 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,674 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,674 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,674 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,674 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,674 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,674 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,674 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,674 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,674 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,674 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,674 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,675 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,675 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,675 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,675 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,675 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,676 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,676 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,676 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,676 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,676 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,679 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,681 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,681 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,681 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,681 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,681 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,681 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,681 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,683 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,685 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,685 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,685 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,685 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,685 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,685 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,685 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,685 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,686 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,686 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,686 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,686 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,686 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,686 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,686 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,686 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,686 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,687 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,687 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,687 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,688 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,688 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,688 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,688 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,688 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,688 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,688 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,688 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,688 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,688 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,688 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,688 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,688 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,688 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,688 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,688 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,688 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,689 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,689 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,689 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,689 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,689 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,689 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,689 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,689 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,689 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,690 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,690 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,690 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,691 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,691 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,691 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,691 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,691 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,691 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,691 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,691 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,691 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,691 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   learning_rate: 0.11013898979209548
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   n_estimators: 86
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   subsample: 0.9578849478844019
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9636601537167676
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   reg_alpha: 1.4565994044938084e-05
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO -   reg_lambda: 4.107640210812544e-06
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,692 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,694 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,694 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,694 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,694 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,694 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,694 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,694 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,694 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,695 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,695 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,695 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,696 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,696 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,696 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,696 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,696 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,696 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,696 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,696 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,696 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,696 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,696 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,696 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,696 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,697 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,697 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,697 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,697 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,697 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,697 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,697 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,697 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,698 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,698 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,698 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,698 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,698 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,698 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,698 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,698 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,698 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,698 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,698 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,698 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,698 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,698 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,698 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,698 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,700 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,700 - src.hyperparameter_tuning - ERROR - Trial 91 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,718 - src.hyperparameter_tuning - INFO - Trial 92: 모델 타입 = lightgbm
2025-06-24 09:39:08,721 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,721 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,722 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,722 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,722 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,722 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,722 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,722 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,722 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,722 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,722 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,722 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,722 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,722 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,722 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,722 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,722 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,722 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,723 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,723 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,723 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,723 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,723 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,723 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,723 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,723 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,723 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,724 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,727 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,729 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,729 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,729 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,729 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,729 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,729 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,729 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,731 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,733 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,733 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,733 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,733 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,733 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,733 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,733 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,733 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,733 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,733 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,734 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,734 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,734 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,734 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,734 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,734 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,734 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,735 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,735 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,735 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,735 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,736 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,736 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,736 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,736 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,736 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,736 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,736 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,736 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,736 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,736 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,736 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,736 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,736 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,736 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,737 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,737 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,737 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,737 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,737 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,737 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,737 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,737 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,737 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,738 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,738 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,738 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,738 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,738 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,738 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,738 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,738 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,738 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   learning_rate: 0.06512620613719415
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,739 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,740 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,740 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,740 - src.models.lightgbm_model - INFO -   n_estimators: 62
2025-06-24 09:39:08,740 - src.models.lightgbm_model - INFO -   subsample: 0.9440049750817702
2025-06-24 09:39:08,740 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9069793609426638
2025-06-24 09:39:08,740 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:08,740 - src.models.lightgbm_model - INFO -   reg_alpha: 1.3433121325142226e-06
2025-06-24 09:39:08,740 - src.models.lightgbm_model - INFO -   reg_lambda: 2.1808112052856218e-08
2025-06-24 09:39:08,740 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,740 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,740 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,742 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,742 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,742 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,742 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,742 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,742 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,742 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,742 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,742 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,743 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,743 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,743 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,743 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,743 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,743 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,743 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,743 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,749 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,749 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,749 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,749 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,749 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,749 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,749 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,749 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,749 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,750 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,750 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,750 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,750 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,750 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,750 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,751 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,751 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,751 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,751 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,751 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,751 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,751 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,751 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,751 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,751 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,751 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,751 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,751 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,751 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,751 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,751 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,751 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,751 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,751 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,751 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,751 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,753 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,754 - src.hyperparameter_tuning - ERROR - Trial 92 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,771 - src.hyperparameter_tuning - INFO - Trial 93: 모델 타입 = lightgbm
2025-06-24 09:39:08,774 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,775 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,775 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,775 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,775 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,775 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,775 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,775 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,775 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,776 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,776 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,776 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,776 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,776 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,776 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,776 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,776 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,776 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,777 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,777 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,777 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,777 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,777 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,777 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,777 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,777 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,777 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,777 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,780 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,782 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,782 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,782 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,783 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,783 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,783 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,783 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,785 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,787 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,787 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,787 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,787 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,787 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,787 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,787 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,787 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,787 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,787 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,787 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,787 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,787 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,787 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,787 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,788 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,788 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,788 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,788 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,788 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,789 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,789 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,789 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,789 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,789 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,789 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,789 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,789 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,789 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,789 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,789 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,789 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,789 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,789 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,790 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,790 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,790 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,790 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,791 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,791 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,791 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,791 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,791 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,791 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,791 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,791 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,791 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,792 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,792 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,792 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,792 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,792 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,792 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,792 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,792 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,793 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,793 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,793 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   learning_rate: 0.144034078327933
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,793 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   n_estimators: 161
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   subsample: 0.891280205171518
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9241422630860318
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   reg_alpha: 7.365332985642187e-05
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO -   reg_lambda: 5.580919445808581e-05
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,794 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,796 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,796 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,796 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,796 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,796 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,796 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,796 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,796 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,797 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,797 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,797 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,798 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,800 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,800 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,800 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,800 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,800 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,800 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,800 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,800 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,800 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,800 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,800 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,800 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,801 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,801 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,801 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,801 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,801 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,801 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,801 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,801 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,801 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,801 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,801 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,802 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,802 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,802 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,802 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,802 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,802 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,802 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,802 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,802 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,802 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,802 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,802 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,802 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,804 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,804 - src.hyperparameter_tuning - ERROR - Trial 93 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,822 - src.hyperparameter_tuning - INFO - Trial 94: 모델 타입 = lightgbm
2025-06-24 09:39:08,825 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,826 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,826 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,826 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,826 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,826 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,826 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,826 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,826 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,826 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,826 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,826 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,826 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,826 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,826 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,826 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,826 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,826 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,827 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,827 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,827 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,827 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,827 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,828 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,828 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,828 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,828 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,828 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,831 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,833 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,833 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,833 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,833 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,833 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,833 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,833 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,835 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,837 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,837 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,837 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,837 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,837 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,837 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,837 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,837 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,837 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,837 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,838 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,838 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,838 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,838 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,838 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,838 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,838 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,839 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,839 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,839 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,840 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,840 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,840 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,840 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,840 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,840 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,840 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,840 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,840 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,840 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,840 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,840 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,840 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,840 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,841 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,841 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,841 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,841 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,841 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,841 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,841 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,841 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,841 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,841 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,842 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,842 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,842 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,842 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,842 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,842 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,842 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,843 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,843 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,843 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,843 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,843 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,843 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,843 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,843 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,843 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,843 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,843 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,843 - src.models.lightgbm_model - INFO -   learning_rate: 0.03226966411568605
2025-06-24 09:39:08,843 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,843 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,843 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,843 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   n_estimators: 111
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   subsample: 0.8275247108212429
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6198230292372529
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00034040068930289746
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO -   reg_lambda: 4.96586351698221e-07
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,844 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,846 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,846 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,846 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,846 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,846 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,846 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,847 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,847 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,847 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,847 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,847 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,847 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,847 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,853 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,853 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,853 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,853 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,853 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,853 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,853 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,853 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,853 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,853 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,854 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,854 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,854 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,854 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,854 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,855 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,855 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,855 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,855 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,855 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,855 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,855 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,855 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,855 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,855 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,855 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,855 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,855 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,855 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,855 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,855 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,855 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,855 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,855 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,855 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,855 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,857 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,858 - src.hyperparameter_tuning - ERROR - Trial 94 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,875 - src.hyperparameter_tuning - INFO - Trial 95: 모델 타입 = lightgbm
2025-06-24 09:39:08,879 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,880 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,880 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,880 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,880 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,880 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,880 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,880 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,880 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,880 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,880 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,880 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,880 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,880 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,880 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,880 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,880 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,880 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,881 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,881 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,881 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,881 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,881 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,882 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,882 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,882 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,882 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,882 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,885 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,887 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,887 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,887 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,887 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,887 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,887 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,887 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,889 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,891 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,891 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,891 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,891 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,891 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,891 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,891 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,891 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,892 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,892 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,892 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,892 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,892 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,892 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,892 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,892 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,892 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,893 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,893 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,893 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,894 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,894 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,894 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,894 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,894 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,894 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,894 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,894 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,894 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,894 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,894 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,894 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,894 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,894 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,894 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,894 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,895 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,895 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,896 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,896 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,897 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,897 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,897 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,897 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,897 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,897 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,897 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,897 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,897 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,897 - src.models.lightgbm_model - INFO -   learning_rate: 0.23289446247753645
2025-06-24 09:39:08,897 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,897 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,897 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,897 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   n_estimators: 199
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   subsample: 0.9182339907634957
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8414284434329359
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   reg_alpha: 0.30891866315595923
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO -   reg_lambda: 7.06945184557314
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,898 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,908 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,908 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,908 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,908 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,908 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,909 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,910 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,910 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,910 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,915 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,915 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,915 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,915 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,915 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,915 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,915 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,915 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,915 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,916 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,916 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,916 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,916 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,916 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,916 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,917 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,917 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,917 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,917 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,917 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,917 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,917 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,917 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,917 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,917 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,917 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,917 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,917 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,917 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,917 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,917 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,917 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,917 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,917 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,917 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,917 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,919 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,919 - src.hyperparameter_tuning - ERROR - Trial 95 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,937 - src.hyperparameter_tuning - INFO - Trial 96: 모델 타입 = lightgbm
2025-06-24 09:39:08,940 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,941 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,941 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,941 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,941 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,941 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,941 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,941 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,941 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,942 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,942 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,942 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,942 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,942 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,942 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,942 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,942 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,942 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,943 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,943 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,943 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,943 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,943 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,943 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,943 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,943 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,943 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,943 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,946 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,949 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,949 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,949 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,949 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,949 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,949 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,949 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,951 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,953 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:08,953 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,953 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,953 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:08,953 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:08,953 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,953 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:08,953 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:08,953 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,953 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,954 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:08,954 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:08,954 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,954 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,954 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:08,954 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:08,954 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,954 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,954 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:08,954 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:08,955 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:08,955 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:08,955 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:08,955 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:08,955 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:08,955 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:08,955 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:08,955 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:08,955 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,955 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:08,955 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:08,955 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:08,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:08,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,956 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,956 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,957 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,957 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,957 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:08,957 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:08,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,958 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,958 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,958 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,958 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,958 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,958 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,958 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,958 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,959 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:08,959 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   learning_rate: 0.0128858323826597
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:08,959 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:39:08,960 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:08,960 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:08,960 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:08,960 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:08,960 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:08,960 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:08,960 - src.models.lightgbm_model - INFO -   n_estimators: 392
2025-06-24 09:39:08,960 - src.models.lightgbm_model - INFO -   subsample: 0.9883471561917563
2025-06-24 09:39:08,960 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9800264200829185
2025-06-24 09:39:08,960 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:39:08,960 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0008163736186869123
2025-06-24 09:39:08,960 - src.models.lightgbm_model - INFO -   reg_lambda: 7.146987388366111e-08
2025-06-24 09:39:08,960 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:08,960 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:08,960 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:08,962 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:08,962 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:08,962 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:08,962 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:08,962 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:08,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:08,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:08,963 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:08,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:08,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:08,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:08,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:08,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:08,963 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:08,963 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:08,964 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:08,964 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:08,964 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:08,964 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:08,964 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,964 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,964 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:08,964 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:08,964 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:08,965 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:08,965 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:08,965 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:08,965 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,965 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,965 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,966 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:08,966 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:08,966 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:08,966 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:08,966 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:08,966 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:08,966 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:08,966 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:08,966 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:08,966 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:08,966 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:08,966 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:08,966 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:08,966 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:08,966 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:08,966 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:08,966 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:08,966 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,966 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,966 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:08,966 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:08,968 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:08,968 - src.hyperparameter_tuning - ERROR - Trial 96 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:08,987 - src.hyperparameter_tuning - INFO - Trial 97: 모델 타입 = lightgbm
2025-06-24 09:39:08,990 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:08,990 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:08,990 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:08,990 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:08,990 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:08,990 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:08,990 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:08,990 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:08,991 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:08,991 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:08,991 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:08,991 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:08,991 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:08,991 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:08,991 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:08,991 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:08,991 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:08,991 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:08,992 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,992 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,992 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:08,992 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:08,992 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:08,992 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:08,992 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:08,992 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:08,992 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:08,992 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:08,996 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:08,998 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:08,998 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:08,998 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:08,998 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:08,998 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:08,998 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:08,998 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:09,000 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:09,002 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:09,002 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:09,002 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:09,002 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:09,002 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:09,002 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:09,002 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:09,002 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:09,002 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,002 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,003 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:09,003 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:09,003 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,003 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,003 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:09,003 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:09,003 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,003 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:09,004 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:09,004 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:09,004 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:09,004 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:09,004 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:09,004 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:09,004 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:09,004 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:09,005 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:09,005 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:09,005 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:09,005 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:09,005 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:09,005 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:09,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:09,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:09,005 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:09,005 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:09,005 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:09,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:09,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:09,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:09,006 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:09,006 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,006 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:09,006 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,006 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:09,006 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,007 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:09,007 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:09,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:09,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:09,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:09,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:09,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:09,007 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:09,008 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,008 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:09,008 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO -   learning_rate: 0.04708035431951437
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:09,008 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   n_estimators: 545
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   subsample: 0.8481306135407106
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8777043418153438
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   reg_alpha: 5.301017506056371e-06
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO -   reg_lambda: 1.4157321646404635e-07
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:09,009 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:09,011 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:09,011 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:09,011 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:09,011 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:09,011 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:09,011 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:09,011 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,011 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:09,012 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:09,012 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:09,012 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:09,012 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:09,012 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:09,012 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:09,012 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:09,012 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,013 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:09,014 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:09,014 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:09,014 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:09,014 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:09,014 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,014 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,014 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:09,014 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:09,015 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:09,015 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:09,015 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:09,015 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:09,015 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:09,015 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:09,015 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:09,016 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:09,016 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:09,016 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:09,016 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:09,016 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:09,016 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:09,016 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:09,016 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:09,016 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:09,016 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:09,016 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:09,016 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:09,016 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:09,016 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:09,016 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:09,016 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:09,016 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:09,016 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,016 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,016 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,016 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,019 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:09,019 - src.hyperparameter_tuning - ERROR - Trial 97 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:09,037 - src.hyperparameter_tuning - INFO - Trial 98: 모델 타입 = lightgbm
2025-06-24 09:39:09,040 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:09,041 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:09,041 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:09,041 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:09,041 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:09,041 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:09,041 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:09,041 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:09,041 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:09,041 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:09,041 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:09,041 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:09,041 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:09,042 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:09,042 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:09,042 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:09,042 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:09,042 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:09,042 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:09,043 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:09,043 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:09,043 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:09,043 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:09,043 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:09,043 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:09,043 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:09,043 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:09,043 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:09,046 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:09,048 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:09,048 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:09,048 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:09,048 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:09,048 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:09,048 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:09,048 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:09,050 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:09,052 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:09,052 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:09,052 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:09,052 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:09,052 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:09,052 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:09,052 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:09,052 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:09,052 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,052 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,053 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:09,053 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:09,053 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,053 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,053 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:09,053 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:09,053 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,054 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:09,054 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:09,054 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:09,054 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:09,055 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:09,055 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:09,055 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:09,055 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:09,055 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:09,055 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:09,055 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:09,055 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:09,055 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:09,055 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:09,055 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:09,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:09,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:09,055 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:09,055 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:09,055 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:09,056 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:09,056 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:09,056 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:09,056 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:09,056 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:09,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:09,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:09,057 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:09,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:09,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:09,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:09,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:09,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:09,057 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:09,057 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,058 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:09,058 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   learning_rate: 0.014754168878137339
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:09,058 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:09,059 - src.models.lightgbm_model - INFO -   n_estimators: 354
2025-06-24 09:39:09,059 - src.models.lightgbm_model - INFO -   subsample: 0.7178025885121065
2025-06-24 09:39:09,059 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8037627937927796
2025-06-24 09:39:09,059 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:39:09,059 - src.models.lightgbm_model - INFO -   reg_alpha: 2.5408310634329025e-06
2025-06-24 09:39:09,059 - src.models.lightgbm_model - INFO -   reg_lambda: 1.658568588495107e-05
2025-06-24 09:39:09,059 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:09,059 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:09,059 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:09,061 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:09,061 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:09,061 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:09,061 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:09,061 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:09,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:09,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:09,061 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:09,062 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:09,062 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:09,062 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:09,062 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:09,062 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:09,062 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:09,062 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,062 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:09,063 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:09,063 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:09,063 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:09,063 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:09,063 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,063 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,063 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:09,063 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:09,063 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:09,063 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:09,063 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:09,063 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:09,063 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:09,064 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:09,064 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:09,064 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:09,064 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:09,064 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:09,064 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:09,064 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:09,064 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:09,064 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:09,064 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:09,064 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:09,064 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:09,064 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:09,065 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:09,065 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:09,065 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:09,065 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:09,065 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:09,065 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:09,065 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,065 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,065 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,065 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,067 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:09,067 - src.hyperparameter_tuning - ERROR - Trial 98 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:09,085 - src.hyperparameter_tuning - INFO - Trial 99: 모델 타입 = lightgbm
2025-06-24 09:39:09,088 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:39:09,089 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:39:09,089 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:39:09,089 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:39:09,089 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:39:09,089 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:39:09,089 - src.training - INFO - 교차 검증 시작
2025-06-24 09:39:09,089 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:39:09,089 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:39:09,090 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:39:09,090 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:39:09,090 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:39:09,090 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:39:09,090 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:39:09,090 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:39:09,090 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:39:09,090 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:39:09,090 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:39:09,091 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:09,091 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:09,091 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:39:09,091 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:39:09,091 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:09,091 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:39:09,091 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:39:09,091 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:39:09,091 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:39:09,091 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:39:09,094 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:39:09,096 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:09,096 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:39:09,096 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:39:09,096 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:39:09,096 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:39:09,096 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:39:09,096 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:39:09,099 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:39:09,100 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:39:09,101 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:09,101 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:09,101 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:39:09,101 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:39:09,101 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:09,101 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:39:09,101 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:39:09,101 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,101 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,101 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:39:09,101 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:39:09,101 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,101 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,101 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:39:09,101 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:39:09,101 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,102 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:09,102 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:39:09,102 - src.training - INFO - 모델 학습 시작
2025-06-24 09:39:09,103 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:39:09,103 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:39:09,103 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:39:09,103 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:39:09,103 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:39:09,103 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:39:09,103 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:39:09,103 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:39:09,103 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:09,103 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:39:09,103 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:39:09,103 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:39:09,103 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:39:09,103 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,103 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:09,103 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:09,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:09,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:09,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:09,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:09,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:09,104 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:39:09,104 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,105 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:39:09,105 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,105 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:09,105 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,105 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:09,105 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:09,105 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:09,105 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:09,105 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:09,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:09,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:09,106 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:09,106 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,106 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:39:09,106 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,106 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:39:09,106 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,106 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:39:09,106 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   learning_rate: 0.03847826310814636
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   n_estimators: 139
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   subsample: 0.9029634435810079
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8644492537002094
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   reg_alpha: 1.8669869859858968e-05
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO -   reg_lambda: 1.3473548198935023e-08
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:39:09,107 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:39:09,109 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:39:09,109 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:39:09,109 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:39:09,109 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:39:09,109 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:39:09,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:39:09,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:39:09,110 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:39:09,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:39:09,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:39:09,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:39:09,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:39:09,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:39:09,111 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:39:09,111 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:39:09,111 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:39:09,111 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:39:09,111 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:39:09,111 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:39:09,111 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,111 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,111 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:39:09,111 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:39:09,111 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:39:09,111 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:39:09,111 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:39:09,111 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:39:09,112 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:09,112 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:09,112 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:09,112 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:39:09,113 - src.training - INFO -   precision: 0.0
2025-06-24 09:39:09,113 - src.training - INFO -   recall: 0.0
2025-06-24 09:39:09,113 - src.training - INFO -   f1: 0.0
2025-06-24 09:39:09,113 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:39:09,113 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:39:09,113 - src.training - INFO -   positive_samples: 0
2025-06-24 09:39:09,113 - src.training - INFO -   negative_samples: 250
2025-06-24 09:39:09,113 - src.training - INFO -   total_samples: 250
2025-06-24 09:39:09,113 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:39:09,113 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:39:09,113 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:39:09,113 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:39:09,113 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:39:09,113 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:39:09,113 - src.training - INFO - 모델 학습 완료
2025-06-24 09:39:09,113 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:39:09,113 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,113 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,113 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:39:09,113 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:39:09,115 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:39:09,115 - src.hyperparameter_tuning - ERROR - Trial 99 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:39:09,116 - src.hyperparameter_tuning - INFO - 튜닝 완료 - 최고 성능: -inf
2025-06-24 09:39:09,116 - src.hyperparameter_tuning - INFO - 튜닝 시간: 4.91초
2025-06-24 09:39:09,120 - __main__ - INFO - 튜닝 결과 저장 중...
2025-06-24 09:39:09,120 - __main__ - ERROR - 결과 저장 실패: 'NoneType' object has no attribute 'copy'
2025-06-24 09:39:09,120 - __main__ - INFO - 최고 성능: -inf
2025-06-24 09:39:09,120 - __main__ - INFO - 최적 파라미터:
2025-06-24 09:39:09,120 - __main__ - INFO -   n_estimators: 406
2025-06-24 09:39:09,120 - __main__ - INFO -   max_depth: 12
2025-06-24 09:39:09,120 - __main__ - INFO -   learning_rate: 0.1205712628744377
2025-06-24 09:39:09,120 - __main__ - INFO -   subsample: 0.8394633936788146
2025-06-24 09:39:09,120 - __main__ - INFO -   colsample_bytree: 0.6624074561769746
2025-06-24 09:39:09,120 - __main__ - INFO -   min_child_weight: 2
2025-06-24 09:39:09,120 - __main__ - INFO -   reg_alpha: 3.3323645788192616e-08
2025-06-24 09:39:09,121 - __main__ - INFO -   reg_lambda: 0.6245760287469893

==================================================
튜닝 결과 요약
==================================================
모델 타입: lightgbm
실험 타입: hyperparameter_tuning
사용 데이터 행 수: 1,000
MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/f7ac736428fb41a38c1865a27e63e329
최고 성능: -inf
최적 파라미터: {'n_estimators': 406, 'max_depth': 12, 'learning_rate': 0.1205712628744377, 'subsample': 0.8394633936788146, 'colsample_bytree': 0.6624074561769746, 'min_child_weight': 2, 'reg_alpha': 3.3323645788192616e-08, 'reg_lambda': 0.6245760287469893}
튜닝 시간: 4.911026477813721
==================================================
2025-06-24 09:39:09,121 - __main__ - INFO - 실험 결과가 /home/junhyung/Documents/simcare/kbsmc_suicide/results/experiment_results_20250624_093909.txt에 저장되었습니다.
2025-06-24 09:39:09,122 - __main__ - INFO - MLflow Experiment ID: 765186397364671153
2025-06-24 09:39:09,122 - __main__ - INFO - MLflow Run ID: f7ac736428fb41a38c1865a27e63e329
2025-06-24 09:39:09,122 - __main__ - INFO - MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/f7ac736428fb41a38c1865a27e63e329
