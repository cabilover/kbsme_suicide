2025-06-24 09:31:56,616 - src.hyperparameter_tuning - INFO - MLflow 실험 설정: hyperparameter_tuning (ID: 765186397364671153)
2025-06-24 09:31:56,616 - src.hyperparameter_tuning - INFO - 데이터 로드 중: data/processed/processed_data_with_features.csv
2025-06-24 09:31:56,621 - src.hyperparameter_tuning - INFO - 테스트용 데이터 로드: 1,000 행
2025-06-24 09:31:56,621 - src.hyperparameter_tuning - INFO - 모델 타입: catboost
2025-06-24 09:31:56,621 - src.hyperparameter_tuning - INFO - 튜닝 설정 - 시도 횟수: 100, 타임아웃: 3600초
2025-06-24 09:31:56,621 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 튜너 초기화 완료
2025-06-24 09:31:56,621 - src.hyperparameter_tuning - INFO -   - 튜닝 설정: {'data': {'file_path': 'data/processed_data.csv', 'encoding': 'utf-8', 'na_values': ['', 'nan', 'NaN', 'NULL', 'null']}, 'features': {'target_columns': ['suicide_a_next_year'], 'exclude_columns': ['id', 'patient_id', 'visit_date', 'visit_year'], 'categorical_columns': ['gender', 'marital_status', 'education_level', 'income_level', 'residence_type', 'insurance_type', 'primary_diagnosis', 'comorbidity', 'medication_type', 'treatment_type', 'follow_up_status'], 'selected_features': ['age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score'], 'validation': {'scope': 'sample', 'sample_size': 10}, 'enable_feature_engineering': False, 'enable_lagged_features': False, 'lag_periods': [1, 2, 3], 'lagged_features': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}, 'enable_rolling_stats': False, 'rolling_stats': {'window_sizes': [2, 3], 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}}, 'preprocessing': {'time_series_imputation': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp'], 'fallback_strategy': 'mean'}, 'numerical_imputation': {'strategy': 'mean', 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']}, 'categorical_imputation': {'strategy': 'most_frequent', 'columns': ['sex']}, 'categorical_encoding': {'method': 'ordinal'}, 'missing_value_strategy': 'median', 'outlier_detection': {'method': 'iqr', 'threshold': 1.5}, 'scaling': {'method': 'robust', 'with_mean': True, 'with_std': True}, 'feature_selection': {'method': 'variance_threshold', 'threshold': 0.01}}, 'data_split': {'test_ids_ratio': 0.15, 'random_state': 42, 'method': 'stratified_kfold', 'n_splits': 5, 'test_size': 0.2, 'val_size': 0.2}, 'validation': {'strategy': 'group_kfold', 'num_cv_folds': 3, 'test_size': 0.15, 'random_state': 42, 'val_ids_ratio': 0.15, 'validation_start_year': 2021, 'min_train_years': 3, 'max_train_years': 8}, 'time_series': {'date_column': 'dov', 'year_column': 'yov', 'id_column': 'id'}, 'evaluation': {'regression_metrics': ['mae', 'rmse', 'r2'], 'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2'], 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True, 'primary_metric': 'f1_score', 'secondary_metrics': ['recall', 'precision', 'balanced_accuracy', 'roc_auc'], 'cv': {'strategy': 'group_kfold', 'n_folds': 5, 'shuffle': False}}, 'training': {'early_stopping': True, 'patience': 10, 'handle_imbalance': True, 'save_best_model': True, 'model_save_path': 'models/'}, 'logging': {'log_splits_info': True, 'log_fold_details': True, 'level': 'INFO', 'format': '%(asctime)s - %(name)s - %(levelname)s - %(message)s', 'file': 'logs/experiment.log'}, 'output': {'directory': 'results', 'save_model': True, 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True}, 'mlflow': {'experiment_name': 'hyperparameter_tuning', 'experiment_description': '자살 위험 예측 모델 실험', 'tags': ['suicide_prediction', 'healthcare', 'classification', 'regression'], 'nested_runs': True, 'save_artifacts': True, 'log_params': True, 'log_metrics': True, 'log_model': True, 'tracking': {'tracking_uri': 'file:./mlruns', 'experiment_name': 'suicide_prediction', 'nested_runs': True, 'artifact_location': './mlruns'}, 'logging': {'param_logging_level': 'INFO', 'metric_logging_level': 'INFO', 'artifact_logging_level': 'INFO', 'log_experiment_info': True, 'log_fold_results': True, 'log_model_info': True}, 'log_optimization': True}, 'model': {'model_type': 'catboost', 'catboost': {'iterations': 100, 'depth': 6, 'learning_rate': 0.1, 'l2_leaf_reg': 3, 'cat_features': [], 'cat_l2': 10.0, 'cat_smooth': 10.0, 'max_cat_threshold': 32, 'one_hot_max_size': 10, 'random_strength': 1, 'bagging_temperature': 1, 'border_count': 254, 'feature_border_type': 'GreedyLogSum', 'early_stopping_rounds': 10, 'verbose': False, 'class_weights': [1, 1], 'auto_class_weights': 'Balanced', 'scale_pos_weight': 1.0, 'use_focal_loss': False, 'focal_loss': {'alpha': 0.25, 'gamma': 2.0}, 'boosting_type': 'Plain', 'bootstrap_type': 'Bernoulli', 'subsample': 0.8, 'rsm': 0.8, 'leaf_estimation_method': 'Newton', 'random_seed': 42, 'bootstrap_seed': 42, 'min_data_in_leaf': 1, 'max_leaves': 31, 'grow_policy': 'SymmetricTree', 'min_fold_size': 1, 'leaf_estimation_iterations': 1, 'fold_permutation_block': 1, 'leaf_estimation_backtracking': 'AnyImprovement', 'best_model_min_trees': 1, 'model_shrink_rate': 0, 'model_shrink_mode': 'Constant', 'langevin': False, 'diffusion_temperature': 10000, 'posterior_sampling': False, 'boost_from_average': True, 'allow_const_label': False, 'score_function': 'Cosine', 'monotone_constraints': '', 'penalties_coefficient': 1, 'first_feature_use_penalties': 0, 'model_size_reg': 0.5, 'per_float_feature_quantization': '', 'eval_fraction': 0, 'fixed_binary_splits': None, 'ignored_features': None, 'train_dir': None, 'name': 'experiment', 'prediction_type': 'Probability', 'fold_len_multiplier': 2, 'has_time': False, 'allow_writing_files': False, 'save_snapshot': False, 'snapshot_file': None, 'snapshot_interval': 600, 'gradient_iterations': 1, 'sampling_unit': 'Object', 'mvs_reg': 0.1, 'thread_count': 28}}, 'imbalanced_data': {'resampling': {'enabled': False, 'method': 'smote', 'smote': {'k_neighbors': 5, 'sampling_strategy': 'auto'}, 'borderline_smote': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'm_neighbors': 10}, 'adasyn': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'n_neighbors': 5}, 'under_sampling': {'strategy': 'random', 'sampling_strategy': 'auto'}}, 'class_weights': 'Balanced', 'auto_class_weights': 'Balanced', 'scale_pos_weight': 1.0}, 'experiment': {'name': 'hyperparameter_tuning_experiment', 'description': 'Optuna 기반 하이퍼파라미터 최적화 실험', 'tags': ['hyperparameter_tuning', 'optuna', 'optimization']}, 'tuning': {'direction': 'maximize', 'n_trials': 50, 'n_jobs': 1, 'early_stopping': {'enabled': True, 'patience': 20, 'min_trials': 30}}, 'sampler': {'type': 'tpe', 'tpe': {'n_startup_trials': 10, 'n_ei_candidates': 24, 'multivariate': True, 'group': False}, 'cmaes': {'x0': {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'min_child_weight': 1, 'reg_alpha': 0.1, 'reg_lambda': 1.0}, 'sigma0': 0.1}}, 'xgboost_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 15, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'scale_pos_weight': {'type': 'float', 'low': 0.5, 'high': 10.0, 'log': True}}, 'lightgbm_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 12, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}}, 'catboost_params': {'iterations': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'depth': {'type': 'int', 'low': 3, 'high': 10, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'l2_leaf_reg': {'type': 'float', 'low': 1, 'high': 10, 'log': True}, 'border_count': {'type': 'int', 'low': 32, 'high': 255, 'log': False}, 'bagging_temperature': {'type': 'float', 'low': 0.1, 'high': 1.0, 'log': False}, 'random_strength': {'type': 'float', 'low': 0.1, 'high': 10.0, 'log': True}}, 'random_forest_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 20, 'log': False}, 'min_samples_split': {'type': 'int', 'low': 2, 'high': 20, 'log': False}, 'min_samples_leaf': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'max_features': {'type': 'categorical', 'choices': ['sqrt', 'log2', 'auto']}}, 'results': {'save_best_model': True, 'model_save_path': 'models/best_tuned_model.joblib', 'save_study': True, 'study_save_path': 'models/optuna_study.pkl', 'create_plots': True, 'plots_save_path': 'data/tuning_results/'}}
2025-06-24 09:31:56,621 - src.hyperparameter_tuning - INFO -   - 튜닝 횟수: 100
2025-06-24 09:31:56,621 - src.hyperparameter_tuning - INFO -   - 타임아웃: 3600초
2025-06-24 09:31:56,621 - __main__ - INFO - 하이퍼파라미터 최적화 실행 중...
2025-06-24 09:31:56,621 - src.hyperparameter_tuning - INFO - === 하이퍼파라미터 튜닝 시작 ===
2025-06-24 09:31:56,622 - src.hyperparameter_tuning - INFO - Trial 0: 모델 타입 = catboost
2025-06-24 09:31:56,626 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:31:56,627 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:31:56,627 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:31:56,627 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:31:56,627 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:31:56,627 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:31:56,627 - src.training - INFO - 교차 검증 시작
2025-06-24 09:31:56,627 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:31:56,627 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:31:56,628 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:31:56,628 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:31:56,628 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:31:56,628 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:31:56,628 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:31:56,628 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:31:56,628 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:31:56,628 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:31:56,628 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:31:56,630 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:56,630 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:56,630 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:56,630 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:56,630 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:56,630 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:31:56,630 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:31:56,630 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:31:56,630 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:31:56,630 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:31:56,634 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:31:56,636 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:56,636 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:31:56,636 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:31:56,636 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:31:56,636 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:31:56,636 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:31:56,636 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:56,638 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:56,640 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:31:56,640 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:56,640 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:56,640 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:56,640 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:56,640 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:56,640 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:56,640 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:31:56,640 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:56,640 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,641 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:31:56,641 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:31:56,641 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,641 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,641 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:31:56,641 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:31:56,641 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,642 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:56,642 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:56,642 - src.training - INFO - 모델 학습 시작
2025-06-24 09:31:56,643 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:31:56,643 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:31:56,643 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:31:56,643 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:31:56,643 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:31:56,643 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:31:56,643 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:31:56,643 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:31:56,643 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:56,643 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:31:56,643 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:31:56,643 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:31:56,643 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:31:56,643 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:56,643 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:56,643 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:56,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:56,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:56,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:56,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:56,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:56,644 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:31:56,644 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:56,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:31:56,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:56,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:56,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:56,645 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:56,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:56,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:56,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:56,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:56,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:56,646 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:56,646 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:56,646 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:31:56,646 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,646 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:56,646 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,646 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:31:56,646 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:31:56,646 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:31:56,646 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   iterations: 218
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   learning_rate: 0.1205712628744377
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.968793330444372
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   random_strength: 0.13066739238053282
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   bagging_temperature: 0.2403950683025824
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   border_count: 66
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:56,647 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:31:56,648 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:56,648 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:31:56,871 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:31:56,871 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:31:56,871 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:31:56,871 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:31:56,871 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:31:56,871 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:31:56,871 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:56,871 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:56,871 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:56,872 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:56,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:56,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:56,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:56,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:56,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:56,873 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:56,873 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:56,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:31:56,873 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:31:56,873 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:31:56,873 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:31:56,873 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:31:56,874 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,874 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,874 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:31:56,874 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:31:56,874 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:31:56,874 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:31:56,874 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:31:56,874 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:31:56,875 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:56,875 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:56,875 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:56,875 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:56,876 - src.training - INFO -   precision: 0.0
2025-06-24 09:31:56,876 - src.training - INFO -   recall: 0.0
2025-06-24 09:31:56,876 - src.training - INFO -   f1: 0.0
2025-06-24 09:31:56,876 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:31:56,876 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:31:56,876 - src.training - INFO -   positive_samples: 0
2025-06-24 09:31:56,876 - src.training - INFO -   negative_samples: 250
2025-06-24 09:31:56,876 - src.training - INFO -   total_samples: 250
2025-06-24 09:31:56,876 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:31:56,876 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:31:56,876 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:31:56,876 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:31:56,876 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:31:56,876 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:31:56,876 - src.training - INFO - 모델 학습 완료
2025-06-24 09:31:56,876 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:31:56,876 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:56,876 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,876 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:56,876 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,878 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:31:56,878 - src.hyperparameter_tuning - ERROR - Trial 0 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:31:56,879 - src.hyperparameter_tuning - INFO - Trial 1: 모델 타입 = catboost
2025-06-24 09:31:56,884 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:31:56,884 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:31:56,884 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:31:56,884 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:31:56,884 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:31:56,884 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:31:56,884 - src.training - INFO - 교차 검증 시작
2025-06-24 09:31:56,884 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:31:56,884 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:31:56,885 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:31:56,885 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:31:56,885 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:31:56,885 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:31:56,885 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:31:56,885 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:31:56,885 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:31:56,885 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:31:56,885 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:31:56,886 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:56,886 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:56,886 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:56,886 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:56,886 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:56,886 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:31:56,886 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:31:56,886 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:31:56,886 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:31:56,886 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:31:56,891 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:31:56,893 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:56,893 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:31:56,893 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:31:56,893 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:31:56,893 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:31:56,893 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:31:56,893 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:56,895 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:56,897 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:31:56,897 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:56,897 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:56,897 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:56,897 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:56,897 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:56,897 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:56,897 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:31:56,897 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:56,897 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,898 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:31:56,898 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:31:56,898 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,898 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,898 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:31:56,898 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:31:56,898 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,898 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:56,898 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:56,898 - src.training - INFO - 모델 학습 시작
2025-06-24 09:31:56,899 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:31:56,899 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:31:56,899 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:31:56,899 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:31:56,899 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:31:56,899 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:31:56,899 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:31:56,899 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:31:56,899 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:56,899 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:31:56,899 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:31:56,899 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:31:56,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:31:56,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:56,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:56,900 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:56,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:56,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:56,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:56,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:56,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:56,901 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:31:56,901 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:56,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:31:56,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:56,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:56,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:56,902 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:56,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:56,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:56,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:56,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:56,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:56,902 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:56,902 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:56,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:31:56,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,902 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   iterations: 440
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   depth: 7
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   learning_rate: 0.11114989443094977
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.0485387725194617
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   random_strength: 0.26587543983272705
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   bagging_temperature: 0.8491983767203796
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   border_count: 249
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:31:56,903 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:56,904 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:31:57,081 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:31:57,081 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:31:57,081 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:31:57,081 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:31:57,081 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:31:57,081 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:31:57,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:57,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:57,082 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:57,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:57,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:57,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:57,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:57,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:57,083 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:57,083 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:31:57,083 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:31:57,083 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:31:57,083 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:31:57,083 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:31:57,083 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,084 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,084 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:31:57,084 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:31:57,084 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:31:57,084 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:31:57,084 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:31:57,084 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:31:57,084 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,085 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,085 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,085 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,085 - src.training - INFO -   precision: 0.0
2025-06-24 09:31:57,085 - src.training - INFO -   recall: 0.0
2025-06-24 09:31:57,085 - src.training - INFO -   f1: 0.0
2025-06-24 09:31:57,085 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:31:57,085 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:31:57,085 - src.training - INFO -   positive_samples: 0
2025-06-24 09:31:57,085 - src.training - INFO -   negative_samples: 250
2025-06-24 09:31:57,085 - src.training - INFO -   total_samples: 250
2025-06-24 09:31:57,086 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:31:57,086 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:31:57,086 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:31:57,086 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:31:57,086 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:31:57,086 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:31:57,086 - src.training - INFO - 모델 학습 완료
2025-06-24 09:31:57,086 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:31:57,086 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,086 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,086 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,086 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,088 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:31:57,088 - src.hyperparameter_tuning - ERROR - Trial 1 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:31:57,089 - src.hyperparameter_tuning - INFO - Trial 2: 모델 타입 = catboost
2025-06-24 09:31:57,094 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:31:57,094 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:31:57,094 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:31:57,094 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:31:57,094 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:31:57,094 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:31:57,094 - src.training - INFO - 교차 검증 시작
2025-06-24 09:31:57,094 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:31:57,094 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:31:57,095 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:31:57,095 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:31:57,095 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:31:57,095 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:31:57,095 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:31:57,095 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:31:57,095 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:31:57,095 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:31:57,095 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:31:57,096 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:57,096 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:57,096 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:57,096 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:57,096 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:57,096 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:31:57,096 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:31:57,096 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:31:57,096 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:31:57,096 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:31:57,100 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:31:57,102 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:57,102 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:31:57,102 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:31:57,102 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:31:57,102 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:31:57,102 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:31:57,102 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:57,104 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:57,106 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:31:57,106 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:57,106 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:57,106 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:57,106 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:57,106 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:57,106 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:57,106 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:31:57,106 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,106 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,107 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:31:57,107 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:31:57,107 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,107 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,107 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:31:57,107 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:31:57,107 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,108 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:57,108 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:57,108 - src.training - INFO - 모델 학습 시작
2025-06-24 09:31:57,109 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:31:57,109 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:31:57,109 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:31:57,109 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:31:57,109 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:31:57,109 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:31:57,109 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:31:57,109 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:31:57,109 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:57,109 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:31:57,109 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:31:57,109 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:31:57,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:31:57,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:57,109 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:57,109 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:57,109 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:57,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:57,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:57,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:57,110 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:31:57,110 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:31:57,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:57,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:57,111 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:57,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:57,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:57,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:57,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:57,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:57,111 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:57,111 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,112 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:31:57,112 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,112 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:57,112 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,112 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:31:57,112 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:31:57,112 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:31:57,112 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:31:57,112 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   iterations: 132
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   learning_rate: 0.028145092716060652
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.347776308515933
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   random_strength: 1.6738085788752133
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   bagging_temperature: 0.36210622617823773
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   border_count: 128
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:57,113 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:31:57,307 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:31:57,307 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:31:57,307 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:31:57,307 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:31:57,307 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:31:57,307 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:31:57,307 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:57,307 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,308 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:57,308 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:57,308 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:57,308 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:57,308 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:57,308 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:57,308 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:57,309 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:57,309 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,309 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:31:57,309 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:31:57,309 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:31:57,309 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:31:57,309 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:31:57,309 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,309 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,309 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:31:57,310 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:31:57,310 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:31:57,310 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:31:57,310 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:31:57,310 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:31:57,310 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,310 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,311 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,311 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,311 - src.training - INFO -   precision: 0.0
2025-06-24 09:31:57,311 - src.training - INFO -   recall: 0.0
2025-06-24 09:31:57,311 - src.training - INFO -   f1: 0.0
2025-06-24 09:31:57,311 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:31:57,311 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:31:57,311 - src.training - INFO -   positive_samples: 0
2025-06-24 09:31:57,311 - src.training - INFO -   negative_samples: 250
2025-06-24 09:31:57,311 - src.training - INFO -   total_samples: 250
2025-06-24 09:31:57,311 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:31:57,311 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:31:57,311 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:31:57,311 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:31:57,311 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:31:57,311 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:31:57,311 - src.training - INFO - 모델 학습 완료
2025-06-24 09:31:57,311 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:31:57,311 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,311 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,311 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,311 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,313 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:31:57,314 - src.hyperparameter_tuning - ERROR - Trial 2 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:31:57,315 - src.hyperparameter_tuning - INFO - Trial 3: 모델 타입 = catboost
2025-06-24 09:31:57,319 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:31:57,319 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:31:57,320 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:31:57,320 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:31:57,320 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:31:57,320 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:31:57,320 - src.training - INFO - 교차 검증 시작
2025-06-24 09:31:57,320 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:31:57,320 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:31:57,320 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:31:57,320 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:31:57,320 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:31:57,320 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:31:57,320 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:31:57,320 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:31:57,320 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:31:57,320 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:31:57,320 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:31:57,321 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:57,321 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:57,321 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:57,321 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:57,321 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:57,321 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:31:57,321 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:31:57,321 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:31:57,321 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:31:57,321 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:31:57,325 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:31:57,327 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:57,327 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:31:57,327 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:31:57,327 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:31:57,327 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:31:57,327 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:31:57,327 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:57,329 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:57,331 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:31:57,331 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:57,331 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:57,331 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:57,331 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:57,331 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:57,331 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:57,331 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:31:57,331 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,331 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,332 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:31:57,332 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:31:57,332 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,332 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,332 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:31:57,332 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:31:57,332 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,332 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:57,332 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:57,332 - src.training - INFO - 모델 학습 시작
2025-06-24 09:31:57,333 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:31:57,333 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:31:57,333 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:31:57,333 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:31:57,333 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:31:57,333 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:31:57,333 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:31:57,333 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:31:57,333 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:57,333 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:31:57,333 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:31:57,333 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:31:57,333 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:31:57,333 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:57,334 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:57,334 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:57,334 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:57,334 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:57,334 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:57,334 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:57,335 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:31:57,335 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:31:57,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:57,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:57,335 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:57,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:57,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:57,336 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:57,336 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:57,336 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:57,336 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:57,336 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,336 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:31:57,336 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,336 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:57,336 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,336 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:31:57,336 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:31:57,336 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   iterations: 112
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   learning_rate: 0.03476649150592621
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.858051065806936
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   random_strength: 1.0677482709481354
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   bagging_temperature: 0.2797064039425238
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   border_count: 207
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:31:57,337 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:31:57,338 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:57,338 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:31:57,338 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:57,338 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:31:57,524 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:31:57,524 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:31:57,524 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:31:57,524 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:31:57,524 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:31:57,524 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:31:57,524 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:57,524 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,524 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:57,525 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:57,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:57,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:57,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:57,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:57,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:57,526 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:57,526 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,526 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:31:57,526 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:31:57,526 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:31:57,526 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:31:57,526 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:31:57,526 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,526 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,526 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:31:57,526 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:31:57,527 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:31:57,527 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:31:57,527 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:31:57,527 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:31:57,527 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,527 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,528 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,528 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,528 - src.training - INFO -   precision: 0.0
2025-06-24 09:31:57,528 - src.training - INFO -   recall: 0.0
2025-06-24 09:31:57,528 - src.training - INFO -   f1: 0.0
2025-06-24 09:31:57,528 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:31:57,528 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:31:57,528 - src.training - INFO -   positive_samples: 0
2025-06-24 09:31:57,528 - src.training - INFO -   negative_samples: 250
2025-06-24 09:31:57,528 - src.training - INFO -   total_samples: 250
2025-06-24 09:31:57,528 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:31:57,528 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:31:57,528 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:31:57,528 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:31:57,528 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:31:57,528 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:31:57,528 - src.training - INFO - 모델 학습 완료
2025-06-24 09:31:57,528 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:31:57,528 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,528 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,528 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,528 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,531 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:31:57,531 - src.hyperparameter_tuning - ERROR - Trial 3 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:31:57,532 - src.hyperparameter_tuning - INFO - Trial 4: 모델 타입 = catboost
2025-06-24 09:31:57,536 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:31:57,537 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:31:57,537 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:31:57,537 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:31:57,537 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:31:57,537 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:31:57,537 - src.training - INFO - 교차 검증 시작
2025-06-24 09:31:57,537 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:31:57,537 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:31:57,537 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:31:57,537 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:31:57,537 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:31:57,537 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:31:57,537 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:31:57,537 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:31:57,537 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:31:57,538 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:31:57,538 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:31:57,539 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:57,539 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:57,539 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:57,539 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:57,539 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:57,539 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:31:57,539 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:31:57,539 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:31:57,539 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:31:57,539 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:31:57,543 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:31:57,545 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:57,545 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:31:57,545 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:31:57,545 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:31:57,545 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:31:57,545 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:31:57,545 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:57,547 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:57,549 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:31:57,549 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:57,549 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:57,549 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:57,549 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:57,549 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:57,549 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:57,549 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:31:57,549 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,549 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,550 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:31:57,550 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:31:57,550 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,550 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,550 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:31:57,550 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:31:57,550 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,550 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:57,550 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:57,550 - src.training - INFO - 모델 학습 시작
2025-06-24 09:31:57,551 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:31:57,551 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:31:57,551 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:31:57,551 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:31:57,551 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:31:57,551 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:31:57,551 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:31:57,551 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:31:57,551 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:57,551 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:31:57,551 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:31:57,551 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:31:57,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:31:57,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:57,552 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:57,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:57,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:57,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:57,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:57,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:57,553 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:31:57,553 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:31:57,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:57,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:57,553 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:57,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:57,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:57,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:57,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:57,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:57,554 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:57,554 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,554 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:31:57,554 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,554 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:57,554 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,554 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:31:57,554 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:31:57,554 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   iterations: 317
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   learning_rate: 0.07896186801026692
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.4808945119975185
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   random_strength: 8.536189862866832
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   bagging_temperature: 0.9539969835279999
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   border_count: 46
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:31:57,555 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:31:57,556 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:31:57,556 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:31:57,556 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:31:57,556 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:31:57,556 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:31:57,556 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:31:57,556 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:31:57,556 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:31:57,556 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:31:57,556 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:31:57,556 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:57,556 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:31:57,556 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:57,556 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:31:57,745 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:31:57,745 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:31:57,745 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:31:57,745 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:31:57,745 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:31:57,745 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:31:57,745 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:57,745 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,745 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:57,746 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:57,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:57,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:57,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:57,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:57,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:57,746 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:57,746 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,747 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:31:57,747 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:31:57,747 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:31:57,747 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:31:57,747 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:31:57,747 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,747 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,747 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:31:57,747 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:31:57,748 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:31:57,748 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:31:57,748 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:31:57,748 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:31:57,748 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,748 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,748 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,749 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,749 - src.training - INFO -   precision: 0.0
2025-06-24 09:31:57,749 - src.training - INFO -   recall: 0.0
2025-06-24 09:31:57,749 - src.training - INFO -   f1: 0.0
2025-06-24 09:31:57,749 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:31:57,749 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:31:57,749 - src.training - INFO -   positive_samples: 0
2025-06-24 09:31:57,749 - src.training - INFO -   negative_samples: 250
2025-06-24 09:31:57,749 - src.training - INFO -   total_samples: 250
2025-06-24 09:31:57,749 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:31:57,749 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:31:57,749 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:31:57,749 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:31:57,749 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:31:57,749 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:31:57,749 - src.training - INFO - 모델 학습 완료
2025-06-24 09:31:57,749 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:31:57,749 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,749 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,749 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,749 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,751 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:31:57,751 - src.hyperparameter_tuning - ERROR - Trial 4 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:31:57,752 - src.hyperparameter_tuning - INFO - Trial 5: 모델 타입 = catboost
2025-06-24 09:31:57,756 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:31:57,757 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:31:57,757 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:31:57,757 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:31:57,757 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:31:57,757 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:31:57,757 - src.training - INFO - 교차 검증 시작
2025-06-24 09:31:57,757 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:31:57,757 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:31:57,758 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:31:57,758 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:31:57,758 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:31:57,758 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:31:57,758 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:31:57,758 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:31:57,758 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:31:57,758 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:31:57,758 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:31:57,759 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:57,759 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:57,759 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:57,759 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:57,759 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:57,759 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:31:57,759 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:31:57,759 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:31:57,759 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:31:57,759 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:31:57,763 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:31:57,765 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:57,765 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:31:57,765 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:31:57,765 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:31:57,765 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:31:57,765 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:31:57,765 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:57,767 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:57,769 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:31:57,769 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:57,769 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:57,769 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:57,769 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:57,769 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:57,769 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:57,769 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:31:57,769 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,769 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,770 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:31:57,770 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:31:57,770 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,770 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,770 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:31:57,770 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:31:57,770 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,770 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:57,770 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:57,770 - src.training - INFO - 모델 학습 시작
2025-06-24 09:31:57,771 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:31:57,771 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:31:57,771 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:31:57,771 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:31:57,771 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:31:57,771 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:31:57,771 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:31:57,771 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:31:57,771 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:57,771 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:31:57,771 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:31:57,771 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:31:57,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:31:57,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:57,772 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:57,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:57,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:57,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:57,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:57,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:57,773 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:31:57,773 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:31:57,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:57,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:57,773 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:57,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:57,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:57,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:57,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:57,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:57,774 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:57,774 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,774 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:31:57,774 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,774 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:57,774 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,774 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:31:57,774 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:31:57,774 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:31:57,774 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   iterations: 414
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   learning_rate: 0.013940346079873234
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.833180632488465
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   random_strength: 0.978033701665941
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   bagging_temperature: 0.20983441136030095
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   border_count: 130
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:31:57,775 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:57,776 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:31:57,776 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:57,776 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:31:57,979 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:31:57,979 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:31:57,980 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:31:57,980 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:31:57,980 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:31:57,980 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:31:57,980 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:57,980 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,980 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:57,980 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:57,981 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:57,981 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:57,981 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:57,981 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:57,981 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:57,981 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:57,981 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:31:57,982 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:31:57,982 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:31:57,982 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:31:57,982 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:31:57,982 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,982 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,982 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:31:57,982 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:31:57,982 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:31:57,982 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:31:57,982 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:31:57,983 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:31:57,983 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,983 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,983 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,984 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:57,984 - src.training - INFO -   precision: 0.0
2025-06-24 09:31:57,984 - src.training - INFO -   recall: 0.0
2025-06-24 09:31:57,984 - src.training - INFO -   f1: 0.0
2025-06-24 09:31:57,984 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:31:57,984 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:31:57,984 - src.training - INFO -   positive_samples: 0
2025-06-24 09:31:57,984 - src.training - INFO -   negative_samples: 250
2025-06-24 09:31:57,984 - src.training - INFO -   total_samples: 250
2025-06-24 09:31:57,984 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:31:57,984 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:31:57,984 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:31:57,984 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:31:57,984 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:31:57,984 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:31:57,984 - src.training - INFO - 모델 학습 완료
2025-06-24 09:31:57,984 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:31:57,984 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,984 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,984 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:57,984 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:57,986 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:31:57,986 - src.hyperparameter_tuning - ERROR - Trial 5 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:31:57,987 - src.hyperparameter_tuning - INFO - Trial 6: 모델 타입 = catboost
2025-06-24 09:31:57,991 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:31:57,992 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:31:57,992 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:31:57,992 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:31:57,992 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:31:57,992 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:31:57,992 - src.training - INFO - 교차 검증 시작
2025-06-24 09:31:57,992 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:31:57,992 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:31:57,993 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:31:57,993 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:31:57,993 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:31:57,993 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:31:57,993 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:31:57,993 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:31:57,993 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:31:57,993 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:31:57,993 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:31:57,994 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:57,994 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:57,994 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:57,994 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:57,994 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:57,994 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:31:57,994 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:31:57,994 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:31:57,994 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:31:57,994 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:31:57,998 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:31:58,000 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:58,000 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:31:58,000 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:31:58,000 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:31:58,000 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:31:58,000 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:31:58,000 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:58,002 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:58,004 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:31:58,004 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:58,004 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:58,004 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:58,004 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:58,004 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:58,004 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:58,004 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:31:58,004 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,004 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,005 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:31:58,005 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:31:58,005 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,005 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,005 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:31:58,005 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:31:58,005 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,005 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:58,005 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:58,005 - src.training - INFO - 모델 학습 시작
2025-06-24 09:31:58,006 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:31:58,006 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:31:58,006 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:31:58,006 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:31:58,006 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:31:58,006 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:31:58,006 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:31:58,006 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:31:58,006 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:58,006 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:31:58,006 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:31:58,006 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:31:58,006 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:31:58,006 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,007 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:58,007 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:58,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:58,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:58,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:58,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:58,008 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:58,008 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:31:58,008 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,008 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:31:58,008 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,008 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:58,008 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,008 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:58,009 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:58,009 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:58,009 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:58,009 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:58,009 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:58,009 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:58,009 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:58,009 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,010 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:31:58,010 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   iterations: 65
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   learning_rate: 0.024112898115291985
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.597505784732165
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   random_strength: 1.2399967836846095
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   bagging_temperature: 0.5680612190600297
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   border_count: 101
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:31:58,010 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:58,011 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:31:58,220 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:31:58,220 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:31:58,220 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:31:58,220 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:31:58,220 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:31:58,220 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:31:58,220 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:58,220 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,220 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:58,221 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:58,221 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:58,221 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:58,221 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:58,221 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:58,221 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:58,221 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:58,222 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,222 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:31:58,222 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:31:58,222 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:31:58,222 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:31:58,222 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:31:58,222 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,222 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,222 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:31:58,222 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:31:58,223 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:31:58,223 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:31:58,223 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:31:58,223 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:31:58,223 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,223 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,224 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,224 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,224 - src.training - INFO -   precision: 0.0
2025-06-24 09:31:58,224 - src.training - INFO -   recall: 0.0
2025-06-24 09:31:58,224 - src.training - INFO -   f1: 0.0
2025-06-24 09:31:58,224 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:31:58,224 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:31:58,224 - src.training - INFO -   positive_samples: 0
2025-06-24 09:31:58,224 - src.training - INFO -   negative_samples: 250
2025-06-24 09:31:58,224 - src.training - INFO -   total_samples: 250
2025-06-24 09:31:58,224 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:31:58,224 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:31:58,224 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:31:58,224 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:31:58,224 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:31:58,224 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:31:58,224 - src.training - INFO - 모델 학습 완료
2025-06-24 09:31:58,224 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:31:58,224 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,224 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,224 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,224 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,226 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:31:58,226 - src.hyperparameter_tuning - ERROR - Trial 6 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:31:58,228 - src.hyperparameter_tuning - INFO - Trial 7: 모델 타입 = catboost
2025-06-24 09:31:58,231 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:31:58,232 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:31:58,232 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:31:58,232 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:31:58,232 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:31:58,232 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:31:58,232 - src.training - INFO - 교차 검증 시작
2025-06-24 09:31:58,232 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:31:58,232 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:31:58,233 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:31:58,233 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:31:58,233 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:31:58,233 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:31:58,233 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:31:58,233 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:31:58,233 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:31:58,233 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:31:58,233 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:31:58,234 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:58,234 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:58,234 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:58,234 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:58,234 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:58,234 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:31:58,234 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:31:58,234 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:31:58,234 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:31:58,234 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:31:58,238 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:31:58,240 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:58,240 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:31:58,240 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:31:58,240 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:31:58,240 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:31:58,240 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:31:58,240 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:58,242 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:58,243 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:31:58,243 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:58,244 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:58,244 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:58,244 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:58,244 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:58,244 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:58,244 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:31:58,244 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,244 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,244 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:31:58,244 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:31:58,244 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,244 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,244 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:31:58,244 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:31:58,244 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,245 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:58,245 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:58,245 - src.training - INFO - 모델 학습 시작
2025-06-24 09:31:58,246 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:31:58,246 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:31:58,246 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:31:58,246 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:31:58,246 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:31:58,246 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:31:58,246 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:31:58,246 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:31:58,246 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:58,246 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:31:58,246 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:31:58,246 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:31:58,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:31:58,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:58,246 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:58,247 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:58,247 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:58,247 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:58,247 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:58,247 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:58,247 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:31:58,247 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,247 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:31:58,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:58,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:58,248 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:58,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:58,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:58,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:58,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:58,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:58,249 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:58,249 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:31:58,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,249 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:58,249 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,249 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:31:58,249 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:31:58,249 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:31:58,249 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:31:58,249 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:31:58,249 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:31:58,249 - src.models.catboost_model - INFO -   iterations: 133
2025-06-24 09:31:58,249 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 09:31:58,249 - src.models.catboost_model - INFO -   learning_rate: 0.13962563737015762
2025-06-24 09:31:58,249 - src.models.catboost_model - INFO -   l2_leaf_reg: 8.699593128513321
2025-06-24 09:31:58,249 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   random_strength: 6.978281265126034
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   bagging_temperature: 0.6381099809299766
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   border_count: 232
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:58,250 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:31:58,446 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:31:58,446 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:31:58,446 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:31:58,446 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:31:58,446 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:31:58,446 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:31:58,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:58,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,447 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:58,447 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:58,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:58,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:58,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:58,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:58,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:58,448 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:58,448 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,448 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:31:58,448 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:31:58,448 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:31:58,448 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:31:58,448 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:31:58,448 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,448 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,448 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:31:58,448 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:31:58,449 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:31:58,449 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:31:58,449 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:31:58,449 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:31:58,449 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,449 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,450 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,450 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,450 - src.training - INFO -   precision: 0.0
2025-06-24 09:31:58,450 - src.training - INFO -   recall: 0.0
2025-06-24 09:31:58,450 - src.training - INFO -   f1: 0.0
2025-06-24 09:31:58,450 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:31:58,450 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:31:58,450 - src.training - INFO -   positive_samples: 0
2025-06-24 09:31:58,450 - src.training - INFO -   negative_samples: 250
2025-06-24 09:31:58,450 - src.training - INFO -   total_samples: 250
2025-06-24 09:31:58,450 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:31:58,450 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:31:58,450 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:31:58,450 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:31:58,450 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:31:58,450 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:31:58,450 - src.training - INFO - 모델 학습 완료
2025-06-24 09:31:58,450 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:31:58,450 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,450 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,450 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,450 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,452 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:31:58,453 - src.hyperparameter_tuning - ERROR - Trial 7 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:31:58,454 - src.hyperparameter_tuning - INFO - Trial 8: 모델 타입 = catboost
2025-06-24 09:31:58,458 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:31:58,458 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:31:58,458 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:31:58,458 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:31:58,458 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:31:58,458 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:31:58,458 - src.training - INFO - 교차 검증 시작
2025-06-24 09:31:58,458 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:31:58,459 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:31:58,459 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:31:58,459 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:31:58,459 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:31:58,459 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:31:58,459 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:31:58,459 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:31:58,459 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:31:58,459 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:31:58,459 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:31:58,460 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:58,460 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:58,460 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:58,460 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:58,460 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:58,460 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:31:58,460 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:31:58,460 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:31:58,460 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:31:58,460 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:31:58,464 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:31:58,466 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:58,466 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:31:58,466 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:31:58,466 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:31:58,466 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:31:58,466 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:31:58,466 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:58,468 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:58,470 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:31:58,470 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:58,470 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:58,470 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:58,470 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:58,470 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:58,470 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:58,470 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:31:58,470 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,470 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,471 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:31:58,471 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:31:58,471 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,471 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,471 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:31:58,471 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:31:58,471 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,472 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:58,472 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:58,472 - src.training - INFO - 모델 학습 시작
2025-06-24 09:31:58,473 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:31:58,473 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:31:58,473 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:31:58,473 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:31:58,473 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:31:58,473 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:31:58,473 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:31:58,473 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:31:58,473 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:58,473 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:31:58,473 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:31:58,473 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:31:58,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:31:58,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:58,473 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:58,473 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:58,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:58,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:58,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:58,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:58,474 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:31:58,474 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:31:58,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:58,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,475 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:58,475 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:58,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:58,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:58,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:58,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:58,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:58,475 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:58,476 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,476 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:31:58,476 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   iterations: 89
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   learning_rate: 0.011662890273931383
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.1150972021685583
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   random_strength: 4.544383960336017
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   bagging_temperature: 0.34421412859650635
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   border_count: 119
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:31:58,476 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:58,477 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:31:58,675 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:31:58,675 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:31:58,675 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:31:58,675 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:31:58,675 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:31:58,675 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:31:58,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:58,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:58,676 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:58,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:58,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:58,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:58,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:58,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:58,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:58,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,677 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:31:58,678 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:31:58,678 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:31:58,678 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:31:58,678 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:31:58,678 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,678 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,678 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:31:58,678 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:31:58,678 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:31:58,678 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:31:58,679 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:31:58,679 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:31:58,679 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,679 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,679 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,680 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,680 - src.training - INFO -   precision: 0.0
2025-06-24 09:31:58,680 - src.training - INFO -   recall: 0.0
2025-06-24 09:31:58,680 - src.training - INFO -   f1: 0.0
2025-06-24 09:31:58,680 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:31:58,680 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:31:58,680 - src.training - INFO -   positive_samples: 0
2025-06-24 09:31:58,680 - src.training - INFO -   negative_samples: 250
2025-06-24 09:31:58,680 - src.training - INFO -   total_samples: 250
2025-06-24 09:31:58,680 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:31:58,680 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:31:58,680 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:31:58,680 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:31:58,680 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:31:58,680 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:31:58,680 - src.training - INFO - 모델 학습 완료
2025-06-24 09:31:58,680 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:31:58,680 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,680 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,680 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,680 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,682 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:31:58,682 - src.hyperparameter_tuning - ERROR - Trial 8 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:31:58,683 - src.hyperparameter_tuning - INFO - Trial 9: 모델 타입 = catboost
2025-06-24 09:31:58,687 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:31:58,688 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:31:58,688 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:31:58,688 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:31:58,688 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:31:58,688 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:31:58,688 - src.training - INFO - 교차 검증 시작
2025-06-24 09:31:58,688 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:31:58,688 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:31:58,689 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:31:58,689 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:31:58,689 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:31:58,689 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:31:58,689 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:31:58,689 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:31:58,689 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:31:58,689 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:31:58,689 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:31:58,690 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:58,690 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:58,690 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:58,690 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:58,690 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:58,690 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:31:58,690 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:31:58,690 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:31:58,690 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:31:58,690 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:31:58,694 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:31:58,696 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:58,696 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:31:58,696 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:31:58,696 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:31:58,696 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:31:58,696 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:31:58,696 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:58,698 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:58,700 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:31:58,700 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:58,700 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:58,700 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:58,700 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:58,700 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:58,700 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:58,700 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:31:58,700 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,700 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,701 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:31:58,701 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:31:58,701 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,701 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,701 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:31:58,701 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:31:58,701 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,702 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:58,702 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:58,702 - src.training - INFO - 모델 학습 시작
2025-06-24 09:31:58,702 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:31:58,702 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:31:58,703 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:31:58,703 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:31:58,703 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:31:58,703 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:31:58,703 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:31:58,703 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:31:58,703 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:58,703 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:31:58,703 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:31:58,703 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:31:58,703 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:31:58,703 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,703 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:58,703 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:58,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:58,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:58,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:58,704 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:58,704 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:58,704 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:31:58,704 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:31:58,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:58,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:58,705 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:58,705 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:58,705 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:58,705 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:58,705 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:58,705 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:58,705 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:58,705 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:31:58,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   iterations: 210
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   learning_rate: 0.06333268775321842
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.383324997521996
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   random_strength: 9.413993046829944
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   bagging_temperature: 0.16709557931179375
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   border_count: 211
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:31:58,706 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:58,707 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:31:58,923 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:31:58,923 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:31:58,923 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:31:58,923 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:31:58,923 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:31:58,923 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:31:58,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:58,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:58,924 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:58,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:58,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:58,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:58,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:58,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:58,924 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:58,924 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:31:58,925 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:31:58,925 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:31:58,925 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:31:58,925 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:31:58,925 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,925 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,925 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:31:58,925 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:31:58,925 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:31:58,926 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:31:58,926 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:31:58,926 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:31:58,926 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,926 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,926 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,927 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:58,927 - src.training - INFO -   precision: 0.0
2025-06-24 09:31:58,927 - src.training - INFO -   recall: 0.0
2025-06-24 09:31:58,927 - src.training - INFO -   f1: 0.0
2025-06-24 09:31:58,927 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:31:58,927 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:31:58,927 - src.training - INFO -   positive_samples: 0
2025-06-24 09:31:58,927 - src.training - INFO -   negative_samples: 250
2025-06-24 09:31:58,927 - src.training - INFO -   total_samples: 250
2025-06-24 09:31:58,927 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:31:58,927 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:31:58,927 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:31:58,927 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:31:58,927 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:31:58,927 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:31:58,927 - src.training - INFO - 모델 학습 완료
2025-06-24 09:31:58,927 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:31:58,927 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,927 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,927 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,927 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,929 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:31:58,929 - src.hyperparameter_tuning - ERROR - Trial 9 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:31:58,941 - src.hyperparameter_tuning - INFO - Trial 10: 모델 타입 = catboost
2025-06-24 09:31:58,945 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:31:58,946 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:31:58,946 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:31:58,946 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:31:58,946 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:31:58,946 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:31:58,946 - src.training - INFO - 교차 검증 시작
2025-06-24 09:31:58,946 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:31:58,946 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:31:58,946 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:31:58,947 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:31:58,947 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:31:58,947 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:31:58,947 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:31:58,947 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:31:58,947 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:31:58,947 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:31:58,947 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:31:58,948 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:58,948 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:58,948 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:58,948 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:58,948 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:58,948 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:31:58,948 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:31:58,948 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:31:58,948 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:31:58,948 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:31:58,952 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:31:58,954 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:58,954 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:31:58,954 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:31:58,954 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:31:58,954 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:31:58,954 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:31:58,954 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:58,956 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:58,959 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:31:58,959 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:58,959 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:58,959 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:58,959 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:58,959 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:58,959 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:58,959 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:31:58,959 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,959 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,960 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:31:58,960 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:31:58,960 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,960 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,960 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:31:58,960 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:31:58,960 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,960 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:58,960 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:58,960 - src.training - INFO - 모델 학습 시작
2025-06-24 09:31:58,961 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:31:58,961 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:31:58,961 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:31:58,961 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:31:58,961 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:31:58,961 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:31:58,961 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:31:58,961 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:31:58,961 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:58,961 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:31:58,961 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:31:58,961 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:31:58,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:31:58,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:58,962 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:58,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:58,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:58,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:58,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:58,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:58,963 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:31:58,963 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,964 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:31:58,964 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,964 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:58,964 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,964 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:58,964 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:58,964 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:58,964 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:58,964 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:58,965 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:58,965 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:58,965 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:58,965 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:58,965 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:31:58,965 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,965 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:58,965 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:58,965 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:31:58,965 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:31:58,965 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   iterations: 291
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   learning_rate: 0.2704729722717775
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   l2_leaf_reg: 8.556385477088204
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   random_strength: 0.10722312838040222
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   bagging_temperature: 0.458239007998159
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   border_count: 35
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:31:58,966 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:58,967 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:31:59,162 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:31:59,162 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:31:59,162 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:31:59,162 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:31:59,162 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:31:59,162 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:31:59,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:59,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:59,163 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:59,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:59,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:59,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:59,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:59,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:59,164 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:59,164 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:31:59,164 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:31:59,165 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:31:59,165 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:31:59,165 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:31:59,165 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,165 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,165 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:31:59,165 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:31:59,165 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:31:59,165 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:31:59,165 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:31:59,165 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:31:59,166 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,166 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,166 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,166 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,166 - src.training - INFO -   precision: 0.0
2025-06-24 09:31:59,166 - src.training - INFO -   recall: 0.0
2025-06-24 09:31:59,166 - src.training - INFO -   f1: 0.0
2025-06-24 09:31:59,166 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:31:59,166 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:31:59,166 - src.training - INFO -   positive_samples: 0
2025-06-24 09:31:59,166 - src.training - INFO -   negative_samples: 250
2025-06-24 09:31:59,166 - src.training - INFO -   total_samples: 250
2025-06-24 09:31:59,166 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:31:59,167 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:31:59,167 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:31:59,167 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:31:59,167 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:31:59,167 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:31:59,167 - src.training - INFO - 모델 학습 완료
2025-06-24 09:31:59,167 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:31:59,167 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,167 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,167 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,167 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,169 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:31:59,169 - src.hyperparameter_tuning - ERROR - Trial 10 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:31:59,180 - src.hyperparameter_tuning - INFO - Trial 11: 모델 타입 = catboost
2025-06-24 09:31:59,184 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:31:59,185 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:31:59,185 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:31:59,185 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:31:59,185 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:31:59,185 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:31:59,185 - src.training - INFO - 교차 검증 시작
2025-06-24 09:31:59,185 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:31:59,185 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:31:59,186 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:31:59,186 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:31:59,186 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:31:59,186 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:31:59,186 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:31:59,186 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:31:59,186 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:31:59,186 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:31:59,186 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:31:59,187 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:59,187 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:59,187 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:59,187 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:59,187 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:59,187 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:31:59,187 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:31:59,187 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:31:59,187 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:31:59,187 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:31:59,191 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:31:59,193 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:59,193 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:31:59,193 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:31:59,193 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:31:59,193 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:31:59,193 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:31:59,193 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:59,195 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:59,197 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:31:59,197 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:59,197 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:59,197 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:59,197 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:59,197 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:59,197 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:59,197 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:31:59,197 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,197 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,198 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:31:59,198 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:31:59,198 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,198 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,198 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:31:59,198 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:31:59,198 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,199 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:59,199 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:59,199 - src.training - INFO - 모델 학습 시작
2025-06-24 09:31:59,199 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:31:59,200 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:31:59,200 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:31:59,200 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:31:59,200 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:31:59,200 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:31:59,200 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:31:59,200 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:31:59,200 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:59,200 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:31:59,200 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:31:59,200 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:31:59,200 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:31:59,200 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,200 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:59,200 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:59,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:59,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:59,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:59,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:59,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:59,201 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:31:59,201 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:31:59,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:59,202 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,202 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:59,202 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:59,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:59,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:59,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:59,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:59,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:59,203 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:59,203 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,203 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:31:59,203 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,203 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:59,203 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,203 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:31:59,203 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:31:59,203 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:31:59,203 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   iterations: 484
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   learning_rate: 0.123229454137605
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.0369102150482288
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   random_strength: 0.13013973606575802
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   bagging_temperature: 0.818444535435679
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   border_count: 170
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:31:59,204 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:31:59,205 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:59,205 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:31:59,205 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:59,205 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:31:59,390 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:31:59,390 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:31:59,390 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:31:59,390 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:31:59,390 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:31:59,390 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:31:59,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:59,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:59,391 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:59,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:59,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:59,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:59,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:59,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:59,392 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:59,392 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,392 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:31:59,392 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:31:59,393 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:31:59,393 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:31:59,393 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:31:59,393 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,393 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:31:59,393 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:31:59,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:31:59,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:31:59,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:31:59,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:31:59,394 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,394 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,394 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,394 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,394 - src.training - INFO -   precision: 0.0
2025-06-24 09:31:59,394 - src.training - INFO -   recall: 0.0
2025-06-24 09:31:59,394 - src.training - INFO -   f1: 0.0
2025-06-24 09:31:59,394 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:31:59,394 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:31:59,394 - src.training - INFO -   positive_samples: 0
2025-06-24 09:31:59,394 - src.training - INFO -   negative_samples: 250
2025-06-24 09:31:59,394 - src.training - INFO -   total_samples: 250
2025-06-24 09:31:59,395 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:31:59,395 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:31:59,395 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:31:59,395 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:31:59,395 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:31:59,395 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:31:59,395 - src.training - INFO - 모델 학습 완료
2025-06-24 09:31:59,395 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:31:59,395 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,395 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,395 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,395 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,397 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:31:59,397 - src.hyperparameter_tuning - ERROR - Trial 11 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:31:59,409 - src.hyperparameter_tuning - INFO - Trial 12: 모델 타입 = catboost
2025-06-24 09:31:59,413 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:31:59,413 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:31:59,413 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:31:59,413 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:31:59,413 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:31:59,413 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:31:59,413 - src.training - INFO - 교차 검증 시작
2025-06-24 09:31:59,413 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:31:59,414 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:31:59,414 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:31:59,414 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:31:59,414 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:31:59,414 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:31:59,414 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:31:59,414 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:31:59,414 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:31:59,414 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:31:59,414 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:31:59,415 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:59,415 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:59,415 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:59,415 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:59,415 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:59,415 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:31:59,415 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:31:59,415 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:31:59,415 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:31:59,415 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:31:59,419 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:31:59,422 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:59,422 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:31:59,422 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:31:59,422 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:31:59,422 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:31:59,422 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:31:59,422 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:59,424 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:59,426 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:31:59,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:59,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:59,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:59,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:59,426 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:59,426 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:59,426 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:31:59,426 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,426 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,427 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:31:59,427 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:31:59,427 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,427 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,427 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:31:59,427 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:31:59,427 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,427 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:59,427 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:59,427 - src.training - INFO - 모델 학습 시작
2025-06-24 09:31:59,428 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:31:59,428 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:31:59,428 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:31:59,428 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:31:59,428 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:31:59,428 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:31:59,428 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:31:59,428 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:31:59,428 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:59,428 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:31:59,428 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:31:59,428 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:31:59,428 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:31:59,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:59,429 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:59,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:59,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:59,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:59,430 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:59,430 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:59,430 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:31:59,430 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:31:59,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:59,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:59,431 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:59,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:59,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:59,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:59,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:59,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:59,431 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:59,431 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,432 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:31:59,432 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   iterations: 389
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   learning_rate: 0.22514439322776264
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   l2_leaf_reg: 5.296674788500097
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   random_strength: 0.2720997615584854
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   bagging_temperature: 0.7110532584087175
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   border_count: 77
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:31:59,432 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:59,433 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:31:59,666 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:31:59,666 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:31:59,666 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:31:59,666 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:31:59,666 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:31:59,667 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:31:59,667 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:59,667 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,667 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:59,667 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:59,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:59,668 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:59,668 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:59,668 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:59,668 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:59,668 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:59,668 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,668 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:31:59,669 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:31:59,669 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:31:59,669 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:31:59,669 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:31:59,669 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,669 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,669 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:31:59,669 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:31:59,669 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:31:59,669 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:31:59,669 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:31:59,669 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:31:59,670 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,670 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,670 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,670 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,670 - src.training - INFO -   precision: 0.0
2025-06-24 09:31:59,671 - src.training - INFO -   recall: 0.0
2025-06-24 09:31:59,671 - src.training - INFO -   f1: 0.0
2025-06-24 09:31:59,671 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:31:59,671 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:31:59,671 - src.training - INFO -   positive_samples: 0
2025-06-24 09:31:59,671 - src.training - INFO -   negative_samples: 250
2025-06-24 09:31:59,671 - src.training - INFO -   total_samples: 250
2025-06-24 09:31:59,671 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:31:59,671 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:31:59,671 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:31:59,671 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:31:59,671 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:31:59,671 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:31:59,671 - src.training - INFO - 모델 학습 완료
2025-06-24 09:31:59,671 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:31:59,671 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,671 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,671 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,671 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,673 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:31:59,673 - src.hyperparameter_tuning - ERROR - Trial 12 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:31:59,686 - src.hyperparameter_tuning - INFO - Trial 13: 모델 타입 = catboost
2025-06-24 09:31:59,690 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:31:59,691 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:31:59,691 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:31:59,691 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:31:59,691 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:31:59,691 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:31:59,691 - src.training - INFO - 교차 검증 시작
2025-06-24 09:31:59,691 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:31:59,691 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:31:59,692 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:31:59,692 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:31:59,692 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:31:59,692 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:31:59,692 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:31:59,692 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:31:59,692 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:31:59,692 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:31:59,692 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:31:59,693 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:59,693 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:59,693 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:59,693 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:59,693 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:59,693 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:31:59,693 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:31:59,693 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:31:59,693 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:31:59,693 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:31:59,697 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:31:59,699 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:59,699 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:31:59,699 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:31:59,699 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:31:59,699 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:31:59,699 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:31:59,699 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:59,701 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:59,703 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:31:59,703 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:59,703 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:59,703 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:59,703 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:59,703 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:59,703 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:59,704 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:31:59,704 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,704 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,704 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:31:59,704 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:31:59,704 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,704 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,704 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:31:59,704 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:31:59,704 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,705 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:59,705 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:59,705 - src.training - INFO - 모델 학습 시작
2025-06-24 09:31:59,706 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:31:59,706 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:31:59,706 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:31:59,706 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:31:59,706 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:31:59,706 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:31:59,706 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:31:59,706 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:31:59,706 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:59,706 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:31:59,706 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:31:59,706 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:31:59,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:31:59,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:59,706 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:59,706 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:59,706 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:59,707 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:59,707 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:59,707 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:59,707 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:31:59,707 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,707 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:31:59,707 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,707 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:59,707 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:59,708 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:59,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:59,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:59,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:59,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:59,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:59,708 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:59,708 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:31:59,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO -   iterations: 214
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO -   depth: 7
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO -   learning_rate: 0.11633823680103778
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.3874310439811683
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO -   random_strength: 0.2846282635669904
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO -   bagging_temperature: 0.9044596427685287
2025-06-24 09:31:59,709 - src.models.catboost_model - INFO -   border_count: 253
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:59,710 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:31:59,916 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:31:59,916 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:31:59,916 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:31:59,916 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:31:59,916 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:31:59,916 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:31:59,916 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:59,916 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,916 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:59,917 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:59,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:59,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:59,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:59,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:59,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:59,917 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:59,917 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:31:59,918 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:31:59,918 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:31:59,918 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:31:59,918 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:31:59,918 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,918 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,918 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:31:59,918 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:31:59,919 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:31:59,919 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:31:59,919 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:31:59,919 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:31:59,919 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,919 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,919 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,920 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:31:59,920 - src.training - INFO -   precision: 0.0
2025-06-24 09:31:59,920 - src.training - INFO -   recall: 0.0
2025-06-24 09:31:59,920 - src.training - INFO -   f1: 0.0
2025-06-24 09:31:59,920 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:31:59,920 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:31:59,920 - src.training - INFO -   positive_samples: 0
2025-06-24 09:31:59,920 - src.training - INFO -   negative_samples: 250
2025-06-24 09:31:59,920 - src.training - INFO -   total_samples: 250
2025-06-24 09:31:59,920 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:31:59,920 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:31:59,920 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:31:59,920 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:31:59,920 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:31:59,920 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:31:59,920 - src.training - INFO - 모델 학습 완료
2025-06-24 09:31:59,920 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:31:59,920 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,920 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,920 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,920 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,922 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:31:59,923 - src.hyperparameter_tuning - ERROR - Trial 13 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:31:59,934 - src.hyperparameter_tuning - INFO - Trial 14: 모델 타입 = catboost
2025-06-24 09:31:59,937 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:31:59,938 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:31:59,938 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:31:59,938 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:31:59,938 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:31:59,938 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:31:59,938 - src.training - INFO - 교차 검증 시작
2025-06-24 09:31:59,938 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:31:59,938 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:31:59,939 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:31:59,939 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:31:59,939 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:31:59,939 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:31:59,939 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:31:59,939 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:31:59,939 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:31:59,939 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:31:59,939 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:31:59,940 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:59,940 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:59,940 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:31:59,940 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:31:59,940 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:59,940 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:31:59,940 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:31:59,940 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:31:59,940 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:31:59,940 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:31:59,944 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:31:59,946 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:59,946 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:31:59,946 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:31:59,946 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:31:59,946 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:31:59,946 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:31:59,946 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:31:59,948 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:31:59,950 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:31:59,950 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:59,950 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:59,950 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:31:59,950 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:31:59,950 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:59,950 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:31:59,950 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:31:59,950 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,950 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,950 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:31:59,950 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:31:59,950 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,951 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,951 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:31:59,951 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:31:59,951 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,951 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:59,951 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:31:59,951 - src.training - INFO - 모델 학습 시작
2025-06-24 09:31:59,952 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:31:59,952 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:31:59,952 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:31:59,952 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:31:59,952 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:31:59,952 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:31:59,952 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:31:59,952 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:31:59,952 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:59,952 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:31:59,952 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:31:59,952 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:31:59,952 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:31:59,952 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,952 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:59,953 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:59,953 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:59,953 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:59,953 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:59,953 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:59,953 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:59,953 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:31:59,953 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:31:59,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:31:59,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:31:59,954 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:31:59,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:31:59,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:31:59,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:31:59,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:31:59,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:31:59,955 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:31:59,955 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:31:59,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:31:59,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,955 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:31:59,955 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:31:59,955 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:31:59,955 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:31:59,955 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:31:59,955 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   iterations: 221
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   learning_rate: 0.17599635577438225
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.8714678182571203
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   random_strength: 0.30287539859849916
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   bagging_temperature: 0.7531610149049307
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   border_count: 170
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:31:59,956 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:00,153 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:00,153 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:00,153 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:00,153 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:00,153 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:00,153 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:00,153 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:00,153 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:00,154 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:00,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:00,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:00,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:00,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:00,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:00,155 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:00,155 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,155 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:00,155 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:00,156 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:00,156 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:00,156 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:00,156 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,156 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,156 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:00,156 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:00,156 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:00,156 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:00,156 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:00,156 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:00,156 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,157 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,157 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,157 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,157 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:00,157 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:00,157 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:00,157 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:00,157 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:00,157 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:00,157 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:00,157 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:00,157 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:00,157 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:00,157 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:00,157 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:00,157 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:00,157 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:00,157 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:00,157 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:00,158 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,158 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,158 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,158 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,160 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:00,160 - src.hyperparameter_tuning - ERROR - Trial 14 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:00,171 - src.hyperparameter_tuning - INFO - Trial 15: 모델 타입 = catboost
2025-06-24 09:32:00,175 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:00,176 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:00,176 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:00,176 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:00,176 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:00,176 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:00,176 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:00,176 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:00,176 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:00,177 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:00,177 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:00,177 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:00,177 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:00,177 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:00,177 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:00,177 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:00,177 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:00,177 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:00,178 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:00,178 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:00,178 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:00,178 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:00,178 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:00,178 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:00,178 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:00,178 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:00,178 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:00,178 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:00,182 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:00,184 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:00,184 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:00,184 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:00,184 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:00,184 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:00,184 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:00,184 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:00,186 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:00,188 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:00,188 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:00,188 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:00,188 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:00,188 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:00,188 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:00,188 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:00,188 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:00,188 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,188 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,188 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:00,188 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:00,188 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,188 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,189 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:00,189 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:00,189 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,189 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:00,189 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:00,189 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:00,190 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:00,190 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:00,190 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:00,190 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:00,190 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:00,190 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:00,190 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:00,190 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:00,190 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:00,190 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:00,190 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:00,190 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:00,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:00,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:00,191 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:00,191 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:00,191 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:00,191 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:00,191 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:00,191 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:00,192 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:00,192 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:00,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:00,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:00,192 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:00,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:00,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:00,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:00,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:00,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:00,193 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:00,193 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:00,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   iterations: 500
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   depth: 7
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   learning_rate: 0.08271464384743993
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   l2_leaf_reg: 6.427854453713883
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   random_strength: 0.5286741166545424
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   bagging_temperature: 0.47805141729345574
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   border_count: 75
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:00,194 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:00,195 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:00,401 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:00,401 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:00,401 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:00,401 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:00,401 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:00,401 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:00,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:00,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:00,402 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:00,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:00,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:00,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:00,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:00,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:00,402 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:00,402 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:00,403 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:00,403 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:00,403 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:00,403 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:00,403 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,403 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,403 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:00,403 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:00,404 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:00,404 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:00,404 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:00,404 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:00,404 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,404 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,404 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,405 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,405 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:00,405 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:00,405 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:00,405 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:00,405 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:00,405 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:00,405 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:00,405 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:00,405 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:00,405 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:00,405 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:00,405 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:00,405 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:00,405 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:00,405 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:00,405 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:00,405 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,405 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,405 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,405 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,407 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:00,407 - src.hyperparameter_tuning - ERROR - Trial 15 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:00,419 - src.hyperparameter_tuning - INFO - Trial 16: 모델 타입 = catboost
2025-06-24 09:32:00,422 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:00,423 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:00,423 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:00,423 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:00,423 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:00,423 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:00,423 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:00,423 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:00,423 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:00,424 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:00,424 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:00,424 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:00,424 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:00,424 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:00,424 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:00,424 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:00,424 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:00,424 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:00,425 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:00,425 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:00,425 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:00,425 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:00,425 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:00,425 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:00,425 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:00,425 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:00,425 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:00,425 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:00,429 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:00,431 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:00,431 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:00,431 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:00,431 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:00,431 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:00,431 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:00,431 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:00,433 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:00,434 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:00,434 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:00,435 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:00,435 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:00,435 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:00,435 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:00,435 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:00,435 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:00,435 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,435 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,435 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:00,435 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:00,435 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,435 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,435 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:00,435 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:00,435 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,436 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:00,436 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:00,436 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:00,437 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:00,437 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:00,437 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:00,437 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:00,437 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:00,437 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:00,437 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:00,437 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:00,437 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:00,437 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:00,437 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:00,437 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:00,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:00,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:00,437 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:00,437 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:00,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:00,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:00,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:00,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:00,438 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:00,438 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:00,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:00,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:00,439 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:00,439 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:00,439 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:00,439 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:00,439 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:00,439 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:00,439 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:00,439 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,440 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:00,440 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   iterations: 354
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   learning_rate: 0.04657370744630152
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.4360242559303533
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   random_strength: 0.18015596595059322
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   bagging_temperature: 0.10315524104905854
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   border_count: 164
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:00,440 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:00,441 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:00,642 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:00,642 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:00,642 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:00,642 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:00,642 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:00,642 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:00,642 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:00,643 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,643 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:00,643 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:00,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:00,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:00,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:00,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:00,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:00,644 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:00,644 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:00,645 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:00,645 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:00,645 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:00,645 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:00,645 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,645 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:00,645 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:00,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:00,646 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:00,646 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:00,646 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:00,646 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,646 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,646 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,647 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,647 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:00,647 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:00,647 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:00,647 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:00,647 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:00,647 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:00,647 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:00,647 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:00,647 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:00,647 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:00,647 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:00,647 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:00,647 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:00,647 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:00,647 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:00,647 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:00,647 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,647 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,647 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,647 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,649 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:00,650 - src.hyperparameter_tuning - ERROR - Trial 16 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:00,661 - src.hyperparameter_tuning - INFO - Trial 17: 모델 타입 = catboost
2025-06-24 09:32:00,665 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:00,666 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:00,666 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:00,666 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:00,666 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:00,666 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:00,666 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:00,666 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:00,666 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:00,666 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:00,666 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:00,666 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:00,666 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:00,666 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:00,666 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:00,666 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:00,666 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:00,666 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:00,667 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:00,667 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:00,667 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:00,667 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:00,668 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:00,668 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:00,668 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:00,668 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:00,668 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:00,668 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:00,671 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:00,673 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:00,673 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:00,673 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:00,673 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:00,673 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:00,673 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:00,673 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:00,675 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:00,677 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:00,677 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:00,678 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:00,678 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:00,678 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:00,678 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:00,678 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:00,678 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:00,678 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,678 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,678 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:00,678 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:00,678 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,678 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,678 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:00,678 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:00,678 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,679 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:00,679 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:00,679 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:00,680 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:00,680 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:00,680 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:00,680 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:00,680 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:00,680 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:00,680 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:00,680 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:00,680 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:00,680 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:00,680 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:00,680 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:00,680 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:00,680 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,680 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:00,681 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:00,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:00,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:00,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:00,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:00,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:00,681 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:00,681 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:00,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:00,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:00,682 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:00,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:00,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:00,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:00,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:00,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:00,683 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:00,683 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,683 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:00,683 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,683 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:00,683 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,683 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:00,683 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:00,683 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:00,683 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   iterations: 252
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   learning_rate: 0.0948212509794976
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.0024921838459906
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   random_strength: 0.5983206987374902
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   bagging_temperature: 0.8238465414662601
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   border_count: 79
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:00,684 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:00,685 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:00,685 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:00,893 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:00,893 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:00,893 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:00,893 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:00,893 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:00,893 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:00,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:00,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:00,894 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:00,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:00,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:00,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:00,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:00,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:00,894 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:00,894 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:00,895 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:00,895 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:00,895 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:00,895 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:00,895 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,895 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,895 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:00,895 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:00,895 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:00,896 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:00,896 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:00,896 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:00,896 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,896 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,896 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,897 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:00,897 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:00,897 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:00,897 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:00,897 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:00,897 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:00,897 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:00,897 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:00,897 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:00,897 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:00,897 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:00,897 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:00,897 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:00,897 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:00,897 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:00,897 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:00,897 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:00,897 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,897 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,897 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,897 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,899 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:00,899 - src.hyperparameter_tuning - ERROR - Trial 17 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:00,911 - src.hyperparameter_tuning - INFO - Trial 18: 모델 타입 = catboost
2025-06-24 09:32:00,915 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:00,915 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:00,915 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:00,915 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:00,915 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:00,916 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:00,916 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:00,916 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:00,916 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:00,916 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:00,916 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:00,916 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:00,916 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:00,916 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:00,916 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:00,916 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:00,916 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:00,916 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:00,917 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:00,917 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:00,917 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:00,917 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:00,917 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:00,917 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:00,917 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:00,917 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:00,917 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:00,917 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:00,921 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:00,923 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:00,923 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:00,923 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:00,923 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:00,923 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:00,923 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:00,923 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:00,925 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:00,927 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:00,927 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:00,927 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:00,927 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:00,927 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:00,927 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:00,927 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:00,927 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:00,927 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,927 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,928 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:00,928 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:00,928 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,928 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,928 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:00,928 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:00,928 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,929 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:00,929 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:00,929 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:00,930 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:00,930 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:00,930 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:00,930 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:00,930 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:00,930 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:00,930 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:00,930 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:00,930 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:00,930 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:00,930 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:00,930 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:00,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:00,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:00,930 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:00,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:00,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:00,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:00,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:00,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:00,931 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:00,931 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,932 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:00,932 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,932 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:00,932 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,932 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:00,932 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:00,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:00,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:00,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:00,933 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:00,933 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:00,933 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:00,933 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:00,933 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:00,933 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,933 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:00,933 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:00,933 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:00,933 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:00,933 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:00,933 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   iterations: 443
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   learning_rate: 0.17441159401168882
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.0507541827528841
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   random_strength: 0.1635280109508478
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   bagging_temperature: 0.6036543037871052
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   border_count: 196
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:00,934 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:00,935 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:00,935 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:00,935 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:00,935 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:01,146 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:01,146 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:01,146 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:01,146 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:01,146 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:01,146 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:01,147 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:01,147 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,147 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:01,147 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:01,147 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:01,147 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:01,148 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:01,148 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:01,148 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:01,148 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:01,148 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,148 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:01,149 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:01,149 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:01,149 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:01,149 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:01,149 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,149 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,149 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:01,149 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:01,149 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:01,149 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:01,149 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:01,149 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:01,150 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,150 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,150 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,150 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,150 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:01,150 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:01,150 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:01,150 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:01,150 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:01,150 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:01,150 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:01,150 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:01,150 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:01,150 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:01,150 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:01,150 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:01,150 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:01,151 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:01,151 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:01,151 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:01,151 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,151 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,151 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,151 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,153 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:01,153 - src.hyperparameter_tuning - ERROR - Trial 18 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:01,164 - src.hyperparameter_tuning - INFO - Trial 19: 모델 타입 = catboost
2025-06-24 09:32:01,168 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:01,169 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:01,169 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:01,169 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:01,169 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:01,169 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:01,169 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:01,169 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:01,169 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:01,170 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:01,170 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:01,170 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:01,170 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:01,170 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:01,170 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:01,170 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:01,170 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:01,170 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:01,171 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:01,171 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:01,171 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:01,171 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:01,171 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:01,171 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:01,171 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:01,171 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:01,171 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:01,171 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:01,174 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:01,176 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:01,177 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:01,177 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:01,177 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:01,177 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:01,177 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:01,177 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:01,179 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:01,180 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:01,180 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:01,180 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:01,181 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:01,181 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:01,181 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:01,181 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:01,181 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:01,181 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,181 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,181 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:01,181 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:01,181 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,181 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,181 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:01,181 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:01,181 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,182 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:01,182 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:01,182 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:01,183 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:01,183 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:01,183 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:01,183 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:01,183 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:01,183 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:01,183 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:01,183 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:01,183 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:01,183 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:01,183 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:01,183 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:01,183 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:01,183 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,183 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:01,183 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:01,183 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:01,184 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:01,184 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:01,184 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:01,184 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:01,184 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:01,184 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,184 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:01,184 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,184 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:01,184 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:01,185 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:01,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:01,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:01,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:01,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:01,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:01,186 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:01,186 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:01,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO -   iterations: 173
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO -   learning_rate: 0.053202968028185825
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO -   l2_leaf_reg: 6.626306529057902
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO -   random_strength: 0.44660663318794375
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO -   bagging_temperature: 0.9983545344356272
2025-06-24 09:32:01,186 - src.models.catboost_model - INFO -   border_count: 152
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:01,187 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:01,392 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:01,392 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:01,392 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:01,392 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:01,392 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:01,392 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:01,392 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:01,392 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,392 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:01,393 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:01,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:01,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:01,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:01,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:01,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:01,393 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:01,393 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:01,394 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:01,394 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:01,394 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:01,394 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:01,394 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,394 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,394 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:01,394 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:01,394 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:01,395 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:01,395 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:01,395 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:01,395 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,395 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,395 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,396 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,396 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:01,396 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:01,396 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:01,396 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:01,396 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:01,396 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:01,396 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:01,396 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:01,396 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:01,396 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:01,396 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:01,396 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:01,396 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:01,396 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:01,396 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:01,396 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:01,396 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,396 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,396 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,396 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,398 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:01,398 - src.hyperparameter_tuning - ERROR - Trial 19 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:01,410 - src.hyperparameter_tuning - INFO - Trial 20: 모델 타입 = catboost
2025-06-24 09:32:01,414 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:01,415 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:01,415 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:01,415 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:01,415 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:01,415 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:01,415 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:01,415 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:01,415 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:01,415 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:01,415 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:01,415 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:01,415 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:01,415 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:01,415 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:01,415 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:01,415 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:01,415 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:01,416 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:01,416 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:01,416 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:01,416 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:01,416 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:01,417 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:01,417 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:01,417 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:01,417 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:01,417 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:01,420 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:01,422 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:01,422 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:01,422 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:01,422 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:01,422 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:01,422 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:01,422 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:01,424 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:01,426 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:01,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:01,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:01,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:01,426 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:01,426 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:01,426 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:01,426 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:01,426 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,426 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,427 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:01,427 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:01,427 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,427 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,427 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:01,427 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:01,427 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,428 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:01,428 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:01,428 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:01,428 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:01,428 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:01,428 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:01,428 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:01,428 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:01,428 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:01,429 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:01,429 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:01,429 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:01,429 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:01,429 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:01,429 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:01,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:01,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:01,429 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:01,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:01,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:01,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:01,430 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:01,430 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:01,430 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:01,430 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:01,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:01,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:01,431 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:01,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:01,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:01,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:01,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:01,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:01,431 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:01,431 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,431 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:01,432 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   iterations: 341
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   learning_rate: 0.29697644583724647
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.8811697120743722
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   random_strength: 0.1975268205285391
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   bagging_temperature: 0.44345835043851745
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   border_count: 103
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:01,432 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:01,433 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:01,617 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:01,617 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:01,617 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:01,617 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:01,617 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:01,617 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:01,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:01,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:01,618 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:01,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:01,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:01,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:01,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:01,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:01,619 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:01,619 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:01,620 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:01,620 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:01,620 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:01,620 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:01,620 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,620 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,620 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:01,620 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:01,620 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:01,620 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:01,620 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:01,620 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:01,621 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,621 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,621 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,622 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,622 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:01,622 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:01,622 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:01,622 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:01,622 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:01,622 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:01,622 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:01,622 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:01,622 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:01,622 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:01,622 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:01,622 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:01,622 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:01,622 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:01,622 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:01,622 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:01,622 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,622 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,622 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,622 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,625 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:01,625 - src.hyperparameter_tuning - ERROR - Trial 20 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:01,639 - src.hyperparameter_tuning - INFO - Trial 21: 모델 타입 = catboost
2025-06-24 09:32:01,644 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:01,644 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:01,644 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:01,644 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:01,644 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:01,644 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:01,644 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:01,644 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:01,645 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:01,645 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:01,645 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:01,645 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:01,645 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:01,645 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:01,645 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:01,645 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:01,645 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:01,645 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:01,646 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:01,646 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:01,646 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:01,646 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:01,646 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:01,646 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:01,646 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:01,646 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:01,646 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:01,646 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:01,650 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:01,652 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:01,652 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:01,652 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:01,652 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:01,652 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:01,652 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:01,652 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:01,655 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:01,656 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:01,656 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:01,657 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:01,657 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:01,657 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:01,657 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:01,657 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:01,657 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:01,657 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,657 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,657 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:01,657 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:01,657 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,657 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,657 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:01,657 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:01,657 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,658 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:01,658 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:01,658 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:01,659 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:01,659 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:01,659 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:01,659 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:01,659 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:01,659 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:01,659 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:01,659 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:01,659 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:01,659 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:01,659 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:01,659 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:01,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:01,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:01,659 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:01,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:01,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:01,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:01,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:01,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:01,660 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:01,660 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,661 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:01,661 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,661 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:01,661 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,661 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:01,661 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:01,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:01,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:01,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:01,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:01,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:01,662 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:01,662 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:01,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,662 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:01,662 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,662 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:01,662 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   iterations: 159
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   learning_rate: 0.022504767658397474
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.5764935273350633
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   random_strength: 2.4178530521027257
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   bagging_temperature: 0.32355650305435624
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   border_count: 55
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:01,663 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:01,664 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:01,873 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:01,873 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:01,873 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:01,873 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:01,873 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:01,873 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:01,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:01,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:01,874 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:01,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:01,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:01,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:01,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:01,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:01,875 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:01,875 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,875 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:01,875 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:01,875 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:01,875 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:01,875 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:01,875 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,876 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,876 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:01,876 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:01,876 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:01,876 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:01,876 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:01,876 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:01,876 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,876 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,877 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,877 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:01,877 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:01,877 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:01,877 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:01,877 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:01,877 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:01,877 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:01,877 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:01,877 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:01,877 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:01,877 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:01,877 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:01,877 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:01,877 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:01,877 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:01,877 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:01,877 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:01,877 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,877 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,877 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,877 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,879 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:01,880 - src.hyperparameter_tuning - ERROR - Trial 21 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:01,892 - src.hyperparameter_tuning - INFO - Trial 22: 모델 타입 = catboost
2025-06-24 09:32:01,896 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:01,897 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:01,897 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:01,897 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:01,897 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:01,897 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:01,897 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:01,897 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:01,897 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:01,897 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:01,897 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:01,897 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:01,897 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:01,897 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:01,897 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:01,897 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:01,897 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:01,897 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:01,898 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:01,898 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:01,898 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:01,899 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:01,899 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:01,899 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:01,899 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:01,899 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:01,899 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:01,899 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:01,902 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:01,905 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:01,905 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:01,905 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:01,905 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:01,905 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:01,905 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:01,905 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:01,907 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:01,909 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:01,909 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:01,909 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:01,909 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:01,909 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:01,909 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:01,909 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:01,909 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:01,909 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,909 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,910 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:01,910 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:01,910 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,910 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,910 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:01,910 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:01,910 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,910 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:01,910 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:01,910 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:01,911 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:01,911 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:01,911 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:01,911 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:01,911 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:01,911 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:01,911 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:01,911 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:01,911 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:01,911 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:01,911 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:01,911 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:01,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:01,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:01,912 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:01,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:01,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:01,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:01,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:01,913 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:01,913 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:01,913 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:01,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:01,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:01,914 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:01,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:01,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:01,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:01,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:01,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:01,914 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:01,914 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:01,915 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:01,915 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   iterations: 167
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   learning_rate: 0.032156922069577924
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.683699911999036
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   random_strength: 2.1633628606049036
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   bagging_temperature: 0.38774656822982
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   border_count: 133
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:01,915 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:01,916 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:02,125 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:02,125 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:02,125 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:02,125 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:02,125 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:02,125 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:02,125 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:02,125 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:02,126 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:02,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:02,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:02,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:02,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:02,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:02,127 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:02,127 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,127 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:02,127 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:02,127 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:02,127 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:02,127 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:02,127 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,127 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,127 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:02,127 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:02,128 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:02,128 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:02,128 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:02,128 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:02,128 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,128 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,129 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,129 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,129 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:02,129 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:02,129 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:02,129 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:02,129 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:02,129 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:02,129 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:02,129 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:02,129 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:02,129 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:02,129 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:02,129 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:02,129 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:02,129 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:02,129 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:02,129 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:02,129 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,129 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,129 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,129 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,131 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:02,132 - src.hyperparameter_tuning - ERROR - Trial 22 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:02,144 - src.hyperparameter_tuning - INFO - Trial 23: 모델 타입 = catboost
2025-06-24 09:32:02,148 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:02,148 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:02,148 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:02,148 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:02,148 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:02,148 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:02,148 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:02,148 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:02,148 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:02,149 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:02,149 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:02,149 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:02,149 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:02,149 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:02,149 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:02,149 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:02,149 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:02,149 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:02,150 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:02,150 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:02,150 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:02,150 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:02,150 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:02,150 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:02,150 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:02,150 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:02,150 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:02,150 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:02,154 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:02,156 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:02,156 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:02,156 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:02,156 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:02,156 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:02,156 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:02,156 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:02,158 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:02,160 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:02,160 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:02,160 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:02,160 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:02,160 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:02,160 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:02,160 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:02,160 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:02,160 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,160 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,161 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:02,161 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:02,161 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,161 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,161 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:02,161 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:02,161 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,161 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:02,161 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:02,161 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:02,162 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:02,162 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:02,162 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:02,162 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:02,162 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:02,162 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:02,162 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:02,162 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:02,162 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:02,162 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:02,162 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:02,162 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:02,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:02,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:02,163 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:02,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:02,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:02,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:02,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:02,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:02,164 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:02,164 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:02,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:02,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:02,165 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:02,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:02,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:02,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:02,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:02,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:02,165 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:02,165 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:02,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   iterations: 264
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   learning_rate: 0.020033568197078282
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.536113899347054
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   random_strength: 2.017057673332462
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   bagging_temperature: 0.248351768613523
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   border_count: 103
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:02,166 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:02,167 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:02,377 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:02,377 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:02,377 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:02,377 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:02,377 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:02,377 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:02,377 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:02,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:02,378 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:02,378 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:02,378 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:02,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:02,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:02,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:02,379 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:02,379 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:02,380 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:02,380 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:02,380 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:02,380 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:02,380 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,380 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,380 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:02,380 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:02,380 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:02,380 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:02,380 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:02,380 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:02,381 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,381 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,381 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,381 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,381 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:02,381 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:02,381 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:02,381 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:02,381 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:02,381 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:02,382 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:02,382 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:02,382 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:02,382 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:02,382 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:02,382 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:02,382 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:02,382 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:02,382 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:02,382 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:02,382 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,382 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,382 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,382 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,384 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:02,384 - src.hyperparameter_tuning - ERROR - Trial 23 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:02,396 - src.hyperparameter_tuning - INFO - Trial 24: 모델 타입 = catboost
2025-06-24 09:32:02,400 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:02,401 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:02,401 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:02,401 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:02,401 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:02,401 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:02,401 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:02,401 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:02,401 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:02,402 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:02,402 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:02,402 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:02,402 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:02,402 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:02,402 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:02,402 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:02,402 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:02,402 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:02,403 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:02,403 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:02,403 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:02,403 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:02,403 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:02,403 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:02,403 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:02,403 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:02,403 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:02,403 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:02,407 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:02,409 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:02,409 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:02,409 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:02,409 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:02,409 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:02,409 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:02,409 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:02,411 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:02,412 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:02,412 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:02,413 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:02,413 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:02,413 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:02,413 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:02,413 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:02,413 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:02,413 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,413 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,413 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:02,413 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:02,413 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,413 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,413 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:02,413 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:02,413 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,414 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:02,414 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:02,414 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:02,415 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:02,415 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:02,415 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:02,415 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:02,415 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:02,415 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:02,415 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:02,415 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:02,415 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:02,415 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:02,415 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:02,415 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:02,415 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:02,415 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,415 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:02,416 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:02,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:02,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:02,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:02,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:02,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:02,416 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:02,416 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:02,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:02,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:02,417 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:02,417 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:02,417 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:02,417 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:02,418 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:02,418 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:02,418 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:02,418 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,418 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:02,418 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,418 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:02,418 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,418 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:02,418 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:02,418 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:02,418 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   iterations: 129
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   depth: 7
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   learning_rate: 0.0364551837979755
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.7725021611802665
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   random_strength: 0.4160035578799861
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   bagging_temperature: 0.13902827605757823
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   border_count: 196
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:02,419 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:02,624 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:02,624 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:02,624 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:02,624 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:02,624 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:02,624 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:02,624 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:02,624 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,625 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:02,625 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:02,625 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:02,625 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:02,625 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:02,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:02,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:02,626 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:02,626 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,626 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:02,626 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:02,627 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:02,627 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:02,627 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:02,627 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,627 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,627 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:02,627 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:02,627 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:02,627 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:02,627 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:02,627 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:02,627 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,628 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,628 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,628 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,628 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:02,628 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:02,628 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:02,628 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:02,628 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:02,628 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:02,628 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:02,628 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:02,628 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:02,628 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:02,628 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:02,628 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:02,628 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:02,628 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:02,628 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:02,629 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:02,629 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,629 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,629 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,629 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,631 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:02,631 - src.hyperparameter_tuning - ERROR - Trial 24 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:02,643 - src.hyperparameter_tuning - INFO - Trial 25: 모델 타입 = catboost
2025-06-24 09:32:02,647 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:02,648 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:02,648 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:02,648 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:02,648 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:02,648 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:02,648 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:02,648 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:02,648 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:02,648 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:02,648 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:02,648 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:02,648 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:02,648 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:02,648 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:02,648 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:02,648 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:02,648 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:02,649 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:02,649 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:02,649 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:02,650 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:02,650 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:02,650 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:02,650 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:02,650 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:02,650 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:02,650 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:02,653 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:02,655 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:02,655 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:02,655 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:02,655 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:02,655 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:02,655 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:02,655 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:02,657 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:02,659 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:02,659 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:02,659 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:02,659 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:02,659 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:02,659 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:02,659 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:02,659 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:02,659 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,659 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,660 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:02,660 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:02,660 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,660 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,660 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:02,660 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:02,660 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,661 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:02,661 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:02,661 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:02,661 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:02,661 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:02,661 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:02,662 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:02,662 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:02,662 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:02,662 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:02,662 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:02,662 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:02,662 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:02,662 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:02,662 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:02,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:02,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:02,662 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:02,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:02,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:02,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:02,663 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:02,663 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:02,663 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:02,663 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:02,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:02,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:02,664 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:02,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:02,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:02,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:02,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:02,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:02,664 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:02,664 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:02,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   iterations: 53
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   learning_rate: 0.06782181176718574
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.428206342948866
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   random_strength: 3.3770586827607363
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   bagging_temperature: 0.5245785821833571
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   border_count: 249
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:02,665 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:02,666 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:02,868 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:02,868 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:02,868 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:02,868 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:02,868 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:02,868 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:02,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:02,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:02,869 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:02,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:02,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:02,870 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:02,870 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:02,870 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:02,870 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:02,870 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,870 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:02,871 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:02,871 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:02,871 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:02,871 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:02,871 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,871 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,871 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:02,871 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:02,871 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:02,871 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:02,871 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:02,871 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:02,872 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,872 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,872 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,873 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:02,873 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:02,873 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:02,873 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:02,873 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:02,873 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:02,873 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:02,873 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:02,873 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:02,873 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:02,873 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:02,873 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:02,873 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:02,873 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:02,873 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:02,873 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:02,873 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:02,873 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,873 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,873 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,873 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,875 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:02,876 - src.hyperparameter_tuning - ERROR - Trial 25 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:02,888 - src.hyperparameter_tuning - INFO - Trial 26: 모델 타입 = catboost
2025-06-24 09:32:02,892 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:02,892 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:02,892 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:02,893 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:02,893 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:02,893 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:02,893 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:02,893 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:02,893 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:02,893 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:02,893 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:02,893 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:02,893 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:02,893 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:02,893 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:02,893 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:02,893 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:02,893 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:02,895 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:02,895 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:02,895 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:02,895 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:02,895 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:02,895 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:02,895 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:02,895 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:02,895 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:02,895 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:02,899 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:02,901 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:02,901 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:02,901 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:02,901 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:02,901 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:02,901 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:02,901 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:02,903 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:02,904 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:02,905 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:02,905 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:02,905 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:02,905 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:02,905 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:02,905 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:02,905 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:02,905 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,905 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,905 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:02,905 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:02,905 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,906 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,906 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:02,906 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:02,906 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,906 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:02,906 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:02,906 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:02,907 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:02,907 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:02,907 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:02,907 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:02,907 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:02,907 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:02,907 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:02,907 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:02,907 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:02,907 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:02,907 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:02,907 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:02,907 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:02,907 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:02,908 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:02,908 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:02,908 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:02,908 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:02,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:02,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:02,909 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:02,909 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,909 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:02,909 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,909 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:02,909 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,909 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:02,910 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:02,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:02,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:02,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:02,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:02,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:02,911 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:02,911 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:02,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:02,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,911 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:02,911 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:02,911 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:02,911 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:02,911 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:02,911 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   iterations: 188
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   learning_rate: 0.10217665383542349
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.181098545523033
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   random_strength: 0.683090773549746
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   bagging_temperature: 0.3599296720705299
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   border_count: 61
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:02,912 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:03,109 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:03,109 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:03,109 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:03,109 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:03,109 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:03,109 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:03,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:03,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:03,110 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:03,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:03,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:03,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:03,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:03,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:03,111 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:03,111 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:03,111 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:03,111 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:03,111 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:03,111 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:03,111 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,111 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,111 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:03,111 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:03,112 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:03,112 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:03,112 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:03,112 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:03,112 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,112 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,113 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,113 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,113 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:03,113 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:03,113 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:03,113 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:03,113 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:03,113 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:03,113 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:03,113 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:03,113 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:03,113 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:03,113 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:03,113 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:03,113 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:03,113 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:03,113 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:03,113 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:03,113 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,113 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,113 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,113 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,116 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:03,116 - src.hyperparameter_tuning - ERROR - Trial 26 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:03,128 - src.hyperparameter_tuning - INFO - Trial 27: 모델 타입 = catboost
2025-06-24 09:32:03,132 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:03,133 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:03,133 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:03,133 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:03,133 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:03,133 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:03,133 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:03,133 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:03,133 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:03,134 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:03,134 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:03,134 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:03,134 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:03,134 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:03,134 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:03,134 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:03,134 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:03,134 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:03,135 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:03,135 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:03,135 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:03,135 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:03,135 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:03,135 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:03,135 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:03,135 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:03,135 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:03,135 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:03,139 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:03,142 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:03,142 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:03,142 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:03,142 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:03,142 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:03,142 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:03,142 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:03,144 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:03,146 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:03,146 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:03,146 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:03,146 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:03,146 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:03,146 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:03,146 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:03,146 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:03,146 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,146 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,147 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:03,147 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:03,147 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,147 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,147 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:03,147 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:03,147 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,148 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:03,148 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:03,148 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:03,149 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:03,149 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:03,149 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:03,149 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:03,149 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:03,149 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:03,149 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:03,149 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:03,149 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:03,149 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:03,149 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:03,149 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:03,149 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:03,149 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,149 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:03,149 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:03,150 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:03,150 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:03,150 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:03,150 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:03,150 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:03,150 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:03,150 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,150 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:03,150 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,150 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:03,150 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:03,151 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:03,151 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:03,151 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:03,151 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:03,151 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:03,151 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:03,152 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:03,152 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,152 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:03,152 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO -   iterations: 295
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO -   learning_rate: 0.16149524072351598
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO -   l2_leaf_reg: 5.7350814380199795
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO -   random_strength: 1.3799865512698966
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO -   bagging_temperature: 0.24115705936722487
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO -   border_count: 91
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:03,152 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:03,153 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:03,341 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:03,341 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:03,341 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:03,341 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:03,341 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:03,341 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:03,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:03,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:03,342 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:03,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:03,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:03,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:03,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:03,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:03,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:03,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:03,344 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:03,344 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:03,344 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:03,344 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:03,344 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,344 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,344 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:03,344 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:03,344 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:03,344 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:03,344 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:03,344 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:03,345 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,345 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,345 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,346 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,346 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:03,346 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:03,346 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:03,346 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:03,346 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:03,346 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:03,346 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:03,346 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:03,346 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:03,346 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:03,346 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:03,346 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:03,346 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:03,346 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:03,346 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:03,346 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:03,346 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,346 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,346 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,346 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,348 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:03,348 - src.hyperparameter_tuning - ERROR - Trial 27 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:03,361 - src.hyperparameter_tuning - INFO - Trial 28: 모델 타입 = catboost
2025-06-24 09:32:03,365 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:03,365 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:03,365 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:03,365 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:03,365 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:03,365 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:03,365 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:03,365 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:03,365 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:03,366 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:03,366 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:03,366 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:03,366 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:03,366 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:03,366 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:03,366 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:03,366 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:03,366 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:03,367 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:03,367 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:03,367 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:03,367 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:03,367 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:03,367 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:03,367 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:03,367 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:03,367 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:03,367 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:03,371 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:03,373 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:03,373 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:03,373 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:03,373 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:03,373 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:03,373 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:03,373 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:03,375 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:03,377 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:03,377 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:03,377 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:03,377 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:03,377 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:03,377 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:03,377 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:03,377 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:03,377 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,377 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,378 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:03,378 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:03,378 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,378 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,378 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:03,378 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:03,378 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,378 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:03,378 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:03,378 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:03,379 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:03,379 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:03,379 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:03,379 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:03,379 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:03,379 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:03,379 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:03,379 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:03,379 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:03,379 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:03,379 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:03,379 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:03,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:03,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,380 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:03,380 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:03,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:03,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:03,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:03,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:03,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:03,381 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:03,381 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:03,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:03,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:03,381 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:03,381 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:03,381 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:03,382 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:03,382 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:03,382 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:03,382 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:03,382 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:03,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,382 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:03,382 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,382 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:03,382 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:03,382 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   iterations: 235
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   learning_rate: 0.049247604089672284
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.883193521787007
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   random_strength: 0.10993730876801601
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   bagging_temperature: 0.6780408609934784
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   border_count: 147
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:03,383 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:03,384 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:03,384 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:03,384 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:03,384 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:03,552 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:03,552 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:03,552 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:03,552 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:03,552 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:03,552 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:03,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:03,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:03,553 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:03,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:03,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:03,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:03,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:03,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:03,554 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:03,554 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,554 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:03,554 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:03,554 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:03,554 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:03,554 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:03,554 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,554 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,554 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:03,554 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:03,555 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:03,555 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:03,555 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:03,555 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:03,555 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,555 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,556 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,556 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,556 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:03,556 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:03,556 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:03,556 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:03,556 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:03,556 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:03,556 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:03,556 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:03,556 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:03,556 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:03,556 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:03,556 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:03,556 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:03,556 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:03,556 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:03,556 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:03,556 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,556 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,556 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,556 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,559 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:03,559 - src.hyperparameter_tuning - ERROR - Trial 28 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:03,573 - src.hyperparameter_tuning - INFO - Trial 29: 모델 타입 = catboost
2025-06-24 09:32:03,577 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:03,578 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:03,578 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:03,578 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:03,578 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:03,578 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:03,578 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:03,578 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:03,578 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:03,579 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:03,579 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:03,579 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:03,579 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:03,579 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:03,579 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:03,579 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:03,579 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:03,579 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:03,580 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:03,580 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:03,580 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:03,580 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:03,580 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:03,580 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:03,580 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:03,580 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:03,580 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:03,580 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:03,584 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:03,586 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:03,586 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:03,586 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:03,586 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:03,586 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:03,586 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:03,586 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:03,588 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:03,590 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:03,590 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:03,591 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:03,591 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:03,591 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:03,591 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:03,591 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:03,591 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:03,591 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,591 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,591 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:03,591 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:03,591 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,591 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,591 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:03,591 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:03,591 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,592 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:03,592 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:03,592 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:03,593 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:03,593 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:03,593 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:03,593 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:03,593 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:03,593 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:03,593 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:03,593 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:03,593 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:03,593 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:03,593 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:03,593 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:03,593 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:03,593 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,594 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:03,594 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:03,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:03,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:03,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:03,595 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:03,595 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:03,595 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:03,595 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,595 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:03,595 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,595 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:03,595 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,596 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:03,596 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:03,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:03,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:03,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:03,597 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:03,597 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:03,597 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:03,597 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,597 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:03,597 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,597 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:03,597 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,597 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:03,597 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:03,597 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   iterations: 124
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   learning_rate: 0.03012786909270733
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.474793678506975
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   random_strength: 0.8361419971766108
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   bagging_temperature: 0.3026518255288541
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   border_count: 219
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:03,598 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:03,599 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:03,783 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:03,783 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:03,783 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:03,783 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:03,783 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:03,783 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:03,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:03,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:03,784 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:03,784 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:03,784 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:03,784 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:03,784 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:03,784 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:03,784 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:03,784 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:03,785 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:03,785 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:03,785 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:03,785 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:03,785 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,785 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,785 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:03,785 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:03,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:03,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:03,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:03,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:03,786 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,786 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,786 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,787 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:03,787 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:03,787 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:03,787 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:03,787 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:03,787 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:03,787 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:03,787 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:03,787 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:03,787 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:03,787 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:03,787 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:03,787 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:03,787 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:03,787 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:03,787 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:03,787 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:03,787 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,787 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,787 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,787 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,789 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:03,789 - src.hyperparameter_tuning - ERROR - Trial 29 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:03,802 - src.hyperparameter_tuning - INFO - Trial 30: 모델 타입 = catboost
2025-06-24 09:32:03,807 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:03,807 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:03,807 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:03,807 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:03,807 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:03,807 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:03,807 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:03,807 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:03,807 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:03,808 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:03,808 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:03,808 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:03,808 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:03,808 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:03,808 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:03,808 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:03,808 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:03,808 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:03,809 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:03,809 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:03,809 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:03,809 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:03,809 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:03,809 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:03,809 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:03,809 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:03,809 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:03,809 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:03,813 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:03,815 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:03,815 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:03,815 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:03,815 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:03,815 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:03,815 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:03,815 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:03,817 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:03,819 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:03,819 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:03,819 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:03,819 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:03,819 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:03,819 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:03,819 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:03,819 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:03,819 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,819 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,820 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:03,820 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:03,820 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,820 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,820 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:03,820 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:03,820 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,821 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:03,821 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:03,821 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:03,821 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:03,821 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:03,821 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:03,821 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:03,821 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:03,822 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:03,822 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:03,822 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:03,822 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:03,822 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:03,822 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:03,822 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:03,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:03,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:03,822 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:03,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:03,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:03,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:03,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:03,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:03,823 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:03,823 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:03,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:03,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:03,824 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:03,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:03,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:03,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:03,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:03,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:03,824 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:03,824 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:03,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:03,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   iterations: 91
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   learning_rate: 0.017608367955403596
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.0461088070794076
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   random_strength: 1.5915803943138997
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   bagging_temperature: 0.40347660744242353
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   border_count: 185
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:03,825 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:03,826 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:04,009 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:04,009 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:04,009 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:04,009 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:04,009 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:04,009 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:04,009 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:04,009 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,009 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:04,009 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:04,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:04,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:04,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:04,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:04,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:04,010 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:04,010 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,010 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:04,011 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:04,011 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:04,011 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:04,011 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:04,011 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,011 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,011 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:04,011 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:04,011 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:04,011 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:04,011 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:04,011 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:04,012 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,012 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,012 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,013 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,013 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:04,013 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:04,013 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:04,013 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:04,013 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:04,013 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:04,013 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:04,013 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:04,013 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:04,013 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:04,013 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:04,013 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:04,013 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:04,013 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:04,013 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:04,013 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:04,013 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,013 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,013 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,013 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,015 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:04,015 - src.hyperparameter_tuning - ERROR - Trial 30 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:04,028 - src.hyperparameter_tuning - INFO - Trial 31: 모델 타입 = catboost
2025-06-24 09:32:04,032 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:04,033 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:04,033 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:04,033 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:04,033 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:04,033 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:04,033 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:04,033 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:04,033 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:04,033 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:04,033 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:04,033 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:04,033 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:04,033 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:04,033 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:04,033 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:04,033 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:04,033 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:04,034 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:04,034 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:04,034 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:04,034 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:04,034 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:04,035 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:04,035 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:04,035 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:04,035 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:04,035 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:04,038 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:04,040 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:04,040 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:04,040 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:04,040 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:04,040 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:04,040 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:04,040 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:04,042 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:04,044 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:04,044 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:04,044 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:04,044 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:04,044 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:04,044 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:04,044 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:04,044 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:04,044 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,044 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,045 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:04,045 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:04,045 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,045 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,045 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:04,045 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:04,045 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,046 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:04,046 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:04,046 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:04,046 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:04,046 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:04,047 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:04,047 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:04,047 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:04,047 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:04,047 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:04,047 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:04,047 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:04,047 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:04,047 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:04,047 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:04,047 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:04,047 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,047 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:04,047 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:04,047 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:04,047 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:04,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:04,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:04,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:04,048 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:04,048 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:04,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:04,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:04,049 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:04,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:04,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:04,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:04,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:04,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:04,049 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:04,049 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,050 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:04,050 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO -   iterations: 102
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO -   learning_rate: 0.04003095698566738
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.239510870451076
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO -   random_strength: 0.824165300094786
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO -   bagging_temperature: 0.27940190463075765
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO -   border_count: 226
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:04,050 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:04,051 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:04,233 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:04,233 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:04,233 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:04,233 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:04,233 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:04,233 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:04,233 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:04,233 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,233 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:04,234 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:04,234 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:04,234 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:04,234 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:04,234 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:04,234 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:04,234 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:04,234 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,234 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:04,235 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:04,235 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:04,235 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:04,235 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:04,235 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,235 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,235 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:04,235 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:04,235 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:04,235 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:04,236 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:04,236 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:04,236 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,236 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,236 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,237 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,237 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:04,237 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:04,237 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:04,237 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:04,237 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:04,237 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:04,237 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:04,237 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:04,237 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:04,237 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:04,237 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:04,237 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:04,237 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:04,237 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:04,237 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:04,237 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:04,237 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,237 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,237 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,237 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,239 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:04,239 - src.hyperparameter_tuning - ERROR - Trial 31 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:04,252 - src.hyperparameter_tuning - INFO - Trial 32: 모델 타입 = catboost
2025-06-24 09:32:04,256 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:04,257 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:04,257 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:04,257 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:04,257 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:04,257 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:04,257 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:04,257 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:04,257 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:04,257 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:04,257 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:04,257 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:04,257 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:04,258 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:04,258 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:04,258 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:04,258 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:04,258 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:04,258 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:04,259 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:04,259 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:04,259 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:04,259 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:04,259 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:04,259 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:04,259 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:04,259 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:04,259 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:04,262 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:04,264 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:04,264 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:04,264 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:04,264 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:04,264 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:04,264 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:04,264 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:04,266 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:04,268 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:04,268 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:04,268 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:04,268 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:04,268 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:04,268 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:04,269 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:04,269 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:04,269 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,269 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,269 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:04,269 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:04,269 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,269 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,269 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:04,269 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:04,269 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,270 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:04,270 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:04,270 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:04,271 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:04,271 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:04,271 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:04,271 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:04,271 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:04,271 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:04,271 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:04,271 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:04,271 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:04,271 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:04,271 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:04,271 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:04,271 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:04,271 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,271 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:04,271 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:04,271 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:04,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:04,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:04,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:04,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:04,272 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:04,272 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,272 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:04,272 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,272 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:04,272 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,273 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:04,273 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:04,273 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:04,273 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:04,273 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:04,273 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:04,273 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:04,274 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:04,274 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:04,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO -   iterations: 150
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO -   learning_rate: 0.07089439432338407
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.3394718854855523
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:04,274 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   random_strength: 1.184212449164789
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   bagging_temperature: 0.24875494556358774
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   border_count: 237
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:04,275 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:04,457 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:04,458 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:04,458 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:04,458 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:04,458 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:04,458 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:04,458 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:04,458 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,458 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:04,458 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:04,458 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:04,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:04,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:04,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:04,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:04,459 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:04,459 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,459 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:04,460 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:04,460 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:04,460 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:04,460 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:04,460 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,460 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,460 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:04,460 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:04,460 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:04,460 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:04,461 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:04,461 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:04,461 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,461 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,461 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,462 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,462 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:04,462 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:04,462 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:04,462 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:04,462 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:04,462 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:04,462 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:04,462 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:04,462 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:04,462 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:04,462 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:04,462 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:04,462 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:04,462 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:04,462 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:04,462 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:04,462 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,462 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,462 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,462 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,465 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:04,465 - src.hyperparameter_tuning - ERROR - Trial 32 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:04,478 - src.hyperparameter_tuning - INFO - Trial 33: 모델 타입 = catboost
2025-06-24 09:32:04,482 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:04,483 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:04,483 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:04,483 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:04,483 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:04,483 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:04,483 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:04,483 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:04,483 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:04,484 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:04,484 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:04,484 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:04,484 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:04,484 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:04,484 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:04,484 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:04,484 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:04,484 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:04,485 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:04,485 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:04,485 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:04,485 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:04,485 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:04,485 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:04,485 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:04,485 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:04,485 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:04,485 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:04,488 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:04,491 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:04,491 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:04,491 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:04,491 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:04,491 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:04,491 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:04,491 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:04,493 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:04,495 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:04,495 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:04,495 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:04,495 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:04,495 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:04,495 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:04,495 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:04,495 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:04,495 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,495 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,495 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:04,495 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:04,495 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,495 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,496 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:04,496 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:04,496 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,496 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:04,496 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:04,496 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:04,497 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:04,497 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:04,497 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:04,497 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:04,497 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:04,497 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:04,497 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:04,497 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:04,497 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:04,497 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:04,497 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:04,497 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:04,497 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:04,497 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,497 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:04,498 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:04,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:04,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:04,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:04,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:04,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:04,499 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:04,499 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:04,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:04,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:04,499 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:04,499 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:04,499 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:04,500 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:04,500 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:04,500 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:04,500 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:04,500 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,500 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:04,500 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,500 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:04,500 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,500 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:04,500 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:04,500 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   iterations: 190
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   learning_rate: 0.028700027342638906
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.7255422322239637
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   random_strength: 0.22647910751813097
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   bagging_temperature: 0.181612784750266
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   border_count: 120
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:04,501 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:04,502 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:04,671 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:04,671 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:04,671 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:04,671 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:04,671 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:04,671 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:04,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:04,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:04,671 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:04,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:04,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:04,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:04,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:04,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:04,672 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:04,672 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,672 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:04,673 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:04,673 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:04,673 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:04,673 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:04,673 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,673 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,673 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:04,673 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:04,673 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:04,673 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:04,673 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:04,674 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:04,674 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,674 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,674 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,674 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,675 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:04,675 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:04,675 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:04,675 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:04,675 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:04,675 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:04,675 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:04,675 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:04,675 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:04,675 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:04,675 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:04,675 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:04,675 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:04,675 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:04,675 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:04,675 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:04,675 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,675 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,675 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,675 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,677 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:04,677 - src.hyperparameter_tuning - ERROR - Trial 33 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:04,691 - src.hyperparameter_tuning - INFO - Trial 34: 모델 타입 = catboost
2025-06-24 09:32:04,695 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:04,696 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:04,696 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:04,696 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:04,696 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:04,696 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:04,696 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:04,696 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:04,696 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:04,697 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:04,697 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:04,697 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:04,697 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:04,697 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:04,697 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:04,697 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:04,697 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:04,697 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:04,698 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:04,698 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:04,698 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:04,698 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:04,698 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:04,698 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:04,698 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:04,698 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:04,698 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:04,698 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:04,702 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:04,704 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:04,704 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:04,704 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:04,704 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:04,704 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:04,704 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:04,704 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:04,706 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:04,708 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:04,708 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:04,708 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:04,708 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:04,708 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:04,708 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:04,708 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:04,708 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:04,708 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,708 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,709 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:04,709 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:04,709 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,709 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,709 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:04,709 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:04,709 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,710 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:04,710 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:04,710 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:04,710 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:04,711 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:04,711 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:04,711 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:04,711 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:04,711 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:04,711 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:04,711 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:04,711 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:04,711 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:04,711 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:04,711 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:04,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:04,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:04,711 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:04,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:04,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:04,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:04,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:04,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:04,712 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:04,712 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,712 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:04,712 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,712 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:04,712 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:04,713 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:04,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:04,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:04,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:04,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:04,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:04,714 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:04,714 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:04,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,714 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:04,714 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,714 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:04,714 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:04,714 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:04,714 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   iterations: 322
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   learning_rate: 0.03915576949160284
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.838337943090178
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   random_strength: 0.38226540044619517
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   bagging_temperature: 0.5309965144549018
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   border_count: 212
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:04,715 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:04,716 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:04,898 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:04,898 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:04,899 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:04,899 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:04,899 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:04,899 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:04,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:04,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:04,899 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:04,899 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:04,899 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:04,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:04,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:04,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:04,900 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:04,900 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:04,901 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:04,901 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:04,901 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:04,901 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:04,901 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,901 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,901 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:04,901 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:04,901 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:04,901 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:04,901 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:04,901 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:04,902 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,902 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,902 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,902 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:04,902 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:04,903 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:04,903 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:04,903 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:04,903 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:04,903 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:04,903 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:04,903 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:04,903 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:04,903 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:04,903 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:04,903 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:04,903 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:04,903 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:04,903 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:04,903 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:04,903 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,903 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,903 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,903 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,905 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:04,905 - src.hyperparameter_tuning - ERROR - Trial 34 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:04,919 - src.hyperparameter_tuning - INFO - Trial 35: 모델 타입 = catboost
2025-06-24 09:32:04,923 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:04,924 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:04,924 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:04,924 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:04,924 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:04,924 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:04,924 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:04,924 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:04,924 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:04,924 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:04,924 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:04,924 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:04,924 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:04,924 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:04,925 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:04,925 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:04,925 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:04,925 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:04,926 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:04,926 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:04,926 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:04,926 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:04,926 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:04,926 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:04,926 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:04,926 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:04,926 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:04,926 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:04,930 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:04,932 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:04,932 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:04,932 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:04,932 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:04,932 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:04,932 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:04,932 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:04,934 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:04,936 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:04,936 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:04,936 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:04,936 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:04,936 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:04,936 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:04,936 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:04,936 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:04,936 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,936 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,937 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:04,937 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:04,937 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,937 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,937 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:04,937 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:04,937 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,937 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:04,937 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:04,937 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:04,938 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:04,938 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:04,938 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:04,938 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:04,938 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:04,938 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:04,938 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:04,938 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:04,938 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:04,938 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:04,938 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:04,938 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:04,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:04,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:04,939 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:04,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:04,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:04,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:04,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:04,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:04,940 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:04,940 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,940 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:04,940 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,940 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:04,940 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,940 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:04,940 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:04,940 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:04,941 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:04,941 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:04,941 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:04,941 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:04,941 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:04,941 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:04,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:04,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,941 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:04,941 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   iterations: 78
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   learning_rate: 0.025983028514952534
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.2001923814862734
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   random_strength: 4.041030232077091
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   bagging_temperature: 0.21290275750904167
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   border_count: 195
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:04,942 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:04,943 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:05,125 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:05,125 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:05,125 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:05,125 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:05,125 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:05,125 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:05,125 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:05,125 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,125 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:05,126 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:05,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:05,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:05,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:05,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:05,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:05,126 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:05,126 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,127 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:05,127 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:05,127 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:05,127 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:05,127 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:05,127 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,127 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,127 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:05,127 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:05,127 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:05,128 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:05,128 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:05,128 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:05,128 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,128 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,128 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,129 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,129 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:05,129 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:05,129 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:05,129 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:05,129 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:05,129 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:05,129 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:05,129 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:05,129 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:05,129 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:05,129 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:05,129 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:05,129 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:05,129 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:05,129 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:05,129 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:05,129 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,129 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,129 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,129 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,131 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:05,131 - src.hyperparameter_tuning - ERROR - Trial 35 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:05,144 - src.hyperparameter_tuning - INFO - Trial 36: 모델 타입 = catboost
2025-06-24 09:32:05,148 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:05,149 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:05,149 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:05,149 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:05,149 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:05,149 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:05,149 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:05,149 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:05,149 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:05,150 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:05,150 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:05,150 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:05,150 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:05,150 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:05,150 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:05,150 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:05,150 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:05,150 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:05,151 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:05,151 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:05,151 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:05,151 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:05,151 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:05,151 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:05,151 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:05,151 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:05,151 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:05,151 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:05,155 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:05,157 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:05,157 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:05,157 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:05,157 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:05,157 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:05,157 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:05,157 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:05,159 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:05,161 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:05,161 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:05,161 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:05,161 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:05,161 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:05,161 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:05,161 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:05,161 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:05,161 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,161 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,162 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:05,162 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:05,162 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,162 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,162 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:05,162 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:05,162 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,163 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:05,163 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:05,163 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:05,164 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:05,164 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:05,164 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:05,164 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:05,164 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:05,164 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:05,164 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:05,164 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:05,164 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:05,164 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:05,164 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:05,164 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:05,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:05,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:05,164 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:05,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:05,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:05,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:05,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:05,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:05,165 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:05,165 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:05,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:05,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,166 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:05,166 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:05,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:05,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:05,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:05,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:05,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:05,166 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:05,166 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:05,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO -   iterations: 106
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO -   learning_rate: 0.015358609551550979
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.7015357212722606
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO -   random_strength: 0.9205993460515823
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO -   bagging_temperature: 0.41577021125776964
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO -   border_count: 235
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:05,167 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:05,168 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:05,354 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:05,354 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:05,354 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:05,354 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:05,354 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:05,354 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:05,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:05,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,355 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:05,355 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:05,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:05,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:05,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:05,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:05,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:05,356 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:05,356 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,356 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:05,356 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:05,356 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:05,356 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:05,356 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:05,356 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,356 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,356 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:05,356 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:05,357 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:05,357 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:05,357 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:05,357 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:05,357 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,357 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,357 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,358 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,358 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:05,358 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:05,358 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:05,358 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:05,358 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:05,358 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:05,358 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:05,358 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:05,358 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:05,358 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:05,358 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:05,358 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:05,358 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:05,358 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:05,358 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:05,358 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:05,358 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,358 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,358 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,358 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,360 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:05,360 - src.hyperparameter_tuning - ERROR - Trial 36 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:05,374 - src.hyperparameter_tuning - INFO - Trial 37: 모델 타입 = catboost
2025-06-24 09:32:05,377 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:05,378 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:05,378 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:05,378 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:05,378 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:05,378 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:05,378 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:05,378 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:05,378 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:05,379 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:05,379 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:05,379 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:05,379 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:05,379 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:05,379 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:05,379 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:05,379 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:05,379 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:05,380 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:05,380 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:05,380 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:05,380 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:05,380 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:05,380 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:05,380 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:05,380 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:05,380 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:05,380 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:05,383 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:05,386 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:05,386 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:05,386 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:05,386 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:05,386 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:05,386 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:05,386 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:05,388 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:05,390 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:05,390 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:05,390 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:05,390 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:05,390 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:05,390 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:05,390 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:05,390 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:05,390 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,390 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,391 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:05,391 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:05,391 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,391 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,391 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:05,391 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:05,391 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,391 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:05,391 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:05,391 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:05,392 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:05,392 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:05,392 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:05,392 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:05,392 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:05,392 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:05,392 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:05,392 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:05,392 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:05,392 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:05,392 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:05,392 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:05,392 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:05,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:05,393 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:05,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:05,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:05,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:05,394 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:05,394 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:05,394 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:05,394 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:05,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:05,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:05,394 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:05,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:05,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:05,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:05,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:05,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:05,395 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:05,395 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:05,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   iterations: 425
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   learning_rate: 0.010900709612868577
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.074161877319149
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   random_strength: 0.1392323924920776
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   bagging_temperature: 0.3456068201833362
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   border_count: 130
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:05,396 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:05,397 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:05,580 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:05,580 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:05,580 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:05,580 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:05,580 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:05,580 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:05,580 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:05,580 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,580 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:05,580 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:05,580 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:05,581 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:05,581 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:05,581 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:05,581 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:05,581 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:05,581 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,581 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:05,582 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:05,582 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:05,582 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:05,582 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:05,582 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,582 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,582 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:05,582 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:05,582 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:05,582 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:05,582 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:05,582 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:05,583 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,583 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,583 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,583 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,583 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:05,583 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:05,583 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:05,583 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:05,583 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:05,584 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:05,584 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:05,584 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:05,584 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:05,584 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:05,584 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:05,584 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:05,584 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:05,584 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:05,584 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:05,584 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:05,584 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,584 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,584 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,584 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,586 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:05,586 - src.hyperparameter_tuning - ERROR - Trial 37 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:05,599 - src.hyperparameter_tuning - INFO - Trial 38: 모델 타입 = catboost
2025-06-24 09:32:05,603 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:05,604 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:05,604 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:05,604 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:05,604 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:05,604 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:05,604 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:05,604 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:05,604 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:05,604 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:05,604 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:05,604 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:05,604 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:05,605 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:05,605 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:05,605 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:05,605 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:05,605 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:05,605 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:05,606 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:05,606 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:05,606 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:05,606 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:05,606 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:05,606 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:05,606 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:05,606 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:05,606 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:05,609 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:05,611 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:05,611 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:05,611 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:05,611 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:05,611 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:05,611 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:05,611 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:05,613 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:05,615 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:05,615 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:05,615 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:05,615 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:05,615 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:05,615 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:05,615 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:05,615 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:05,616 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,616 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,616 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:05,616 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:05,616 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,616 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,616 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:05,616 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:05,616 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,617 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:05,617 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:05,617 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:05,618 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:05,618 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:05,618 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:05,618 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:05,618 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:05,618 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:05,618 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:05,618 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:05,618 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:05,618 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:05,618 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:05,618 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:05,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:05,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:05,618 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:05,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:05,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:05,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:05,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:05,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:05,619 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:05,619 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:05,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:05,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,620 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:05,620 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:05,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:05,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:05,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:05,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:05,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:05,620 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:05,620 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,621 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:05,621 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO -   iterations: 138
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO -   learning_rate: 0.08208111414122299
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.1449986479763594
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO -   random_strength: 2.863306598404364
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO -   bagging_temperature: 0.49152502467868175
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO -   border_count: 34
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:05,621 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:05,622 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:05,804 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:05,804 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:05,804 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:05,804 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:05,804 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:05,804 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:05,804 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:05,804 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,805 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:05,805 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:05,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:05,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:05,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:05,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:05,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:05,806 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:05,806 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:05,806 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:05,807 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:05,807 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:05,807 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:05,807 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,807 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,807 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:05,807 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:05,807 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:05,807 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:05,807 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:05,807 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:05,807 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,808 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,808 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,808 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:05,808 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:05,808 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:05,808 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:05,808 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:05,808 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:05,808 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:05,808 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:05,808 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:05,808 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:05,808 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:05,808 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:05,808 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:05,808 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:05,808 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:05,808 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:05,808 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:05,808 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,808 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,809 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,809 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,811 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:05,811 - src.hyperparameter_tuning - ERROR - Trial 38 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:05,824 - src.hyperparameter_tuning - INFO - Trial 39: 모델 타입 = catboost
2025-06-24 09:32:05,828 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:05,829 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:05,829 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:05,829 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:05,829 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:05,829 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:05,829 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:05,829 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:05,829 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:05,830 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:05,830 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:05,830 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:05,830 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:05,830 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:05,830 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:05,830 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:05,830 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:05,830 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:05,831 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:05,831 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:05,831 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:05,831 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:05,831 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:05,831 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:05,831 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:05,831 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:05,831 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:05,831 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:05,835 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:05,837 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:05,837 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:05,837 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:05,837 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:05,837 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:05,837 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:05,837 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:05,839 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:05,841 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:05,841 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:05,841 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:05,841 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:05,841 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:05,841 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:05,841 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:05,841 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:05,841 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,841 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,842 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:05,842 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:05,842 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,842 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,842 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:05,842 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:05,842 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,842 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:05,842 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:05,842 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:05,843 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:05,843 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:05,843 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:05,843 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:05,843 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:05,843 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:05,843 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:05,843 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:05,843 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:05,843 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:05,843 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:05,843 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:05,843 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:05,843 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,844 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:05,844 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:05,844 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:05,844 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:05,844 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:05,844 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:05,844 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:05,845 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:05,845 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:05,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:05,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:05,845 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:05,845 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:05,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:05,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:05,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:05,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:05,846 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:05,846 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:05,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:05,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,846 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:05,846 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:05,846 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   iterations: 398
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   depth: 7
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   learning_rate: 0.22340131296482119
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   l2_leaf_reg: 9.751401558116617
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   random_strength: 6.994379538319024
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   bagging_temperature: 0.6119450643336962
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   border_count: 245
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:05,847 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:05,848 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:06,031 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:06,031 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:06,031 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:06,031 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:06,031 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:06,031 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:06,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:06,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:06,031 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:06,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:06,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:06,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:06,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:06,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:06,032 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:06,032 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,032 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:06,033 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:06,033 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:06,033 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:06,033 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:06,033 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,033 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,033 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:06,033 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:06,033 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:06,033 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:06,034 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:06,034 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:06,034 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,034 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,034 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,035 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,035 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:06,035 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:06,035 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:06,035 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:06,035 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:06,035 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:06,035 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:06,035 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:06,035 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:06,035 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:06,035 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:06,035 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:06,035 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:06,035 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:06,035 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:06,035 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:06,035 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,035 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,035 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,035 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,037 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:06,038 - src.hyperparameter_tuning - ERROR - Trial 39 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:06,051 - src.hyperparameter_tuning - INFO - Trial 40: 모델 타입 = catboost
2025-06-24 09:32:06,055 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:06,056 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:06,056 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:06,056 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:06,056 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:06,056 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:06,056 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:06,056 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:06,056 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:06,057 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:06,057 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:06,057 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:06,057 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:06,057 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:06,057 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:06,057 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:06,057 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:06,057 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:06,058 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:06,058 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:06,058 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:06,058 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:06,058 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:06,058 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:06,058 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:06,058 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:06,058 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:06,058 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:06,062 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:06,064 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:06,064 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:06,064 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:06,064 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:06,064 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:06,064 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:06,064 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:06,066 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:06,068 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:06,068 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:06,068 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:06,069 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:06,069 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:06,069 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:06,069 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:06,069 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:06,069 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,069 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,069 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:06,069 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:06,069 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,069 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,069 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:06,069 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:06,069 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,070 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:06,070 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:06,070 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:06,071 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:06,071 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:06,071 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:06,071 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:06,071 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:06,071 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:06,071 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:06,071 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:06,071 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:06,071 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:06,071 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:06,071 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:06,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:06,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:06,072 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:06,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:06,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:06,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:06,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:06,073 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:06,073 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:06,073 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,073 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:06,073 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,073 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:06,073 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,073 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:06,074 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:06,074 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:06,074 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:06,074 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:06,074 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:06,074 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:06,075 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:06,075 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,075 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:06,075 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,075 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:06,075 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,075 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:06,075 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:06,075 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:06,075 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   iterations: 459
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   learning_rate: 0.060566236415982876
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.7668918737672525
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   random_strength: 1.6750084904010554
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   bagging_temperature: 0.8745468117335569
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   border_count: 159
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:06,076 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:06,077 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:06,268 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:06,268 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:06,268 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:06,268 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:06,268 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:06,268 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:06,268 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:06,268 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,268 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:06,268 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:06,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:06,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:06,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:06,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:06,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:06,269 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:06,269 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,269 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:06,270 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:06,270 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:06,270 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:06,270 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:06,270 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,270 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,270 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:06,270 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:06,270 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:06,270 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:06,270 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:06,270 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:06,271 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,271 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,271 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,271 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,272 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:06,272 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:06,272 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:06,272 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:06,272 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:06,272 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:06,272 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:06,272 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:06,272 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:06,272 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:06,272 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:06,272 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:06,272 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:06,272 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:06,272 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:06,272 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:06,272 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,272 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,272 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,272 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,275 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:06,275 - src.hyperparameter_tuning - ERROR - Trial 40 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:06,289 - src.hyperparameter_tuning - INFO - Trial 41: 모델 타입 = catboost
2025-06-24 09:32:06,293 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:06,294 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:06,294 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:06,294 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:06,294 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:06,294 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:06,294 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:06,294 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:06,294 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:06,295 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:06,295 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:06,295 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:06,295 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:06,295 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:06,295 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:06,295 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:06,295 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:06,295 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:06,296 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:06,296 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:06,296 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:06,296 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:06,296 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:06,296 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:06,296 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:06,296 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:06,296 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:06,296 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:06,300 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:06,302 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:06,302 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:06,302 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:06,302 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:06,302 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:06,302 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:06,302 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:06,304 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:06,306 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:06,306 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:06,306 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:06,306 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:06,306 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:06,306 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:06,306 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:06,306 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:06,306 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,306 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,307 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:06,307 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:06,307 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,307 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,307 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:06,307 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:06,307 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,307 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:06,307 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:06,307 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:06,308 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:06,308 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:06,308 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:06,308 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:06,308 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:06,308 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:06,308 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:06,308 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:06,308 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:06,308 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:06,308 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:06,308 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:06,308 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:06,308 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,309 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:06,309 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:06,309 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:06,309 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:06,309 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:06,309 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:06,309 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:06,310 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:06,310 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:06,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:06,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:06,310 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:06,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:06,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:06,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:06,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:06,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:06,311 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:06,311 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:06,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,311 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:06,311 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   iterations: 365
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   learning_rate: 0.13066261709902915
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.203205616849172
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   random_strength: 5.263820110984334
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   bagging_temperature: 0.990254074978382
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   border_count: 44
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:06,312 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:06,313 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:06,501 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:06,501 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:06,501 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:06,501 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:06,501 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:06,501 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:06,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:06,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:06,501 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:06,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:06,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:06,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:06,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:06,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:06,502 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:06,502 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:06,503 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:06,503 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:06,503 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:06,503 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:06,503 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,503 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,503 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:06,503 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:06,503 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:06,503 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:06,503 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:06,503 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:06,504 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,504 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,504 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,504 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,505 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:06,505 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:06,505 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:06,505 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:06,505 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:06,505 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:06,505 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:06,505 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:06,505 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:06,505 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:06,505 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:06,505 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:06,505 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:06,505 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:06,505 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:06,505 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:06,505 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,505 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,505 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,505 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,507 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:06,507 - src.hyperparameter_tuning - ERROR - Trial 41 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:06,522 - src.hyperparameter_tuning - INFO - Trial 42: 모델 타입 = catboost
2025-06-24 09:32:06,525 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:06,526 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:06,526 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:06,526 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:06,526 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:06,526 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:06,526 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:06,526 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:06,526 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:06,527 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:06,527 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:06,527 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:06,527 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:06,527 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:06,527 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:06,527 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:06,527 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:06,527 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:06,528 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:06,528 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:06,528 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:06,528 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:06,528 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:06,528 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:06,528 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:06,528 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:06,528 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:06,528 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:06,532 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:06,534 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:06,534 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:06,534 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:06,534 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:06,534 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:06,534 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:06,534 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:06,536 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:06,538 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:06,538 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:06,538 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:06,538 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:06,539 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:06,539 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:06,539 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:06,539 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:06,539 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,539 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,539 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:06,539 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:06,539 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,539 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,539 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:06,539 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:06,539 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,540 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:06,540 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:06,540 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:06,541 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:06,541 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:06,541 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:06,541 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:06,541 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:06,541 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:06,541 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:06,541 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:06,541 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:06,541 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:06,541 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:06,541 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:06,541 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:06,541 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,541 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:06,541 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:06,541 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:06,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:06,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:06,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:06,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:06,542 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:06,542 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,542 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:06,542 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,542 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:06,543 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,543 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:06,543 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:06,543 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:06,543 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:06,543 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:06,543 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:06,544 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:06,544 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:06,544 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,544 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:06,544 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,544 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:06,544 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,544 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:06,544 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:06,544 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:06,544 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:06,544 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:06,544 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   iterations: 290
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   learning_rate: 0.08983304753180525
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.0123406038630443
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   random_strength: 6.2809138006692
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   bagging_temperature: 0.9271612956107459
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   border_count: 56
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:06,545 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:06,728 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:06,729 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:06,729 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:06,729 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:06,729 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:06,729 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:06,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:06,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:06,729 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:06,729 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:06,729 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:06,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:06,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:06,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:06,730 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:06,730 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:06,731 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:06,731 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:06,731 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:06,731 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:06,731 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,731 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,731 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:06,731 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:06,731 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:06,731 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:06,731 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:06,731 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:06,732 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,732 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,732 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,732 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,732 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:06,732 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:06,732 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:06,732 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:06,732 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:06,732 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:06,732 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:06,732 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:06,732 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:06,732 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:06,732 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:06,733 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:06,733 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:06,733 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:06,733 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:06,733 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:06,733 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,733 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,733 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,733 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,735 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:06,735 - src.hyperparameter_tuning - ERROR - Trial 42 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:06,749 - src.hyperparameter_tuning - INFO - Trial 43: 모델 타입 = catboost
2025-06-24 09:32:06,753 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:06,754 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:06,754 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:06,754 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:06,754 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:06,754 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:06,754 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:06,754 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:06,754 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:06,754 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:06,754 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:06,754 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:06,754 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:06,754 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:06,754 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:06,754 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:06,754 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:06,754 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:06,755 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:06,755 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:06,755 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:06,755 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:06,755 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:06,755 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:06,755 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:06,756 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:06,756 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:06,756 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:06,759 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:06,761 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:06,761 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:06,761 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:06,761 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:06,761 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:06,761 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:06,761 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:06,763 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:06,765 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:06,765 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:06,766 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:06,766 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:06,766 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:06,766 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:06,766 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:06,766 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:06,766 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,766 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,766 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:06,766 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:06,766 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,766 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,766 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:06,766 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:06,766 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,767 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:06,767 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:06,767 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:06,768 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:06,768 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:06,768 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:06,768 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:06,768 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:06,768 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:06,768 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:06,768 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:06,768 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:06,768 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:06,768 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:06,768 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:06,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:06,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:06,768 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:06,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:06,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:06,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:06,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:06,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:06,769 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:06,769 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,770 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:06,770 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,770 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:06,770 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,770 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:06,770 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:06,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:06,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:06,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:06,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:06,771 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:06,771 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:06,771 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:06,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,771 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:06,771 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,771 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:06,771 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:06,771 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:06,771 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   iterations: 309
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   learning_rate: 0.10881627577586109
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.4962088224139751
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   random_strength: 1.1219248769313048
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   bagging_temperature: 0.7756117890541615
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   border_count: 45
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:06,772 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:06,954 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:06,954 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:06,954 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:06,954 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:06,954 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:06,954 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:06,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:06,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:06,954 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:06,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:06,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:06,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:06,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:06,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:06,955 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:06,955 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:06,956 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:06,956 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:06,956 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:06,956 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:06,956 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,956 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,956 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:06,956 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:06,956 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:06,956 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:06,956 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:06,956 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:06,957 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,957 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,957 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,957 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:06,958 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:06,958 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:06,958 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:06,958 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:06,958 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:06,958 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:06,958 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:06,958 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:06,958 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:06,958 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:06,958 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:06,958 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:06,958 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:06,958 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:06,958 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:06,958 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:06,958 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,958 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,958 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,958 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,960 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:06,960 - src.hyperparameter_tuning - ERROR - Trial 43 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:06,974 - src.hyperparameter_tuning - INFO - Trial 44: 모델 타입 = catboost
2025-06-24 09:32:06,978 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:06,979 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:06,979 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:06,979 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:06,979 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:06,979 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:06,979 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:06,979 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:06,979 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:06,980 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:06,980 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:06,980 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:06,980 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:06,980 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:06,980 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:06,980 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:06,980 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:06,980 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:06,981 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:06,981 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:06,981 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:06,981 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:06,981 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:06,981 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:06,981 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:06,981 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:06,981 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:06,981 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:06,985 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:06,987 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:06,987 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:06,987 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:06,987 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:06,987 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:06,987 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:06,987 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:06,989 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:06,991 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:06,991 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:06,991 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:06,991 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:06,991 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:06,991 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:06,991 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:06,991 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:06,991 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,991 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,991 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:06,991 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:06,992 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,992 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,992 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:06,992 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:06,992 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,992 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:06,992 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:06,992 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:06,993 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:06,993 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:06,993 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:06,993 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:06,993 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:06,993 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:06,993 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:06,993 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:06,993 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:06,993 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:06,993 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:06,993 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:06,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:06,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:06,994 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:06,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:06,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:06,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:06,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:06,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:06,995 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:06,995 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:06,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:06,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:06,995 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:06,995 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:06,995 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:06,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:06,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:06,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:06,996 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:06,996 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:06,996 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:06,996 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,996 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:06,996 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:06,996 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:06,996 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:06,996 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   iterations: 242
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   learning_rate: 0.07653927482065244
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.1629304237400784
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   random_strength: 0.3448927082959153
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   bagging_temperature: 0.9520592386302439
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   border_count: 182
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:06,997 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:06,998 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:06,998 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:06,998 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:06,998 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:06,998 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:06,998 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:06,998 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:06,998 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:06,998 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:07,179 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:07,179 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:07,179 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:07,179 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:07,179 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:07,179 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:07,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:07,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,180 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:07,180 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:07,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:07,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:07,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:07,181 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:07,181 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:07,181 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:07,181 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,181 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:07,181 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:07,181 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:07,182 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:07,182 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:07,182 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,182 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,182 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:07,182 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:07,182 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:07,182 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:07,182 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:07,182 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:07,182 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,183 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,183 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,183 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,183 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:07,183 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:07,183 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:07,183 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:07,183 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:07,183 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:07,183 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:07,183 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:07,183 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:07,183 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:07,183 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:07,183 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:07,183 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:07,183 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:07,183 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:07,183 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:07,183 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,183 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,183 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,183 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,186 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:07,186 - src.hyperparameter_tuning - ERROR - Trial 44 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:07,201 - src.hyperparameter_tuning - INFO - Trial 45: 모델 타입 = catboost
2025-06-24 09:32:07,205 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:07,205 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:07,205 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:07,205 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:07,206 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:07,206 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:07,206 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:07,206 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:07,206 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:07,206 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:07,206 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:07,206 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:07,206 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:07,206 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:07,206 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:07,206 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:07,206 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:07,206 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:07,207 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:07,207 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:07,207 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:07,207 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:07,207 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:07,207 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:07,207 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:07,208 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:07,208 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:07,208 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:07,212 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:07,214 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:07,214 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:07,214 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:07,214 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:07,214 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:07,214 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:07,214 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:07,216 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:07,218 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:07,218 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:07,218 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:07,218 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:07,218 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:07,218 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:07,218 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:07,218 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:07,218 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,218 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,219 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:07,219 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:07,219 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,219 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,219 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:07,219 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:07,219 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,219 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:07,219 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:07,219 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:07,220 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:07,220 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:07,220 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:07,220 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:07,220 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:07,220 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:07,220 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:07,220 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:07,220 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:07,220 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:07,220 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:07,220 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:07,220 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:07,220 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,221 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:07,221 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:07,221 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:07,221 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:07,221 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:07,221 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:07,222 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:07,222 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:07,222 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,222 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:07,222 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,222 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:07,222 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,222 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:07,222 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:07,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:07,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:07,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:07,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:07,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:07,223 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:07,223 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:07,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,223 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:07,223 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   iterations: 192
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   learning_rate: 0.14620410965828723
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.6263502455350154
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   random_strength: 0.2594372836984769
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   bagging_temperature: 0.8592768407338789
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   border_count: 83
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:07,224 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:07,225 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:07,407 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:07,408 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:07,408 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:07,408 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:07,408 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:07,408 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:07,408 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:07,408 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,408 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:07,408 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:07,408 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:07,409 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:07,409 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:07,409 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:07,409 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:07,409 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:07,409 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,409 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:07,410 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:07,410 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:07,410 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:07,410 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:07,410 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,410 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,410 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:07,410 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:07,410 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:07,410 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:07,410 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:07,410 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:07,411 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,411 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,411 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,411 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,412 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:07,412 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:07,412 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:07,412 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:07,412 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:07,412 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:07,412 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:07,412 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:07,412 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:07,412 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:07,412 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:07,412 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:07,412 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:07,412 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:07,412 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:07,412 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:07,412 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,412 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,412 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,412 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,414 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:07,414 - src.hyperparameter_tuning - ERROR - Trial 45 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:07,429 - src.hyperparameter_tuning - INFO - Trial 46: 모델 타입 = catboost
2025-06-24 09:32:07,432 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:07,433 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:07,433 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:07,433 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:07,433 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:07,433 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:07,433 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:07,433 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:07,433 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:07,434 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:07,434 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:07,434 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:07,434 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:07,434 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:07,434 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:07,434 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:07,434 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:07,434 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:07,435 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:07,435 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:07,435 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:07,435 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:07,435 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:07,435 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:07,435 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:07,435 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:07,435 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:07,435 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:07,439 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:07,441 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:07,441 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:07,441 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:07,441 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:07,441 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:07,441 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:07,441 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:07,443 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:07,445 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:07,445 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:07,445 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:07,445 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:07,445 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:07,445 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:07,445 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:07,445 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:07,445 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,445 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,446 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:07,446 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:07,446 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,446 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,446 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:07,446 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:07,446 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,446 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:07,446 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:07,446 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:07,447 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:07,447 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:07,447 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:07,447 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:07,447 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:07,447 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:07,447 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:07,447 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:07,447 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:07,447 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:07,447 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:07,447 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:07,447 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:07,447 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,448 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:07,448 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:07,448 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:07,448 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:07,448 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:07,448 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:07,448 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:07,449 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:07,449 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,449 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:07,449 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,449 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:07,449 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,449 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:07,449 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:07,449 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:07,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:07,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:07,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:07,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:07,450 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:07,450 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,450 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:07,450 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,450 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:07,450 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,450 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   iterations: 472
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   learning_rate: 0.20781461336599077
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.244987068989872
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   random_strength: 8.455892276653092
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   bagging_temperature: 0.28461697726904467
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   border_count: 68
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:07,451 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:07,452 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:07,633 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:07,633 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:07,633 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:07,633 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:07,633 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:07,633 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:07,633 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:07,633 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,633 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:07,634 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:07,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:07,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:07,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:07,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:07,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:07,634 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:07,634 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,635 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:07,635 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:07,635 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:07,635 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:07,635 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:07,635 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,635 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,635 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:07,635 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:07,636 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:07,636 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:07,636 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:07,636 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:07,636 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,636 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,636 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,637 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,637 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:07,637 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:07,637 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:07,637 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:07,637 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:07,637 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:07,637 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:07,637 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:07,637 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:07,637 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:07,637 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:07,637 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:07,637 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:07,637 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:07,637 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:07,637 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:07,637 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,637 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,637 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,637 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,639 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:07,639 - src.hyperparameter_tuning - ERROR - Trial 46 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:07,654 - src.hyperparameter_tuning - INFO - Trial 47: 모델 타입 = catboost
2025-06-24 09:32:07,658 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:07,658 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:07,659 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:07,659 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:07,659 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:07,659 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:07,659 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:07,659 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:07,659 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:07,659 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:07,659 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:07,659 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:07,659 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:07,659 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:07,659 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:07,659 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:07,659 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:07,659 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:07,660 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:07,660 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:07,660 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:07,660 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:07,660 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:07,661 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:07,661 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:07,661 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:07,661 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:07,661 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:07,664 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:07,666 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:07,666 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:07,666 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:07,667 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:07,667 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:07,667 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:07,667 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:07,669 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:07,671 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:07,671 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:07,671 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:07,671 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:07,671 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:07,671 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:07,671 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:07,671 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:07,671 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,671 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,671 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:07,671 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:07,671 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,671 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,671 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:07,671 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:07,671 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,672 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:07,672 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:07,672 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:07,673 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:07,673 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:07,673 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:07,673 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:07,673 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:07,673 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:07,673 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:07,673 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:07,673 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:07,673 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:07,673 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:07,673 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:07,673 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:07,673 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,673 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:07,674 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:07,674 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:07,674 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:07,674 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:07,674 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:07,674 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:07,675 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:07,675 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:07,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:07,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:07,675 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:07,675 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:07,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:07,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:07,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:07,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:07,676 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:07,676 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:07,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,676 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:07,676 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,676 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:07,676 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:07,676 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   iterations: 373
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   learning_rate: 0.05671995388711304
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   l2_leaf_reg: 7.111587060100682
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   random_strength: 0.1339654752528074
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   bagging_temperature: 0.1683815669464992
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   border_count: 116
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:07,677 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:07,678 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:07,842 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:07,842 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:07,842 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:07,842 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:07,842 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:07,842 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:07,842 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:07,842 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,843 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:07,843 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:07,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:07,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:07,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:07,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:07,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:07,844 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:07,844 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,844 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:07,844 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:07,844 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:07,844 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:07,844 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:07,844 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,844 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,844 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:07,844 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:07,845 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:07,845 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:07,845 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:07,845 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:07,845 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,845 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,846 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,846 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:07,846 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:07,846 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:07,846 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:07,846 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:07,846 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:07,846 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:07,846 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:07,846 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:07,846 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:07,846 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:07,846 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:07,846 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:07,846 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:07,846 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:07,846 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:07,846 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:07,846 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,846 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,846 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,846 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,848 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:07,849 - src.hyperparameter_tuning - ERROR - Trial 47 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:07,863 - src.hyperparameter_tuning - INFO - Trial 48: 모델 타입 = catboost
2025-06-24 09:32:07,867 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:07,868 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:07,868 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:07,868 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:07,868 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:07,868 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:07,868 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:07,868 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:07,868 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:07,868 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:07,869 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:07,869 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:07,869 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:07,869 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:07,869 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:07,869 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:07,869 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:07,869 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:07,870 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:07,870 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:07,870 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:07,870 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:07,870 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:07,870 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:07,870 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:07,870 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:07,870 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:07,870 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:07,873 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:07,875 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:07,875 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:07,875 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:07,875 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:07,876 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:07,876 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:07,876 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:07,878 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:07,879 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:07,879 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:07,879 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:07,880 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:07,880 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:07,880 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:07,880 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:07,880 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:07,880 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,880 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,880 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:07,880 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:07,880 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,880 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,880 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:07,880 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:07,880 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,881 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:07,881 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:07,881 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:07,882 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:07,882 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:07,882 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:07,882 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:07,882 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:07,882 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:07,882 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:07,882 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:07,882 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:07,882 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:07,882 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:07,882 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:07,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:07,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:07,882 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:07,882 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:07,883 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:07,883 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:07,883 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:07,883 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:07,883 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:07,883 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:07,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:07,884 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,884 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:07,884 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:07,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:07,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:07,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:07,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:07,885 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:07,885 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:07,885 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:07,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:07,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,885 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:07,885 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:07,885 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:07,885 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:07,885 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:07,885 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:07,885 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   iterations: 225
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   learning_rate: 0.04360556269296231
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.293585292817162
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   random_strength: 0.10137537825952185
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   bagging_temperature: 0.7764223627168135
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   border_count: 206
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:07,886 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:08,069 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:08,069 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:08,069 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:08,069 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:08,069 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:08,069 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:08,069 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:08,069 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,069 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:08,070 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:08,070 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:08,070 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:08,070 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:08,070 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:08,070 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:08,071 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:08,071 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:08,071 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:08,071 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:08,071 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:08,071 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:08,071 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,071 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,071 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:08,071 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:08,072 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:08,072 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:08,072 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:08,072 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:08,072 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,072 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,073 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,073 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,073 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:08,073 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:08,073 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:08,073 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:08,073 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:08,073 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:08,073 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:08,073 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:08,073 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:08,073 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:08,073 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:08,073 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:08,073 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:08,073 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:08,073 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:08,073 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:08,073 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,073 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,073 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,073 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,076 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:08,076 - src.hyperparameter_tuning - ERROR - Trial 48 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:08,091 - src.hyperparameter_tuning - INFO - Trial 49: 모델 타입 = catboost
2025-06-24 09:32:08,095 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:08,095 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:08,095 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:08,095 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:08,095 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:08,095 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:08,096 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:08,096 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:08,096 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:08,096 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:08,096 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:08,096 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:08,096 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:08,096 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:08,096 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:08,096 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:08,096 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:08,096 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:08,097 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:08,097 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:08,097 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:08,097 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:08,097 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:08,097 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:08,097 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:08,097 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:08,097 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:08,097 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:08,101 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:08,103 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:08,103 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:08,103 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:08,103 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:08,103 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:08,103 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:08,103 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:08,105 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:08,107 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:08,107 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:08,107 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:08,107 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:08,107 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:08,107 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:08,107 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:08,107 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:08,107 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,107 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,108 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:08,108 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:08,108 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,108 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,108 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:08,108 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:08,108 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,108 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:08,108 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:08,108 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:08,109 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:08,109 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:08,109 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:08,109 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:08,109 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:08,109 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:08,109 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:08,109 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:08,109 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:08,109 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:08,109 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:08,109 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:08,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:08,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:08,110 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:08,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:08,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:08,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:08,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:08,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:08,111 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:08,111 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:08,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:08,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:08,111 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:08,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:08,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:08,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:08,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:08,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:08,112 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:08,112 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,112 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:08,112 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,112 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:08,112 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,112 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:08,112 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:08,112 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   iterations: 70
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   learning_rate: 0.11004810920404415
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.458287277916232
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   random_strength: 0.48299397007082895
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   bagging_temperature: 0.11876190757261534
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   border_count: 49
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:08,113 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:08,114 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:08,114 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:08,114 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:08,114 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:08,114 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:08,114 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:08,114 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:08,114 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:08,288 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:08,288 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:08,288 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:08,288 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:08,288 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:08,288 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:08,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:08,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:08,289 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:08,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:08,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:08,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:08,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:08,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:08,290 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:08,290 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,290 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:08,290 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:08,290 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:08,290 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:08,290 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:08,290 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,290 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,290 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:08,290 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:08,291 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:08,291 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:08,291 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:08,291 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:08,291 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,291 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,292 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,292 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,292 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:08,292 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:08,292 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:08,292 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:08,292 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:08,292 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:08,292 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:08,292 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:08,292 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:08,292 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:08,292 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:08,292 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:08,292 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:08,292 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:08,292 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:08,292 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:08,292 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,292 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,292 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,292 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,295 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:08,295 - src.hyperparameter_tuning - ERROR - Trial 49 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:08,310 - src.hyperparameter_tuning - INFO - Trial 50: 모델 타입 = catboost
2025-06-24 09:32:08,314 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:08,315 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:08,315 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:08,315 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:08,315 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:08,315 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:08,315 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:08,315 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:08,315 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:08,315 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:08,315 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:08,315 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:08,316 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:08,316 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:08,316 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:08,316 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:08,316 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:08,316 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:08,316 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:08,317 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:08,317 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:08,317 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:08,317 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:08,317 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:08,317 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:08,317 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:08,317 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:08,317 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:08,320 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:08,322 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:08,322 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:08,322 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:08,322 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:08,322 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:08,323 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:08,323 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:08,324 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:08,326 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:08,326 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:08,326 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:08,326 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:08,326 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:08,326 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:08,326 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:08,326 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:08,326 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,327 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,327 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:08,327 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:08,327 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,327 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,327 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:08,327 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:08,327 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,328 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:08,328 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:08,328 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:08,328 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:08,329 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:08,329 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:08,329 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:08,329 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:08,329 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:08,329 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:08,329 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:08,329 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:08,329 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:08,329 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:08,329 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:08,329 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:08,329 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,329 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:08,329 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:08,329 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:08,329 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:08,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:08,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:08,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:08,330 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:08,330 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,330 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:08,330 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,330 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:08,330 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,330 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:08,331 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:08,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:08,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:08,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:08,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:08,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:08,331 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:08,331 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,332 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:08,332 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   iterations: 332
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   learning_rate: 0.03521076343782821
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   l2_leaf_reg: 5.527177694586895
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   random_strength: 0.20419959154564662
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   bagging_temperature: 0.2048327106878925
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   border_count: 94
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:08,332 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:08,333 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:08,508 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:08,508 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:08,508 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:08,508 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:08,508 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:08,508 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:08,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:08,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,509 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:08,509 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:08,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:08,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:08,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:08,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:08,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:08,510 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:08,510 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,510 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:08,510 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:08,510 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:08,510 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:08,510 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:08,510 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,510 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,510 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:08,510 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:08,511 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:08,511 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:08,511 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:08,511 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:08,511 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,511 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,512 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,512 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,512 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:08,512 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:08,512 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:08,512 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:08,512 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:08,512 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:08,512 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:08,512 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:08,512 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:08,512 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:08,512 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:08,512 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:08,512 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:08,512 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:08,512 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:08,512 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:08,512 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,512 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,512 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,512 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,514 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:08,515 - src.hyperparameter_tuning - ERROR - Trial 50 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:08,529 - src.hyperparameter_tuning - INFO - Trial 51: 모델 타입 = catboost
2025-06-24 09:32:08,533 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:08,534 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:08,534 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:08,534 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:08,534 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:08,534 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:08,534 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:08,534 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:08,534 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:08,535 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:08,535 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:08,535 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:08,535 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:08,535 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:08,535 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:08,535 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:08,535 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:08,535 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:08,536 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:08,536 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:08,536 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:08,536 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:08,536 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:08,536 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:08,536 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:08,536 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:08,536 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:08,536 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:08,540 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:08,542 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:08,542 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:08,542 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:08,542 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:08,542 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:08,542 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:08,542 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:08,544 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:08,545 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:08,546 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:08,546 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:08,546 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:08,546 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:08,546 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:08,546 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:08,546 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:08,546 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,546 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,546 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:08,546 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:08,546 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,546 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,546 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:08,546 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:08,546 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,547 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:08,547 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:08,547 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:08,548 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:08,548 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:08,548 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:08,548 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:08,548 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:08,548 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:08,548 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:08,548 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:08,548 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:08,548 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:08,548 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:08,548 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:08,548 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:08,548 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,548 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:08,548 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:08,548 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:08,549 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:08,549 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:08,549 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:08,549 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:08,549 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:08,549 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:08,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:08,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,550 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:08,550 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:08,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:08,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:08,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:08,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:08,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:08,551 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:08,551 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:08,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO -   iterations: 406
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO -   learning_rate: 0.015538789372281252
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO -   l2_leaf_reg: 5.100070682997032
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:08,551 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   random_strength: 0.6601066213400216
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   bagging_temperature: 0.22616609533923138
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   border_count: 139
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:08,552 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:08,727 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:08,727 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:08,727 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:08,727 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:08,727 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:08,727 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:08,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:08,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:08,728 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:08,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:08,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:08,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:08,729 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:08,729 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:08,729 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:08,729 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:08,730 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:08,730 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:08,730 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:08,730 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:08,730 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,730 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,730 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:08,730 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:08,730 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:08,730 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:08,730 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:08,730 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:08,731 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,731 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,731 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,731 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,732 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:08,732 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:08,732 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:08,732 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:08,732 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:08,732 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:08,732 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:08,732 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:08,732 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:08,732 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:08,732 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:08,732 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:08,732 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:08,732 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:08,732 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:08,732 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:08,732 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,732 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,732 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,732 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,735 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:08,735 - src.hyperparameter_tuning - ERROR - Trial 51 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:08,750 - src.hyperparameter_tuning - INFO - Trial 52: 모델 타입 = catboost
2025-06-24 09:32:08,754 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:08,755 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:08,755 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:08,755 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:08,755 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:08,755 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:08,755 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:08,755 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:08,755 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:08,755 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:08,755 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:08,755 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:08,755 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:08,755 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:08,755 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:08,755 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:08,755 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:08,755 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:08,756 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:08,756 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:08,756 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:08,756 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:08,756 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:08,757 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:08,757 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:08,757 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:08,757 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:08,757 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:08,761 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:08,763 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:08,763 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:08,763 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:08,763 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:08,763 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:08,763 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:08,763 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:08,765 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:08,766 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:08,767 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:08,767 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:08,767 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:08,767 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:08,767 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:08,767 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:08,767 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:08,767 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,767 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,767 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:08,767 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:08,767 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,767 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,767 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:08,767 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:08,767 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,768 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:08,768 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:08,768 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:08,769 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:08,769 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:08,769 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:08,769 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:08,769 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:08,769 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:08,769 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:08,769 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:08,769 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:08,769 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:08,769 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:08,769 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:08,769 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:08,769 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,770 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:08,770 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:08,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:08,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:08,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:08,771 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:08,771 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:08,771 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:08,771 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:08,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:08,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:08,771 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:08,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:08,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:08,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:08,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:08,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:08,772 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:08,772 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:08,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,772 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:08,772 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   iterations: 412
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   learning_rate: 0.014224007032327037
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   l2_leaf_reg: 5.9974152304281
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   random_strength: 0.15625794493429893
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   bagging_temperature: 0.14727121380424188
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   border_count: 114
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:08,773 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:08,774 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:08,948 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:08,948 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:08,948 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:08,948 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:08,948 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:08,948 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:08,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:08,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,949 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:08,949 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:08,949 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:08,949 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:08,950 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:08,950 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:08,950 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:08,950 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:08,950 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,950 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:08,951 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:08,951 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:08,951 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:08,951 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:08,951 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,951 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,951 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:08,951 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:08,951 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:08,951 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:08,952 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:08,952 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:08,952 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,952 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,952 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,953 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:08,953 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:08,953 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:08,953 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:08,953 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:08,953 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:08,953 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:08,953 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:08,953 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:08,953 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:08,953 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:08,953 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:08,953 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:08,953 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:08,953 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:08,953 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:08,953 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:08,953 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,953 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,953 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,953 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,956 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:08,956 - src.hyperparameter_tuning - ERROR - Trial 52 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:08,971 - src.hyperparameter_tuning - INFO - Trial 53: 모델 타입 = catboost
2025-06-24 09:32:08,975 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:08,976 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:08,976 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:08,976 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:08,976 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:08,976 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:08,976 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:08,976 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:08,976 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:08,977 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:08,977 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:08,977 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:08,977 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:08,977 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:08,977 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:08,977 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:08,977 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:08,977 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:08,978 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:08,978 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:08,978 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:08,978 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:08,978 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:08,978 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:08,978 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:08,978 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:08,978 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:08,978 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:08,982 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:08,984 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:08,984 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:08,984 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:08,984 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:08,984 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:08,984 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:08,984 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:08,986 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:08,988 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:08,988 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:08,988 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:08,989 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:08,989 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:08,989 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:08,989 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:08,989 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:08,989 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,989 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,989 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:08,989 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:08,989 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,989 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,989 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:08,990 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:08,990 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,990 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:08,990 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:08,990 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:08,991 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:08,991 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:08,991 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:08,991 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:08,991 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:08,991 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:08,991 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:08,991 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:08,991 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:08,991 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:08,991 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:08,991 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:08,991 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:08,991 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,992 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:08,992 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:08,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:08,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:08,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:08,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:08,993 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:08,993 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:08,993 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:08,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:08,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:08,993 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:08,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:08,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:08,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:08,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:08,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:08,994 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:08,994 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:08,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:08,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,994 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:08,994 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   iterations: 435
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   depth: 7
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   learning_rate: 0.012569207702256002
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.9823788705498173
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   random_strength: 1.036891626525922
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   bagging_temperature: 0.31296731600344513
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   border_count: 177
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:08,995 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:08,996 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:09,170 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:09,170 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:09,170 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:09,170 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:09,170 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:09,170 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:09,170 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:09,170 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:09,171 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:09,171 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:09,171 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:09,171 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:09,171 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:09,171 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:09,172 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:09,172 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:09,172 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:09,172 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:09,172 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:09,172 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:09,172 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,172 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,173 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:09,173 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:09,173 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:09,173 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:09,173 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:09,173 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:09,173 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,174 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,174 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,174 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,174 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:09,174 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:09,174 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:09,174 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:09,174 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:09,174 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:09,174 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:09,174 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:09,174 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:09,174 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:09,174 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:09,174 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:09,174 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:09,174 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:09,174 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:09,174 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:09,174 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,174 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,174 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,174 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,177 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:09,177 - src.hyperparameter_tuning - ERROR - Trial 53 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:09,192 - src.hyperparameter_tuning - INFO - Trial 54: 모델 타입 = catboost
2025-06-24 09:32:09,196 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:09,197 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:09,197 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:09,197 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:09,197 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:09,197 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:09,197 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:09,197 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:09,197 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:09,197 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:09,197 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:09,197 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:09,197 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:09,198 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:09,198 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:09,198 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:09,198 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:09,198 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:09,199 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:09,199 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:09,199 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:09,199 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:09,199 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:09,199 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:09,199 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:09,199 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:09,199 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:09,199 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:09,203 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:09,205 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:09,205 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:09,205 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:09,205 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:09,205 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:09,205 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:09,205 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:09,207 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:09,209 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:09,209 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:09,209 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:09,209 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:09,209 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:09,209 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:09,209 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:09,209 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:09,209 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,209 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,209 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:09,209 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:09,210 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,210 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,210 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:09,210 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:09,210 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,210 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:09,210 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:09,210 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:09,211 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:09,211 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:09,211 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:09,211 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:09,211 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:09,211 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:09,211 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:09,211 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:09,211 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:09,211 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:09,211 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:09,211 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:09,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:09,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:09,212 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:09,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:09,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:09,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:09,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:09,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:09,212 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:09,212 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:09,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:09,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:09,213 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:09,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:09,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:09,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:09,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:09,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:09,214 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:09,214 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:09,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,214 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:09,214 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,214 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:09,214 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:09,214 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:09,214 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   iterations: 492
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   learning_rate: 0.020427856728467128
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.5619854275071472
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   random_strength: 1.3766659394963772
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   bagging_temperature: 0.26822323430285766
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   border_count: 68
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:09,215 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:09,216 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:09,216 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:09,391 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:09,391 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:09,391 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:09,391 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:09,391 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:09,391 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:09,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:09,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:09,392 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:09,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:09,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:09,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:09,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:09,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:09,392 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:09,392 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,392 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:09,393 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:09,393 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:09,393 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:09,393 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:09,393 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,393 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:09,393 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:09,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:09,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:09,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:09,394 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:09,394 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,394 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,394 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,394 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,395 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:09,395 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:09,395 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:09,395 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:09,395 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:09,395 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:09,395 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:09,395 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:09,395 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:09,395 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:09,395 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:09,395 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:09,395 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:09,395 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:09,395 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:09,395 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:09,395 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,395 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,395 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,395 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,397 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:09,397 - src.hyperparameter_tuning - ERROR - Trial 54 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:09,412 - src.hyperparameter_tuning - INFO - Trial 55: 모델 타입 = catboost
2025-06-24 09:32:09,416 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:09,417 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:09,417 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:09,417 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:09,417 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:09,417 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:09,417 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:09,417 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:09,417 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:09,418 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:09,418 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:09,418 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:09,418 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:09,418 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:09,418 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:09,418 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:09,418 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:09,418 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:09,419 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:09,419 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:09,419 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:09,419 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:09,419 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:09,419 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:09,419 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:09,419 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:09,419 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:09,419 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:09,423 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:09,425 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:09,425 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:09,425 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:09,425 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:09,425 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:09,425 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:09,425 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:09,427 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:09,429 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:09,429 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:09,429 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:09,429 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:09,429 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:09,429 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:09,429 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:09,429 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:09,429 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,429 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,430 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:09,430 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:09,430 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,430 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,430 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:09,430 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:09,430 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,431 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:09,431 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:09,431 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:09,432 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:09,432 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:09,432 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:09,432 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:09,432 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:09,432 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:09,432 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:09,432 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:09,432 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:09,432 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:09,432 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:09,432 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:09,432 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:09,432 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,432 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:09,432 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:09,432 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:09,432 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:09,433 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:09,433 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:09,433 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:09,433 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:09,433 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,433 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:09,433 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,433 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:09,433 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,434 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:09,434 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:09,434 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:09,434 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:09,434 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:09,434 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:09,435 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:09,435 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:09,435 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:09,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,435 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:09,435 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,435 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:09,435 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:09,435 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:09,435 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   iterations: 379
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   learning_rate: 0.024913145338318912
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   l2_leaf_reg: 7.550138024640487
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   random_strength: 2.9685567693811192
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   bagging_temperature: 0.3797684667551782
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   border_count: 157
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:09,436 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:09,437 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:09,437 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:09,437 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:09,437 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:09,606 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:09,606 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:09,606 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:09,606 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:09,606 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:09,606 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:09,606 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:09,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:09,607 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:09,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:09,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:09,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:09,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:09,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:09,608 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:09,608 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:09,609 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:09,609 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:09,609 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:09,609 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:09,609 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,609 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,609 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:09,609 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:09,609 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:09,609 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:09,609 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:09,609 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:09,610 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,610 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,610 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,610 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,610 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:09,610 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:09,610 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:09,610 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:09,610 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:09,611 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:09,611 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:09,611 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:09,611 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:09,611 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:09,611 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:09,611 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:09,611 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:09,611 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:09,611 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:09,611 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:09,611 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,611 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,611 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,611 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,613 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:09,613 - src.hyperparameter_tuning - ERROR - Trial 55 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:09,629 - src.hyperparameter_tuning - INFO - Trial 56: 모델 타입 = catboost
2025-06-24 09:32:09,632 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:09,633 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:09,633 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:09,633 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:09,633 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:09,633 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:09,633 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:09,633 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:09,633 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:09,634 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:09,634 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:09,634 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:09,634 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:09,634 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:09,634 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:09,634 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:09,634 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:09,634 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:09,635 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:09,635 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:09,635 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:09,635 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:09,635 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:09,635 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:09,635 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:09,635 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:09,635 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:09,635 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:09,639 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:09,641 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:09,641 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:09,641 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:09,641 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:09,641 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:09,641 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:09,641 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:09,643 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:09,645 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:09,645 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:09,645 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:09,645 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:09,645 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:09,645 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:09,645 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:09,645 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:09,645 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,645 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,646 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:09,646 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:09,646 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,646 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,646 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:09,646 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:09,646 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,647 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:09,647 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:09,647 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:09,647 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:09,648 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:09,648 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:09,648 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:09,648 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:09,648 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:09,648 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:09,648 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:09,648 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:09,648 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:09,648 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:09,648 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:09,648 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:09,648 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,648 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:09,648 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:09,648 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:09,648 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:09,649 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:09,649 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:09,649 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:09,649 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:09,649 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:09,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:09,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:09,650 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:09,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:09,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:09,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:09,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:09,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:09,650 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:09,650 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,651 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:09,651 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   iterations: 454
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   learning_rate: 0.1460415444237617
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.336558693489824
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   random_strength: 9.545939765217414
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   bagging_temperature: 0.671421004692545
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   border_count: 128
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:09,651 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:09,652 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:09,825 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:09,825 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:09,825 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:09,825 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:09,825 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:09,826 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:09,826 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:09,826 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,826 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:09,826 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:09,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:09,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:09,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:09,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:09,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:09,827 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:09,827 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:09,828 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:09,828 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:09,828 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:09,828 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:09,828 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,828 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:09,828 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:09,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:09,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:09,829 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:09,829 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:09,829 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,829 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,829 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,830 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:09,830 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:09,830 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:09,830 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:09,830 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:09,830 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:09,830 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:09,830 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:09,830 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:09,830 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:09,830 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:09,830 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:09,830 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:09,830 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:09,830 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:09,830 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:09,830 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:09,830 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,830 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,830 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,830 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,832 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:09,832 - src.hyperparameter_tuning - ERROR - Trial 56 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:09,848 - src.hyperparameter_tuning - INFO - Trial 57: 모델 타입 = catboost
2025-06-24 09:32:09,853 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:09,854 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:09,854 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:09,854 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:09,854 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:09,854 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:09,854 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:09,854 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:09,854 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:09,854 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:09,854 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:09,854 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:09,854 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:09,854 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:09,855 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:09,855 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:09,855 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:09,855 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:09,855 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:09,856 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:09,856 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:09,856 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:09,856 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:09,856 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:09,856 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:09,856 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:09,856 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:09,856 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:09,859 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:09,862 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:09,862 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:09,862 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:09,862 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:09,862 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:09,862 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:09,862 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:09,864 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:09,866 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:09,866 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:09,866 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:09,866 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:09,866 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:09,866 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:09,866 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:09,866 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:09,866 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,866 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,867 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:09,867 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:09,867 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,867 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,867 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:09,867 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:09,867 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,867 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:09,868 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:09,868 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:09,869 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:09,869 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:09,869 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:09,869 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:09,869 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:09,869 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:09,869 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:09,869 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:09,869 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:09,869 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:09,869 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:09,869 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:09,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:09,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:09,869 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:09,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:09,870 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:09,870 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:09,870 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:09,870 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:09,870 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:09,870 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,871 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:09,871 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,871 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:09,871 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,871 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:09,871 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:09,871 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:09,871 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:09,871 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:09,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:09,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:09,872 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:09,872 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:09,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:09,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,872 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:09,872 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:09,872 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:09,872 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:09,872 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:09,872 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   iterations: 273
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   learning_rate: 0.09177560791109401
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.8740851331689392
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   random_strength: 1.8496399639958223
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   bagging_temperature: 0.19338719826351908
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   border_count: 107
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:09,873 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:10,048 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:10,048 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:10,048 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:10,048 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:10,048 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:10,048 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:10,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:10,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,049 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:10,049 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:10,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:10,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:10,050 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:10,050 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:10,050 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:10,050 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:10,050 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,050 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:10,051 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:10,051 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:10,051 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:10,051 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:10,051 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,051 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,051 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:10,051 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:10,051 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:10,051 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:10,051 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:10,051 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:10,052 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,052 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,052 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,052 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,053 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:10,053 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:10,053 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:10,053 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:10,053 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:10,053 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:10,053 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:10,053 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:10,053 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:10,053 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:10,053 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:10,053 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:10,053 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:10,053 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:10,053 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:10,053 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:10,053 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,053 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,053 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,053 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,055 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:10,055 - src.hyperparameter_tuning - ERROR - Trial 57 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:10,070 - src.hyperparameter_tuning - INFO - Trial 58: 모델 타입 = catboost
2025-06-24 09:32:10,074 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:10,075 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:10,075 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:10,075 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:10,075 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:10,075 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:10,075 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:10,075 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:10,075 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:10,076 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:10,076 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:10,076 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:10,076 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:10,076 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:10,076 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:10,076 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:10,076 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:10,076 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:10,077 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:10,077 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:10,077 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:10,077 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:10,077 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:10,077 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:10,077 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:10,077 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:10,077 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:10,077 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:10,080 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:10,082 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:10,082 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:10,083 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:10,083 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:10,083 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:10,083 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:10,083 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:10,085 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:10,086 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:10,087 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:10,087 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:10,087 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:10,087 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:10,087 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:10,087 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:10,087 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:10,087 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,087 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,087 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:10,087 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:10,087 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,087 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,087 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:10,087 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:10,087 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,088 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:10,088 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:10,088 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:10,089 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:10,089 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:10,089 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:10,089 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:10,089 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:10,089 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:10,089 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:10,089 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:10,089 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:10,089 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:10,089 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:10,089 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:10,089 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:10,089 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,089 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:10,089 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:10,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:10,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:10,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:10,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:10,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:10,090 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:10,090 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:10,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:10,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:10,091 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:10,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:10,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:10,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:10,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:10,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:10,092 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:10,092 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:10,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,092 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:10,092 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,092 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:10,092 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:10,092 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:10,092 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:10,092 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:10,092 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:10,092 - src.models.catboost_model - INFO -   iterations: 351
2025-06-24 09:32:10,092 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:10,092 - src.models.catboost_model - INFO -   learning_rate: 0.1203993896639319
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.584605417131763
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   random_strength: 0.540428347729739
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   bagging_temperature: 0.9440555757522147
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   border_count: 141
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:10,093 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:10,268 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:10,268 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:10,268 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:10,268 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:10,268 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:10,268 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:10,268 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:10,268 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,269 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:10,269 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:10,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:10,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:10,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:10,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:10,270 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:10,270 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:10,270 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,270 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:10,270 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:10,271 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:10,271 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:10,271 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:10,271 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,271 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,271 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:10,271 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:10,271 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:10,271 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:10,271 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:10,271 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:10,272 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,272 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,272 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,272 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,272 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:10,272 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:10,272 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:10,272 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:10,272 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:10,272 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:10,273 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:10,273 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:10,273 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:10,273 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:10,273 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:10,273 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:10,273 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:10,273 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:10,273 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:10,273 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:10,273 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,273 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,273 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,273 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,275 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:10,275 - src.hyperparameter_tuning - ERROR - Trial 58 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:10,291 - src.hyperparameter_tuning - INFO - Trial 59: 모델 타입 = catboost
2025-06-24 09:32:10,295 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:10,296 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:10,296 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:10,296 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:10,296 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:10,296 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:10,296 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:10,296 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:10,296 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:10,297 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:10,297 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:10,297 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:10,297 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:10,297 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:10,297 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:10,297 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:10,297 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:10,297 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:10,298 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:10,298 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:10,298 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:10,298 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:10,298 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:10,298 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:10,298 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:10,298 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:10,298 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:10,298 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:10,302 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:10,304 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:10,304 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:10,305 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:10,305 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:10,305 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:10,305 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:10,305 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:10,307 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:10,309 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:10,309 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:10,309 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:10,309 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:10,309 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:10,309 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:10,309 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:10,310 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:10,310 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,310 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,310 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:10,310 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:10,310 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,310 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,310 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:10,310 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:10,310 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,311 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:10,311 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:10,311 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:10,312 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:10,312 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:10,312 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:10,312 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:10,312 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:10,312 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:10,312 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:10,312 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:10,312 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:10,312 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:10,312 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:10,312 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:10,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:10,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:10,312 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:10,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:10,313 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:10,313 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:10,313 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:10,313 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:10,313 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:10,313 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,313 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:10,313 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,313 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:10,313 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,314 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:10,314 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:10,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:10,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:10,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:10,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:10,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:10,315 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:10,315 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:10,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO -   iterations: 114
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO -   learning_rate: 0.02217736744738808
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.686366108086429
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO -   random_strength: 0.3189176551683765
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO -   bagging_temperature: 0.4334180757689089
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO -   border_count: 224
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:10,315 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:10,316 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:10,497 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:10,497 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:10,497 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:10,497 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:10,497 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:10,497 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:10,497 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:10,497 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,498 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:10,498 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:10,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:10,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:10,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:10,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:10,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:10,499 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:10,499 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:10,499 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:10,499 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:10,499 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:10,499 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:10,499 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,499 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,500 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:10,500 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:10,500 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:10,500 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:10,500 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:10,500 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:10,500 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,501 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,501 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,501 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,501 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:10,501 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:10,502 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:10,502 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:10,502 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:10,502 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:10,502 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:10,502 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:10,502 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:10,502 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:10,502 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:10,502 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:10,502 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:10,502 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:10,502 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:10,502 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:10,502 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,502 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,502 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,502 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,504 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:10,504 - src.hyperparameter_tuning - ERROR - Trial 59 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:10,520 - src.hyperparameter_tuning - INFO - Trial 60: 모델 타입 = catboost
2025-06-24 09:32:10,524 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:10,525 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:10,525 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:10,525 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:10,525 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:10,525 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:10,525 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:10,525 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:10,525 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:10,526 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:10,526 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:10,526 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:10,526 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:10,526 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:10,526 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:10,526 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:10,526 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:10,526 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:10,527 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:10,527 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:10,527 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:10,527 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:10,527 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:10,527 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:10,527 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:10,527 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:10,527 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:10,527 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:10,531 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:10,533 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:10,533 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:10,533 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:10,533 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:10,533 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:10,533 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:10,533 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:10,535 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:10,538 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:10,538 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:10,538 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:10,538 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:10,538 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:10,538 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:10,538 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:10,538 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:10,538 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,538 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,538 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:10,538 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:10,538 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,538 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,538 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:10,538 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:10,538 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,539 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:10,539 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:10,539 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:10,540 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:10,540 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:10,540 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:10,540 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:10,540 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:10,540 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:10,540 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:10,540 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:10,540 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:10,540 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:10,540 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:10,540 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:10,540 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:10,540 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,540 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:10,541 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:10,541 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:10,541 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:10,541 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:10,541 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:10,541 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:10,541 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:10,541 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,542 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:10,542 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,542 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:10,542 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,542 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:10,542 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:10,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:10,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:10,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:10,543 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:10,543 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:10,543 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:10,543 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,543 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:10,543 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,543 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:10,543 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,543 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:10,543 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:10,543 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:10,543 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   iterations: 208
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   learning_rate: 0.19142935921641308
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.7248399861387833
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   random_strength: 0.7414496365923825
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   bagging_temperature: 0.3251544483005666
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   border_count: 167
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:10,544 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:10,721 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:10,721 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:10,721 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:10,721 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:10,721 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:10,721 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:10,721 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:10,721 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,722 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:10,722 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:10,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:10,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:10,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:10,723 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:10,723 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:10,723 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:10,723 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:10,724 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:10,724 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:10,724 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:10,724 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:10,724 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,724 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,724 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:10,724 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:10,724 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:10,724 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:10,724 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:10,724 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:10,725 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,725 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,725 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,725 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,725 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:10,725 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:10,725 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:10,726 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:10,726 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:10,726 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:10,726 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:10,726 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:10,726 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:10,726 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:10,726 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:10,726 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:10,726 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:10,726 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:10,726 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:10,726 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:10,726 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,726 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,726 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,726 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,728 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:10,728 - src.hyperparameter_tuning - ERROR - Trial 60 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:10,744 - src.hyperparameter_tuning - INFO - Trial 61: 모델 타입 = catboost
2025-06-24 09:32:10,748 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:10,749 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:10,749 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:10,749 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:10,749 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:10,749 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:10,749 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:10,749 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:10,749 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:10,749 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:10,749 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:10,749 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:10,749 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:10,749 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:10,749 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:10,749 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:10,749 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:10,749 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:10,750 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:10,750 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:10,750 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:10,750 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:10,750 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:10,750 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:10,750 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:10,750 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:10,750 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:10,751 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:10,754 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:10,757 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:10,757 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:10,757 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:10,757 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:10,757 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:10,757 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:10,757 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:10,759 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:10,761 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:10,761 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:10,761 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:10,761 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:10,761 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:10,761 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:10,761 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:10,761 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:10,761 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,761 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,761 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:10,761 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:10,761 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,761 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,761 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:10,761 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:10,761 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,762 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:10,762 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:10,762 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:10,763 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:10,763 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:10,763 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:10,763 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:10,763 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:10,763 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:10,763 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:10,763 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:10,763 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:10,763 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:10,763 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:10,763 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:10,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:10,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:10,763 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:10,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:10,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:10,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:10,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:10,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:10,764 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:10,764 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:10,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:10,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:10,765 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:10,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:10,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:10,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:10,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:10,766 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:10,766 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:10,766 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:10,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,766 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:10,766 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,766 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:10,766 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:10,766 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:10,766 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:10,766 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   iterations: 51
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   learning_rate: 0.025795687873140315
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.391814431860162
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   random_strength: 1.3240406137460856
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   bagging_temperature: 0.57529299898474
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   border_count: 88
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:10,767 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:10,942 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:10,942 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:10,942 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:10,942 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:10,942 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:10,943 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:10,943 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:10,943 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,943 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:10,943 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:10,943 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:10,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:10,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:10,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:10,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:10,944 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:10,944 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,944 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:10,945 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:10,945 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:10,945 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:10,945 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:10,945 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,945 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,945 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:10,945 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:10,945 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:10,945 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:10,945 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:10,945 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:10,946 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,946 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,946 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,946 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:10,947 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:10,947 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:10,947 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:10,947 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:10,947 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:10,947 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:10,947 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:10,947 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:10,947 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:10,947 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:10,947 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:10,947 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:10,947 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:10,947 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:10,947 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:10,947 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:10,947 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,947 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,947 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,947 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,949 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:10,949 - src.hyperparameter_tuning - ERROR - Trial 61 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:10,965 - src.hyperparameter_tuning - INFO - Trial 62: 모델 타입 = catboost
2025-06-24 09:32:10,969 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:10,970 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:10,970 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:10,970 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:10,970 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:10,970 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:10,970 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:10,970 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:10,970 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:10,971 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:10,971 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:10,971 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:10,971 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:10,971 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:10,971 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:10,971 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:10,971 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:10,971 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:10,972 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:10,972 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:10,972 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:10,972 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:10,972 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:10,972 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:10,972 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:10,972 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:10,972 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:10,972 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:10,976 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:10,978 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:10,978 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:10,978 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:10,978 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:10,978 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:10,978 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:10,978 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:10,980 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:10,982 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:10,982 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:10,982 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:10,982 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:10,982 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:10,982 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:10,982 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:10,982 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:10,982 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,982 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,982 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:10,982 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:10,982 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,982 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,982 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:10,982 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:10,982 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,983 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:10,983 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:10,983 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:10,984 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:10,984 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:10,984 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:10,984 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:10,984 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:10,984 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:10,984 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:10,984 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:10,984 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:10,984 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:10,984 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:10,984 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:10,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:10,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:10,985 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:10,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:10,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:10,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:10,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:10,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:10,985 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:10,985 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:10,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:10,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:10,986 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:10,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:10,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:10,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:10,987 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:10,987 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:10,987 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:10,987 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:10,987 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:10,987 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,987 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:10,987 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:10,987 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:10,987 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:10,987 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:10,987 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   iterations: 75
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   learning_rate: 0.01726424961681102
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.2419877577307394
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   random_strength: 2.3819508583730045
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   bagging_temperature: 0.8294673835366463
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   border_count: 99
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:10,988 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:11,163 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:11,163 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:11,163 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:11,163 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:11,163 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:11,163 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:11,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:11,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:11,164 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:11,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:11,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:11,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:11,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:11,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:11,165 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:11,165 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:11,166 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:11,166 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:11,166 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:11,166 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:11,166 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,166 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,166 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:11,166 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:11,166 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:11,166 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:11,166 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:11,166 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:11,167 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,167 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,167 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,167 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,167 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:11,167 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:11,167 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:11,167 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:11,167 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:11,167 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:11,168 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:11,168 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:11,168 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:11,168 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:11,168 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:11,168 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:11,168 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:11,168 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:11,168 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:11,168 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:11,168 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,168 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,168 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,168 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,170 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:11,170 - src.hyperparameter_tuning - ERROR - Trial 62 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:11,186 - src.hyperparameter_tuning - INFO - Trial 63: 모델 타입 = catboost
2025-06-24 09:32:11,190 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:11,190 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:11,191 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:11,191 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:11,191 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:11,191 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:11,191 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:11,191 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:11,191 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:11,191 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:11,191 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:11,191 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:11,191 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:11,191 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:11,191 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:11,191 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:11,191 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:11,191 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:11,192 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:11,192 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:11,192 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:11,192 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:11,192 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:11,192 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:11,192 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:11,192 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:11,192 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:11,193 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:11,196 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:11,198 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:11,198 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:11,198 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:11,198 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:11,198 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:11,198 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:11,198 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:11,200 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:11,202 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:11,202 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:11,202 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:11,202 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:11,202 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:11,202 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:11,202 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:11,202 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:11,202 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,202 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,203 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:11,203 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:11,203 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,203 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,203 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:11,203 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:11,203 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,203 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:11,203 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:11,204 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:11,204 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:11,204 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:11,204 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:11,204 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:11,204 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:11,204 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:11,204 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:11,204 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:11,204 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:11,205 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:11,205 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:11,205 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:11,205 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:11,205 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,205 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:11,205 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:11,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:11,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:11,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:11,206 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:11,206 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:11,206 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:11,206 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:11,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:11,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:11,207 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:11,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:11,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:11,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:11,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:11,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:11,207 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:11,207 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,208 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:11,208 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   iterations: 145
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   learning_rate: 0.03240907344353371
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.371172782165182
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   random_strength: 0.9507737627599216
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   bagging_temperature: 0.8831127839216423
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   border_count: 125
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:11,208 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:11,209 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:11,383 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:11,383 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:11,383 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:11,383 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:11,383 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:11,383 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:11,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:11,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,384 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:11,384 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:11,384 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:11,384 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:11,384 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:11,384 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:11,385 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:11,385 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:11,385 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,385 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:11,385 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:11,385 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:11,385 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:11,385 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:11,386 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,386 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,386 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:11,386 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:11,386 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:11,386 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:11,386 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:11,386 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:11,386 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,387 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,387 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,387 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,387 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:11,387 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:11,387 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:11,387 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:11,387 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:11,387 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:11,387 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:11,387 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:11,387 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:11,387 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:11,387 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:11,387 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:11,387 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:11,387 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:11,387 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:11,387 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:11,387 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,387 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,387 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,387 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,390 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:11,390 - src.hyperparameter_tuning - ERROR - Trial 63 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:11,405 - src.hyperparameter_tuning - INFO - Trial 64: 모델 타입 = catboost
2025-06-24 09:32:11,409 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:11,410 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:11,410 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:11,410 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:11,410 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:11,410 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:11,410 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:11,410 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:11,410 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:11,411 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:11,411 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:11,411 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:11,411 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:11,411 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:11,411 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:11,411 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:11,411 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:11,411 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:11,412 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:11,412 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:11,412 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:11,412 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:11,412 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:11,412 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:11,412 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:11,412 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:11,412 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:11,412 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:11,416 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:11,418 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:11,418 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:11,418 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:11,418 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:11,418 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:11,418 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:11,418 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:11,420 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:11,422 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:11,422 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:11,422 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:11,422 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:11,422 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:11,422 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:11,422 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:11,422 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:11,422 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,422 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,422 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:11,423 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:11,423 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,423 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,423 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:11,423 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:11,423 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,423 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:11,423 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:11,423 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:11,424 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:11,424 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:11,424 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:11,424 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:11,424 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:11,424 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:11,424 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:11,424 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:11,424 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:11,424 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:11,424 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:11,424 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:11,424 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:11,424 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:11,425 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:11,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:11,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:11,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:11,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:11,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:11,426 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:11,426 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:11,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:11,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:11,426 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:11,426 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:11,426 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:11,427 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:11,427 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:11,427 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:11,427 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:11,427 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,427 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:11,427 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,427 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:11,427 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,427 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:11,427 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:11,427 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   iterations: 93
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   learning_rate: 0.06388399786673828
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   l2_leaf_reg: 5.234930843919431
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   random_strength: 3.8361076446479214
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   bagging_temperature: 0.7283968471729166
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   border_count: 136
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:11,428 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:11,429 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:11,429 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:11,429 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:11,429 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:11,603 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:11,603 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:11,603 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:11,603 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:11,603 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:11,603 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:11,603 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:11,603 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:11,604 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:11,604 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:11,604 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:11,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:11,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:11,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:11,605 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:11,605 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,605 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:11,606 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:11,606 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:11,606 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:11,606 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:11,606 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,606 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,606 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:11,606 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:11,606 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:11,606 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:11,606 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:11,606 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:11,607 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,607 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,607 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,607 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,608 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:11,608 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:11,608 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:11,608 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:11,608 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:11,608 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:11,608 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:11,608 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:11,608 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:11,608 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:11,608 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:11,608 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:11,608 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:11,608 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:11,608 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:11,608 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:11,608 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,608 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,608 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,608 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,610 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:11,610 - src.hyperparameter_tuning - ERROR - Trial 64 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:11,626 - src.hyperparameter_tuning - INFO - Trial 65: 모델 타입 = catboost
2025-06-24 09:32:11,630 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:11,631 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:11,631 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:11,631 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:11,631 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:11,631 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:11,631 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:11,631 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:11,631 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:11,631 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:11,631 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:11,631 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:11,631 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:11,632 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:11,632 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:11,632 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:11,632 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:11,632 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:11,633 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:11,633 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:11,633 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:11,633 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:11,633 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:11,633 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:11,633 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:11,633 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:11,633 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:11,633 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:11,636 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:11,638 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:11,638 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:11,638 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:11,638 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:11,639 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:11,639 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:11,639 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:11,641 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:11,643 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:11,643 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:11,643 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:11,643 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:11,643 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:11,643 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:11,643 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:11,643 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:11,643 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,643 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,643 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:11,643 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:11,643 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,643 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,643 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:11,644 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:11,644 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,644 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:11,644 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:11,644 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:11,645 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:11,645 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:11,645 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:11,645 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:11,645 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:11,645 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:11,645 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:11,645 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:11,645 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:11,645 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:11,645 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:11,645 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:11,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:11,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:11,646 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:11,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:11,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:11,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:11,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:11,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:11,646 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:11,646 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:11,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:11,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:11,647 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:11,647 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:11,647 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:11,648 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:11,648 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:11,648 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:11,648 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:11,648 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,648 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:11,648 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,648 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:11,648 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,648 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:11,648 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:11,648 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:11,648 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   iterations: 252
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   learning_rate: 0.05163774054354756
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.865140193283543
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   random_strength: 0.6153870536426129
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   bagging_temperature: 0.4762989601158772
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   border_count: 70
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:11,649 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:11,835 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:11,835 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:11,835 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:11,835 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:11,835 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:11,835 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:11,835 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:11,835 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,836 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:11,836 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:11,836 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:11,836 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:11,836 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:11,836 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:11,837 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:11,837 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:11,837 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,837 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:11,837 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:11,837 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:11,837 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:11,838 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:11,838 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,838 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,838 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:11,838 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:11,838 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:11,838 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:11,838 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:11,838 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:11,838 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,839 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,839 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,839 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:11,839 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:11,839 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:11,839 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:11,839 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:11,839 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:11,839 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:11,839 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:11,839 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:11,839 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:11,839 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:11,839 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:11,839 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:11,839 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:11,839 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:11,839 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:11,839 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:11,839 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,839 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,839 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,839 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,842 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:11,842 - src.hyperparameter_tuning - ERROR - Trial 65 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:11,858 - src.hyperparameter_tuning - INFO - Trial 66: 모델 타입 = catboost
2025-06-24 09:32:11,862 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:11,863 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:11,863 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:11,863 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:11,863 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:11,863 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:11,863 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:11,863 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:11,864 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:11,864 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:11,864 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:11,864 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:11,864 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:11,864 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:11,864 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:11,864 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:11,864 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:11,864 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:11,865 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:11,865 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:11,865 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:11,865 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:11,865 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:11,865 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:11,865 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:11,865 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:11,866 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:11,866 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:11,869 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:11,872 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:11,872 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:11,872 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:11,872 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:11,872 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:11,872 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:11,872 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:11,874 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:11,876 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:11,876 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:11,876 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:11,876 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:11,876 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:11,876 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:11,876 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:11,876 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:11,876 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,876 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,877 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:11,877 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:11,877 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,877 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,877 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:11,877 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:11,877 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,877 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:11,878 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:11,878 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:11,878 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:11,878 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:11,878 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:11,878 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:11,878 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:11,878 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:11,878 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:11,878 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:11,878 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:11,879 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:11,879 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:11,879 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:11,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:11,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:11,879 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:11,879 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:11,879 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:11,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:11,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:11,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:11,880 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:11,880 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:11,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:11,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:11,881 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:11,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:11,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:11,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:11,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:11,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:11,881 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:11,881 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:11,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:11,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   iterations: 171
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   learning_rate: 0.04347778964221662
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   l2_leaf_reg: 6.236296447464508
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   random_strength: 1.5866159971908103
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   bagging_temperature: 0.360620981843112
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   border_count: 254
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:11,882 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:11,883 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:12,063 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:12,063 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:12,063 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:12,063 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:12,063 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:12,063 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:12,063 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:12,063 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,063 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:12,064 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:12,064 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:12,064 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:12,064 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:12,064 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:12,064 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:12,065 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:12,065 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,065 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:12,065 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:12,065 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:12,065 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:12,065 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:12,066 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,066 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,066 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:12,066 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:12,066 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:12,066 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:12,066 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:12,066 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:12,066 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,067 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,067 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,067 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,067 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:12,067 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:12,067 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:12,067 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:12,067 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:12,068 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:12,068 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:12,068 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:12,068 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:12,068 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:12,068 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:12,068 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:12,068 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:12,068 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:12,068 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:12,068 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:12,068 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,068 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,068 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,068 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,070 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:12,070 - src.hyperparameter_tuning - ERROR - Trial 66 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:12,088 - src.hyperparameter_tuning - INFO - Trial 67: 모델 타입 = catboost
2025-06-24 09:32:12,093 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:12,094 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:12,094 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:12,094 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:12,094 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:12,094 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:12,094 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:12,094 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:12,094 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:12,094 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:12,094 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:12,094 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:12,094 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:12,094 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:12,094 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:12,094 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:12,094 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:12,094 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:12,096 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:12,096 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:12,096 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:12,096 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:12,096 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:12,096 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:12,096 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:12,096 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:12,096 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:12,096 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:12,100 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:12,102 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:12,102 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:12,102 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:12,102 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:12,102 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:12,102 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:12,102 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:12,104 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:12,106 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:12,106 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:12,107 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:12,107 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:12,107 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:12,107 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:12,107 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:12,107 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:12,107 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,107 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,107 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:12,107 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:12,107 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,107 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,107 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:12,107 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:12,107 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,108 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:12,108 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:12,108 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:12,109 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:12,109 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:12,109 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:12,109 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:12,109 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:12,109 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:12,109 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:12,109 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:12,109 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:12,109 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:12,109 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:12,109 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:12,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:12,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:12,109 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:12,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:12,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:12,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:12,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:12,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:12,110 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:12,110 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:12,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:12,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:12,111 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:12,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:12,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:12,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:12,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:12,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:12,112 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:12,112 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,112 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:12,112 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,112 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:12,112 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,112 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:12,112 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:12,112 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:12,112 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   iterations: 64
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   learning_rate: 0.0739375060790503
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.2819175053815917
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   random_strength: 0.11595989694708969
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   bagging_temperature: 0.9820263062678408
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   border_count: 109
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:12,113 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:12,114 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:12,114 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:12,114 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:12,114 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:12,295 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:12,295 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:12,295 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:12,295 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:12,295 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:12,295 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:12,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:12,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:12,296 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:12,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:12,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:12,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:12,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:12,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:12,297 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:12,297 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:12,297 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:12,297 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:12,297 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:12,297 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:12,297 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,297 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,298 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:12,298 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:12,298 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:12,298 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:12,298 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:12,298 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:12,298 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,298 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,299 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,299 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,299 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:12,299 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:12,299 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:12,299 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:12,299 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:12,299 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:12,299 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:12,299 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:12,299 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:12,299 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:12,299 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:12,299 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:12,299 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:12,299 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:12,299 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:12,299 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:12,299 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,299 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,299 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,299 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,302 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:12,302 - src.hyperparameter_tuning - ERROR - Trial 67 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:12,318 - src.hyperparameter_tuning - INFO - Trial 68: 모델 타입 = catboost
2025-06-24 09:32:12,322 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:12,322 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:12,322 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:12,322 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:12,322 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:12,322 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:12,322 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:12,322 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:12,322 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:12,323 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:12,323 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:12,323 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:12,323 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:12,323 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:12,323 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:12,323 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:12,323 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:12,323 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:12,324 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:12,324 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:12,324 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:12,324 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:12,324 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:12,324 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:12,324 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:12,324 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:12,324 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:12,324 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:12,328 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:12,330 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:12,330 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:12,330 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:12,330 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:12,330 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:12,330 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:12,330 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:12,332 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:12,334 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:12,334 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:12,334 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:12,334 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:12,334 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:12,334 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:12,334 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:12,335 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:12,335 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,335 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,335 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:12,335 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:12,335 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,335 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,335 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:12,335 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:12,335 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,336 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:12,336 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:12,336 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:12,337 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:12,337 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:12,337 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:12,337 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:12,337 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:12,337 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:12,337 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:12,337 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:12,337 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:12,337 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:12,337 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:12,337 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:12,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:12,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:12,337 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:12,337 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:12,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:12,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:12,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:12,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:12,338 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:12,338 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,339 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:12,339 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,339 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:12,339 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,339 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:12,339 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:12,339 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:12,339 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:12,339 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:12,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:12,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:12,340 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:12,340 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:12,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,340 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:12,340 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,340 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:12,340 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:12,340 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:12,340 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   iterations: 121
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   learning_rate: 0.018806107854357726
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.8234423182045916
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   random_strength: 2.1080837340391354
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   bagging_temperature: 0.2642712370355795
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   border_count: 40
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:12,341 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:12,342 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:12,342 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:12,342 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:12,342 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:12,342 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:12,342 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:12,342 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:12,342 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:12,342 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:12,526 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:12,526 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:12,526 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:12,526 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:12,526 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:12,526 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:12,526 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:12,526 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,527 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:12,527 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:12,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:12,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:12,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:12,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:12,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:12,528 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:12,528 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:12,528 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:12,528 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:12,528 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:12,528 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:12,528 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,528 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,528 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:12,528 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:12,529 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:12,529 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:12,529 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:12,529 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:12,529 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,529 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,529 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,530 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,530 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:12,530 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:12,530 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:12,530 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:12,530 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:12,530 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:12,530 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:12,530 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:12,530 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:12,530 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:12,530 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:12,530 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:12,530 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:12,530 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:12,530 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:12,530 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:12,530 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,530 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,530 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,530 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,532 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:12,532 - src.hyperparameter_tuning - ERROR - Trial 68 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:12,548 - src.hyperparameter_tuning - INFO - Trial 69: 모델 타입 = catboost
2025-06-24 09:32:12,552 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:12,553 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:12,553 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:12,553 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:12,553 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:12,553 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:12,553 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:12,553 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:12,553 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:12,553 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:12,553 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:12,553 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:12,553 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:12,553 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:12,553 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:12,553 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:12,554 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:12,554 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:12,554 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:12,554 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:12,554 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:12,554 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:12,555 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:12,555 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:12,555 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:12,555 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:12,555 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:12,555 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:12,558 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:12,560 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:12,560 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:12,560 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:12,560 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:12,560 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:12,560 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:12,560 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:12,562 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:12,564 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:12,564 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:12,564 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:12,564 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:12,564 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:12,564 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:12,564 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:12,564 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:12,564 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,564 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,565 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:12,565 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:12,565 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,565 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,565 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:12,565 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:12,565 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,566 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:12,566 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:12,566 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:12,566 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:12,567 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:12,567 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:12,567 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:12,567 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:12,567 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:12,567 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:12,567 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:12,567 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:12,567 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:12,567 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:12,567 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:12,567 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:12,567 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,567 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:12,567 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:12,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:12,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:12,568 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:12,568 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:12,568 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:12,568 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:12,568 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:12,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:12,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:12,569 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:12,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:12,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:12,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:12,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:12,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:12,569 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:12,569 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,570 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:12,570 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   iterations: 422
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   learning_rate: 0.029124577509419002
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.092867344661627
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   random_strength: 0.7582454228195513
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   bagging_temperature: 0.23122041198197482
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   border_count: 242
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:12,570 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:12,571 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:12,755 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:12,755 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:12,755 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:12,755 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:12,755 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:12,755 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:12,755 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:12,755 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,755 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:12,755 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:12,756 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:12,756 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:12,756 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:12,756 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:12,756 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:12,756 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:12,756 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,756 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:12,757 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:12,757 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:12,757 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:12,757 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:12,757 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,757 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,757 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:12,757 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:12,757 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:12,757 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:12,757 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:12,757 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:12,758 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,758 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,758 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,758 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,758 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:12,759 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:12,759 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:12,759 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:12,759 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:12,759 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:12,759 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:12,759 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:12,759 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:12,759 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:12,759 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:12,759 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:12,759 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:12,759 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:12,759 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:12,759 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:12,759 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,759 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,759 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,759 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,761 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:12,761 - src.hyperparameter_tuning - ERROR - Trial 69 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:12,777 - src.hyperparameter_tuning - INFO - Trial 70: 모델 타입 = catboost
2025-06-24 09:32:12,781 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:12,781 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:12,781 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:12,782 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:12,782 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:12,782 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:12,782 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:12,782 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:12,782 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:12,782 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:12,782 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:12,782 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:12,782 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:12,782 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:12,782 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:12,782 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:12,782 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:12,782 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:12,783 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:12,783 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:12,783 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:12,783 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:12,783 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:12,783 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:12,783 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:12,783 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:12,783 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:12,783 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:12,787 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:12,789 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:12,789 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:12,789 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:12,789 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:12,789 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:12,789 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:12,789 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:12,791 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:12,793 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:12,793 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:12,793 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:12,793 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:12,793 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:12,793 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:12,793 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:12,793 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:12,793 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,793 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,794 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:12,794 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:12,794 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,794 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,794 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:12,794 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:12,794 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,795 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:12,795 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:12,795 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:12,795 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:12,795 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:12,795 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:12,795 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:12,795 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:12,796 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:12,796 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:12,796 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:12,796 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:12,796 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:12,796 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:12,796 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:12,796 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:12,796 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,796 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:12,796 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:12,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:12,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:12,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:12,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:12,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:12,797 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:12,797 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,797 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:12,797 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,797 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:12,797 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,797 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:12,798 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:12,798 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:12,798 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:12,798 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:12,798 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:12,798 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:12,798 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:12,798 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,799 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:12,799 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   iterations: 158
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   learning_rate: 0.09717719682425534
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.03095339199025
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   random_strength: 0.2422804061938444
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   bagging_temperature: 0.15328097148318853
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   border_count: 61
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:12,799 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:12,800 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:12,983 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:12,983 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:12,983 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:12,983 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:12,983 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:12,983 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:12,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:12,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:12,984 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:12,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:12,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:12,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:12,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:12,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:12,984 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:12,984 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:12,985 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:12,985 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:12,985 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:12,985 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:12,985 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,985 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,985 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:12,985 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:12,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:12,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:12,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:12,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:12,986 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,986 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,987 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,987 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:12,987 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:12,987 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:12,987 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:12,987 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:12,987 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:12,987 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:12,987 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:12,987 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:12,987 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:12,987 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:12,987 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:12,987 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:12,987 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:12,987 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:12,987 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:12,987 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:12,987 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,987 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,987 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:12,987 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:12,990 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:12,990 - src.hyperparameter_tuning - ERROR - Trial 70 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:13,006 - src.hyperparameter_tuning - INFO - Trial 71: 모델 타입 = catboost
2025-06-24 09:32:13,010 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:13,010 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:13,010 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:13,010 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:13,010 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:13,010 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:13,010 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:13,010 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:13,010 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:13,011 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:13,011 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:13,011 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:13,011 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:13,011 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:13,011 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:13,011 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:13,011 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:13,011 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:13,012 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:13,012 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:13,012 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:13,012 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:13,012 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:13,012 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:13,012 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:13,012 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:13,012 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:13,012 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:13,016 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:13,018 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:13,018 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:13,018 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:13,018 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:13,018 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:13,018 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:13,018 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:13,020 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:13,022 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:13,022 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:13,022 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:13,022 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:13,022 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:13,022 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:13,022 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:13,022 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:13,022 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,022 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,023 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:13,023 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:13,023 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,023 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,023 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:13,023 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:13,023 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,023 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:13,023 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:13,023 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:13,024 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:13,024 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:13,024 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:13,024 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:13,024 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:13,024 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:13,024 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:13,024 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:13,024 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:13,024 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:13,024 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:13,024 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:13,024 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:13,024 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:13,025 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:13,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:13,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:13,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:13,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:13,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:13,026 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:13,026 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:13,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:13,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:13,026 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:13,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:13,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:13,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:13,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:13,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:13,027 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:13,027 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:13,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,027 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:13,027 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,027 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   iterations: 87
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   learning_rate: 0.13084169159148806
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   l2_leaf_reg: 7.98988105749073
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   random_strength: 5.115548084901096
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   bagging_temperature: 0.5575856216197695
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   border_count: 223
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:13,028 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:13,029 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:13,211 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:13,211 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:13,211 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:13,211 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:13,211 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:13,211 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:13,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:13,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,212 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:13,212 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:13,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:13,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:13,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:13,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:13,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:13,213 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:13,213 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:13,213 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:13,214 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:13,214 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:13,214 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:13,214 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,214 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,214 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:13,214 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:13,214 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:13,214 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:13,214 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:13,214 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:13,214 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,215 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,215 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,215 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,215 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:13,215 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:13,215 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:13,215 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:13,215 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:13,215 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:13,215 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:13,215 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:13,215 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:13,215 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:13,215 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:13,215 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:13,216 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:13,216 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:13,216 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:13,216 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:13,216 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,216 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,216 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,216 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,218 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:13,218 - src.hyperparameter_tuning - ERROR - Trial 71 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:13,234 - src.hyperparameter_tuning - INFO - Trial 72: 모델 타입 = catboost
2025-06-24 09:32:13,238 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:13,239 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:13,239 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:13,239 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:13,239 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:13,239 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:13,239 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:13,239 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:13,239 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:13,240 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:13,240 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:13,240 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:13,240 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:13,240 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:13,240 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:13,240 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:13,240 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:13,240 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:13,241 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:13,241 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:13,241 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:13,241 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:13,241 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:13,241 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:13,241 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:13,241 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:13,241 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:13,241 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:13,244 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:13,246 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:13,246 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:13,246 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:13,246 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:13,246 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:13,246 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:13,246 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:13,248 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:13,250 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:13,250 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:13,251 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:13,251 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:13,251 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:13,251 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:13,251 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:13,251 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:13,251 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,251 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,251 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:13,251 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:13,251 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,251 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,251 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:13,251 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:13,251 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,252 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:13,252 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:13,252 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:13,253 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:13,253 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:13,253 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:13,253 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:13,253 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:13,253 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:13,253 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:13,253 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:13,253 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:13,253 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:13,253 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:13,253 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:13,253 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:13,253 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,253 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:13,253 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:13,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:13,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:13,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:13,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:13,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:13,254 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:13,254 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,255 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:13,255 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,255 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:13,255 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,255 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:13,255 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:13,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:13,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:13,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:13,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:13,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:13,256 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:13,256 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,256 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:13,256 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,256 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:13,256 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,256 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:13,256 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:13,256 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:13,256 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   iterations: 139
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   learning_rate: 0.15899137323957577
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   l2_leaf_reg: 6.690038556563137
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   random_strength: 8.554153146957065
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   bagging_temperature: 0.5958596816315245
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   border_count: 230
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:13,257 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:13,441 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:13,441 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:13,441 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:13,441 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:13,441 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:13,441 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:13,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:13,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:13,442 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:13,442 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:13,442 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:13,442 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:13,442 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:13,442 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:13,442 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:13,442 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,443 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:13,443 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:13,443 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:13,443 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:13,443 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:13,443 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,443 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,443 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:13,443 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:13,444 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:13,444 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:13,444 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:13,444 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:13,444 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,444 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,445 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,445 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,445 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:13,445 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:13,445 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:13,445 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:13,445 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:13,445 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:13,445 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:13,445 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:13,445 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:13,445 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:13,445 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:13,445 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:13,445 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:13,445 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:13,445 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:13,445 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:13,445 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,445 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,445 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,445 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,448 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:13,448 - src.hyperparameter_tuning - ERROR - Trial 72 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:13,464 - src.hyperparameter_tuning - INFO - Trial 73: 모델 타입 = catboost
2025-06-24 09:32:13,468 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:13,468 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:13,468 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:13,469 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:13,469 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:13,469 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:13,469 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:13,469 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:13,469 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:13,469 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:13,469 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:13,469 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:13,469 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:13,469 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:13,469 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:13,469 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:13,470 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:13,470 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:13,470 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:13,470 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:13,470 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:13,470 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:13,471 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:13,471 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:13,471 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:13,471 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:13,471 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:13,471 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:13,474 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:13,476 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:13,476 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:13,476 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:13,476 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:13,476 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:13,476 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:13,476 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:13,478 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:13,480 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:13,480 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:13,480 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:13,480 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:13,480 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:13,480 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:13,480 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:13,480 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:13,480 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,480 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,481 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:13,481 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:13,481 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,481 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,481 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:13,481 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:13,481 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,482 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:13,482 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:13,482 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:13,482 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:13,482 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:13,483 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:13,483 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:13,483 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:13,483 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:13,483 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:13,483 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:13,483 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:13,483 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:13,483 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:13,483 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:13,483 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:13,483 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,483 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:13,483 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:13,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:13,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:13,484 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:13,484 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:13,484 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:13,484 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:13,484 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,484 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:13,484 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,484 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:13,484 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,484 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:13,485 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:13,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:13,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:13,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:13,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:13,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:13,485 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:13,485 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,486 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:13,486 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   iterations: 477
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   learning_rate: 0.10838803621999016
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   l2_leaf_reg: 9.9518378445725
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   random_strength: 6.90935309172222
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   bagging_temperature: 0.6454195951544005
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   border_count: 147
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:13,486 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:13,487 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:13,670 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:13,670 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:13,670 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:13,670 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:13,670 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:13,670 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:13,670 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:13,670 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,670 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:13,671 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:13,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:13,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:13,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:13,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:13,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:13,671 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:13,671 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,672 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:13,672 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:13,672 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:13,672 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:13,672 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:13,672 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,672 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,672 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:13,672 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:13,672 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:13,673 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:13,673 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:13,673 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:13,673 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,673 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,673 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,674 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,674 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:13,674 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:13,674 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:13,674 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:13,674 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:13,674 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:13,674 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:13,674 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:13,674 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:13,674 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:13,674 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:13,674 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:13,674 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:13,674 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:13,674 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:13,674 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:13,674 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,674 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,674 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,674 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,676 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:13,676 - src.hyperparameter_tuning - ERROR - Trial 73 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:13,693 - src.hyperparameter_tuning - INFO - Trial 74: 모델 타입 = catboost
2025-06-24 09:32:13,697 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:13,698 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:13,698 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:13,698 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:13,698 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:13,698 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:13,698 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:13,698 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:13,698 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:13,699 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:13,699 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:13,699 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:13,699 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:13,699 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:13,699 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:13,699 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:13,699 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:13,699 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:13,700 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:13,700 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:13,700 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:13,700 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:13,700 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:13,700 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:13,700 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:13,700 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:13,700 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:13,700 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:13,704 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:13,706 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:13,706 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:13,706 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:13,706 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:13,706 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:13,706 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:13,706 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:13,708 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:13,710 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:13,710 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:13,710 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:13,710 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:13,710 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:13,710 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:13,710 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:13,710 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:13,710 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,710 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,711 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:13,711 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:13,711 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,711 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,711 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:13,711 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:13,711 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,712 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:13,712 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:13,712 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:13,713 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:13,713 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:13,713 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:13,713 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:13,713 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:13,713 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:13,713 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:13,713 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:13,713 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:13,713 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:13,713 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:13,713 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:13,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:13,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:13,713 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:13,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:13,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:13,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:13,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:13,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:13,714 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:13,714 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:13,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:13,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:13,715 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:13,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:13,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:13,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:13,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:13,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:13,715 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:13,715 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:13,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO -   iterations: 132
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO -   learning_rate: 0.010314872438492523
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO -   l2_leaf_reg: 9.274668976663852
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO -   random_strength: 4.803189900586076
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO -   bagging_temperature: 0.6968180751581096
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO -   border_count: 215
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:13,716 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:13,717 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:13,900 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:13,900 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:13,900 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:13,900 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:13,900 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:13,900 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:13,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:13,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:13,901 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:13,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:13,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:13,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:13,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:13,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:13,902 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:13,902 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:13,902 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:13,902 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:13,902 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:13,902 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:13,902 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,902 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,902 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:13,902 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:13,903 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:13,903 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:13,903 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:13,903 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:13,903 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,903 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,904 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,904 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:13,904 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:13,904 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:13,904 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:13,904 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:13,904 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:13,904 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:13,904 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:13,904 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:13,904 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:13,904 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:13,904 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:13,904 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:13,904 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:13,904 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:13,904 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:13,904 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:13,904 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,904 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,904 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,904 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,907 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:13,907 - src.hyperparameter_tuning - ERROR - Trial 74 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:13,924 - src.hyperparameter_tuning - INFO - Trial 75: 모델 타입 = catboost
2025-06-24 09:32:13,928 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:13,929 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:13,929 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:13,929 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:13,929 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:13,929 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:13,929 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:13,929 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:13,929 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:13,930 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:13,930 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:13,930 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:13,930 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:13,930 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:13,930 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:13,930 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:13,930 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:13,930 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:13,931 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:13,931 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:13,931 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:13,931 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:13,931 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:13,931 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:13,931 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:13,931 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:13,931 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:13,931 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:13,934 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:13,936 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:13,936 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:13,937 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:13,937 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:13,937 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:13,937 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:13,937 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:13,939 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:13,941 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:13,941 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:13,941 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:13,941 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:13,941 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:13,941 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:13,941 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:13,941 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:13,941 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,941 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,941 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:13,941 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:13,941 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,941 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,941 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:13,941 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:13,942 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,942 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:13,942 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:13,942 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:13,943 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:13,943 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:13,943 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:13,943 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:13,943 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:13,943 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:13,943 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:13,943 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:13,943 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:13,943 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:13,943 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:13,943 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:13,943 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:13,943 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,943 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:13,944 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:13,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:13,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:13,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:13,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:13,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:13,945 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:13,945 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,945 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:13,945 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,945 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:13,945 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,945 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:13,945 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:13,945 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:13,945 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:13,946 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:13,946 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:13,946 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:13,946 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:13,946 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:13,946 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:13,946 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,946 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:13,946 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:13,946 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:13,946 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:13,946 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   iterations: 106
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   learning_rate: 0.012445297565604625
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.048147049394574
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   random_strength: 1.1613780237066584
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   bagging_temperature: 0.5175143534658535
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   border_count: 247
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:13,947 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:13,948 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:13,948 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:13,948 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:13,948 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:13,948 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:13,948 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:13,948 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:13,948 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:13,948 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:13,948 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:14,120 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:14,120 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:14,120 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:14,121 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:14,121 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:14,121 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:14,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:14,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:14,121 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:14,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:14,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:14,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:14,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:14,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:14,122 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:14,122 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:14,123 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:14,123 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:14,123 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:14,123 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:14,123 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,123 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,123 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:14,123 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:14,123 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:14,123 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:14,123 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:14,123 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:14,124 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,124 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,124 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,124 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,125 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:14,125 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:14,125 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:14,125 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:14,125 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:14,125 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:14,125 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:14,125 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:14,125 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:14,125 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:14,125 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:14,125 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:14,125 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:14,125 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:14,125 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:14,125 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:14,125 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,125 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,125 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,125 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,127 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:14,127 - src.hyperparameter_tuning - ERROR - Trial 75 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:14,143 - src.hyperparameter_tuning - INFO - Trial 76: 모델 타입 = catboost
2025-06-24 09:32:14,147 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:14,148 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:14,148 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:14,148 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:14,148 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:14,148 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:14,148 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:14,148 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:14,148 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:14,149 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:14,149 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:14,149 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:14,149 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:14,149 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:14,149 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:14,149 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:14,149 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:14,149 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:14,150 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:14,150 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:14,150 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:14,150 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:14,150 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:14,150 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:14,150 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:14,150 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:14,150 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:14,150 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:14,154 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:14,156 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:14,156 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:14,156 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:14,156 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:14,156 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:14,156 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:14,156 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:14,158 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:14,160 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:14,160 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:14,160 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:14,160 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:14,160 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:14,160 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:14,160 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:14,160 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:14,160 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,160 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,161 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:14,161 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:14,161 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,161 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,161 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:14,161 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:14,161 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,162 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:14,162 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:14,162 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:14,162 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:14,163 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:14,163 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:14,163 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:14,163 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:14,163 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:14,163 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:14,163 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:14,163 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:14,163 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:14,163 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:14,163 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:14,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:14,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:14,163 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:14,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:14,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:14,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:14,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:14,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:14,164 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:14,164 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:14,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:14,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:14,165 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:14,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:14,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:14,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:14,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:14,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:14,166 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:14,166 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,166 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:14,166 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO -   iterations: 186
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO -   depth: 7
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO -   learning_rate: 0.25613505570149814
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.5524032777584176
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:14,166 - src.models.catboost_model - INFO -   random_strength: 7.505871136309986
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   bagging_temperature: 0.6391706927667427
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   border_count: 239
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:14,167 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:14,357 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:14,357 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:14,358 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:14,358 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:14,358 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:14,358 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:14,358 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:14,358 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,358 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:14,358 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:14,358 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:14,359 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:14,359 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:14,359 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:14,359 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:14,359 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:14,359 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,359 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:14,360 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:14,360 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:14,360 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:14,360 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:14,360 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,360 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,360 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:14,360 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:14,360 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:14,360 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:14,361 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:14,361 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:14,361 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,361 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,361 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,362 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,362 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:14,362 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:14,362 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:14,362 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:14,362 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:14,362 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:14,362 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:14,362 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:14,362 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:14,362 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:14,362 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:14,362 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:14,362 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:14,362 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:14,362 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:14,362 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:14,362 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,362 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,362 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,362 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,365 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:14,365 - src.hyperparameter_tuning - ERROR - Trial 76 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:14,382 - src.hyperparameter_tuning - INFO - Trial 77: 모델 타입 = catboost
2025-06-24 09:32:14,386 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:14,387 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:14,387 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:14,387 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:14,387 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:14,387 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:14,387 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:14,387 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:14,387 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:14,387 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:14,387 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:14,387 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:14,387 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:14,387 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:14,387 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:14,387 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:14,388 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:14,388 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:14,389 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:14,389 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:14,389 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:14,389 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:14,389 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:14,389 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:14,389 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:14,389 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:14,389 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:14,389 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:14,393 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:14,396 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:14,396 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:14,396 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:14,396 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:14,396 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:14,396 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:14,396 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:14,398 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:14,400 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:14,400 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:14,400 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:14,400 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:14,400 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:14,400 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:14,400 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:14,400 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:14,400 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,400 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,401 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:14,401 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:14,401 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,401 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,401 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:14,401 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:14,401 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,401 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:14,401 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:14,401 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:14,402 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:14,402 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:14,402 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:14,402 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:14,402 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:14,402 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:14,402 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:14,402 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:14,402 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:14,402 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:14,402 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:14,402 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:14,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:14,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:14,403 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:14,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:14,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:14,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:14,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:14,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:14,404 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:14,404 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:14,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:14,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:14,404 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:14,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:14,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:14,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:14,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:14,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:14,405 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:14,405 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:14,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,405 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:14,405 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   iterations: 203
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   learning_rate: 0.08266941862076241
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.47765714198417
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   random_strength: 4.19176129235651
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   bagging_temperature: 0.29942109712123577
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   border_count: 203
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:14,406 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:14,407 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:14,592 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:14,592 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:14,592 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:14,592 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:14,592 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:14,592 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:14,592 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:14,592 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,592 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:14,593 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:14,593 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:14,593 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:14,593 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:14,593 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:14,593 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:14,594 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:14,594 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,594 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:14,594 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:14,594 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:14,594 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:14,594 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:14,594 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,594 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,594 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:14,594 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:14,595 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:14,595 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:14,595 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:14,595 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:14,595 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,595 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,596 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,596 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,596 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:14,596 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:14,596 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:14,596 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:14,596 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:14,596 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:14,596 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:14,596 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:14,596 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:14,596 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:14,596 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:14,596 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:14,596 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:14,596 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:14,596 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:14,596 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:14,596 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,596 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,596 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,596 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,599 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:14,599 - src.hyperparameter_tuning - ERROR - Trial 77 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:14,616 - src.hyperparameter_tuning - INFO - Trial 78: 모델 타입 = catboost
2025-06-24 09:32:14,620 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:14,620 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:14,620 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:14,620 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:14,620 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:14,620 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:14,620 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:14,620 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:14,621 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:14,621 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:14,621 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:14,621 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:14,621 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:14,621 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:14,621 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:14,621 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:14,621 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:14,621 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:14,622 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:14,622 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:14,622 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:14,622 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:14,623 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:14,623 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:14,623 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:14,623 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:14,623 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:14,623 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:14,626 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:14,628 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:14,628 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:14,629 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:14,629 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:14,629 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:14,629 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:14,629 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:14,631 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:14,633 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:14,633 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:14,633 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:14,633 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:14,633 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:14,633 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:14,633 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:14,633 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:14,633 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,633 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,634 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:14,634 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:14,634 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,634 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,634 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:14,634 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:14,634 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,635 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:14,635 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:14,635 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:14,636 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:14,636 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:14,636 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:14,636 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:14,636 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:14,636 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:14,636 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:14,636 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:14,636 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:14,636 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:14,636 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:14,636 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:14,636 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:14,636 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,636 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:14,637 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:14,637 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:14,637 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:14,637 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:14,637 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:14,637 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:14,638 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:14,638 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,638 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:14,638 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,638 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:14,638 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,638 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:14,638 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:14,639 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:14,639 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:14,639 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:14,639 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:14,639 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:14,639 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:14,639 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,640 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:14,640 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   iterations: 155
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   learning_rate: 0.13683120157492276
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.759140441856878
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   random_strength: 5.779275513987985
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   bagging_temperature: 0.9162847127743488
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   border_count: 233
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:14,640 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:14,641 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:14,823 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:14,823 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:14,823 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:14,823 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:14,823 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:14,823 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:14,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:14,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,824 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:14,824 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:14,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:14,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:14,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:14,825 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:14,825 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:14,825 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:14,825 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:14,825 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:14,826 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:14,826 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:14,826 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:14,826 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,826 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,826 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:14,826 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:14,826 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:14,826 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:14,826 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:14,826 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:14,826 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,827 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,827 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,827 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:14,827 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:14,827 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:14,827 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:14,827 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:14,827 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:14,827 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:14,827 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:14,827 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:14,827 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:14,827 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:14,827 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:14,827 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:14,827 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:14,827 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:14,827 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:14,827 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:14,827 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,827 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,828 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,828 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,830 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:14,830 - src.hyperparameter_tuning - ERROR - Trial 78 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:14,847 - src.hyperparameter_tuning - INFO - Trial 79: 모델 타입 = catboost
2025-06-24 09:32:14,851 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:14,851 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:14,852 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:14,852 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:14,852 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:14,852 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:14,852 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:14,852 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:14,852 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:14,852 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:14,852 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:14,852 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:14,852 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:14,852 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:14,852 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:14,852 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:14,852 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:14,852 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:14,854 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:14,854 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:14,854 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:14,854 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:14,854 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:14,854 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:14,854 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:14,854 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:14,854 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:14,854 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:14,858 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:14,860 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:14,860 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:14,860 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:14,860 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:14,860 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:14,860 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:14,860 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:14,862 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:14,864 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:14,864 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:14,864 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:14,864 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:14,864 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:14,864 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:14,864 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:14,864 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:14,864 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,864 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,865 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:14,865 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:14,865 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,865 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,865 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:14,865 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:14,865 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,866 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:14,866 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:14,866 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:14,867 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:14,867 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:14,867 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:14,867 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:14,867 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:14,867 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:14,867 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:14,867 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:14,867 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:14,867 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:14,867 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:14,867 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:14,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:14,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:14,867 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:14,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:14,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:14,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:14,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:14,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:14,868 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:14,868 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:14,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:14,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:14,869 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:14,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:14,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:14,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:14,870 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:14,870 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:14,870 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:14,870 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:14,870 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:14,870 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,870 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:14,870 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:14,870 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:14,870 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:14,870 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   iterations: 60
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   learning_rate: 0.033314222477245005
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.6326907981695473
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   random_strength: 0.38188102286048575
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   bagging_temperature: 0.8037707127368952
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   border_count: 80
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:14,871 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:14,872 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:15,056 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:15,056 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:15,056 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:15,056 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:15,056 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:15,056 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:15,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:15,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,057 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:15,057 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:15,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:15,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:15,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:15,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:15,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:15,057 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:15,058 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,058 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:15,058 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:15,058 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:15,058 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:15,058 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:15,058 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,058 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,058 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:15,058 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:15,059 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:15,059 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:15,059 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:15,059 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:15,059 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,059 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,060 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,060 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,060 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:15,060 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:15,060 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:15,060 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:15,060 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:15,060 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:15,060 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:15,060 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:15,060 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:15,060 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:15,060 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:15,060 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:15,060 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:15,060 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:15,060 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:15,060 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:15,060 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,060 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,060 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,060 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,063 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:15,063 - src.hyperparameter_tuning - ERROR - Trial 79 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:15,079 - src.hyperparameter_tuning - INFO - Trial 80: 모델 타입 = catboost
2025-06-24 09:32:15,083 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:15,084 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:15,084 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:15,084 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:15,084 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:15,084 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:15,084 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:15,084 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:15,084 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:15,085 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:15,085 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:15,085 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:15,085 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:15,085 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:15,085 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:15,085 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:15,085 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:15,085 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:15,086 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:15,086 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:15,086 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:15,086 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:15,086 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:15,086 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:15,086 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:15,086 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:15,086 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:15,086 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:15,090 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:15,092 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:15,092 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:15,092 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:15,092 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:15,092 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:15,092 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:15,092 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:15,094 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:15,097 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:15,097 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:15,097 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:15,097 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:15,097 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:15,097 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:15,097 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:15,097 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:15,097 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,097 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,097 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:15,098 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:15,098 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,098 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,098 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:15,098 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:15,098 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,098 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:15,098 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:15,098 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:15,099 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:15,099 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:15,099 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:15,099 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:15,099 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:15,099 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:15,099 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:15,099 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:15,099 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:15,099 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:15,099 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:15,099 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:15,100 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:15,100 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,100 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:15,100 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:15,100 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:15,100 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:15,100 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:15,101 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:15,101 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:15,101 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:15,101 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,101 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:15,101 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,101 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:15,101 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,101 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:15,102 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:15,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:15,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:15,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:15,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:15,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:15,102 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:15,102 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,103 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:15,103 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   iterations: 302
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   learning_rate: 0.03777754239575799
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.8851209989680489
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   random_strength: 0.8630634725792179
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   bagging_temperature: 0.7359306877191281
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   border_count: 52
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:15,103 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:15,104 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:15,288 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:15,288 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:15,288 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:15,288 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:15,288 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:15,288 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:15,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:15,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:15,288 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:15,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:15,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:15,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:15,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:15,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:15,289 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:15,289 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:15,290 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:15,290 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:15,290 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:15,290 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:15,290 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,290 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,290 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:15,290 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:15,290 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:15,290 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:15,290 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:15,290 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:15,291 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,291 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,291 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,291 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,291 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:15,291 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:15,291 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:15,291 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:15,291 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:15,291 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:15,291 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:15,291 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:15,291 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:15,291 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:15,291 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:15,291 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:15,291 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:15,291 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:15,292 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:15,292 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:15,292 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,292 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,292 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,292 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,294 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:15,294 - src.hyperparameter_tuning - ERROR - Trial 80 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:15,310 - src.hyperparameter_tuning - INFO - Trial 81: 모델 타입 = catboost
2025-06-24 09:32:15,314 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:15,315 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:15,315 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:15,315 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:15,315 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:15,315 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:15,315 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:15,315 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:15,315 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:15,316 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:15,316 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:15,316 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:15,316 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:15,316 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:15,316 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:15,316 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:15,316 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:15,316 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:15,317 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:15,317 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:15,317 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:15,317 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:15,317 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:15,317 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:15,317 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:15,317 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:15,317 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:15,317 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:15,321 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:15,323 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:15,323 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:15,323 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:15,323 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:15,323 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:15,323 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:15,323 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:15,325 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:15,327 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:15,327 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:15,327 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:15,327 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:15,327 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:15,327 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:15,327 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:15,327 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:15,327 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,327 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,328 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:15,328 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:15,328 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,328 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,328 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:15,328 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:15,328 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,328 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:15,328 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:15,328 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:15,329 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:15,329 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:15,329 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:15,329 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:15,329 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:15,329 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:15,329 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:15,329 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:15,329 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:15,329 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:15,329 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:15,329 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:15,329 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:15,329 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,330 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:15,330 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:15,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:15,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:15,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:15,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:15,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:15,331 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:15,331 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:15,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:15,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:15,331 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:15,332 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:15,332 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:15,332 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:15,332 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:15,332 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:15,332 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:15,332 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,332 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:15,332 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,332 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:15,332 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   iterations: 86
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   learning_rate: 0.012100095831092957
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.1044385366141696
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   random_strength: 8.627281708362409
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   bagging_temperature: 0.3975736720049897
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   border_count: 97
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:15,333 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:15,334 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:15,515 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:15,515 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:15,515 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:15,515 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:15,515 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:15,515 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:15,515 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:15,515 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,515 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:15,515 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:15,516 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:15,516 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:15,516 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:15,516 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:15,516 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:15,516 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:15,516 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:15,517 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:15,517 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:15,517 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:15,517 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:15,517 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,517 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,517 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:15,517 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:15,517 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:15,517 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:15,517 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:15,517 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:15,518 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,518 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,518 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,518 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,518 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:15,518 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:15,518 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:15,518 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:15,519 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:15,519 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:15,519 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:15,519 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:15,519 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:15,519 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:15,519 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:15,519 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:15,519 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:15,519 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:15,519 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:15,519 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:15,519 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,519 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,519 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,519 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,521 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:15,521 - src.hyperparameter_tuning - ERROR - Trial 81 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:15,537 - src.hyperparameter_tuning - INFO - Trial 82: 모델 타입 = catboost
2025-06-24 09:32:15,541 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:15,542 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:15,542 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:15,542 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:15,542 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:15,542 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:15,542 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:15,542 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:15,542 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:15,543 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:15,543 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:15,543 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:15,543 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:15,543 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:15,543 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:15,543 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:15,543 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:15,543 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:15,544 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:15,544 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:15,544 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:15,544 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:15,544 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:15,544 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:15,544 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:15,544 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:15,544 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:15,544 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:15,547 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:15,549 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:15,550 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:15,550 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:15,550 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:15,550 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:15,550 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:15,550 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:15,552 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:15,554 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:15,554 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:15,554 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:15,554 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:15,554 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:15,554 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:15,554 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:15,554 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:15,554 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,554 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,554 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:15,554 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:15,554 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,554 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,555 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:15,555 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:15,555 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,555 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:15,555 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:15,555 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:15,556 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:15,556 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:15,556 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:15,556 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:15,556 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:15,556 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:15,556 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:15,556 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:15,556 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:15,556 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:15,556 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:15,556 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:15,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:15,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:15,557 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:15,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:15,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:15,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:15,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:15,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:15,557 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:15,557 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:15,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:15,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:15,558 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:15,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:15,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:15,559 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:15,559 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:15,559 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:15,559 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:15,559 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,559 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:15,559 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,559 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:15,559 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,559 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:15,559 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:15,559 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   iterations: 115
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   learning_rate: 0.022652530125766727
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.222831022368963
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   random_strength: 0.17723984209400015
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   bagging_temperature: 0.3323001094872569
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   border_count: 124
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:15,560 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:15,561 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:15,561 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:15,561 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:15,561 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:15,561 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:15,561 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:15,561 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:15,561 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:15,561 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:15,561 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:15,561 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:15,723 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:15,723 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:15,723 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:15,723 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:15,723 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:15,723 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:15,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:15,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:15,724 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:15,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:15,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:15,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:15,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:15,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:15,724 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:15,725 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:15,725 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:15,725 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:15,725 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:15,725 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:15,725 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,725 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,725 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:15,725 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:15,726 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:15,726 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:15,726 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:15,726 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:15,726 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,726 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,727 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,727 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,727 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:15,727 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:15,727 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:15,727 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:15,727 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:15,727 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:15,727 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:15,727 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:15,727 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:15,727 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:15,727 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:15,727 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:15,727 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:15,727 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:15,727 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:15,727 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:15,727 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,727 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,727 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,727 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,730 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:15,730 - src.hyperparameter_tuning - ERROR - Trial 82 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:15,746 - src.hyperparameter_tuning - INFO - Trial 83: 모델 타입 = catboost
2025-06-24 09:32:15,750 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:15,751 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:15,751 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:15,751 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:15,751 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:15,751 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:15,751 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:15,751 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:15,751 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:15,752 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:15,752 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:15,752 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:15,752 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:15,752 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:15,752 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:15,752 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:15,752 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:15,752 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:15,753 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:15,753 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:15,753 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:15,753 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:15,753 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:15,753 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:15,753 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:15,753 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:15,753 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:15,753 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:15,757 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:15,759 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:15,759 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:15,759 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:15,759 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:15,759 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:15,759 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:15,759 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:15,761 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:15,763 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:15,763 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:15,763 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:15,763 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:15,763 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:15,763 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:15,763 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:15,763 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:15,763 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,763 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,764 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:15,764 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:15,764 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,764 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,764 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:15,764 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:15,764 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,765 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:15,765 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:15,765 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:15,765 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:15,765 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:15,765 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:15,766 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:15,766 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:15,766 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:15,766 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:15,766 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:15,766 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:15,766 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:15,766 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:15,766 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:15,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:15,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:15,766 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:15,766 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:15,766 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:15,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:15,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:15,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:15,767 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:15,767 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:15,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:15,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:15,768 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:15,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:15,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:15,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:15,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:15,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:15,768 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:15,769 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,769 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:15,769 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO -   iterations: 100
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO -   learning_rate: 0.013769831506989608
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.3946060184771758
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:15,769 - src.models.catboost_model - INFO -   random_strength: 6.186954913426708
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   bagging_temperature: 0.2549893348022655
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   border_count: 118
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:15,770 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:15,949 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:15,950 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:15,950 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:15,950 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:15,950 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:15,950 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:15,950 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:15,950 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,950 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:15,950 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:15,951 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:15,951 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:15,951 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:15,951 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:15,951 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:15,951 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:15,951 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,951 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:15,952 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:15,952 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:15,952 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:15,952 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:15,952 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,952 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,952 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:15,952 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:15,952 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:15,953 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:15,953 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:15,953 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:15,953 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,953 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,953 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,954 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:15,954 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:15,954 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:15,954 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:15,954 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:15,954 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:15,954 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:15,954 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:15,954 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:15,954 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:15,954 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:15,954 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:15,954 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:15,954 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:15,954 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:15,954 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:15,954 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:15,954 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,954 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,954 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,954 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,956 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:15,956 - src.hyperparameter_tuning - ERROR - Trial 83 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:15,973 - src.hyperparameter_tuning - INFO - Trial 84: 모델 타입 = catboost
2025-06-24 09:32:15,977 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:15,978 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:15,978 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:15,978 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:15,978 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:15,978 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:15,978 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:15,978 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:15,978 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:15,979 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:15,979 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:15,979 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:15,979 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:15,979 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:15,979 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:15,979 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:15,979 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:15,979 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:15,980 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:15,980 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:15,980 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:15,980 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:15,980 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:15,980 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:15,980 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:15,980 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:15,980 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:15,980 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:15,983 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:15,985 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:15,985 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:15,985 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:15,985 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:15,985 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:15,985 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:15,985 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:15,987 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:15,989 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:15,989 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:15,989 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:15,989 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:15,989 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:15,989 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:15,989 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:15,989 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:15,989 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,989 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,990 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:15,990 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:15,990 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,990 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,990 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:15,990 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:15,990 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,990 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:15,991 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:15,991 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:15,991 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:15,991 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:15,991 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:15,991 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:15,991 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:15,991 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:15,991 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:15,991 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:15,991 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:15,992 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:15,992 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:15,992 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:15,992 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:15,992 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,992 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:15,992 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:15,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:15,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:15,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:15,993 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:15,993 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:15,993 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:15,993 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:15,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:15,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:15,993 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:15,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:15,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:15,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:15,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:15,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:15,994 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:15,994 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:15,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:15,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,994 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:15,994 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   iterations: 82
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   learning_rate: 0.01686414783364091
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.265661610821141
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   random_strength: 2.708943289554124
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   bagging_temperature: 0.3687759172262218
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   border_count: 111
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:15,995 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:15,996 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:16,169 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:16,169 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:16,169 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:16,169 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:16,169 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:16,169 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:16,169 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:16,169 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,169 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:16,170 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:16,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:16,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:16,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:16,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:16,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:16,170 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:16,170 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:16,171 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:16,171 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:16,171 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:16,171 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:16,171 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,171 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,171 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:16,171 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:16,171 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:16,172 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:16,172 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:16,172 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:16,172 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,172 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,172 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,173 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,173 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:16,173 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:16,173 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:16,173 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:16,173 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:16,173 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:16,173 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:16,173 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:16,173 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:16,173 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:16,173 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:16,173 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:16,173 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:16,173 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:16,173 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:16,173 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:16,173 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,173 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,173 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,173 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,175 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:16,175 - src.hyperparameter_tuning - ERROR - Trial 84 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:16,191 - src.hyperparameter_tuning - INFO - Trial 85: 모델 타입 = catboost
2025-06-24 09:32:16,195 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:16,196 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:16,196 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:16,196 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:16,196 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:16,196 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:16,196 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:16,196 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:16,196 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:16,197 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:16,197 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:16,197 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:16,197 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:16,197 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:16,197 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:16,197 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:16,197 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:16,197 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:16,198 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:16,198 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:16,198 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:16,198 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:16,198 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:16,198 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:16,198 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:16,198 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:16,198 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:16,198 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:16,201 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:16,203 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:16,203 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:16,203 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:16,204 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:16,204 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:16,204 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:16,204 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:16,206 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:16,207 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:16,207 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:16,208 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:16,208 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:16,208 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:16,208 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:16,208 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:16,208 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:16,208 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,208 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,208 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:16,208 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:16,208 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,208 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,208 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:16,208 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:16,208 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,209 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:16,209 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:16,209 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:16,210 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:16,210 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:16,210 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:16,210 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:16,210 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:16,210 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:16,210 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:16,210 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:16,210 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:16,210 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:16,210 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:16,210 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:16,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:16,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:16,210 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:16,210 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:16,211 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:16,211 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:16,211 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:16,211 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:16,211 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:16,211 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:16,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:16,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,212 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:16,212 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:16,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:16,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:16,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:16,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:16,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:16,212 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:16,213 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:16,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   iterations: 390
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   learning_rate: 0.17641982372974038
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.933253346252746
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   random_strength: 7.621119953512778
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   bagging_temperature: 0.2939498580198395
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   border_count: 133
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:16,213 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:16,214 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:16,394 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:16,394 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:16,394 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:16,394 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:16,394 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:16,394 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:16,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:16,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:16,394 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:16,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:16,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:16,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:16,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:16,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:16,395 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:16,395 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:16,396 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:16,396 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:16,396 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:16,396 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:16,396 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,396 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,396 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:16,396 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:16,396 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:16,396 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:16,396 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:16,396 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:16,397 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,397 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,397 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,397 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,398 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:16,398 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:16,398 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:16,398 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:16,398 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:16,398 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:16,398 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:16,398 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:16,398 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:16,398 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:16,398 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:16,398 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:16,398 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:16,398 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:16,398 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:16,398 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:16,398 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,398 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,398 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,398 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,400 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:16,400 - src.hyperparameter_tuning - ERROR - Trial 85 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:16,416 - src.hyperparameter_tuning - INFO - Trial 86: 모델 타입 = catboost
2025-06-24 09:32:16,420 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:16,421 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:16,421 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:16,421 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:16,421 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:16,421 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:16,421 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:16,421 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:16,421 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:16,422 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:16,422 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:16,422 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:16,422 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:16,422 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:16,422 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:16,422 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:16,422 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:16,422 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:16,423 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:16,423 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:16,423 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:16,423 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:16,423 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:16,423 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:16,423 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:16,423 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:16,423 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:16,423 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:16,427 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:16,429 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:16,429 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:16,429 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:16,429 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:16,429 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:16,429 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:16,429 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:16,431 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:16,432 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:16,433 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:16,433 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:16,433 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:16,433 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:16,433 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:16,433 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:16,433 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:16,433 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,433 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,433 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:16,433 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:16,433 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,433 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,433 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:16,433 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:16,433 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,434 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:16,434 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:16,434 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:16,435 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:16,435 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:16,435 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:16,435 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:16,435 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:16,435 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:16,435 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:16,435 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:16,435 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:16,435 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:16,435 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:16,435 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:16,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:16,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:16,435 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:16,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:16,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:16,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:16,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:16,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:16,436 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:16,436 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,436 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:16,436 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,436 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:16,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:16,437 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:16,437 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:16,437 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:16,437 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:16,437 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:16,437 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:16,438 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:16,438 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:16,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,438 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:16,438 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,438 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:16,438 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:16,438 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:16,438 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:16,438 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:16,438 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:16,438 - src.models.catboost_model - INFO -   iterations: 446
2025-06-24 09:32:16,438 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 09:32:16,438 - src.models.catboost_model - INFO -   learning_rate: 0.011121186848251993
2025-06-24 09:32:16,438 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.3818526049375564
2025-06-24 09:32:16,438 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:16,438 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:16,438 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   random_strength: 1.8442491032478416
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   bagging_temperature: 0.45179750395645013
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   border_count: 122
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:16,439 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:16,642 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:16,642 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:16,642 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:16,642 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:16,642 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:16,642 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:16,642 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:16,642 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,643 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:16,643 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:16,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:16,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:16,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:16,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:16,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:16,644 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:16,644 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:16,645 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:16,645 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:16,645 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:16,645 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:16,645 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,645 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:16,645 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:16,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:16,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:16,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:16,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:16,646 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,646 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,646 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,646 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,647 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:16,647 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:16,647 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:16,647 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:16,647 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:16,647 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:16,647 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:16,647 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:16,647 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:16,647 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:16,647 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:16,647 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:16,647 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:16,647 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:16,647 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:16,647 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:16,647 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,647 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,647 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,647 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,650 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:16,650 - src.hyperparameter_tuning - ERROR - Trial 86 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:16,667 - src.hyperparameter_tuning - INFO - Trial 87: 모델 타입 = catboost
2025-06-24 09:32:16,671 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:16,672 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:16,672 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:16,672 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:16,672 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:16,672 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:16,672 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:16,672 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:16,672 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:16,673 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:16,673 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:16,673 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:16,673 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:16,673 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:16,673 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:16,673 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:16,673 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:16,673 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:16,674 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:16,674 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:16,674 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:16,674 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:16,674 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:16,674 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:16,674 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:16,674 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:16,674 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:16,674 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:16,678 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:16,680 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:16,680 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:16,680 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:16,680 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:16,680 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:16,680 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:16,680 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:16,682 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:16,685 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:16,685 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:16,685 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:16,685 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:16,685 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:16,685 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:16,685 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:16,685 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:16,685 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,685 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,685 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:16,686 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:16,686 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,686 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,686 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:16,686 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:16,686 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,686 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:16,686 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:16,686 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:16,687 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:16,687 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:16,687 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:16,687 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:16,687 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:16,687 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:16,687 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:16,687 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:16,687 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:16,687 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:16,687 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:16,687 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:16,687 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:16,688 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,688 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:16,688 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:16,688 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:16,688 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:16,689 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:16,689 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:16,689 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:16,689 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:16,689 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,689 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:16,689 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,689 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:16,689 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,690 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:16,690 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:16,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:16,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:16,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:16,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:16,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:16,691 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:16,691 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:16,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,691 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:16,691 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,691 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:16,691 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:16,691 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:16,691 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   iterations: 285
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   learning_rate: 0.010004078539318182
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.4923815252783847
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   random_strength: 3.4486017893348855
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   bagging_temperature: 0.5048928028638805
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   border_count: 32
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:16,692 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:16,693 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:16,693 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:16,693 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:16,693 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:16,693 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:16,693 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:16,693 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:16,693 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:16,867 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:16,867 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:16,867 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:16,868 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:16,868 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:16,868 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:16,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:16,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:16,868 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:16,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:16,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:16,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:16,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:16,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:16,869 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:16,869 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:16,870 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:16,870 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:16,870 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:16,870 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:16,870 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,870 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,870 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:16,870 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:16,870 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:16,870 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:16,870 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:16,870 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:16,871 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,871 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,871 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,871 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:16,872 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:16,872 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:16,872 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:16,872 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:16,872 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:16,872 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:16,872 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:16,872 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:16,872 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:16,872 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:16,872 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:16,872 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:16,872 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:16,872 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:16,872 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:16,872 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:16,872 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,872 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,872 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,872 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,874 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:16,875 - src.hyperparameter_tuning - ERROR - Trial 87 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:16,893 - src.hyperparameter_tuning - INFO - Trial 88: 모델 타입 = catboost
2025-06-24 09:32:16,897 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:16,898 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:16,898 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:16,898 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:16,898 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:16,898 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:16,898 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:16,898 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:16,898 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:16,899 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:16,899 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:16,899 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:16,899 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:16,899 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:16,899 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:16,899 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:16,899 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:16,899 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:16,900 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:16,900 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:16,900 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:16,900 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:16,900 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:16,900 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:16,900 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:16,900 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:16,900 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:16,900 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:16,904 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:16,906 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:16,906 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:16,906 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:16,906 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:16,906 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:16,906 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:16,906 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:16,908 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:16,910 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:16,910 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:16,910 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:16,910 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:16,910 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:16,910 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:16,911 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:16,911 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:16,911 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,911 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,911 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:16,911 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:16,911 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,911 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,911 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:16,911 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:16,911 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,912 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:16,912 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:16,912 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:16,913 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:16,913 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:16,913 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:16,913 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:16,913 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:16,913 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:16,913 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:16,913 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:16,913 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:16,913 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:16,913 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:16,913 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:16,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:16,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:16,913 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:16,913 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:16,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:16,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:16,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:16,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:16,914 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:16,914 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,914 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:16,914 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,914 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:16,914 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,915 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:16,915 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:16,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:16,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:16,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:16,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:16,916 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:16,916 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:16,916 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:16,916 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:16,916 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,916 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:16,916 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:16,916 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:16,916 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:16,916 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:16,916 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   iterations: 321
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   learning_rate: 0.0272307435969206
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.110048804346646
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   random_strength: 1.488694184133132
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   bagging_temperature: 0.5501474459214453
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   border_count: 154
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:16,917 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:17,100 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:17,101 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:17,101 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:17,101 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:17,101 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:17,101 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:17,101 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:17,101 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,101 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:17,101 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:17,101 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:17,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:17,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:17,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:17,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:17,102 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:17,102 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,102 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:17,103 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:17,103 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:17,103 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:17,103 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:17,103 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,103 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,103 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:17,103 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:17,103 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:17,103 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:17,103 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:17,103 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:17,104 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,104 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,104 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,104 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,104 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:17,104 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:17,105 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:17,105 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:17,105 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:17,105 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:17,105 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:17,105 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:17,105 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:17,105 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:17,105 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:17,105 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:17,105 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:17,105 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:17,105 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:17,105 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:17,105 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,105 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,105 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,105 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,107 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:17,107 - src.hyperparameter_tuning - ERROR - Trial 88 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:17,124 - src.hyperparameter_tuning - INFO - Trial 89: 모델 타입 = catboost
2025-06-24 09:32:17,128 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:17,129 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:17,129 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:17,129 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:17,129 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:17,129 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:17,129 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:17,129 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:17,129 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:17,130 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:17,130 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:17,130 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:17,130 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:17,130 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:17,130 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:17,130 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:17,130 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:17,130 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:17,131 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:17,131 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:17,131 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:17,131 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:17,131 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:17,131 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:17,131 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:17,131 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:17,131 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:17,131 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:17,135 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:17,137 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:17,137 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:17,137 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:17,137 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:17,137 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:17,137 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:17,137 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:17,139 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:17,141 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:17,141 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:17,141 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:17,141 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:17,141 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:17,141 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:17,141 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:17,141 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:17,141 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,141 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,142 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:17,142 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:17,142 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,142 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,142 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:17,142 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:17,142 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,142 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:17,142 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:17,142 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:17,143 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:17,143 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:17,143 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:17,143 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:17,143 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:17,143 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:17,143 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:17,143 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:17,143 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:17,143 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:17,143 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:17,143 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:17,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:17,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,144 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:17,144 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:17,144 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:17,144 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:17,144 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:17,144 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:17,145 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:17,145 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:17,145 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,145 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:17,145 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,145 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:17,145 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,145 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:17,145 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:17,146 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:17,146 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:17,146 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:17,146 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:17,146 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:17,146 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:17,146 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:17,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,146 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   iterations: 125
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   learning_rate: 0.10014851978353537
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.7603676619795885
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   random_strength: 1.2752693166524163
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   bagging_temperature: 0.12302925944759105
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   border_count: 88
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:17,147 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:17,148 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:17,329 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:17,329 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:17,329 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:17,329 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:17,329 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:17,329 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:17,329 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:17,329 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,330 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:17,330 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:17,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:17,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:17,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:17,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:17,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:17,331 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:17,331 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:17,331 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:17,332 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:17,332 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:17,332 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:17,332 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,332 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,332 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:17,332 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:17,332 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:17,332 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:17,332 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:17,332 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:17,333 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,333 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,333 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,333 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,333 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:17,334 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:17,334 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:17,334 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:17,334 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:17,334 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:17,334 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:17,334 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:17,334 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:17,334 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:17,334 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:17,334 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:17,334 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:17,334 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:17,334 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:17,334 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:17,334 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,334 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,334 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,334 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,336 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:17,336 - src.hyperparameter_tuning - ERROR - Trial 89 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:17,353 - src.hyperparameter_tuning - INFO - Trial 90: 모델 타입 = catboost
2025-06-24 09:32:17,357 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:17,358 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:17,358 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:17,358 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:17,358 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:17,358 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:17,358 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:17,358 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:17,358 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:17,359 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:17,359 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:17,359 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:17,359 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:17,359 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:17,359 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:17,359 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:17,359 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:17,359 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:17,360 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:17,360 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:17,361 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:17,361 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:17,361 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:17,361 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:17,361 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:17,361 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:17,361 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:17,361 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:17,365 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:17,367 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:17,367 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:17,367 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:17,367 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:17,367 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:17,367 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:17,367 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:17,369 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:17,371 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:17,371 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:17,371 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:17,371 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:17,371 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:17,371 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:17,371 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:17,371 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:17,371 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,371 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,372 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:17,372 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:17,372 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,372 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,372 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:17,372 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:17,372 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,373 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:17,373 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:17,373 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:17,374 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:17,374 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:17,374 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:17,374 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:17,374 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:17,374 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:17,374 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:17,374 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:17,374 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:17,374 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:17,374 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:17,374 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:17,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:17,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:17,375 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:17,375 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:17,375 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:17,375 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:17,375 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:17,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:17,376 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:17,376 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:17,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:17,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:17,376 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:17,377 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:17,377 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:17,377 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:17,377 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:17,377 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:17,377 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:17,377 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:17,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,378 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:17,378 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,378 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:17,378 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:17,378 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:17,378 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   iterations: 466
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   learning_rate: 0.12126576208759421
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.7384433645666633
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   random_strength: 9.627355286676718
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   bagging_temperature: 0.42100738280890465
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   border_count: 148
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:17,379 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:17,380 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:17,380 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:17,556 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:17,556 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:17,556 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:17,556 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:17,556 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:17,557 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:17,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:17,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:17,557 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:17,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:17,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:17,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:17,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:17,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:17,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:17,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:17,559 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:17,559 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:17,559 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:17,559 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:17,559 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,559 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:17,559 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:17,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:17,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:17,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:17,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:17,560 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,560 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,560 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,560 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,561 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:17,561 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:17,561 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:17,561 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:17,561 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:17,561 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:17,561 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:17,561 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:17,561 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:17,561 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:17,561 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:17,561 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:17,561 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:17,561 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:17,561 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:17,561 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:17,561 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,561 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,561 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,561 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,563 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:17,563 - src.hyperparameter_tuning - ERROR - Trial 90 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:17,580 - src.hyperparameter_tuning - INFO - Trial 91: 모델 타입 = catboost
2025-06-24 09:32:17,584 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:17,585 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:17,585 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:17,585 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:17,585 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:17,585 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:17,585 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:17,585 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:17,585 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:17,586 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:17,586 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:17,586 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:17,586 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:17,586 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:17,586 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:17,586 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:17,586 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:17,586 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:17,587 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:17,587 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:17,587 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:17,587 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:17,587 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:17,587 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:17,587 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:17,587 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:17,587 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:17,587 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:17,591 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:17,593 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:17,593 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:17,593 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:17,593 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:17,593 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:17,593 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:17,593 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:17,595 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:17,597 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:17,597 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:17,597 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:17,597 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:17,597 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:17,597 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:17,597 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:17,597 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:17,597 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,597 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,597 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:17,597 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:17,597 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,597 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,597 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:17,597 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:17,597 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,598 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:17,598 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:17,598 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:17,599 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:17,599 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:17,599 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:17,599 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:17,599 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:17,599 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:17,599 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:17,599 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:17,599 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:17,599 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:17,599 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:17,599 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:17,599 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:17,599 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,599 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:17,600 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:17,600 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:17,600 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:17,600 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:17,600 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:17,600 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:17,600 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:17,601 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,601 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:17,601 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,601 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:17,601 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,601 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:17,601 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:17,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:17,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:17,602 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:17,602 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:17,602 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:17,602 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:17,602 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:17,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,602 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:17,602 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,602 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:17,602 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:17,602 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:17,602 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   iterations: 234
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   learning_rate: 0.05618218372296084
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.3047097165272898
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   random_strength: 6.837869152401954
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   bagging_temperature: 0.21199091347663385
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   border_count: 204
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:17,603 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:17,777 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:17,777 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:17,777 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:17,777 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:17,777 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:17,777 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:17,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:17,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,778 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:17,778 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:17,778 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:17,778 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:17,778 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:17,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:17,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:17,779 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:17,779 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:17,779 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:17,780 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:17,780 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:17,780 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:17,780 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,780 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,780 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:17,780 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:17,780 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:17,780 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:17,780 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:17,780 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:17,780 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,781 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,781 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,781 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,781 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:17,781 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:17,781 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:17,781 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:17,781 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:17,781 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:17,781 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:17,781 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:17,781 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:17,781 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:17,781 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:17,781 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:17,781 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:17,781 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:17,781 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:17,781 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:17,781 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,781 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,781 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,781 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,784 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:17,784 - src.hyperparameter_tuning - ERROR - Trial 91 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:17,800 - src.hyperparameter_tuning - INFO - Trial 92: 모델 타입 = catboost
2025-06-24 09:32:17,804 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:17,805 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:17,805 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:17,805 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:17,805 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:17,805 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:17,805 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:17,805 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:17,805 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:17,806 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:17,806 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:17,806 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:17,806 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:17,806 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:17,806 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:17,806 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:17,806 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:17,806 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:17,807 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:17,807 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:17,807 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:17,807 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:17,807 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:17,807 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:17,807 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:17,807 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:17,807 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:17,807 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:17,811 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:17,813 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:17,813 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:17,813 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:17,813 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:17,813 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:17,813 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:17,813 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:17,815 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:17,817 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:17,817 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:17,817 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:17,817 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:17,817 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:17,817 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:17,817 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:17,817 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:17,817 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,817 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,818 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:17,818 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:17,818 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,818 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,818 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:17,818 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:17,818 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,818 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:17,818 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:17,818 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:17,819 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:17,819 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:17,819 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:17,819 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:17,819 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:17,819 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:17,819 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:17,819 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:17,819 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:17,819 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:17,819 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:17,819 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:17,819 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:17,819 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,820 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:17,820 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:17,820 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:17,820 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:17,820 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:17,820 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:17,820 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:17,821 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:17,821 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,821 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:17,821 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,821 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:17,821 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,821 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:17,821 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:17,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:17,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:17,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:17,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:17,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:17,822 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:17,822 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:17,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,822 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:17,822 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,822 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:17,822 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:17,822 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   iterations: 261
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   learning_rate: 0.0456681135620075
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   l2_leaf_reg: 5.015838149254229
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   random_strength: 9.99628373768373
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   bagging_temperature: 0.18375157893309516
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   border_count: 211
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:17,823 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:17,824 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:17,824 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:17,824 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:17,824 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:17,824 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:17,824 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:17,824 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:17,824 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:17,824 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:17,824 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:17,824 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:17,824 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:17,824 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:17,824 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:17,983 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:17,983 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:17,983 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:17,983 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:17,983 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:17,983 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:17,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:17,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:17,984 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:17,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:17,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:17,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:17,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:17,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:17,985 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:17,985 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:17,985 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:17,985 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:17,986 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:17,986 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:17,986 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,986 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:17,986 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:17,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:17,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:17,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:17,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:17,986 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,987 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,987 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,987 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:17,987 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:17,987 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:17,987 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:17,987 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:17,987 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:17,987 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:17,987 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:17,987 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:17,987 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:17,987 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:17,987 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:17,987 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:17,987 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:17,987 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:17,987 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:17,987 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:17,987 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,987 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,987 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:17,987 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:17,990 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:17,990 - src.hyperparameter_tuning - ERROR - Trial 92 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:18,007 - src.hyperparameter_tuning - INFO - Trial 93: 모델 타입 = catboost
2025-06-24 09:32:18,012 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:18,013 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:18,013 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:18,013 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:18,013 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:18,013 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:18,013 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:18,013 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:18,013 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:18,014 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:18,014 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:18,014 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:18,014 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:18,014 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:18,014 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:18,014 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:18,014 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:18,014 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:18,015 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:18,015 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:18,015 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:18,015 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:18,015 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:18,015 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:18,015 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:18,015 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:18,015 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:18,015 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:18,019 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:18,021 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:18,021 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:18,021 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:18,021 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:18,021 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:18,021 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:18,021 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:18,023 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:18,025 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:18,025 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:18,025 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:18,025 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:18,025 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:18,025 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:18,025 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:18,025 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:18,025 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,025 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,026 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:18,026 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:18,026 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,026 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,026 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:18,026 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:18,026 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,027 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:18,027 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:18,027 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:18,027 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:18,027 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:18,027 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:18,027 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:18,027 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:18,027 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:18,027 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:18,028 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:18,028 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:18,028 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:18,028 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:18,028 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:18,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:18,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:18,028 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:18,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:18,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:18,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:18,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:18,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:18,029 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:18,029 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:18,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:18,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:18,030 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:18,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:18,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:18,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:18,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:18,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:18,031 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:18,031 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:18,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO -   iterations: 112
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO -   depth: 7
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO -   learning_rate: 0.0622152608916813
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO -   l2_leaf_reg: 5.687358961139832
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:18,031 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   random_strength: 1.0255118809298327
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   bagging_temperature: 0.22705447777499801
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   border_count: 104
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:18,032 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:18,212 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:18,212 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:18,212 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:18,212 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:18,212 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:18,212 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:18,212 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:18,212 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,212 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:18,213 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:18,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:18,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:18,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:18,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:18,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:18,213 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:18,213 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:18,214 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:18,214 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:18,214 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:18,214 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:18,214 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,214 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,214 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:18,214 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:18,215 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:18,215 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:18,215 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:18,215 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:18,215 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,215 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,216 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,216 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,216 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:18,216 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:18,216 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:18,216 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:18,216 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:18,216 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:18,216 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:18,216 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:18,216 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:18,216 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:18,216 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:18,216 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:18,216 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:18,216 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:18,216 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:18,216 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:18,216 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,216 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,216 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,216 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,219 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:18,219 - src.hyperparameter_tuning - ERROR - Trial 93 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:18,237 - src.hyperparameter_tuning - INFO - Trial 94: 모델 타입 = catboost
2025-06-24 09:32:18,241 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:18,242 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:18,242 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:18,242 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:18,242 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:18,242 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:18,242 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:18,242 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:18,242 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:18,243 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:18,243 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:18,243 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:18,243 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:18,243 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:18,243 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:18,243 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:18,243 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:18,243 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:18,244 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:18,244 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:18,244 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:18,244 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:18,244 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:18,244 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:18,244 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:18,244 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:18,244 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:18,244 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:18,248 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:18,250 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:18,250 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:18,250 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:18,250 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:18,250 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:18,250 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:18,250 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:18,252 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:18,254 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:18,254 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:18,254 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:18,254 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:18,254 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:18,254 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:18,255 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:18,255 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:18,255 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,255 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,255 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:18,255 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:18,255 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,255 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,255 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:18,255 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:18,255 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,256 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:18,256 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:18,256 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:18,257 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:18,257 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:18,257 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:18,257 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:18,257 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:18,257 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:18,257 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:18,257 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:18,257 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:18,257 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:18,257 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:18,257 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:18,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:18,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:18,257 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:18,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:18,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:18,258 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:18,258 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:18,258 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:18,258 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:18,258 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,258 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:18,258 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:18,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:18,259 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:18,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:18,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:18,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:18,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:18,260 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:18,260 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:18,260 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,260 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:18,260 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,260 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:18,260 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,260 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:18,260 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:18,260 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:18,260 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:18,260 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   iterations: 95
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   learning_rate: 0.07887282545007289
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.8967028928510064
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   random_strength: 8.204611127091466
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   bagging_temperature: 0.3459234267564316
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   border_count: 251
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:18,261 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:18,436 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:18,437 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:18,437 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:18,437 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:18,437 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:18,437 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:18,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:18,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:18,438 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:18,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:18,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:18,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:18,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:18,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:18,438 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:18,438 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:18,439 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:18,439 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:18,439 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:18,439 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:18,439 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,439 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,439 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:18,439 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:18,439 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:18,440 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:18,440 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:18,440 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:18,440 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,440 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,440 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,441 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,441 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:18,441 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:18,441 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:18,441 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:18,441 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:18,441 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:18,441 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:18,441 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:18,441 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:18,441 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:18,441 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:18,441 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:18,441 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:18,441 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:18,441 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:18,441 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:18,441 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,441 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,441 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,441 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,444 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:18,444 - src.hyperparameter_tuning - ERROR - Trial 94 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:18,461 - src.hyperparameter_tuning - INFO - Trial 95: 모델 타입 = catboost
2025-06-24 09:32:18,465 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:18,466 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:18,466 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:18,466 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:18,466 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:18,466 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:18,466 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:18,466 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:18,466 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:18,467 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:18,467 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:18,467 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:18,467 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:18,467 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:18,467 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:18,467 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:18,467 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:18,467 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:18,468 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:18,468 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:18,468 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:18,468 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:18,468 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:18,468 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:18,468 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:18,468 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:18,468 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:18,468 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:18,472 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:18,474 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:18,474 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:18,474 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:18,474 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:18,474 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:18,474 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:18,474 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:18,476 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:18,478 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:18,478 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:18,478 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:18,478 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:18,478 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:18,478 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:18,478 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:18,478 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:18,478 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,478 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,479 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:18,479 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:18,479 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,479 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,479 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:18,479 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:18,479 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,479 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:18,479 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:18,479 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:18,480 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:18,480 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:18,480 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:18,480 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:18,480 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:18,480 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:18,480 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:18,480 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:18,480 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:18,480 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:18,480 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:18,480 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:18,480 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:18,481 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,481 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:18,481 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:18,481 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:18,481 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:18,481 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:18,482 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:18,482 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:18,482 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:18,482 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:18,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:18,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:18,483 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:18,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:18,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:18,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:18,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:18,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:18,483 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:18,483 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,484 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:18,484 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,484 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:18,484 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,484 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:18,484 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:18,484 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:18,484 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:18,484 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:18,484 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:18,484 - src.models.catboost_model - INFO -   iterations: 69
2025-06-24 09:32:18,484 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 09:32:18,484 - src.models.catboost_model - INFO -   learning_rate: 0.06827117170947619
2025-06-24 09:32:18,484 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.484986468053399
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   random_strength: 5.698737850383506
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   bagging_temperature: 0.16443973007161744
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   border_count: 229
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:18,485 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:18,486 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:18,486 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:18,486 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:18,486 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:18,668 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:18,668 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:18,668 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:18,668 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:18,668 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:18,669 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:18,669 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:18,669 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,669 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:18,669 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:18,670 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:18,670 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:18,670 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:18,670 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:18,670 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:18,670 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:18,670 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:18,671 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:18,671 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:18,671 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:18,671 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:18,671 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,671 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,671 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:18,671 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:18,672 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:18,672 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:18,672 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:18,672 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:18,672 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,672 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,673 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,673 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,673 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:18,673 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:18,673 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:18,673 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:18,673 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:18,673 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:18,673 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:18,673 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:18,673 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:18,673 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:18,673 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:18,673 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:18,674 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:18,674 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:18,674 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:18,674 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:18,674 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,674 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,674 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,674 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,677 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:18,677 - src.hyperparameter_tuning - ERROR - Trial 95 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:18,695 - src.hyperparameter_tuning - INFO - Trial 96: 모델 타입 = catboost
2025-06-24 09:32:18,699 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:18,700 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:18,700 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:18,700 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:18,700 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:18,700 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:18,700 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:18,700 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:18,700 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:18,701 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:18,701 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:18,701 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:18,701 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:18,701 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:18,701 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:18,701 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:18,701 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:18,701 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:18,702 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:18,702 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:18,702 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:18,702 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:18,702 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:18,702 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:18,702 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:18,702 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:18,702 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:18,702 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:18,706 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:18,708 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:18,708 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:18,708 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:18,708 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:18,708 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:18,708 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:18,708 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:18,710 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:18,712 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:18,712 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:18,712 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:18,712 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:18,712 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:18,712 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:18,712 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:18,712 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:18,712 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,712 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,713 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:18,713 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:18,713 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,713 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,713 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:18,713 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:18,713 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,713 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:18,713 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:18,713 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:18,714 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:18,714 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:18,714 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:18,714 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:18,714 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:18,714 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:18,714 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:18,714 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:18,714 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:18,714 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:18,714 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:18,714 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:18,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:18,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:18,715 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:18,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:18,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:18,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:18,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:18,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:18,716 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:18,716 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:18,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:18,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:18,716 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:18,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:18,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:18,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:18,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:18,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:18,717 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:18,717 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,717 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:18,717 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,717 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:18,717 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,717 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   iterations: 166
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   learning_rate: 0.08764705688955546
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.4002463190356211
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   random_strength: 4.614563533376168
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   bagging_temperature: 0.2733342406598557
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   border_count: 194
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:18,718 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:18,719 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:18,893 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:18,893 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:18,893 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:18,893 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:18,893 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:18,893 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:18,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:18,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:18,894 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:18,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:18,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:18,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:18,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:18,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:18,894 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:18,894 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:18,895 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:18,895 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:18,895 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:18,895 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:18,895 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,895 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,895 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:18,895 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:18,896 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:18,896 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:18,896 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:18,896 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:18,896 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,896 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,896 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,897 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:18,897 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:18,897 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:18,897 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:18,897 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:18,897 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:18,897 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:18,897 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:18,897 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:18,897 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:18,897 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:18,897 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:18,897 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:18,897 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:18,897 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:18,897 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:18,897 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:18,897 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,897 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,897 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,897 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,899 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:18,899 - src.hyperparameter_tuning - ERROR - Trial 96 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:18,917 - src.hyperparameter_tuning - INFO - Trial 97: 모델 타입 = catboost
2025-06-24 09:32:18,921 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:18,921 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:18,921 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:18,921 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:18,921 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:18,921 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:18,921 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:18,921 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:18,921 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:18,922 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:18,922 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:18,922 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:18,922 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:18,922 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:18,922 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:18,922 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:18,922 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:18,922 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:18,923 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:18,923 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:18,923 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:18,923 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:18,923 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:18,923 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:18,923 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:18,923 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:18,923 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:18,923 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:18,927 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:18,929 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:18,929 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:18,929 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:18,929 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:18,929 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:18,929 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:18,929 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:18,931 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:18,933 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:18,933 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:18,933 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:18,933 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:18,933 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:18,933 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:18,933 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:18,933 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:18,933 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,933 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,934 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:18,934 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:18,934 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,934 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,934 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:18,934 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:18,934 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,934 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:18,934 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:18,934 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:18,935 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:18,935 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:18,935 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:18,935 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:18,935 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:18,935 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:18,935 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:18,935 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:18,935 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:18,935 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:18,935 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:18,935 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:18,935 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:18,935 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,936 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:18,936 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:18,936 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:18,936 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:18,936 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:18,936 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:18,936 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:18,937 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:18,937 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,937 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:18,937 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,937 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:18,937 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,937 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:18,937 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:18,937 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:18,938 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:18,938 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:18,938 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:18,938 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:18,938 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:18,938 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:18,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:18,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,938 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:18,938 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:18,938 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:18,938 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:18,938 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   iterations: 181
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   learning_rate: 0.023925347769662132
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.0013095678362804
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   random_strength: 0.2930569268384629
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   bagging_temperature: 0.10324756777400527
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   border_count: 38
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:18,939 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:18,940 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:18,940 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:18,940 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:18,940 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:18,940 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:18,940 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:18,940 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:19,114 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:19,114 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:19,114 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:19,114 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:19,114 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:19,114 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:19,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:19,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:19,115 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:19,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:19,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:19,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:19,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:19,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:19,116 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:19,116 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,116 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:19,116 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:19,117 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:19,117 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:19,117 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:19,117 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,117 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,117 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:19,117 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:19,117 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:19,117 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:19,117 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:19,117 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:19,117 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:19,118 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:19,118 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:19,118 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:19,118 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:19,118 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:19,118 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:19,118 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:19,118 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:19,118 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:19,118 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:19,118 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:19,118 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:19,118 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:19,118 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:19,118 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:19,118 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:19,118 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:19,118 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:19,118 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:19,119 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,119 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,119 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,119 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,121 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:19,121 - src.hyperparameter_tuning - ERROR - Trial 97 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:19,138 - src.hyperparameter_tuning - INFO - Trial 98: 모델 타입 = catboost
2025-06-24 09:32:19,142 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:19,143 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:19,143 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:19,143 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:19,143 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:19,143 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:19,143 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:19,143 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:19,143 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:19,143 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:19,143 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:19,143 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:19,143 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:19,143 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:19,143 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:19,144 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:19,144 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:19,144 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:19,144 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:19,145 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:19,145 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:19,145 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:19,145 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:19,145 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:19,145 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:19,145 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:19,145 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:19,145 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:19,148 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:19,150 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:19,150 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:19,150 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:19,150 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:19,150 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:19,150 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:19,150 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:19,152 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:19,154 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:19,154 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:19,154 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:19,154 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:19,154 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:19,154 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:19,154 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:19,154 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:19,154 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,154 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,155 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:19,155 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:19,155 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,155 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,155 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:19,155 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:19,155 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,156 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:19,156 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:19,156 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:19,156 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:19,157 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:19,157 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:19,157 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:19,157 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:19,157 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:19,157 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:19,157 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:19,157 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:19,157 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:19,157 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:19,157 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:19,157 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:19,157 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,157 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:19,157 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:19,157 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:19,157 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:19,158 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:19,158 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:19,158 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:19,158 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:19,158 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,158 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:19,158 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,158 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:19,158 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,158 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:19,159 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:19,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:19,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:19,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:19,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:19,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:19,159 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:19,159 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,160 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:19,160 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   iterations: 197
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   learning_rate: 0.040552464140639316
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.6268633021660126
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   random_strength: 6.191567210052264
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   bagging_temperature: 0.8459283491148096
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   border_count: 219
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:19,160 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:19,161 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:19,334 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:19,334 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:19,334 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:19,335 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:19,335 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:19,335 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:19,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:19,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:19,335 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:19,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:19,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:19,336 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:19,336 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:19,336 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:19,336 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:19,336 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,336 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:19,336 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:19,337 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:19,337 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:19,337 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:19,337 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,337 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,337 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:19,337 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:19,337 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:19,337 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:19,337 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:19,337 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:19,337 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:19,338 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:19,338 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:19,338 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:19,338 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:19,338 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:19,338 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:19,338 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:19,338 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:19,338 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:19,338 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:19,338 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:19,338 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:19,338 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:19,338 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:19,338 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:19,338 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:19,338 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:19,338 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:19,338 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:19,338 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,338 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,338 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,338 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,341 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:19,341 - src.hyperparameter_tuning - ERROR - Trial 98 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:19,358 - src.hyperparameter_tuning - INFO - Trial 99: 모델 타입 = catboost
2025-06-24 09:32:19,362 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:32:19,362 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:32:19,362 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:32:19,362 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:32:19,362 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:32:19,362 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:32:19,362 - src.training - INFO - 교차 검증 시작
2025-06-24 09:32:19,362 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:32:19,362 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:32:19,363 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:32:19,363 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:32:19,363 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:32:19,363 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:32:19,363 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:32:19,363 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:32:19,363 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:32:19,363 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:32:19,363 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:32:19,364 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:19,364 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:19,364 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:32:19,364 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:32:19,364 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:19,364 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:32:19,364 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:32:19,364 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:32:19,364 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:32:19,364 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:32:19,368 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:32:19,370 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:19,370 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:32:19,370 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:32:19,370 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:32:19,370 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:32:19,370 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:32:19,370 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:32:19,372 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:32:19,374 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:32:19,374 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:19,374 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:19,374 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:32:19,374 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:32:19,374 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:19,374 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:32:19,374 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:32:19,374 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,374 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,374 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:32:19,375 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:32:19,375 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,375 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,375 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:32:19,375 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:32:19,375 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,375 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:19,375 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:32:19,375 - src.training - INFO - 모델 학습 시작
2025-06-24 09:32:19,376 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:32:19,376 - src.training - INFO - 모델 타입: catboost
2025-06-24 09:32:19,376 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 09:32:19,376 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 09:32:19,376 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:32:19,376 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:32:19,376 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:32:19,376 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 09:32:19,376 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:19,376 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:32:19,376 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:32:19,376 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:32:19,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:32:19,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:19,377 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:19,377 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:19,377 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:19,377 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:19,377 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:19,377 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:19,377 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:32:19,377 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:32:19,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:19,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:19,378 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:19,378 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:19,378 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:19,378 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:19,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:19,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:19,379 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:19,379 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:32:19,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,379 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:32:19,379 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,379 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 09:32:19,379 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 09:32:19,379 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:32:19,379 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   iterations: 148
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   learning_rate: 0.019729409111216633
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.077572245922454
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   random_strength: 7.729888609960743
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   bagging_temperature: 0.2435238399499164
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   border_count: 61
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   class_weights: [1, 1]
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   loss_function: RMSE
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO -   eval_metric: RMSE
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:32:19,380 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 09:32:19,554 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:32:19,554 - src.models.catboost_model - INFO -   - Best Iteration: 390
2025-06-24 09:32:19,554 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008041221618652344}, 'validation': {'Logloss': 0.009578456071365302}}
2025-06-24 09:32:19,555 - src.models.catboost_model - INFO -   - 트리 개수: 401
2025-06-24 09:32:19,555 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:32:19,555 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 09:32:19,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:32:19,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:32:19,555 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:32:19,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:32:19,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:32:19,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:32:19,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:32:19,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:32:19,556 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:32:19,556 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:32:19,557 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:32:19,557 - src.models.catboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:32:19,557 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:32:19,557 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:32:19,557 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,557 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,557 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:32:19,557 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:32:19,557 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:32:19,557 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:32:19,558 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 09:32:19,558 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:32:19,558 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:19,558 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:19,558 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:19,559 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:32:19,559 - src.training - INFO -   precision: 0.0
2025-06-24 09:32:19,559 - src.training - INFO -   recall: 0.0
2025-06-24 09:32:19,559 - src.training - INFO -   f1: 0.0
2025-06-24 09:32:19,559 - src.training - INFO -   accuracy: 1.0
2025-06-24 09:32:19,559 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:32:19,559 - src.training - INFO -   positive_samples: 0
2025-06-24 09:32:19,559 - src.training - INFO -   negative_samples: 250
2025-06-24 09:32:19,559 - src.training - INFO -   total_samples: 250
2025-06-24 09:32:19,559 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:32:19,559 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:32:19,559 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:32:19,559 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:32:19,559 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:32:19,559 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:32:19,559 - src.training - INFO - 모델 학습 완료
2025-06-24 09:32:19,559 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 1.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:32:19,559 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,559 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,559 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:32:19,559 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:32:19,562 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:32:19,562 - src.hyperparameter_tuning - ERROR - Trial 99 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:32:19,563 - src.hyperparameter_tuning - INFO - 튜닝 완료 - 최고 성능: -inf
2025-06-24 09:32:19,563 - src.hyperparameter_tuning - INFO - 튜닝 시간: 22.94초
2025-06-24 09:32:19,567 - __main__ - INFO - 튜닝 결과 저장 중...
2025-06-24 09:32:19,567 - __main__ - ERROR - 결과 저장 실패: 'NoneType' object has no attribute 'copy'
2025-06-24 09:32:19,567 - __main__ - INFO - 최고 성능: -inf
2025-06-24 09:32:19,567 - __main__ - INFO - 최적 파라미터:
2025-06-24 09:32:19,567 - __main__ - INFO -   iterations: 218
2025-06-24 09:32:19,567 - __main__ - INFO -   depth: 10
2025-06-24 09:32:19,567 - __main__ - INFO -   learning_rate: 0.1205712628744377
2025-06-24 09:32:19,567 - __main__ - INFO -   l2_leaf_reg: 3.968793330444372
2025-06-24 09:32:19,567 - __main__ - INFO -   border_count: 66
2025-06-24 09:32:19,567 - __main__ - INFO -   bagging_temperature: 0.2403950683025824
2025-06-24 09:32:19,567 - __main__ - INFO -   random_strength: 0.13066739238053282

==================================================
튜닝 결과 요약
==================================================
모델 타입: catboost
실험 타입: hyperparameter_tuning
사용 데이터 행 수: 1,000
MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/bbc86ba40fa24628b44f8d1eee4b97a9
최고 성능: -inf
최적 파라미터: {'iterations': 218, 'depth': 10, 'learning_rate': 0.1205712628744377, 'l2_leaf_reg': 3.968793330444372, 'border_count': 66, 'bagging_temperature': 0.2403950683025824, 'random_strength': 0.13066739238053282}
튜닝 시간: 22.94171643257141
==================================================
2025-06-24 09:32:19,568 - __main__ - INFO - 실험 결과가 /home/junhyung/Documents/simcare/kbsmc_suicide/results/experiment_results_20250624_093219.txt에 저장되었습니다.
2025-06-24 09:32:19,568 - __main__ - INFO - MLflow Experiment ID: 765186397364671153
2025-06-24 09:32:19,568 - __main__ - INFO - MLflow Run ID: bbc86ba40fa24628b44f8d1eee4b97a9
2025-06-24 09:32:19,568 - __main__ - INFO - MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/bbc86ba40fa24628b44f8d1eee4b97a9
2025-06-24 09:32:19,568 - __main__ - ERROR - 하이퍼파라미터 튜닝 실패: 'tuple' object has no attribute 'get'
