2025-06-24 17:26:34,809 - src.hyperparameter_tuning - INFO - MLflow 실험 설정: hyperparameter_tuning (ID: 765186397364671153)
2025-06-24 17:26:34,810 - src.hyperparameter_tuning - INFO - 전달받은 데이터 사용: (1333765, 33)
2025-06-24 17:26:34,810 - src.hyperparameter_tuning - INFO - 모델 타입: catboost
2025-06-24 17:26:34,810 - src.hyperparameter_tuning - INFO - 튜닝 설정 - 시도 횟수: 5, 타임아웃: 3600초
2025-06-24 17:26:34,810 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 튜너 초기화 완료
2025-06-24 17:26:34,810 - src.hyperparameter_tuning - INFO -   - 튜닝 설정: {'data': {'file_path': 'data/processed/processed_data_with_features.csv', 'encoding': 'utf-8', 'na_values': ['', 'nan', 'NaN', 'NULL', 'null']}, 'features': {'target_columns': ['suicide_a_next_year'], 'exclude_columns': ['id', 'patient_id', 'visit_date', 'visit_year'], 'categorical_columns': ['gender', 'marital_status', 'education_level', 'income_level', 'residence_type', 'insurance_type', 'primary_diagnosis', 'comorbidity', 'medication_type', 'treatment_type', 'follow_up_status'], 'selected_features': ['age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score'], 'validation': {'scope': 'sample', 'sample_size': 10}, 'enable_feature_engineering': False, 'enable_lagged_features': False, 'lag_periods': [1, 2, 3], 'lagged_features': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}, 'enable_rolling_stats': False, 'rolling_stats': {'window_sizes': [2, 3], 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}}, 'preprocessing': {'time_series_imputation': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp'], 'fallback_strategy': 'mean'}, 'numerical_imputation': {'strategy': 'mean', 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']}, 'categorical_imputation': {'strategy': 'most_frequent', 'columns': ['sex']}, 'categorical_encoding': {'method': 'ordinal'}, 'missing_value_strategy': 'median', 'outlier_detection': {'method': 'iqr', 'threshold': 1.5}, 'scaling': {'method': 'robust', 'with_mean': True, 'with_std': True}, 'feature_selection': {'method': 'variance_threshold', 'threshold': 0.01}}, 'data_split': {'test_ids_ratio': 0.15, 'random_state': 42, 'method': 'stratified_kfold', 'n_splits': 5, 'test_size': 0.2, 'val_size': 0.2}, 'validation': {'strategy': 'group_kfold', 'num_cv_folds': 5, 'test_size': 0.15, 'random_state': 42, 'val_ids_ratio': 0.15, 'validation_start_year': 2021, 'min_train_years': 3, 'max_train_years': 8}, 'time_series': {'date_column': 'dov', 'year_column': 'yov', 'id_column': 'id'}, 'evaluation': {'regression_metrics': ['mae', 'rmse', 'r2'], 'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2'], 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True, 'primary_metric': 'pr_auc', 'secondary_metrics': ['recall', 'precision', 'balanced_accuracy', 'roc_auc'], 'metrics': {'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy', 'pr_auc'], 'regression_metrics': ['mae', 'rmse', 'r2'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2', 'pr_auc']}}, 'training': {'early_stopping': True, 'patience': 10, 'handle_imbalance': True, 'save_best_model': True, 'model_save_path': 'models/'}, 'logging': {'log_splits_info': True, 'log_fold_details': True, 'level': 'INFO', 'format': '%(asctime)s - %(name)s - %(levelname)s - %(message)s', 'file': 'logs/experiment.log'}, 'output': {'directory': 'results', 'save_model': True, 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True}, 'mlflow': {'experiment_name': 'hyperparameter_tuning', 'experiment_description': '자살 위험 예측 모델 실험', 'tags': ['suicide_prediction', 'healthcare', 'classification', 'regression'], 'nested_runs': True, 'save_artifacts': True, 'log_params': True, 'log_metrics': True, 'log_model': True, 'tracking': {'tracking_uri': 'file:./mlruns', 'experiment_name': 'suicide_prediction', 'nested_runs': True, 'artifact_location': './mlruns'}, 'logging': {'param_logging_level': 'INFO', 'metric_logging_level': 'INFO', 'artifact_logging_level': 'INFO', 'log_experiment_info': True, 'log_fold_results': True, 'log_model_info': True}, 'log_optimization': True}, 'model': {'model_type': 'catboost', 'catboost': {'iterations': 100, 'depth': 6, 'learning_rate': 0.1, 'l2_leaf_reg': 3, 'loss_function': 'Logloss', 'eval_metric': 'Logloss', 'cat_features': [], 'cat_l2': 10.0, 'cat_smooth': 10.0, 'max_cat_threshold': 32, 'one_hot_max_size': 10, 'random_strength': 1, 'bagging_temperature': 1, 'border_count': 254, 'feature_border_type': 'GreedyLogSum', 'early_stopping_rounds': 10, 'verbose': False, 'auto_class_weights': 'Balanced', 'scale_pos_weight': 1.0, 'use_focal_loss': False, 'focal_loss': {'alpha': 0.25, 'gamma': 2.0}, 'boosting_type': 'Plain', 'bootstrap_type': 'Bernoulli', 'subsample': 0.8, 'rsm': 0.8, 'leaf_estimation_method': 'Newton', 'random_seed': 42, 'bootstrap_seed': 42, 'min_data_in_leaf': 1, 'max_leaves': 31, 'grow_policy': 'SymmetricTree', 'min_fold_size': 1, 'leaf_estimation_iterations': 1, 'fold_permutation_block': 1, 'leaf_estimation_backtracking': 'AnyImprovement', 'best_model_min_trees': 1, 'model_shrink_rate': 0, 'model_shrink_mode': 'Constant', 'langevin': False, 'diffusion_temperature': 10000, 'posterior_sampling': False, 'boost_from_average': True, 'allow_const_label': False, 'score_function': 'Cosine', 'monotone_constraints': '', 'penalties_coefficient': 1, 'first_feature_use_penalties': 0, 'model_size_reg': 0.5, 'per_float_feature_quantization': '', 'eval_fraction': 0, 'fixed_binary_splits': None, 'ignored_features': None, 'train_dir': None, 'name': 'experiment', 'prediction_type': 'Probability', 'fold_len_multiplier': 2, 'has_time': False, 'allow_writing_files': False, 'save_snapshot': False, 'snapshot_file': None, 'snapshot_interval': 600, 'gradient_iterations': 1, 'sampling_unit': 'Object', 'mvs_reg': 0.1, 'thread_count': 28}}, 'imbalanced_data': {'resampling': {'enabled': False, 'method': 'smote', 'smote': {'k_neighbors': 5, 'sampling_strategy': 'auto'}, 'borderline_smote': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'm_neighbors': 10}, 'adasyn': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'n_neighbors': 5}, 'under_sampling': {'strategy': 'random', 'sampling_strategy': 'auto'}}, 'class_weights': 'Balanced', 'auto_class_weights': 'Balanced', 'scale_pos_weight': 1.0}, 'experiment': {'name': 'hyperparameter_tuning_experiment', 'description': 'Optuna 기반 하이퍼파라미터 최적화 실험', 'tags': ['hyperparameter_tuning', 'optuna', 'optimization']}, 'tuning': {'direction': 'maximize', 'n_trials': 5, 'n_jobs': 1, 'early_stopping': {'enabled': True, 'patience': 20, 'min_trials': 30}}, 'sampler': {'type': 'tpe', 'tpe': {'n_startup_trials': 10, 'n_ei_candidates': 24, 'multivariate': True, 'group': False}, 'cmaes': {'x0': {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'min_child_weight': 1, 'reg_alpha': 0.1, 'reg_lambda': 1.0}, 'sigma0': 0.1}}, 'xgboost_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 15, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'scale_pos_weight': {'type': 'float', 'low': 0.5, 'high': 10.0, 'log': True}}, 'lightgbm_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 12, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}}, 'catboost_params': {'iterations': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'depth': {'type': 'int', 'low': 3, 'high': 10, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'l2_leaf_reg': {'type': 'float', 'low': 1, 'high': 10, 'log': True}, 'border_count': {'type': 'int', 'low': 32, 'high': 255, 'log': False}, 'bagging_temperature': {'type': 'float', 'low': 0.1, 'high': 1.0, 'log': False}, 'random_strength': {'type': 'float', 'low': 0.1, 'high': 10.0, 'log': True}}, 'random_forest_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 20, 'log': False}, 'min_samples_split': {'type': 'int', 'low': 2, 'high': 20, 'log': False}, 'min_samples_leaf': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'max_features': {'type': 'categorical', 'choices': ['sqrt', 'log2', 'auto']}}, 'cv': {'strategy': 'group_kfold', 'n_folds': 5, 'shuffle': False}, 'results': {'save_best_model': True, 'model_save_path': 'models/best_tuned_model.joblib', 'save_study': True, 'study_save_path': 'models/optuna_study.pkl', 'create_plots': True, 'plots_save_path': 'data/tuning_results/'}}
2025-06-24 17:26:34,810 - src.hyperparameter_tuning - INFO -   - 튜닝 횟수: 5
2025-06-24 17:26:34,810 - src.hyperparameter_tuning - INFO -   - 타임아웃: 3600초
2025-06-24 17:26:34,845 - __main__ - INFO - MLflow Run 시작: 791d4c3d8650462bb5de9805cf29fef8
2025-06-24 17:26:34,849 - __main__ - INFO - 튜닝 파라미터 로깅 완료: 6개 파라미터
2025-06-24 17:26:34,849 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 최적화 시작
2025-06-24 17:26:34,854 - src.hyperparameter_tuning - INFO - Trial 0: 모델 타입 = catboost
2025-06-24 17:26:36,774 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 17:26:36,774 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 17:26:36,774 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 17:26:36,774 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 17:26:36,774 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 17:26:36,774 - src.training - INFO - 교차 검증 시작
2025-06-24 17:26:36,774 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 17:26:36,793 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 17:26:37,249 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 17:26:37,249 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 17:26:37,249 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 17:26:37,249 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 17:26:37,249 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 17:26:37,249 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 17:26:37,249 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 17:26:37,249 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 17:26:37,249 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 17:26:37,459 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:26:37,459 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:26:37,459 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:26:37,459 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:26:37,459 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:26:37,459 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 17:26:37,459 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 17:26:37,459 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 17:26:37,459 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 17:26:37,459 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 17:26:38,835 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 17:26:39,904 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:26:39,904 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 17:26:39,909 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 17:26:39,940 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 17:26:39,940 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 17:26:39,940 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 17:26:39,940 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:26:41,233 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:26:41,494 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 17:26:41,494 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:26:41,654 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:26:41,654 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:26:41,696 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:26:41,696 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:26:41,696 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:26:41,696 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 17:26:41,696 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:26:41,696 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:26:41,696 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:26:41,696 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:26:41,696 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:41,696 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 17:26:41,756 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 17:26:41,756 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 17:26:41,756 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:41,756 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:41,756 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 17:26:41,756 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 17:26:41,756 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:41,822 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:26:41,822 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:26:41,822 - src.training - INFO - 모델 학습 시작
2025-06-24 17:26:41,822 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:26:41,822 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:26:41,822 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:26:41,822 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:26:41,822 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:26:41,822 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:26:41,822 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:26:41,822 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:26:41,954 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 17:26:41,954 - src.training - INFO - 모델 타입: catboost
2025-06-24 17:26:41,954 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 17:26:41,954 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 17:26:41,954 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 17:26:41,954 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 17:26:41,954 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 17:26:41,954 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 17:26:41,954 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:26:41,954 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 17:26:41,954 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 17:26:41,954 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 17:26:41,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 17:26:41,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:41,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:26:42,046 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:26:42,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:26:42,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:26:42,245 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:26:42,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:26:42,387 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:26:42,403 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 17:26:42,403 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:42,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 17:26:42,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:42,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:26:42,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:42,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:26:42,492 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:26:42,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:26:42,523 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:26:42,539 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:26:42,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:26:42,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:26:42,578 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:26:42,578 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:42,594 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 17:26:42,594 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:42,594 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:26:42,594 - src.models.base_model - INFO - [DEBUG] _find_available_targets - y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:42,594 - src.models.base_model - INFO - [DEBUG] _find_available_targets - target_columns: ['suicide_a_next_year']
2025-06-24 17:26:42,594 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 후보: ['suicide_a_next_year', 'pass__suicide_a_next_year', 'remainder__suicide_a_next_year', 'num__suicide_a_next_year', 'cat__suicide_a_next_year']
2025-06-24 17:26:42,594 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:26:42,594 - src.models.base_model - INFO - [DEBUG] 최종 사용 가능한 타겟: ['pass__suicide_a_next_year']
2025-06-24 17:26:42,594 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:42,594 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 17:26:42,594 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 17:26:42,594 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 17:26:42,606 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   iterations: 218
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   learning_rate: 0.1205712628744377
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.968793330444372
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   random_strength: 0.13066739238053282
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   bagging_temperature: 0.2403950683025824
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   border_count: 66
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 17:26:42,610 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 17:26:42,611 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 17:26:44,065 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 17:26:44,066 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 17:26:44,066 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 17:26:44,066 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 17:26:44,066 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 17:26:44,066 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 17:26:44,066 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:26:44,066 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:44,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:26:44,085 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:26:44,100 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:26:44,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:26:44,129 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:26:44,145 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:26:44,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:26:44,166 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:26:44,166 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:44,170 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 17:26:44,196 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 17:26:44,197 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 17:26:44,197 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 17:26:44,197 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 17:26:44,197 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 17:26:44,197 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 17:26:44,197 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 17:26:44,197 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 17:26:44,200 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 17:26:44,204 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 17:26:44,205 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 17:26:44,205 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 17:26:44,209 - src.evaluation - INFO - 클래스 분포 - 실제: 0=220670, 1=270 (비율: 0.001222)
2025-06-24 17:26:44,209 - src.evaluation - INFO - 예측 분포 - 예측: 0=220940, 1=0
2025-06-24 17:26:44,209 - src.evaluation - WARNING - 모든 예측이 0입니다. 극도로 불균형한 데이터에서 일반적인 현상입니다.
2025-06-24 17:26:44,325 - src.training - INFO -   precision: 0.0
2025-06-24 17:26:44,325 - src.training - INFO -   recall: 0.0
2025-06-24 17:26:44,325 - src.training - INFO -   f1: 0.0
2025-06-24 17:26:44,325 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 17:26:44,325 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 17:26:44,325 - src.training - INFO -   positive_samples: 270
2025-06-24 17:26:44,325 - src.training - INFO -   negative_samples: 220670
2025-06-24 17:26:44,325 - src.training - INFO -   total_samples: 220940
2025-06-24 17:26:44,325 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 17:26:44,325 - src.training - INFO -   roc_auc: 0.0
2025-06-24 17:26:44,325 - src.training - INFO -   pr_auc: 0.0
2025-06-24 17:26:44,325 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 17:26:44,325 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 17:26:44,325 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 17:26:44,325 - src.training - INFO - 모델 학습 완료
2025-06-24 17:26:44,326 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 17:26:44,326 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:44,326 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:44,326 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:44,326 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:44,347 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 17:26:44,347 - src.hyperparameter_tuning - ERROR - Trial 0 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 17:26:44,746 - src.hyperparameter_tuning - INFO - Trial 1: 모델 타입 = catboost
2025-06-24 17:26:46,689 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 17:26:46,689 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 17:26:46,689 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 17:26:46,689 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 17:26:46,689 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 17:26:46,689 - src.training - INFO - 교차 검증 시작
2025-06-24 17:26:46,689 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 17:26:46,708 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 17:26:47,175 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 17:26:47,175 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 17:26:47,175 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 17:26:47,175 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 17:26:47,175 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 17:26:47,175 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 17:26:47,175 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 17:26:47,175 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 17:26:47,175 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 17:26:47,368 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:26:47,368 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:26:47,368 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:26:47,368 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:26:47,368 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:26:47,368 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 17:26:47,368 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 17:26:47,368 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 17:26:47,368 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 17:26:47,368 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 17:26:48,652 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 17:26:49,663 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:26:49,663 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 17:26:49,668 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 17:26:49,700 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 17:26:49,700 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 17:26:49,700 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 17:26:49,700 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:26:50,985 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:26:51,253 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 17:26:51,253 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:26:51,415 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:26:51,415 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:26:51,457 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:26:51,457 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:26:51,457 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:26:51,457 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 17:26:51,457 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:26:51,457 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:26:51,457 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:26:51,457 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:26:51,457 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:51,457 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 17:26:51,518 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 17:26:51,518 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 17:26:51,518 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:51,518 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:51,518 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 17:26:51,518 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 17:26:51,518 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:51,586 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:26:51,586 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:26:51,586 - src.training - INFO - 모델 학습 시작
2025-06-24 17:26:51,587 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:26:51,587 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:26:51,587 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:26:51,587 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:26:51,587 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:26:51,587 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:26:51,587 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:26:51,587 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:26:51,717 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 17:26:51,717 - src.training - INFO - 모델 타입: catboost
2025-06-24 17:26:51,717 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 17:26:51,717 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 17:26:51,717 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 17:26:51,717 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 17:26:51,717 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 17:26:51,717 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 17:26:51,718 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:26:51,718 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 17:26:51,718 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 17:26:51,718 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 17:26:51,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 17:26:51,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:51,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:26:51,805 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:26:51,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:26:51,941 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:26:52,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:26:52,073 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:26:52,149 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:26:52,166 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 17:26:52,166 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:52,238 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 17:26:52,238 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:52,238 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:26:52,238 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:52,239 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:26:52,257 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:26:52,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:26:52,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:26:52,305 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:26:52,322 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:26:52,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:26:52,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:26:52,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:52,358 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 17:26:52,358 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:52,358 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:26:52,358 - src.models.base_model - INFO - [DEBUG] _find_available_targets - y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:52,358 - src.models.base_model - INFO - [DEBUG] _find_available_targets - target_columns: ['suicide_a_next_year']
2025-06-24 17:26:52,358 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 후보: ['suicide_a_next_year', 'pass__suicide_a_next_year', 'remainder__suicide_a_next_year', 'num__suicide_a_next_year', 'cat__suicide_a_next_year']
2025-06-24 17:26:52,358 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:26:52,358 - src.models.base_model - INFO - [DEBUG] 최종 사용 가능한 타겟: ['pass__suicide_a_next_year']
2025-06-24 17:26:52,358 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:52,358 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 17:26:52,358 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 17:26:52,358 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 17:26:52,372 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 17:26:52,375 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 17:26:52,375 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 17:26:52,375 - src.models.catboost_model - INFO -   iterations: 440
2025-06-24 17:26:52,375 - src.models.catboost_model - INFO -   depth: 7
2025-06-24 17:26:52,375 - src.models.catboost_model - INFO -   learning_rate: 0.11114989443094977
2025-06-24 17:26:52,375 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.0485387725194617
2025-06-24 17:26:52,375 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 17:26:52,375 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 17:26:52,375 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 17:26:52,375 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 17:26:52,375 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 17:26:52,375 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 17:26:52,375 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   random_strength: 0.26587543983272705
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   bagging_temperature: 0.8491983767203796
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   border_count: 249
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 17:26:52,376 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 17:26:53,775 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 17:26:53,775 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 17:26:53,775 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 17:26:53,775 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 17:26:53,775 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 17:26:53,776 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 17:26:53,776 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:26:53,776 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:53,776 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:26:53,795 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:26:53,811 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:26:53,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:26:53,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:26:53,859 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:26:53,877 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:26:53,880 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:26:53,880 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:53,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 17:26:53,912 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 17:26:53,912 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 17:26:53,912 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 17:26:53,912 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 17:26:53,912 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 17:26:53,912 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 17:26:53,912 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 17:26:53,912 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 17:26:53,916 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 17:26:53,920 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 17:26:53,921 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 17:26:53,921 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 17:26:53,926 - src.evaluation - INFO - 클래스 분포 - 실제: 0=220670, 1=270 (비율: 0.001222)
2025-06-24 17:26:53,926 - src.evaluation - INFO - 예측 분포 - 예측: 0=220940, 1=0
2025-06-24 17:26:53,926 - src.evaluation - WARNING - 모든 예측이 0입니다. 극도로 불균형한 데이터에서 일반적인 현상입니다.
2025-06-24 17:26:54,042 - src.training - INFO -   precision: 0.0
2025-06-24 17:26:54,042 - src.training - INFO -   recall: 0.0
2025-06-24 17:26:54,042 - src.training - INFO -   f1: 0.0
2025-06-24 17:26:54,042 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 17:26:54,042 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 17:26:54,042 - src.training - INFO -   positive_samples: 270
2025-06-24 17:26:54,042 - src.training - INFO -   negative_samples: 220670
2025-06-24 17:26:54,042 - src.training - INFO -   total_samples: 220940
2025-06-24 17:26:54,042 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 17:26:54,042 - src.training - INFO -   roc_auc: 0.0
2025-06-24 17:26:54,042 - src.training - INFO -   pr_auc: 0.0
2025-06-24 17:26:54,042 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 17:26:54,042 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 17:26:54,042 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 17:26:54,042 - src.training - INFO - 모델 학습 완료
2025-06-24 17:26:54,042 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 17:26:54,042 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:54,042 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:54,042 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:26:54,042 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:26:54,061 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 17:26:54,061 - src.hyperparameter_tuning - ERROR - Trial 1 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 17:26:54,470 - src.hyperparameter_tuning - INFO - Trial 2: 모델 타입 = catboost
2025-06-24 17:26:56,496 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 17:26:56,496 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 17:26:56,496 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 17:26:56,496 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 17:26:56,496 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 17:26:56,496 - src.training - INFO - 교차 검증 시작
2025-06-24 17:26:56,496 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 17:26:56,514 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 17:26:56,993 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 17:26:56,994 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 17:26:56,994 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 17:26:56,994 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 17:26:56,994 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 17:26:56,994 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 17:26:56,994 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 17:26:56,994 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 17:26:56,994 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 17:26:57,167 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:26:57,167 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:26:57,167 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:26:57,167 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:26:57,167 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:26:57,168 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 17:26:57,168 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 17:26:57,168 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 17:26:57,168 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 17:26:57,168 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 17:26:58,547 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 17:26:59,635 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:26:59,635 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 17:26:59,641 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 17:26:59,674 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 17:26:59,674 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 17:26:59,674 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 17:26:59,674 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:27:00,965 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:27:01,229 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 17:27:01,229 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:27:01,389 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:27:01,389 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:27:01,431 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:27:01,431 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:27:01,431 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:27:01,431 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 17:27:01,431 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:27:01,431 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:27:01,431 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:27:01,431 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:27:01,431 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:01,431 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:01,491 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 17:27:01,492 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 17:27:01,492 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:01,492 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:01,492 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 17:27:01,492 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 17:27:01,492 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:01,559 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:27:01,559 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:27:01,559 - src.training - INFO - 모델 학습 시작
2025-06-24 17:27:01,559 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:01,559 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:27:01,559 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:27:01,559 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:27:01,559 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:01,559 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:27:01,559 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:27:01,559 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:27:01,688 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 17:27:01,688 - src.training - INFO - 모델 타입: catboost
2025-06-24 17:27:01,688 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 17:27:01,688 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 17:27:01,688 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 17:27:01,688 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 17:27:01,688 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 17:27:01,688 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 17:27:01,688 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:27:01,688 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 17:27:01,688 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 17:27:01,688 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 17:27:01,688 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 17:27:01,688 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:01,689 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:27:01,776 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:27:01,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:27:01,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:27:01,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:27:02,039 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:27:02,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:27:02,131 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 17:27:02,131 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:02,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 17:27:02,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:02,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:27:02,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:02,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:27:02,209 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:27:02,225 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:27:02,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:27:02,258 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:27:02,275 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:27:02,292 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:27:02,295 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:27:02,295 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:02,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 17:27:02,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:02,310 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:27:02,310 - src.models.base_model - INFO - [DEBUG] _find_available_targets - y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:02,310 - src.models.base_model - INFO - [DEBUG] _find_available_targets - target_columns: ['suicide_a_next_year']
2025-06-24 17:27:02,310 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 후보: ['suicide_a_next_year', 'pass__suicide_a_next_year', 'remainder__suicide_a_next_year', 'num__suicide_a_next_year', 'cat__suicide_a_next_year']
2025-06-24 17:27:02,310 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:27:02,310 - src.models.base_model - INFO - [DEBUG] 최종 사용 가능한 타겟: ['pass__suicide_a_next_year']
2025-06-24 17:27:02,310 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:02,310 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 17:27:02,310 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 17:27:02,310 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 17:27:02,323 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   iterations: 132
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   learning_rate: 0.028145092716060652
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.347776308515933
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   random_strength: 1.6738085788752133
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   bagging_temperature: 0.36210622617823773
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   border_count: 128
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 17:27:02,327 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 17:27:02,328 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 17:27:02,328 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 17:27:02,328 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 17:27:02,328 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 17:27:02,328 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 17:27:02,328 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 17:27:02,328 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 17:27:02,328 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 17:27:02,328 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 17:27:02,328 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 17:27:02,328 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 17:27:02,328 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 17:27:02,328 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 17:27:02,328 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 17:27:02,328 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 17:27:03,741 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 17:27:03,741 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 17:27:03,741 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 17:27:03,741 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 17:27:03,741 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 17:27:03,741 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 17:27:03,741 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:27:03,741 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:03,742 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:27:03,761 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:27:03,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:27:03,792 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:27:03,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:27:03,825 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:27:03,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:27:03,845 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:27:03,845 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:03,848 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 17:27:03,876 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 17:27:03,877 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 17:27:03,877 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 17:27:03,877 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 17:27:03,877 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:03,877 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:03,877 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 17:27:03,877 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 17:27:03,880 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 17:27:03,884 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 17:27:03,885 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 17:27:03,885 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 17:27:03,890 - src.evaluation - INFO - 클래스 분포 - 실제: 0=220670, 1=270 (비율: 0.001222)
2025-06-24 17:27:03,890 - src.evaluation - INFO - 예측 분포 - 예측: 0=220940, 1=0
2025-06-24 17:27:03,890 - src.evaluation - WARNING - 모든 예측이 0입니다. 극도로 불균형한 데이터에서 일반적인 현상입니다.
2025-06-24 17:27:04,007 - src.training - INFO -   precision: 0.0
2025-06-24 17:27:04,007 - src.training - INFO -   recall: 0.0
2025-06-24 17:27:04,007 - src.training - INFO -   f1: 0.0
2025-06-24 17:27:04,007 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 17:27:04,007 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 17:27:04,007 - src.training - INFO -   positive_samples: 270
2025-06-24 17:27:04,007 - src.training - INFO -   negative_samples: 220670
2025-06-24 17:27:04,007 - src.training - INFO -   total_samples: 220940
2025-06-24 17:27:04,007 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 17:27:04,007 - src.training - INFO -   roc_auc: 0.0
2025-06-24 17:27:04,007 - src.training - INFO -   pr_auc: 0.0
2025-06-24 17:27:04,007 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 17:27:04,007 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 17:27:04,007 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 17:27:04,007 - src.training - INFO - 모델 학습 완료
2025-06-24 17:27:04,007 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 17:27:04,007 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:04,007 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:04,007 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:04,007 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:04,026 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 17:27:04,026 - src.hyperparameter_tuning - ERROR - Trial 2 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 17:27:04,437 - src.hyperparameter_tuning - INFO - Trial 3: 모델 타입 = catboost
2025-06-24 17:27:06,476 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 17:27:06,476 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 17:27:06,476 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 17:27:06,476 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 17:27:06,476 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 17:27:06,476 - src.training - INFO - 교차 검증 시작
2025-06-24 17:27:06,476 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 17:27:06,494 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 17:27:06,970 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 17:27:06,970 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 17:27:06,970 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 17:27:06,970 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 17:27:06,970 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 17:27:06,970 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 17:27:06,970 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 17:27:06,970 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 17:27:06,970 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 17:27:07,139 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:27:07,140 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:27:07,140 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:27:07,140 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:27:07,140 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:27:07,140 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 17:27:07,140 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 17:27:07,140 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 17:27:07,140 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 17:27:07,140 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 17:27:08,476 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 17:27:09,458 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:27:09,458 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 17:27:09,464 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 17:27:09,497 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 17:27:09,497 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 17:27:09,497 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 17:27:09,497 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:27:10,700 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:27:10,960 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 17:27:10,960 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:27:11,120 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:27:11,120 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:27:11,161 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:27:11,162 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:27:11,162 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:27:11,162 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 17:27:11,162 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:27:11,162 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:27:11,162 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:27:11,162 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:27:11,162 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:11,162 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:11,222 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 17:27:11,222 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 17:27:11,222 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:11,222 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:11,222 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 17:27:11,222 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 17:27:11,222 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:11,291 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:27:11,291 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:27:11,291 - src.training - INFO - 모델 학습 시작
2025-06-24 17:27:11,291 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:11,291 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:27:11,291 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:27:11,291 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:27:11,291 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:11,291 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:27:11,291 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:27:11,291 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:27:11,421 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 17:27:11,422 - src.training - INFO - 모델 타입: catboost
2025-06-24 17:27:11,422 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 17:27:11,422 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 17:27:11,422 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 17:27:11,422 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 17:27:11,422 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 17:27:11,422 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 17:27:11,422 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:27:11,422 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 17:27:11,422 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 17:27:11,422 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 17:27:11,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 17:27:11,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:11,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:27:11,510 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:27:11,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:27:11,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:27:11,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:27:11,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:27:11,850 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:27:11,866 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 17:27:11,866 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:11,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 17:27:11,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:11,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:27:11,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:11,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:27:11,944 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:27:11,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:27:11,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:27:11,991 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:27:12,008 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:27:12,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:27:12,029 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:27:12,029 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:12,044 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 17:27:12,044 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:12,044 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:27:12,044 - src.models.base_model - INFO - [DEBUG] _find_available_targets - y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:12,044 - src.models.base_model - INFO - [DEBUG] _find_available_targets - target_columns: ['suicide_a_next_year']
2025-06-24 17:27:12,044 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 후보: ['suicide_a_next_year', 'pass__suicide_a_next_year', 'remainder__suicide_a_next_year', 'num__suicide_a_next_year', 'cat__suicide_a_next_year']
2025-06-24 17:27:12,044 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:27:12,044 - src.models.base_model - INFO - [DEBUG] 최종 사용 가능한 타겟: ['pass__suicide_a_next_year']
2025-06-24 17:27:12,044 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:12,044 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 17:27:12,044 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 17:27:12,044 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 17:27:12,057 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 17:27:12,061 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 17:27:12,061 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 17:27:12,061 - src.models.catboost_model - INFO -   iterations: 112
2025-06-24 17:27:12,061 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 17:27:12,061 - src.models.catboost_model - INFO -   learning_rate: 0.03476649150592621
2025-06-24 17:27:12,061 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.858051065806936
2025-06-24 17:27:12,061 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 17:27:12,061 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 17:27:12,061 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 17:27:12,061 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 17:27:12,061 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 17:27:12,061 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 17:27:12,061 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 17:27:12,061 - src.models.catboost_model - INFO -   random_strength: 1.0677482709481354
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   bagging_temperature: 0.2797064039425238
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   border_count: 207
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 17:27:12,062 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 17:27:13,514 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 17:27:13,514 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 17:27:13,515 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 17:27:13,515 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 17:27:13,515 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 17:27:13,515 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 17:27:13,515 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:27:13,515 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:13,515 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:27:13,534 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:27:13,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:27:13,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:27:13,583 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:27:13,600 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:27:13,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:27:13,621 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:27:13,621 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:13,624 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 17:27:13,653 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 17:27:13,654 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 17:27:13,654 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 17:27:13,654 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 17:27:13,654 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:13,654 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:13,654 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 17:27:13,654 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 17:27:13,657 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 17:27:13,661 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 17:27:13,662 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 17:27:13,662 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 17:27:13,667 - src.evaluation - INFO - 클래스 분포 - 실제: 0=220670, 1=270 (비율: 0.001222)
2025-06-24 17:27:13,667 - src.evaluation - INFO - 예측 분포 - 예측: 0=220940, 1=0
2025-06-24 17:27:13,667 - src.evaluation - WARNING - 모든 예측이 0입니다. 극도로 불균형한 데이터에서 일반적인 현상입니다.
2025-06-24 17:27:13,784 - src.training - INFO -   precision: 0.0
2025-06-24 17:27:13,784 - src.training - INFO -   recall: 0.0
2025-06-24 17:27:13,784 - src.training - INFO -   f1: 0.0
2025-06-24 17:27:13,784 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 17:27:13,784 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 17:27:13,784 - src.training - INFO -   positive_samples: 270
2025-06-24 17:27:13,784 - src.training - INFO -   negative_samples: 220670
2025-06-24 17:27:13,784 - src.training - INFO -   total_samples: 220940
2025-06-24 17:27:13,784 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 17:27:13,784 - src.training - INFO -   roc_auc: 0.0
2025-06-24 17:27:13,784 - src.training - INFO -   pr_auc: 0.0
2025-06-24 17:27:13,784 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 17:27:13,784 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 17:27:13,784 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 17:27:13,784 - src.training - INFO - 모델 학습 완료
2025-06-24 17:27:13,784 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 17:27:13,784 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:13,784 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:13,784 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:13,784 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:13,804 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 17:27:13,804 - src.hyperparameter_tuning - ERROR - Trial 3 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 17:27:14,231 - src.hyperparameter_tuning - INFO - Trial 4: 모델 타입 = catboost
2025-06-24 17:27:16,269 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 17:27:16,269 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 17:27:16,269 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 17:27:16,269 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 17:27:16,269 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 17:27:16,269 - src.training - INFO - 교차 검증 시작
2025-06-24 17:27:16,269 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 17:27:16,287 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 17:27:16,761 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 17:27:16,761 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 17:27:16,761 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 17:27:16,761 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 17:27:16,761 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 17:27:16,761 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 17:27:16,761 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 17:27:16,761 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 17:27:16,761 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 17:27:16,931 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:27:16,931 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:27:16,931 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:27:16,931 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:27:16,931 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:27:16,931 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 17:27:16,931 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 17:27:16,931 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 17:27:16,931 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 17:27:16,931 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 17:27:18,331 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 17:27:19,416 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:27:19,416 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 17:27:19,422 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 17:27:19,454 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 17:27:19,454 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 17:27:19,454 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 17:27:19,454 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:27:20,749 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:27:21,014 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 17:27:21,014 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:27:21,175 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:27:21,175 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:27:21,218 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:27:21,218 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:27:21,218 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:27:21,218 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 17:27:21,218 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:27:21,218 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:27:21,218 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:27:21,218 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:27:21,218 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:21,218 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:21,278 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 17:27:21,279 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 17:27:21,279 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:21,279 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:21,279 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 17:27:21,279 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 17:27:21,279 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:21,348 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:27:21,348 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:27:21,348 - src.training - INFO - 모델 학습 시작
2025-06-24 17:27:21,348 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:21,348 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:27:21,348 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:27:21,348 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:27:21,348 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:21,348 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:27:21,348 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:27:21,348 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:27:21,479 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 17:27:21,479 - src.training - INFO - 모델 타입: catboost
2025-06-24 17:27:21,479 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 17:27:21,479 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 17:27:21,479 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 17:27:21,479 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 17:27:21,479 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 17:27:21,479 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 17:27:21,480 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:27:21,480 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 17:27:21,480 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 17:27:21,480 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 17:27:21,480 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 17:27:21,480 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:21,480 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:27:21,567 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:27:21,632 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:27:21,700 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:27:21,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:27:21,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:27:21,904 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:27:21,921 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 17:27:21,921 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:21,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 17:27:21,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:21,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:27:21,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:21,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:27:21,999 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:27:22,014 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:27:22,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:27:22,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:27:22,063 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:27:22,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:27:22,085 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:27:22,085 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:22,100 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 17:27:22,100 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:22,100 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:27:22,100 - src.models.base_model - INFO - [DEBUG] _find_available_targets - y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:22,100 - src.models.base_model - INFO - [DEBUG] _find_available_targets - target_columns: ['suicide_a_next_year']
2025-06-24 17:27:22,100 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 후보: ['suicide_a_next_year', 'pass__suicide_a_next_year', 'remainder__suicide_a_next_year', 'num__suicide_a_next_year', 'cat__suicide_a_next_year']
2025-06-24 17:27:22,100 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:27:22,100 - src.models.base_model - INFO - [DEBUG] 최종 사용 가능한 타겟: ['pass__suicide_a_next_year']
2025-06-24 17:27:22,100 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:22,100 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 17:27:22,100 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 17:27:22,100 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 17:27:22,113 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   iterations: 317
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   learning_rate: 0.07896186801026692
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.4808945119975185
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   random_strength: 8.536189862866832
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   bagging_temperature: 0.9539969835279999
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   border_count: 46
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 17:27:22,117 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 17:27:22,118 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 17:27:23,534 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 17:27:23,535 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 17:27:23,535 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 17:27:23,535 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 17:27:23,535 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 17:27:23,535 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 17:27:23,535 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:27:23,535 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:23,536 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:27:23,553 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:27:23,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:27:23,581 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:27:23,595 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:27:23,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:27:23,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:27:23,630 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:27:23,630 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:23,633 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 17:27:23,659 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 17:27:23,659 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 17:27:23,659 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 17:27:23,660 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 17:27:23,660 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:23,660 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:23,660 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 17:27:23,660 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 17:27:23,663 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 17:27:23,667 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 17:27:23,667 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 17:27:23,667 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 17:27:23,672 - src.evaluation - INFO - 클래스 분포 - 실제: 0=220670, 1=270 (비율: 0.001222)
2025-06-24 17:27:23,672 - src.evaluation - INFO - 예측 분포 - 예측: 0=220940, 1=0
2025-06-24 17:27:23,672 - src.evaluation - WARNING - 모든 예측이 0입니다. 극도로 불균형한 데이터에서 일반적인 현상입니다.
2025-06-24 17:27:23,785 - src.training - INFO -   precision: 0.0
2025-06-24 17:27:23,785 - src.training - INFO -   recall: 0.0
2025-06-24 17:27:23,785 - src.training - INFO -   f1: 0.0
2025-06-24 17:27:23,785 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 17:27:23,785 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 17:27:23,785 - src.training - INFO -   positive_samples: 270
2025-06-24 17:27:23,785 - src.training - INFO -   negative_samples: 220670
2025-06-24 17:27:23,785 - src.training - INFO -   total_samples: 220940
2025-06-24 17:27:23,785 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 17:27:23,785 - src.training - INFO -   roc_auc: 0.0
2025-06-24 17:27:23,785 - src.training - INFO -   pr_auc: 0.0
2025-06-24 17:27:23,785 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 17:27:23,785 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 17:27:23,785 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 17:27:23,785 - src.training - INFO - 모델 학습 완료
2025-06-24 17:27:23,785 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 17:27:23,785 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:23,785 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:23,785 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:23,785 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:23,806 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 17:27:23,806 - src.hyperparameter_tuning - ERROR - Trial 4 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 17:27:24,221 - src.hyperparameter_tuning - WARNING - 유효하지 않은 best_score: -inf
2025-06-24 17:27:24,223 - src.hyperparameter_tuning - INFO - 최적화 완료!
2025-06-24 17:27:24,223 - src.hyperparameter_tuning - INFO -   - 최고 성능: 0.0000
2025-06-24 17:27:24,223 - src.hyperparameter_tuning - INFO -   - 최적 파라미터: {'iterations': 218, 'depth': 10, 'learning_rate': 0.1205712628744377, 'l2_leaf_reg': 3.968793330444372, 'border_count': 66, 'bagging_temperature': 0.2403950683025824, 'random_strength': 0.13066739238053282}
2025-06-24 17:27:26,171 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 17:27:26,171 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 17:27:26,171 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 17:27:26,171 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 17:27:26,171 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 17:27:26,171 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 17:27:26,171 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 17:27:26,171 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 17:27:26,403 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:27:26,403 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:27:26,403 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:27:26,403 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:27:26,403 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:27:26,403 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 17:27:26,403 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 17:27:26,403 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 17:27:26,403 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 17:27:26,403 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 17:27:28,027 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 17:27:29,279 - src.preprocessing - INFO - 데이터 변환 완료: (1333765, 33)
2025-06-24 17:27:29,279 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 17:27:30,505 - src.preprocessing - INFO - 데이터 변환 완료: (1333765, 33)
2025-06-24 17:27:30,505 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 17:27:30,703 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 17:27:30,703 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 17:27:30,703 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 17:27:30,703 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:27:30,703 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:27:30,899 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:27:30,900 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 17:27:30,900 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:27:30,900 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:27:30,900 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:27:30,900 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:27:30,900 - src.hyperparameter_tuning - INFO - [DEBUG] _save_best_model - train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:27:30,900 - src.hyperparameter_tuning - INFO - [DEBUG] _save_best_model - feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:30,900 - src.hyperparameter_tuning - INFO - [DEBUG] _save_best_model - target_columns: ['pass__suicide_a_next_year']
2025-06-24 17:27:30,960 - src.hyperparameter_tuning - INFO - [DEBUG] _save_best_model - X_train shape: (1333765, 6), y_train shape: (1333765, 1)
2025-06-24 17:27:30,960 - src.hyperparameter_tuning - INFO - [DEBUG] _save_best_model - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:30,960 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 17:27:30,960 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 17:27:30,960 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 17:27:30,960 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 17:27:30,960 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 17:27:30,960 - src.hyperparameter_tuning - INFO - 최종 모델 학습 - X_train shape: (1333765, 6), y_train shape: (1333765, 1)
2025-06-24 17:27:30,960 - src.hyperparameter_tuning - INFO - 최종 모델 학습 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:27:30,961 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 17:27:30,961 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(1333765, 6), y=(1333765, 1)
2025-06-24 17:27:30,961 - src.models.catboost_model - INFO - Early Stopping 비활성화
2025-06-24 17:27:30,961 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 17:27:30,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (1333765, 6)
2025-06-24 17:27:30,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:30,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:27:31,073 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:27:31,156 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:27:31,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:27:31,325 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:27:31,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:27:31,515 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:27:31,539 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (1333765, 6)
2025-06-24 17:27:31,539 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:27:31,565 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (1333765, 6)
2025-06-24 17:27:31,565 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(1333765, 6), y=(1333765, 0)
2025-06-24 17:27:31,565 - src.models.base_model - INFO - [DEBUG] _find_available_targets - y 컬럼: []
2025-06-24 17:27:31,565 - src.models.base_model - INFO - [DEBUG] _find_available_targets - target_columns: ['suicide_a_next_year']
2025-06-24 17:27:31,565 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 후보: ['suicide_a_next_year', 'pass__suicide_a_next_year', 'remainder__suicide_a_next_year', 'num__suicide_a_next_year', 'cat__suicide_a_next_year']
2025-06-24 17:27:31,565 - src.models.base_model - WARNING - [DEBUG] 타겟 suicide_a_next_year 매칭 실패. 후보: ['suicide_a_next_year', 'pass__suicide_a_next_year', 'remainder__suicide_a_next_year', 'num__suicide_a_next_year', 'cat__suicide_a_next_year']
2025-06-24 17:27:31,565 - src.models.base_model - INFO - [DEBUG] 최종 사용 가능한 타겟: []
2025-06-24 17:27:31,565 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: []
2025-06-24 17:27:31,565 - src.models.catboost_model - ERROR - y 데이터프레임에 컬럼이 없습니다! 타겟 컬럼 매칭을 확인하세요.
2025-06-24 17:27:31,565 - src.models.catboost_model - ERROR - y 컬럼: []
2025-06-24 17:27:31,565 - src.models.catboost_model - ERROR - y dtypes: Series([], dtype: object)
2025-06-24 17:27:31,566 - src.models.base_model - INFO - 모델이 models/best_tuned_model.joblib에 저장되었습니다.
2025-06-24 17:27:31,567 - src.hyperparameter_tuning - INFO - 최고 모델 저장 완료: models/best_tuned_model.joblib
2025-06-24 17:27:32,274 - src.hyperparameter_tuning - INFO - Study 저장 완료: models/optuna_study.pkl
2025-06-24 17:27:32,484 - matplotlib.legend - WARNING - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
2025-06-24 17:27:32,641 - __main__ - INFO - === 하이퍼파라미터 튜닝 완료 ===
2025-06-24 17:27:32,641 - __main__ - INFO - 최고 성능: 0.0000
2025-06-24 17:27:32,641 - __main__ - INFO - 최적 파라미터:
2025-06-24 17:27:32,641 - __main__ - INFO -   iterations: 218
2025-06-24 17:27:32,641 - __main__ - INFO -   depth: 10
2025-06-24 17:27:32,641 - __main__ - INFO -   learning_rate: 0.1205712628744377
2025-06-24 17:27:32,641 - __main__ - INFO -   l2_leaf_reg: 3.968793330444372
2025-06-24 17:27:32,641 - __main__ - INFO -   border_count: 66
2025-06-24 17:27:32,641 - __main__ - INFO -   bagging_temperature: 0.2403950683025824
2025-06-24 17:27:32,641 - __main__ - INFO -   random_strength: 0.13066739238053282

==================================================
튜닝 결과 요약
==================================================
모델 타입: catboost
실험 타입: hyperparameter_tuning
MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/791d4c3d8650462bb5de9805cf29fef8
최고 성능: 0.0
최적 파라미터: {'iterations': 218, 'depth': 10, 'learning_rate': 0.1205712628744377, 'l2_leaf_reg': 3.968793330444372, 'border_count': 66, 'bagging_temperature': 0.2403950683025824, 'random_strength': 0.13066739238053282}
튜닝 시간: N/A
==================================================
2025-06-24 17:27:32,642 - __main__ - INFO - 실험 결과가 /home/junhyung/Documents/simcare/kbsmc_suicide/results/experiment_results_20250624_172732.txt에 저장되었습니다.
2025-06-24 17:27:32,642 - __main__ - INFO - MLflow Experiment ID: 765186397364671153
2025-06-24 17:27:32,642 - __main__ - INFO - MLflow Run ID: 791d4c3d8650462bb5de9805cf29fef8
2025-06-24 17:27:32,642 - __main__ - INFO - MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/791d4c3d8650462bb5de9805cf29fef8
