2025-06-24 17:41:27,700 - src.hyperparameter_tuning - INFO - MLflow 실험 설정: hyperparameter_tuning (ID: 765186397364671153)
2025-06-24 17:41:27,700 - src.hyperparameter_tuning - INFO - 전달받은 데이터 사용: (1333765, 33)
2025-06-24 17:41:27,701 - src.hyperparameter_tuning - INFO - 모델 타입: lightgbm
2025-06-24 17:41:27,701 - src.hyperparameter_tuning - INFO - 튜닝 설정 - 시도 횟수: 5, 타임아웃: 3600초
2025-06-24 17:41:27,701 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 튜너 초기화 완료
2025-06-24 17:41:27,701 - src.hyperparameter_tuning - INFO -   - 튜닝 설정: {'data': {'file_path': 'data/processed/processed_data_with_features.csv', 'encoding': 'utf-8', 'na_values': ['', 'nan', 'NaN', 'NULL', 'null']}, 'features': {'target_columns': ['suicide_a_next_year'], 'exclude_columns': ['id', 'patient_id', 'visit_date', 'visit_year'], 'categorical_columns': ['gender', 'marital_status', 'education_level', 'income_level', 'residence_type', 'insurance_type', 'primary_diagnosis', 'comorbidity', 'medication_type', 'treatment_type', 'follow_up_status'], 'selected_features': ['age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score'], 'validation': {'scope': 'sample', 'sample_size': 10}, 'enable_feature_engineering': False, 'enable_lagged_features': False, 'lag_periods': [1, 2, 3], 'lagged_features': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}, 'enable_rolling_stats': False, 'rolling_stats': {'window_sizes': [2, 3], 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}}, 'preprocessing': {'time_series_imputation': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp'], 'fallback_strategy': 'mean'}, 'numerical_imputation': {'strategy': 'mean', 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']}, 'categorical_imputation': {'strategy': 'most_frequent', 'columns': ['sex']}, 'categorical_encoding': {'method': 'ordinal'}, 'missing_value_strategy': 'median', 'outlier_detection': {'method': 'iqr', 'threshold': 1.5}, 'scaling': {'method': 'robust', 'with_mean': True, 'with_std': True}, 'feature_selection': {'method': 'variance_threshold', 'threshold': 0.01}}, 'data_split': {'test_ids_ratio': 0.15, 'random_state': 42, 'method': 'stratified_kfold', 'n_splits': 5, 'test_size': 0.2, 'val_size': 0.2}, 'validation': {'strategy': 'group_kfold', 'num_cv_folds': 5, 'test_size': 0.15, 'random_state': 42, 'val_ids_ratio': 0.15, 'validation_start_year': 2021, 'min_train_years': 3, 'max_train_years': 8}, 'time_series': {'date_column': 'dov', 'year_column': 'yov', 'id_column': 'id'}, 'evaluation': {'regression_metrics': ['mae', 'rmse', 'r2'], 'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2'], 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True, 'primary_metric': 'pr_auc', 'secondary_metrics': ['recall', 'precision', 'balanced_accuracy', 'roc_auc'], 'metrics': {'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy', 'pr_auc'], 'regression_metrics': ['mae', 'rmse', 'r2'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2', 'pr_auc']}}, 'training': {'early_stopping': True, 'patience': 10, 'handle_imbalance': True, 'save_best_model': True, 'model_save_path': 'models/'}, 'logging': {'log_splits_info': True, 'log_fold_details': True, 'level': 'INFO', 'format': '%(asctime)s - %(name)s - %(levelname)s - %(message)s', 'file': 'logs/experiment.log'}, 'output': {'directory': 'results', 'save_model': True, 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True}, 'mlflow': {'experiment_name': 'hyperparameter_tuning', 'experiment_description': '자살 위험 예측 모델 실험', 'tags': ['suicide_prediction', 'healthcare', 'classification', 'regression'], 'nested_runs': True, 'save_artifacts': True, 'log_params': True, 'log_metrics': True, 'log_model': True, 'tracking': {'tracking_uri': 'file:./mlruns', 'experiment_name': 'suicide_prediction', 'nested_runs': True, 'artifact_location': './mlruns'}, 'logging': {'param_logging_level': 'INFO', 'metric_logging_level': 'INFO', 'artifact_logging_level': 'INFO', 'log_experiment_info': True, 'log_fold_results': True, 'log_model_info': True}, 'log_optimization': True}, 'model': {'model_type': 'lightgbm', 'lightgbm': {'num_leaves': 31, 'learning_rate': 0.1, 'feature_fraction': 0.9, 'bagging_fraction': 0.8, 'bagging_freq': 5, 'min_data_in_leaf': 20, 'min_sum_hessian_in_leaf': '1e-3', 'lambda_l1': 0.1, 'lambda_l2': 0.1, 'num_threads': 28, 'verbose': -1, 'early_stopping_rounds': 10, 'max_cat_threshold': 32, 'cat_smooth': 10.0, 'cat_l2': 10.0, 'is_unbalance': True, 'scale_pos_weight': 1.0, 'class_weight': 'balanced', 'boosting_type': 'gbdt', 'objective': 'binary', 'metric': 'binary_logloss', 'max_depth': 6, 'min_gain_to_split': 0.0, 'min_child_samples': 20, 'bagging_seed': 42, 'feature_fraction_seed': 42, 'drop_seed': 42, 'data_random_seed': 42, 'use_focal_loss': False, 'focal_loss': {'alpha': 0.25, 'gamma': 2.0}}}, 'imbalanced_data': {'resampling': {'enabled': False, 'method': 'smote', 'smote': {'k_neighbors': 5, 'sampling_strategy': 'auto'}, 'borderline_smote': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'm_neighbors': 10}, 'adasyn': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'n_neighbors': 5}, 'under_sampling': {'strategy': 'random', 'sampling_strategy': 'auto'}}, 'class_weight': 'balanced', 'scale_pos_weight': 1.0, 'is_unbalance': True}, 'experiment': {'name': 'hyperparameter_tuning_experiment', 'description': 'Optuna 기반 하이퍼파라미터 최적화 실험', 'tags': ['hyperparameter_tuning', 'optuna', 'optimization']}, 'tuning': {'direction': 'maximize', 'n_trials': 5, 'n_jobs': 1, 'early_stopping': {'enabled': True, 'patience': 20, 'min_trials': 30}}, 'sampler': {'type': 'tpe', 'tpe': {'n_startup_trials': 10, 'n_ei_candidates': 24, 'multivariate': True, 'group': False}, 'cmaes': {'x0': {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'min_child_weight': 1, 'reg_alpha': 0.1, 'reg_lambda': 1.0}, 'sigma0': 0.1}}, 'xgboost_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 15, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'scale_pos_weight': {'type': 'float', 'low': 0.5, 'high': 10.0, 'log': True}}, 'lightgbm_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 12, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}}, 'catboost_params': {'iterations': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'depth': {'type': 'int', 'low': 3, 'high': 10, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'l2_leaf_reg': {'type': 'float', 'low': 1, 'high': 10, 'log': True}, 'border_count': {'type': 'int', 'low': 32, 'high': 255, 'log': False}, 'bagging_temperature': {'type': 'float', 'low': 0.1, 'high': 1.0, 'log': False}, 'random_strength': {'type': 'float', 'low': 0.1, 'high': 10.0, 'log': True}}, 'random_forest_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 20, 'log': False}, 'min_samples_split': {'type': 'int', 'low': 2, 'high': 20, 'log': False}, 'min_samples_leaf': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'max_features': {'type': 'categorical', 'choices': ['sqrt', 'log2', 'auto']}}, 'cv': {'strategy': 'group_kfold', 'n_folds': 5, 'shuffle': False}, 'results': {'save_best_model': True, 'model_save_path': 'models/best_tuned_model.joblib', 'save_study': True, 'study_save_path': 'models/optuna_study.pkl', 'create_plots': True, 'plots_save_path': 'data/tuning_results/'}}
2025-06-24 17:41:27,701 - src.hyperparameter_tuning - INFO -   - 튜닝 횟수: 5
2025-06-24 17:41:27,701 - src.hyperparameter_tuning - INFO -   - 타임아웃: 3600초
2025-06-24 17:41:27,736 - __main__ - INFO - MLflow Run 시작: 15766a98bd104e1bb715fafa5e47b332
2025-06-24 17:41:27,739 - __main__ - INFO - 튜닝 파라미터 로깅 완료: 6개 파라미터
2025-06-24 17:41:27,739 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 최적화 시작
2025-06-24 17:41:27,744 - src.hyperparameter_tuning - INFO - Trial 0: 모델 타입 = lightgbm
2025-06-24 17:41:29,775 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 17:41:29,775 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 17:41:29,775 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 17:41:29,775 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 17:41:29,775 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 17:41:29,776 - src.training - INFO - 교차 검증 시작
2025-06-24 17:41:29,776 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 17:41:29,792 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 17:41:30,269 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 17:41:30,269 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 17:41:30,269 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 17:41:30,269 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 17:41:30,269 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 17:41:30,269 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 17:41:30,269 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 17:41:30,269 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 17:41:30,269 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 17:41:30,442 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:41:30,442 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:41:30,442 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:41:30,442 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:41:30,442 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:41:30,442 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 17:41:30,442 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 17:41:30,442 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 17:41:30,442 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 17:41:30,442 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 17:41:31,807 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 17:41:32,887 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:41:32,887 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 17:41:32,892 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 17:41:32,922 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 17:41:32,922 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 17:41:32,922 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 17:41:32,922 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:41:34,212 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:41:34,475 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 17:41:34,475 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:41:34,636 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:41:34,636 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:41:34,678 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:41:34,678 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:41:34,678 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:41:34,678 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 17:41:34,678 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:41:34,678 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:41:34,678 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:41:34,678 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:41:34,678 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:34,678 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 17:41:34,739 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 17:41:34,739 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 17:41:34,739 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:34,739 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:34,739 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 17:41:34,739 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 17:41:34,739 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:34,804 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:41:34,804 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:41:34,804 - src.training - INFO - 모델 학습 시작
2025-06-24 17:41:34,804 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:41:34,804 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:41:34,804 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:41:34,804 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:41:34,804 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:41:34,804 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:41:34,804 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:41:34,804 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:41:34,935 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 17:41:34,935 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 17:41:34,935 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 17:41:34,935 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 17:41:34,935 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 17:41:34,935 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 17:41:34,935 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 17:41:34,935 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 17:41:34,935 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:41:34,935 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 17:41:34,935 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 17:41:34,935 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 17:41:34,935 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 17:41:34,935 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:34,936 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:41:35,025 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:41:35,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:41:35,160 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:41:35,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:41:35,290 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:41:35,366 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:41:35,385 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 17:41:35,385 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:35,450 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 17:41:35,450 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:35,450 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:41:35,450 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:35,450 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:41:35,469 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:41:35,484 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:41:35,500 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:41:35,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:41:35,534 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:41:35,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:41:35,555 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:41:35,555 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:35,570 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 17:41:35,570 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:35,570 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:41:35,570 - src.models.base_model - INFO - [DEBUG] _find_available_targets - y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:35,570 - src.models.base_model - INFO - [DEBUG] _find_available_targets - target_columns: ['suicide_a_next_year']
2025-06-24 17:41:35,570 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 후보: ['suicide_a_next_year', 'pass__suicide_a_next_year', 'remainder__suicide_a_next_year', 'num__suicide_a_next_year', 'cat__suicide_a_next_year']
2025-06-24 17:41:35,570 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:41:35,570 - src.models.base_model - INFO - [DEBUG] 최종 사용 가능한 타겟: ['pass__suicide_a_next_year']
2025-06-24 17:41:35,570 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:35,570 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 17:41:35,584 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   learning_rate: 0.1205712628744377
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   n_estimators: 406
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   subsample: 0.8394633936788146
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6624074561769746
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   reg_alpha: 3.3323645788192616e-08
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO -   reg_lambda: 0.6245760287469893
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 17:41:35,588 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 17:41:35,717 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 17:41:35,718 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.7087992977540071})})
2025-06-24 17:41:35,718 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 17:41:35,718 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 17:41:35,718 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 17:41:35,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:41:35,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:35,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:41:35,738 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:41:35,754 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:41:35,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:41:35,787 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:41:35,804 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:41:35,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:41:35,827 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:41:35,827 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:35,829 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 17:41:35,835 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 17:41:35,836 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 17:41:35,836 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 17:41:35,836 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 17:41:35,836 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 17:41:35,836 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 17:41:35,836 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 17:41:35,836 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 17:41:35,839 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 17:41:35,844 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 17:41:35,845 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [7.43446279e-001 1.42770457e-014 5.96039131e-001 0.00000000e+000
 3.64939500e-156 9.42132121e-030 9.64402299e-094 9.17272366e-033
 3.45460844e-010 1.23705126e-027 4.65873474e-005 7.17487841e-001
 9.98045234e-001 1.50044377e-215 3.17773976e-052 2.62013108e-021
 9.39072146e-301 2.11301064e-082 9.99999985e-001 5.50826663e-063
 1.13058639e-133 1.67168661e-104 9.80136271e-072 3.11070401e-020
 8.96674731e-307 1.13344880e-145 1.52026427e-279 9.98341004e-013
 4.13585554e-112 2.54392254e-188 3.76054208e-173 2.45742501e-014
 1.71838643e-012 2.24175421e-274 1.90770849e-111 5.13989591e-006
 2.42022841e-115 9.58375621e-001 2.22787522e-013 5.81291121e-023
 2.32116964e-030 3.94126688e-035 3.75122218e-183 3.43054758e-018
 2.05273152e-035 4.22936455e-173 3.31945145e-032 3.31495914e-077
 1.26257926e-072 4.13647977e-034 3.93311933e-035 8.98427957e-053
 7.14306415e-186 3.97394682e-241 5.22040542e-107 8.32810643e-028
 6.14229938e-122 2.69218988e-162 3.50761795e-127 2.32527469e-039
 5.82495280e-023 5.62466372e-037 1.04649058e-057 9.73663607e-016
 6.16320143e-053 1.17478099e-181 1.52946300e-070 4.85412778e-019
 6.58798151e-028 9.99999998e-001 9.50130548e-053 7.23247035e-038
 1.11989395e-011 5.72528841e-151 8.00501879e-113 1.04432723e-057
 1.72756952e-157 5.59569866e-048 7.56071407e-124 3.75559595e-029
 1.55787075e-011 4.53376564e-266 1.09003957e-060 1.02499152e-077
 6.03658485e-073 1.22826201e-042 4.30786863e-037 3.52861820e-063
 2.73139735e-199 6.41856447e-056 4.05150009e-054 5.95581565e-132
 5.91870443e-094 2.33908950e-070 2.35416461e-108 1.20224965e-151
 6.21947523e-149 2.69580236e-156 1.79206867e-242 3.13747303e-063
 4.62823205e-204 2.24613180e-052 2.27884315e-089 1.75788632e-141
 3.48515659e-089 2.67011584e-261 5.53005022e-149 3.95898914e-138
 4.01664553e-175 1.83319822e-180]
2025-06-24 17:41:35,845 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 17:41:35,850 - src.evaluation - INFO - 클래스 분포 - 실제: 0=220670, 1=270 (비율: 0.001222)
2025-06-24 17:41:35,850 - src.evaluation - INFO - 예측 분포 - 예측: 0=220940, 1=0
2025-06-24 17:41:35,850 - src.evaluation - WARNING - 모든 예측이 0입니다. 극도로 불균형한 데이터에서 일반적인 현상입니다.
2025-06-24 17:41:35,969 - src.training - INFO -   precision: 0.0
2025-06-24 17:41:35,969 - src.training - INFO -   recall: 0.0
2025-06-24 17:41:35,969 - src.training - INFO -   f1: 0.0
2025-06-24 17:41:35,969 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 17:41:35,969 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 17:41:35,969 - src.training - INFO -   positive_samples: 270
2025-06-24 17:41:35,969 - src.training - INFO -   negative_samples: 220670
2025-06-24 17:41:35,969 - src.training - INFO -   total_samples: 220940
2025-06-24 17:41:35,969 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 17:41:35,969 - src.training - INFO -   roc_auc: 0.0
2025-06-24 17:41:35,969 - src.training - INFO -   pr_auc: 0.0
2025-06-24 17:41:35,969 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 17:41:35,970 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 17:41:35,970 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 17:41:35,970 - src.training - INFO - 모델 학습 완료
2025-06-24 17:41:35,970 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 17:41:35,970 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:35,970 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:35,970 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:35,970 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:35,989 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 17:41:35,989 - src.hyperparameter_tuning - ERROR - Trial 0 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 17:41:36,393 - src.hyperparameter_tuning - INFO - Trial 1: 모델 타입 = lightgbm
2025-06-24 17:41:38,322 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 17:41:38,322 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 17:41:38,322 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 17:41:38,322 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 17:41:38,322 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 17:41:38,322 - src.training - INFO - 교차 검증 시작
2025-06-24 17:41:38,322 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 17:41:38,340 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 17:41:38,815 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 17:41:38,816 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 17:41:38,816 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 17:41:38,816 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 17:41:38,816 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 17:41:38,816 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 17:41:38,816 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 17:41:38,816 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 17:41:38,816 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 17:41:38,994 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:41:38,994 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:41:38,994 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:41:38,994 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:41:38,994 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:41:38,994 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 17:41:38,994 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 17:41:38,994 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 17:41:38,994 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 17:41:38,994 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 17:41:40,398 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 17:41:41,502 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:41:41,502 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 17:41:41,509 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 17:41:41,543 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 17:41:41,543 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 17:41:41,543 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 17:41:41,543 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:41:42,857 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:41:43,122 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 17:41:43,122 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:41:43,283 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:41:43,283 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:41:43,325 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:41:43,325 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:41:43,325 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:41:43,325 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 17:41:43,325 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:41:43,326 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:41:43,326 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:41:43,326 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:41:43,326 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:43,326 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 17:41:43,386 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 17:41:43,387 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 17:41:43,387 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:43,387 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:43,387 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 17:41:43,387 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 17:41:43,387 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:43,452 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:41:43,452 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:41:43,452 - src.training - INFO - 모델 학습 시작
2025-06-24 17:41:43,452 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:41:43,452 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:41:43,452 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:41:43,452 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:41:43,452 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:41:43,452 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:41:43,452 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:41:43,452 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:41:43,582 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 17:41:43,582 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 17:41:43,582 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 17:41:43,582 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 17:41:43,582 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 17:41:43,582 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 17:41:43,582 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 17:41:43,582 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 17:41:43,582 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:41:43,582 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 17:41:43,582 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 17:41:43,582 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 17:41:43,582 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 17:41:43,582 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:43,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:41:43,670 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:41:43,735 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:41:43,803 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:41:43,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:41:43,933 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:41:44,009 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:41:44,027 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 17:41:44,027 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:44,090 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 17:41:44,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:44,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:41:44,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:44,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:41:44,109 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:41:44,125 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:41:44,141 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:41:44,157 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:41:44,174 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:41:44,192 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:41:44,194 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:41:44,194 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:44,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 17:41:44,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:44,209 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:41:44,209 - src.models.base_model - INFO - [DEBUG] _find_available_targets - y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:44,209 - src.models.base_model - INFO - [DEBUG] _find_available_targets - target_columns: ['suicide_a_next_year']
2025-06-24 17:41:44,209 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 후보: ['suicide_a_next_year', 'pass__suicide_a_next_year', 'remainder__suicide_a_next_year', 'num__suicide_a_next_year', 'cat__suicide_a_next_year']
2025-06-24 17:41:44,209 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:41:44,209 - src.models.base_model - INFO - [DEBUG] 최종 사용 가능한 타겟: ['pass__suicide_a_next_year']
2025-06-24 17:41:44,209 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:44,209 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 17:41:44,220 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   learning_rate: 0.010725209743171997
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   n_estimators: 621
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   subsample: 0.9879639408647978
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9329770563201687
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   reg_alpha: 4.329370014459266e-07
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO -   reg_lambda: 4.4734294104626844e-07
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 17:41:44,223 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 17:41:44,337 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 17:41:44,337 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.16125891018456975})})
2025-06-24 17:41:44,337 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 17:41:44,337 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 17:41:44,338 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 17:41:44,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:41:44,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:44,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:41:44,356 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:41:44,372 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:41:44,389 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:41:44,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:41:44,421 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:41:44,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:41:44,443 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:41:44,443 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:44,447 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 17:41:44,448 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 17:41:44,449 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 17:41:44,449 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 17:41:44,449 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 17:41:44,449 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 17:41:44,449 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 17:41:44,449 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 17:41:44,449 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 17:41:44,452 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 17:41:44,457 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 17:41:44,458 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00251772 0.10222178 0.04393002 0.33701265 0.0050561  0.0103742
 0.03589401 0.1607431  0.35388794 0.10674087 0.00115553 0.08371821
 0.00477808 0.8134218  0.00115544 0.76679974 0.2341771  0.00115607
 0.39395852 0.46848843 0.85724768 0.39645649 0.12693073 0.00115588
 0.00306533 0.0011561  0.02141667 0.59568929 0.59314329 0.72577103
 0.00115612]
2025-06-24 17:41:44,458 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 17:41:44,462 - src.evaluation - INFO - 클래스 분포 - 실제: 0=220670, 1=270 (비율: 0.001222)
2025-06-24 17:41:44,463 - src.evaluation - INFO - 예측 분포 - 예측: 0=220940, 1=0
2025-06-24 17:41:44,463 - src.evaluation - WARNING - 모든 예측이 0입니다. 극도로 불균형한 데이터에서 일반적인 현상입니다.
2025-06-24 17:41:44,577 - src.training - INFO -   precision: 0.0
2025-06-24 17:41:44,577 - src.training - INFO -   recall: 0.0
2025-06-24 17:41:44,577 - src.training - INFO -   f1: 0.0
2025-06-24 17:41:44,577 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 17:41:44,577 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 17:41:44,577 - src.training - INFO -   positive_samples: 270
2025-06-24 17:41:44,577 - src.training - INFO -   negative_samples: 220670
2025-06-24 17:41:44,577 - src.training - INFO -   total_samples: 220940
2025-06-24 17:41:44,577 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 17:41:44,577 - src.training - INFO -   roc_auc: 0.0
2025-06-24 17:41:44,577 - src.training - INFO -   pr_auc: 0.0
2025-06-24 17:41:44,577 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 17:41:44,577 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 17:41:44,577 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 17:41:44,577 - src.training - INFO - 모델 학습 완료
2025-06-24 17:41:44,577 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 17:41:44,577 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:44,577 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:44,577 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:44,577 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:44,597 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 17:41:44,597 - src.hyperparameter_tuning - ERROR - Trial 1 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 17:41:44,999 - src.hyperparameter_tuning - INFO - Trial 2: 모델 타입 = lightgbm
2025-06-24 17:41:46,949 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 17:41:46,949 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 17:41:46,949 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 17:41:46,949 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 17:41:46,949 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 17:41:46,949 - src.training - INFO - 교차 검증 시작
2025-06-24 17:41:46,949 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 17:41:46,967 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 17:41:47,448 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 17:41:47,448 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 17:41:47,448 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 17:41:47,448 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 17:41:47,448 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 17:41:47,448 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 17:41:47,448 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 17:41:47,448 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 17:41:47,448 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 17:41:47,618 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:41:47,618 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:41:47,618 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:41:47,618 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:41:47,618 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:41:47,618 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 17:41:47,618 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 17:41:47,618 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 17:41:47,618 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 17:41:47,618 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 17:41:49,026 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 17:41:50,124 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:41:50,124 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 17:41:50,130 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 17:41:50,164 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 17:41:50,164 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 17:41:50,164 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 17:41:50,164 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:41:51,468 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:41:51,730 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 17:41:51,730 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:41:51,893 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:41:51,893 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:41:51,935 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:41:51,935 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:41:51,935 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:41:51,935 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 17:41:51,935 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:41:51,935 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:41:51,935 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:41:51,935 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:41:51,935 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:51,935 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 17:41:51,996 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 17:41:51,996 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 17:41:51,996 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:51,996 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:51,996 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 17:41:51,996 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 17:41:51,996 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:52,063 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:41:52,063 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:41:52,063 - src.training - INFO - 모델 학습 시작
2025-06-24 17:41:52,063 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:41:52,063 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:41:52,063 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:41:52,063 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:41:52,064 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:41:52,064 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:41:52,064 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:41:52,064 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:41:52,194 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 17:41:52,194 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 17:41:52,194 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 17:41:52,194 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 17:41:52,194 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 17:41:52,194 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 17:41:52,194 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 17:41:52,194 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 17:41:52,194 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:41:52,194 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 17:41:52,194 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 17:41:52,194 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 17:41:52,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 17:41:52,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:52,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:41:52,282 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:41:52,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:41:52,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:41:52,479 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:41:52,545 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:41:52,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:41:52,640 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 17:41:52,640 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:52,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 17:41:52,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:52,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:41:52,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:52,705 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:41:52,723 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:41:52,738 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:41:52,754 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:41:52,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:41:52,787 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:41:52,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:41:52,809 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:41:52,809 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:52,824 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 17:41:52,824 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:52,824 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:41:52,824 - src.models.base_model - INFO - [DEBUG] _find_available_targets - y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:52,824 - src.models.base_model - INFO - [DEBUG] _find_available_targets - target_columns: ['suicide_a_next_year']
2025-06-24 17:41:52,824 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 후보: ['suicide_a_next_year', 'pass__suicide_a_next_year', 'remainder__suicide_a_next_year', 'num__suicide_a_next_year', 'cat__suicide_a_next_year']
2025-06-24 17:41:52,824 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:41:52,824 - src.models.base_model - INFO - [DEBUG] 최종 사용 가능한 타겟: ['pass__suicide_a_next_year']
2025-06-24 17:41:52,824 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:52,824 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 17:41:52,837 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 17:41:52,839 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 17:41:52,839 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 17:41:52,839 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 17:41:52,839 - src.models.lightgbm_model - INFO -   learning_rate: 0.04345454109729477
2025-06-24 17:41:52,839 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 17:41:52,839 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 17:41:52,839 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 17:41:52,839 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 17:41:52,839 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 17:41:52,839 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 17:41:52,839 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 17:41:52,839 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 17:41:52,839 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 17:41:52,839 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 17:41:52,839 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   n_estimators: 339
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   subsample: 0.7164916560792167
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8447411578889518
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   reg_alpha: 4.258943089524393e-06
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO -   reg_lambda: 1.9826980964985924e-05
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 17:41:52,840 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 17:41:52,954 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 17:41:52,954 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 2.439622263925049})})
2025-06-24 17:41:52,954 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 17:41:52,954 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 17:41:52,954 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 17:41:52,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:41:52,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:52,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:41:52,974 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:41:52,991 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:41:53,008 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:41:53,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:41:53,042 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:41:53,060 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:41:53,063 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:41:53,063 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:53,066 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 17:41:53,068 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 17:41:53,068 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 17:41:53,068 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 17:41:53,068 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 17:41:53,068 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 17:41:53,068 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 17:41:53,068 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 17:41:53,068 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 17:41:53,072 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 17:41:53,076 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 17:41:53,078 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [1.72722680e-002 9.97968158e-001 9.25539727e-001 9.99995256e-001
 9.99999979e-001 2.73122621e-001 1.91477087e-002 7.71807997e-005
 9.99646815e-001 8.76617734e-001 9.99172034e-001 9.93689394e-001
 9.99910062e-001 9.99992605e-001 2.40851140e-080 9.99526913e-001
 1.29498509e-002 1.36987370e-005 2.30902866e-001 1.00000000e+000
 1.71725325e-002 9.39266909e-004 7.01296788e-004 9.99719408e-001
 1.00000000e+000 8.41359307e-001 2.68302423e-004 1.00000000e+000
 1.78339207e-173 9.99999972e-001 1.83078674e-001 9.98891130e-001
 1.56794674e-070 1.16099255e-163 9.41360789e-004 0.00000000e+000
 4.64391193e-099 6.36894497e-101 1.14326731e-068 9.99998321e-001
 8.46536933e-162 9.99996659e-001 9.99244229e-001 9.35224009e-004
 1.61193575e-007 4.13528969e-006 9.99717751e-001 9.99624142e-001
 9.78328928e-111 2.16719076e-004 1.61313841e-007 5.19956020e-028
 7.46177637e-247 1.02335367e-248 9.99951038e-001 9.99861658e-001
 4.67736822e-002 1.25255127e-021 7.02860541e-004 1.00000000e+000
 4.62887823e-018 9.80965903e-001 8.44943489e-006 9.69523758e-031
 4.96417551e-015 4.64091493e-072 1.00000000e+000 3.11397950e-011
 3.61962523e-013 6.04218020e-073 2.61288793e-274 8.97221703e-274
 2.20240033e-003 1.45664733e-031 9.99999977e-001 1.18441950e-010
 3.98828117e-015 7.43250804e-006 9.99999998e-001 9.43950101e-001
 7.21908601e-004 9.99999999e-001 5.19811419e-071 9.99747367e-001
 1.13677196e-019 8.56551525e-005 4.13799504e-006 1.21267978e-017
 9.99922593e-001 9.39928984e-001 2.15681786e-021 4.04050659e-003
 3.80851683e-024 5.46977282e-017 1.66314324e-019 1.00000000e+000
 4.93900760e-026 7.89065129e-001 2.97965630e-011 9.96347168e-001
 1.57264229e-019 6.84930740e-027 8.28661562e-075 9.06839466e-017
 9.94387097e-001 6.08172918e-027 2.13437067e-270 2.09541977e-021
 1.41885837e-007 4.08648297e-013 9.15049973e-017 3.79125582e-026
 1.41793074e-007 9.35784650e-018 2.26123613e-012 1.19067390e-032
 2.45539520e-001 5.73128709e-246 9.78417814e-001 1.23050474e-275
 2.34342994e-253 5.32426688e-020 2.44109753e-016 4.99416787e-025
 7.06927595e-029 1.09969990e-013 1.25120924e-028 4.95727096e-034
 1.51377204e-076 2.72590271e-274 4.76756320e-032 2.24784611e-277
 1.49226696e-040 1.51730789e-025 1.83571076e-073 3.83595118e-024
 1.40426393e-018 4.00216350e-023 7.81638883e-039 2.50739252e-021
 3.61459078e-032 3.36809755e-028 2.22016207e-035 2.04674209e-103
 6.89143564e-273 4.07488351e-076 6.68074498e-083 3.11956029e-107
 1.09828451e-110 5.52197400e-035 8.54546661e-099 9.93307327e-101
 2.09679141e-112 2.77631712e-031 6.69892574e-104 4.58042325e-023
 6.05091838e-277 1.57286318e-017 1.13519085e-038]
2025-06-24 17:41:53,078 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 17:41:53,082 - src.evaluation - INFO - 클래스 분포 - 실제: 0=220670, 1=270 (비율: 0.001222)
2025-06-24 17:41:53,082 - src.evaluation - INFO - 예측 분포 - 예측: 0=220940, 1=0
2025-06-24 17:41:53,082 - src.evaluation - WARNING - 모든 예측이 0입니다. 극도로 불균형한 데이터에서 일반적인 현상입니다.
2025-06-24 17:41:53,196 - src.training - INFO -   precision: 0.0
2025-06-24 17:41:53,196 - src.training - INFO -   recall: 0.0
2025-06-24 17:41:53,196 - src.training - INFO -   f1: 0.0
2025-06-24 17:41:53,196 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 17:41:53,196 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 17:41:53,196 - src.training - INFO -   positive_samples: 270
2025-06-24 17:41:53,196 - src.training - INFO -   negative_samples: 220670
2025-06-24 17:41:53,196 - src.training - INFO -   total_samples: 220940
2025-06-24 17:41:53,196 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 17:41:53,196 - src.training - INFO -   roc_auc: 0.0
2025-06-24 17:41:53,196 - src.training - INFO -   pr_auc: 0.0
2025-06-24 17:41:53,196 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 17:41:53,196 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 17:41:53,196 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 17:41:53,196 - src.training - INFO - 모델 학습 완료
2025-06-24 17:41:53,196 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 17:41:53,196 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:53,196 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:53,196 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:41:53,196 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:41:53,215 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 17:41:53,215 - src.hyperparameter_tuning - ERROR - Trial 2 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 17:41:53,632 - src.hyperparameter_tuning - INFO - Trial 3: 모델 타입 = lightgbm
2025-06-24 17:41:55,576 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 17:41:55,576 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 17:41:55,576 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 17:41:55,576 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 17:41:55,576 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 17:41:55,576 - src.training - INFO - 교차 검증 시작
2025-06-24 17:41:55,576 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 17:41:55,594 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 17:41:56,075 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 17:41:56,075 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 17:41:56,075 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 17:41:56,075 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 17:41:56,075 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 17:41:56,075 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 17:41:56,075 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 17:41:56,075 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 17:41:56,075 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 17:41:56,246 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:41:56,246 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:41:56,246 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:41:56,246 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:41:56,246 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:41:56,246 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 17:41:56,246 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 17:41:56,246 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 17:41:56,246 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 17:41:56,246 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 17:41:57,658 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 17:41:58,761 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:41:58,761 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 17:41:58,765 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 17:41:58,797 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 17:41:58,797 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 17:41:58,797 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 17:41:58,797 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:42:00,107 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:42:00,369 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 17:42:00,369 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:42:00,532 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:42:00,533 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:42:00,574 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:42:00,574 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:42:00,574 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:42:00,574 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 17:42:00,574 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:42:00,574 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:42:00,574 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:42:00,574 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:42:00,574 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:00,574 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 17:42:00,624 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 17:42:00,624 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 17:42:00,624 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:00,624 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:00,624 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 17:42:00,624 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 17:42:00,624 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:00,692 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:42:00,692 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:42:00,692 - src.training - INFO - 모델 학습 시작
2025-06-24 17:42:00,692 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:42:00,692 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:42:00,692 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:42:00,692 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:42:00,692 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:42:00,692 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:42:00,692 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:42:00,692 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:42:00,823 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 17:42:00,823 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 17:42:00,823 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 17:42:00,823 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 17:42:00,823 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 17:42:00,823 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 17:42:00,823 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 17:42:00,823 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 17:42:00,823 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:42:00,823 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 17:42:00,823 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 17:42:00,823 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 17:42:00,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 17:42:00,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:00,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:42:00,910 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:42:00,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:42:01,043 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:42:01,108 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:42:01,172 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:42:01,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:42:01,264 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 17:42:01,264 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:01,328 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 17:42:01,328 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:01,328 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:42:01,328 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:01,329 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:42:01,347 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:42:01,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:42:01,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:42:01,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:42:01,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:42:01,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:42:01,433 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:42:01,433 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:01,448 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 17:42:01,448 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:01,448 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:42:01,448 - src.models.base_model - INFO - [DEBUG] _find_available_targets - y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:01,448 - src.models.base_model - INFO - [DEBUG] _find_available_targets - target_columns: ['suicide_a_next_year']
2025-06-24 17:42:01,448 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 후보: ['suicide_a_next_year', 'pass__suicide_a_next_year', 'remainder__suicide_a_next_year', 'num__suicide_a_next_year', 'cat__suicide_a_next_year']
2025-06-24 17:42:01,448 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:42:01,448 - src.models.base_model - INFO - [DEBUG] 최종 사용 가능한 타겟: ['pass__suicide_a_next_year']
2025-06-24 17:42:01,448 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:01,448 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 17:42:01,459 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   learning_rate: 0.019721610970574007
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   n_estimators: 483
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   subsample: 0.8056937753654446
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.836965827544817
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0029369981104377003
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO -   reg_lambda: 3.425445902633376e-07
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 17:42:01,462 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 17:42:04,348 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 17:42:04,348 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.4003153103655343})})
2025-06-24 17:42:04,348 - src.models.lightgbm_model - INFO -   - Best Iteration: 483
2025-06-24 17:42:04,348 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 17:42:04,349 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 17:42:04,349 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:42:04,349 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:04,349 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:42:04,369 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:42:04,385 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:42:04,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:42:04,419 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:42:04,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:42:04,455 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:42:04,458 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:42:04,458 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:04,461 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 17:42:04,581 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 17:42:04,581 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 17:42:04,581 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 17:42:04,581 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 17:42:04,581 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 17:42:04,581 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 17:42:04,581 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 17:42:04,581 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 17:42:04,585 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 17:42:04,589 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 17:42:04,594 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.05082951 0.04224035 0.01012208 ... 0.00628575 0.01365114 0.00694998]
2025-06-24 17:42:04,594 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 17:42:04,598 - src.evaluation - INFO - 클래스 분포 - 실제: 0=220670, 1=270 (비율: 0.001222)
2025-06-24 17:42:04,598 - src.evaluation - INFO - 예측 분포 - 예측: 0=220920, 1=20
2025-06-24 17:42:05,998 - src.training - INFO -   precision: 0.0
2025-06-24 17:42:05,998 - src.training - INFO -   recall: 0.0
2025-06-24 17:42:05,998 - src.training - INFO -   f1: 0.0
2025-06-24 17:42:05,998 - src.training - INFO -   accuracy: 0.99868742645062
2025-06-24 17:42:05,998 - src.training - INFO -   balanced_accuracy: 0.499954683463996
2025-06-24 17:42:05,998 - src.training - INFO -   positive_samples: 270
2025-06-24 17:42:05,998 - src.training - INFO -   negative_samples: 220670
2025-06-24 17:42:05,998 - src.training - INFO -   total_samples: 220940
2025-06-24 17:42:05,998 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 17:42:05,998 - src.training - INFO -   pr_auc: 0.0
2025-06-24 17:42:05,998 - src.training - INFO -   roc_auc: 0.0
2025-06-24 17:42:05,998 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 17:42:05,999 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 17:42:05,999 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 17:42:05,999 - src.training - INFO - 모델 학습 완료
2025-06-24 17:42:05,999 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.99868742645062, 'balanced_accuracy': 0.499954683463996, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'pr_auc': 0.0, 'roc_auc': 0.0}}
2025-06-24 17:42:05,999 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:05,999 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:05,999 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:05,999 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:06,017 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 17:42:06,018 - src.hyperparameter_tuning - ERROR - Trial 3 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 17:42:06,444 - src.hyperparameter_tuning - INFO - Trial 4: 모델 타입 = lightgbm
2025-06-24 17:42:08,406 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 17:42:08,406 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 17:42:08,406 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 17:42:08,406 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 17:42:08,406 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 17:42:08,406 - src.training - INFO - 교차 검증 시작
2025-06-24 17:42:08,406 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 17:42:08,424 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 17:42:08,905 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 17:42:08,905 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 17:42:08,905 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 17:42:08,905 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 17:42:08,905 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 17:42:08,905 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 17:42:08,905 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 17:42:08,905 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 17:42:08,905 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 17:42:09,075 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:42:09,075 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:42:09,075 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:42:09,075 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:42:09,075 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:42:09,075 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 17:42:09,075 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 17:42:09,075 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 17:42:09,075 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 17:42:09,075 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 17:42:10,527 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 17:42:11,652 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:42:11,652 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 17:42:11,658 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 17:42:11,690 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 17:42:11,691 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 17:42:11,691 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 17:42:11,691 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:42:13,029 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 17:42:13,293 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 17:42:13,293 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:42:13,457 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:42:13,457 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:42:13,499 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:42:13,499 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:42:13,499 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:42:13,499 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 17:42:13,499 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:42:13,499 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:42:13,499 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:42:13,499 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:42:13,499 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:13,499 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 17:42:13,549 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 17:42:13,549 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 17:42:13,549 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:13,549 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:13,549 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 17:42:13,549 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 17:42:13,549 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:13,614 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:42:13,614 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 17:42:13,615 - src.training - INFO - 모델 학습 시작
2025-06-24 17:42:13,615 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:42:13,615 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:42:13,615 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:42:13,615 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:42:13,615 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['pass__suicide_a_next_year']
2025-06-24 17:42:13,615 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:42:13,615 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:42:13,615 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:42:13,746 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 17:42:13,746 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 17:42:13,746 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 17:42:13,746 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 17:42:13,746 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 17:42:13,746 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 17:42:13,746 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 17:42:13,746 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 17:42:13,746 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:42:13,746 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 17:42:13,746 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 17:42:13,746 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 17:42:13,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 17:42:13,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:13,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:42:13,834 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:42:13,899 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:42:13,967 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:42:14,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:42:14,096 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:42:14,172 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:42:14,188 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 17:42:14,188 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:14,253 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 17:42:14,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:14,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:42:14,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:14,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:42:14,272 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:42:14,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:42:14,305 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:42:14,321 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:42:14,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:42:14,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:42:14,359 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:42:14,359 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:14,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 17:42:14,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:14,374 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 17:42:14,374 - src.models.base_model - INFO - [DEBUG] _find_available_targets - y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:14,374 - src.models.base_model - INFO - [DEBUG] _find_available_targets - target_columns: ['suicide_a_next_year']
2025-06-24 17:42:14,374 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 후보: ['suicide_a_next_year', 'pass__suicide_a_next_year', 'remainder__suicide_a_next_year', 'num__suicide_a_next_year', 'cat__suicide_a_next_year']
2025-06-24 17:42:14,374 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:42:14,374 - src.models.base_model - INFO - [DEBUG] 최종 사용 가능한 타겟: ['pass__suicide_a_next_year']
2025-06-24 17:42:14,374 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:14,374 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 17:42:14,387 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   learning_rate: 0.26690431824362526
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   scale_pos_weight: None
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   objective: binary
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   metric: binary_logloss
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   n_estimators: 111
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   subsample: 0.9233589392465844
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7218455076693483
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   reg_alpha: 0.014391207615728067
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO -   reg_lambda: 9.148975058772307e-05
2025-06-24 17:42:14,390 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 17:42:14,391 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 17:42:14,391 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 17:42:14,473 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 17:42:14,473 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'binary_logloss': 0.04236450119220211})})
2025-06-24 17:42:14,473 - src.models.lightgbm_model - INFO -   - Best Iteration: 4
2025-06-24 17:42:14,473 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 17:42:14,473 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 17:42:14,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 17:42:14,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:14,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:42:14,492 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:42:14,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:42:14,526 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:42:14,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:42:14,559 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:42:14,576 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:42:14,579 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 17:42:14,579 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:14,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 17:42:14,585 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 17:42:14,586 - src.models.lightgbm_model - INFO - 예측 완료: (220940, 1)
2025-06-24 17:42:14,586 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 17:42:14,586 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 17:42:14,586 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 17:42:14,586 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 17:42:14,586 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 17:42:14,586 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 17:42:14,589 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 17:42:14,594 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 17:42:14,594 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00000000e+000 5.65111529e-237 3.24454440e-147 4.89420041e-171
 5.85529045e-125 1.30722873e-057 3.88168613e-101 8.66609719e-034
 8.52436809e-261 2.45264724e-201 4.22033690e-267 1.00000000e+000
 7.77853968e-190 1.11835447e-010 8.97522129e-004]
2025-06-24 17:42:14,594 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 17:42:14,599 - src.evaluation - INFO - 클래스 분포 - 실제: 0=220670, 1=270 (비율: 0.001222)
2025-06-24 17:42:14,599 - src.evaluation - INFO - 예측 분포 - 예측: 0=220939, 1=1
2025-06-24 17:42:15,886 - src.training - INFO -   precision: 0.0
2025-06-24 17:42:15,886 - src.training - INFO -   recall: 0.0
2025-06-24 17:42:15,886 - src.training - INFO -   f1: 0.0
2025-06-24 17:42:15,886 - src.training - INFO -   accuracy: 0.9987734226486829
2025-06-24 17:42:15,886 - src.training - INFO -   balanced_accuracy: 0.4999977341731998
2025-06-24 17:42:15,886 - src.training - INFO -   positive_samples: 270
2025-06-24 17:42:15,886 - src.training - INFO -   negative_samples: 220670
2025-06-24 17:42:15,886 - src.training - INFO -   total_samples: 220940
2025-06-24 17:42:15,886 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 17:42:15,886 - src.training - INFO -   pr_auc: 0.0
2025-06-24 17:42:15,886 - src.training - INFO -   roc_auc: 0.0
2025-06-24 17:42:15,886 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 17:42:15,886 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 17:42:15,886 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 17:42:15,886 - src.training - INFO - 모델 학습 완료
2025-06-24 17:42:15,886 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987734226486829, 'balanced_accuracy': 0.4999977341731998, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'pr_auc': 0.0, 'roc_auc': 0.0}}
2025-06-24 17:42:15,886 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:15,886 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:15,886 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:15,886 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:15,905 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 17:42:15,906 - src.hyperparameter_tuning - ERROR - Trial 4 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 17:42:16,333 - src.hyperparameter_tuning - WARNING - 유효하지 않은 best_score: -inf
2025-06-24 17:42:16,336 - src.hyperparameter_tuning - INFO - 최적화 완료!
2025-06-24 17:42:16,336 - src.hyperparameter_tuning - INFO -   - 최고 성능: 0.0000
2025-06-24 17:42:16,336 - src.hyperparameter_tuning - INFO -   - 최적 파라미터: {'n_estimators': 406, 'max_depth': 12, 'learning_rate': 0.1205712628744377, 'subsample': 0.8394633936788146, 'colsample_bytree': 0.6624074561769746, 'min_child_weight': 2, 'reg_alpha': 3.3323645788192616e-08, 'reg_lambda': 0.6245760287469893}
2025-06-24 17:42:18,264 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 17:42:18,264 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 17:42:18,265 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 17:42:18,265 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 17:42:18,265 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 17:42:18,265 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 17:42:18,265 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 17:42:18,265 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 17:42:18,490 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:42:18,490 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:42:18,490 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 17:42:18,490 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 17:42:18,490 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 17:42:18,490 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 17:42:18,490 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 17:42:18,490 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 17:42:18,490 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 17:42:18,490 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 17:42:20,278 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 17:42:21,684 - src.preprocessing - INFO - 데이터 변환 완료: (1333765, 33)
2025-06-24 17:42:21,684 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 17:42:23,026 - src.preprocessing - INFO - 데이터 변환 완료: (1333765, 33)
2025-06-24 17:42:23,027 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 17:42:23,233 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 17:42:23,233 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 17:42:23,233 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 17:42:23,233 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:42:23,233 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 17:42:23,434 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 17:42:23,434 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 17:42:23,434 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - all_columns: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:42:23,434 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - target_columns: ['suicide_a_next_year']
2025-06-24 17:42:23,434 - src.feature_engineering - INFO - 타겟 suicide_a_next_year 매칭됨: pass__suicide_a_next_year
2025-06-24 17:42:23,434 - src.feature_engineering - INFO - [DEBUG] get_target_columns_from_data - available_targets: ['pass__suicide_a_next_year']
2025-06-24 17:42:23,434 - src.hyperparameter_tuning - INFO - [DEBUG] _save_best_model - train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 17:42:23,434 - src.hyperparameter_tuning - INFO - [DEBUG] _save_best_model - feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:23,434 - src.hyperparameter_tuning - INFO - [DEBUG] _save_best_model - target_columns: ['pass__suicide_a_next_year']
2025-06-24 17:42:23,497 - src.hyperparameter_tuning - INFO - [DEBUG] _save_best_model - X_train shape: (1333765, 6), y_train shape: (1333765, 1)
2025-06-24 17:42:23,497 - src.hyperparameter_tuning - INFO - [DEBUG] _save_best_model - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:23,497 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 17:42:23,497 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 17:42:23,497 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 17:42:23,497 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 17:42:23,497 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 17:42:23,497 - src.hyperparameter_tuning - INFO - 최종 모델 학습 - X_train shape: (1333765, 6), y_train shape: (1333765, 1)
2025-06-24 17:42:23,497 - src.hyperparameter_tuning - INFO - 최종 모델 학습 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 17:42:23,497 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 17:42:23,497 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(1333765, 6), y=(1333765, 1)
2025-06-24 17:42:23,497 - src.models.lightgbm_model - INFO - Early Stopping 비활성화
2025-06-24 17:42:23,497 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 17:42:23,497 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (1333765, 6)
2025-06-24 17:42:23,497 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:23,498 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 17:42:23,627 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 17:42:23,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 17:42:23,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 17:42:23,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 17:42:24,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 17:42:24,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 17:42:24,149 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (1333765, 6)
2025-06-24 17:42:24,149 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 17:42:24,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (1333765, 6)
2025-06-24 17:42:24,171 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(1333765, 6), y=(1333765, 0)
2025-06-24 17:42:24,171 - src.models.base_model - INFO - [DEBUG] _find_available_targets - y 컬럼: []
2025-06-24 17:42:24,171 - src.models.base_model - INFO - [DEBUG] _find_available_targets - target_columns: ['suicide_a_next_year']
2025-06-24 17:42:24,171 - src.models.base_model - INFO - [DEBUG] 타겟 suicide_a_next_year 후보: ['suicide_a_next_year', 'pass__suicide_a_next_year', 'remainder__suicide_a_next_year', 'num__suicide_a_next_year', 'cat__suicide_a_next_year']
2025-06-24 17:42:24,171 - src.models.base_model - WARNING - [DEBUG] 타겟 suicide_a_next_year 매칭 실패. 후보: ['suicide_a_next_year', 'pass__suicide_a_next_year', 'remainder__suicide_a_next_year', 'num__suicide_a_next_year', 'cat__suicide_a_next_year']
2025-06-24 17:42:24,171 - src.models.base_model - INFO - [DEBUG] 최종 사용 가능한 타겟: []
2025-06-24 17:42:24,171 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: []
2025-06-24 17:42:24,171 - src.models.lightgbm_model - ERROR - y 데이터프레임에 컬럼이 없습니다! 타겟 컬럼 매칭을 확인하세요.
2025-06-24 17:42:24,173 - src.models.base_model - INFO - 모델이 models/best_tuned_model.joblib에 저장되었습니다.
2025-06-24 17:42:24,173 - src.hyperparameter_tuning - INFO - 최고 모델 저장 완료: models/best_tuned_model.joblib
2025-06-24 17:42:24,909 - src.hyperparameter_tuning - INFO - Study 저장 완료: models/optuna_study.pkl
2025-06-24 17:42:25,125 - matplotlib.legend - WARNING - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
2025-06-24 17:42:25,279 - __main__ - INFO - === 하이퍼파라미터 튜닝 완료 ===
2025-06-24 17:42:25,279 - __main__ - INFO - 최고 성능: 0.0000
2025-06-24 17:42:25,279 - __main__ - INFO - 최적 파라미터:
2025-06-24 17:42:25,279 - __main__ - INFO -   n_estimators: 406
2025-06-24 17:42:25,279 - __main__ - INFO -   max_depth: 12
2025-06-24 17:42:25,279 - __main__ - INFO -   learning_rate: 0.1205712628744377
2025-06-24 17:42:25,279 - __main__ - INFO -   subsample: 0.8394633936788146
2025-06-24 17:42:25,279 - __main__ - INFO -   colsample_bytree: 0.6624074561769746
2025-06-24 17:42:25,279 - __main__ - INFO -   min_child_weight: 2
2025-06-24 17:42:25,279 - __main__ - INFO -   reg_alpha: 3.3323645788192616e-08
2025-06-24 17:42:25,279 - __main__ - INFO -   reg_lambda: 0.6245760287469893

==================================================
튜닝 결과 요약
==================================================
모델 타입: lightgbm
실험 타입: hyperparameter_tuning
MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/15766a98bd104e1bb715fafa5e47b332
최고 성능: 0.0
최적 파라미터: {'n_estimators': 406, 'max_depth': 12, 'learning_rate': 0.1205712628744377, 'subsample': 0.8394633936788146, 'colsample_bytree': 0.6624074561769746, 'min_child_weight': 2, 'reg_alpha': 3.3323645788192616e-08, 'reg_lambda': 0.6245760287469893}
튜닝 시간: N/A
==================================================
2025-06-24 17:42:25,279 - __main__ - INFO - 실험 결과가 /home/junhyung/Documents/simcare/kbsmc_suicide/results/experiment_results_20250624_174225.txt에 저장되었습니다.
2025-06-24 17:42:25,279 - __main__ - INFO - MLflow Experiment ID: 765186397364671153
2025-06-24 17:42:25,279 - __main__ - INFO - MLflow Run ID: 15766a98bd104e1bb715fafa5e47b332
2025-06-24 17:42:25,279 - __main__ - INFO - MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/15766a98bd104e1bb715fafa5e47b332
